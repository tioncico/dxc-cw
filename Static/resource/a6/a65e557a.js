egret=window.egret=window.egret||{},RES=window.RES=window.RES||{},dragonBones=window.dragonBones=window.dragonBones||{},fgui=window.fgui=window.fgui||{},window.fairygui=fgui,god=window.god=window.god||{},window.__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),window.__awaiter=this&&this.__awaiter||function(t,a,s,h){return new(s=s||Promise)(function(i,e){function r(t){try{o(h.next(t))}catch(t){e(t)}}function n(t){try{o(h.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?i(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(r,n)}o((h=h.apply(t,a||[])).next())})},window.__generator=this&&this.__generator||function(i,r){var n,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(i,s)}catch(t){e=[6,t],o=0}finally{n=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},window.__spreadArray=this&&this.__spreadArray||function(t,e){for(var i=0,r=e.length,n=t.length;i<r;i++,n++)t[n]=e[i];return t},window.__decorate=this&&this.__decorate||function(t,e,i,r){var n,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var s=t.length-1;0<=s;s--)(n=t[s])&&(a=(o<3?n(a):3<o?n(e,i,a):n(e,i))||a);return 3<o&&a&&Object.defineProperty(e,i,a),a};var __global,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};void 0===global&&(global=window),void 0===__global&&(__global=global);var __define=this&&this.__define||function(t,e,i,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:i,set:r})};!function(t){t.$hashCount=1;var e=(Object.defineProperty(i.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),i);function i(){this.$hashCode=t.$hashCount++}t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"])}(egret=egret||{}),function(l){var i,h=[],t=(i=l.HashObject,__extends(e,i),e.prototype.$getEventMap=function(t){var e=this.$EventDispatcher;return t?e[2]:e[1]},e.prototype.addEventListener=function(t,e,i,r,n){this.$addListener(t,e,i,r,n)},e.prototype.once=function(t,e,i,r,n){this.$addListener(t,e,i,r,n,!0)},e.prototype.$addListener=function(t,e,i,r,n,o){e||l.$error(1003,"listener");var a=this.$EventDispatcher,s=r?a[2]:a[1],h=s[t];h?0!==a[3]&&(s[t]=h=h.concat()):h=s[t]=[],this.$insertEventBin(h,t,e,i,r,n,o)},e.prototype.$insertEventBin=function(t,e,i,r,n,o,a){o=0|+o;for(var s=-1,h=t.length,l=0;l<h;l++){var u=t[l];if(u.listener==i&&u.thisObject==r&&u.target==this)return!1;-1==s&&u.priority<o&&(s=l)}a={type:e,listener:i,thisObject:r,priority:o,target:this,useCapture:n,dispatchOnce:!!a};return-1!==s?t.splice(s,0,a):t.push(a),!0},e.prototype.removeEventListener=function(t,e,i,r){var n=this.$EventDispatcher,o=r?n[2]:n[1],r=o[t];r&&(0!==n[3]&&(o[t]=r=r.concat()),this.$removeEventBin(r,e,i),0==r.length&&(o[t]=null))},e.prototype.$removeEventBin=function(t,e,i){for(var r=t.length,n=0;n<r;n++){var o=t[n];if(o.listener==e&&o.thisObject==i&&o.target==this)return t.splice(n,1),!0}return!1},e.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},e.prototype.willTrigger=function(t){return this.hasEventListener(t)},e.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},e.prototype.$notifyListener=function(t,e){var i=this.$EventDispatcher,r=(e?i[2]:i[1])[t.$type];if(!r)return!0;var n=r.length;if(0==n)return!0;var o=h;i[3]++;for(var a,s=0;s<n;s++)if((a=r[s]).listener.call(a.thisObject,t),a.dispatchOnce&&o.push(a),t.$isPropagationImmediateStopped)break;for(i[3]--;o.length;)(a=o.pop()).target.removeEventListener(a.type,a.listener,a.thisObject,a.useCapture);return!t.$isDefaultPrevented},e.prototype.dispatchEventWith=function(t,e,i,r){if(e||this.hasEventListener(t)){r=l.Event.create(l.Event,t,e,r);r.data=i;i=this.dispatchEvent(r);return l.Event.release(r),i}return!0},e);function e(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.$EventDispatcher={0:t||e,1:{},2:{},3:0},e}l.EventDispatcher=t,__reflect(t.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret=egret||{}),function(g){function n(t){return 180<(t%=360)?t-=360:t<-180&&(t+=360),t}var a,t=(a=g.EventDispatcher,__extends(s,a),s.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(0)},Object.defineProperty(s.prototype,"name",{get:function(){return this.$name},set:function(t){this.$name=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),s.prototype.$setParent=function(t){this.$parent=t},s.prototype.$onAddToStage=function(t,e){this.$stage=t,this.$nestLevel=e,this.$hasAddToStage=!0,g.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(this)},s.prototype.$onRemoveFromStage=function(){this.$nestLevel=0,g.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(this)},s.prototype.$updateUseTransform=function(){var t=this;1==t.$scaleX&&1==t.$scaleY&&0==t.$skewX&&0==t.$skewY?t.$useTranslate=!1:t.$useTranslate=!0},Object.defineProperty(s.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),s.prototype.$getMatrix=function(){var t=this;return t.$matrixDirty&&(t.$matrixDirty=!1,t.$matrix.$updateScaleAndRotation(t.$scaleX,t.$scaleY,t.$skewX,t.$skewY)),t.$matrix.tx=t.$x,t.$matrix.ty=t.$y,t.$matrix},s.prototype.$setMatrix=function(t,e){void 0===e&&(e=!0);var i=this,r=i.$matrix;r.a=t.a,r.b=t.b,r.c=t.c,r.d=t.d,i.$x=t.tx,i.$y=t.ty,i.$matrixDirty=!1,1==r.a&&0==r.b&&0==r.c&&1==r.d?i.$useTranslate=!1:i.$useTranslate=!0,e&&(i.$scaleX=r.$getScaleX(),i.$scaleY=r.$getScaleY(),i.$skewX=t.$getSkewX(),i.$skewY=t.$getSkewY(),i.$skewXdeg=n(180*i.$skewX/Math.PI),i.$skewYdeg=n(180*i.$skewY/Math.PI),i.$rotation=n(180*i.$skewY/Math.PI)),g.nativeRender&&i.$nativeDisplayObject.setMatrix(t.a,t.b,t.c,t.d,t.tx,t.ty)},s.prototype.$getConcatenatedMatrix=function(){var t=this,e=(e=t.$concatenatedMatrix)||(t.$concatenatedMatrix=new g.Matrix);t.$parent?t.$parent.$getConcatenatedMatrix().$preMultiplyInto(t.$getMatrix(),e):e.copyFrom(t.$getMatrix());var i=t.$anchorOffsetX,r=t.$anchorOffsetY,n=t.$scrollRect;return n?e.$preMultiplyInto(g.$TempMatrix.setTo(1,0,0,1,-n.x-i,-n.y-r),e):0==i&&0==r||e.$preMultiplyInto(g.$TempMatrix.setTo(1,0,0,1,-i,-r),e),t.$concatenatedMatrix},s.prototype.$getInvertedConcatenatedMatrix=function(){var t=this;return t.$invertedConcatenatedMatrix||(t.$invertedConcatenatedMatrix=new g.Matrix),t.$getConcatenatedMatrix().$invertInto(t.$invertedConcatenatedMatrix),t.$invertedConcatenatedMatrix},Object.defineProperty(s.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),s.prototype.$getX=function(){return this.$x},s.prototype.$setX=function(t){var e=this;return e.$x!=t&&(e.$x=t,g.nativeRender?e.$nativeDisplayObject.setX(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())),!0)},Object.defineProperty(s.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),s.prototype.$getY=function(){return this.$y},s.prototype.$setY=function(t){var e=this;return e.$y!=t&&(e.$y=t,g.nativeRender?e.$nativeDisplayObject.setY(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())),!0)},Object.defineProperty(s.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),s.prototype.$getScaleX=function(){return this.$scaleX},s.prototype.$setScaleX=function(t){var e=this;e.$scaleX!=t&&(e.$scaleX=t,e.$matrixDirty=!0,e.$updateUseTransform(),g.nativeRender?e.$nativeDisplayObject.setScaleX(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),s.prototype.$getScaleY=function(){return this.$scaleY},s.prototype.$setScaleY=function(t){var e=this;e.$scaleY!=t&&(e.$scaleY=t,e.$matrixDirty=!0,e.$updateUseTransform(),g.nativeRender?e.$nativeDisplayObject.setScaleY(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),s.prototype.$getRotation=function(){return this.$rotation},s.prototype.$setRotation=function(t){var e,i=this;(t=n(t))!=i.$rotation&&(e=(t-i.$rotation)/180*Math.PI,i.$skewX+=e,i.$skewY+=e,i.$rotation=t,i.$matrixDirty=!0,i.$updateUseTransform(),g.nativeRender?i.$nativeDisplayObject.setRotation(t):((t=i.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(i=i.$maskedObject)&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"skewX",{get:function(){return this.$skewXdeg},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),s.prototype.$setSkewX=function(t){var e=this;t!=e.$skewXdeg&&(t=(t=n(e.$skewXdeg=t))/180*Math.PI,e.$skewX=t,e.$matrixDirty=!0,e.$updateUseTransform(),g.nativeRender?e.$nativeDisplayObject.setSkewX(e.$skewXdeg):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"skewY",{get:function(){return this.$skewYdeg},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),s.prototype.$setSkewY=function(t){var e=this;t!=e.$skewYdeg&&(t=((t=n(e.$skewYdeg=t))+e.$rotation)/180*Math.PI,e.$skewY=t,e.$matrixDirty=!0,e.$updateUseTransform(),g.nativeRender?e.$nativeDisplayObject.setSkewY(e.$skewYdeg):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),s.prototype.$getWidth=function(){return isNaN(this.$explicitWidth)?this.$getOriginalBounds().width:this.$explicitWidth},s.prototype.$setWidth=function(t){t=isNaN(t)?NaN:t,this.$explicitWidth!=t&&(this.$explicitWidth=t)},Object.defineProperty(s.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),s.prototype.$getHeight=function(){return isNaN(this.$explicitHeight)?this.$getOriginalBounds().height:this.$explicitHeight},s.prototype.$setHeight=function(t){t=isNaN(t)?NaN:t,this.$explicitHeight!=t&&(this.$explicitHeight=t)},Object.defineProperty(s.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"anchorOffsetX",{get:function(){return this.$anchorOffsetX},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),s.prototype.$setAnchorOffsetX=function(t){var e=this;e.$anchorOffsetX!=t&&(e.$anchorOffsetX=t,g.nativeRender?e.$nativeDisplayObject.setAnchorOffsetX(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"anchorOffsetY",{get:function(){return this.$anchorOffsetY},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),s.prototype.$setAnchorOffsetY=function(t){var e=this;e.$anchorOffsetY!=t&&(e.$anchorOffsetY=t,g.nativeRender?e.$nativeDisplayObject.setAnchorOffsetY(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),s.prototype.$setVisible=function(t){var e=this;e.$visible!=t&&(e.$visible=t,g.nativeRender?e.$nativeDisplayObject.setVisible(t):(e.$updateRenderMode(),(t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"cacheAsBitmap",{get:function(){return this.$cacheAsBitmap},set:function(t){this.$cacheAsBitmap=t,g.nativeRender?this.$nativeDisplayObject.setCacheAsBitmap(t):this.$setHasDisplayList(t)},enumerable:!0,configurable:!0}),s.prototype.$setHasDisplayList=function(t){var e=this;!!e.$displayList!=t&&(t?(t=g.sys.DisplayList.create(e))&&(e.$displayList=t,e.$cacheDirty=!0):e.$displayList=null)},s.prototype.$cacheDirtyUp=function(){var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},Object.defineProperty(s.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),s.prototype.$setAlpha=function(t){var e=this;e.$alpha!=t&&(e.$alpha=t,g.nativeRender?e.$nativeDisplayObject.setAlpha(t):(e.$updateRenderMode(),(t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},Object.defineProperty(s.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),s.prototype.$getTouchEnabled=function(){return this.$touchEnabled},s.prototype.$setTouchEnabled=function(t){this.$touchEnabled=!!t},Object.defineProperty(s.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),s.prototype.$setScrollRect=function(t){var e=this;t||e.$scrollRect?(t?(e.$scrollRect||(e.$scrollRect=new g.Rectangle),e.$scrollRect.copyFrom(t),g.nativeRender&&e.$nativeDisplayObject.setScrollRect(t.x,t.y,t.width,t.height)):(e.$scrollRect=null,g.nativeRender&&e.$nativeDisplayObject.setScrollRect(0,0,0,0)),g.nativeRender||(e.$updateRenderMode(),(t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(t=e.$maskedObject)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()))):e.$updateRenderMode()},Object.defineProperty(s.prototype,"blendMode",{get:function(){return g.sys.numberToBlendMode(this.$blendMode)},set:function(t){var e=this,t=g.sys.blendModeToNumber(t);e.$blendMode!=t&&(e.$blendMode=t,g.nativeRender?e.$nativeDisplayObject.setBlendMode(t):(e.$updateRenderMode(),(t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"mask",{get:function(){return this.$mask||this.$maskRect},set:function(t){var e=this;if(t!==e){if(t)if(t instanceof s){if(t==e.$mask)return;t.$maskedObject&&(t.$maskedObject.mask=null),(t.$maskedObject=e).$mask=t,g.nativeRender||t.$updateRenderMode(),e.$maskRect&&(g.nativeRender&&e.$nativeDisplayObject.setMaskRect(0,0,0,0),e.$maskRect=null),g.nativeRender&&e.$nativeDisplayObject.setMask(t.$nativeDisplayObject.id)}else e.$maskRect||(e.$maskRect=new g.Rectangle),e.$maskRect.copyFrom(t),g.nativeRender&&e.$nativeDisplayObject.setMaskRect(t.x,t.y,t.width,t.height),e.$mask&&(e.$mask.$maskedObject=null,g.nativeRender||e.$mask.$updateRenderMode()),e.mask&&(g.nativeRender&&e.$nativeDisplayObject.setMask(-1),e.$mask=null);else e.$mask&&(e.$mask.$maskedObject=null,g.nativeRender||e.$mask.$updateRenderMode()),e.mask&&(g.nativeRender&&e.$nativeDisplayObject.setMask(-1),e.$mask=null),e.$maskRect&&(g.nativeRender&&e.$nativeDisplayObject.setMaskRect(0,0,0,0),e.$maskRect=null);g.nativeRender||e.$updateRenderMode()}},enumerable:!0,configurable:!0}),s.prototype.$setMaskRect=function(t){var e=this;(t||e.$maskRect)&&(t?(e.$maskRect||(e.$maskRect=new g.Rectangle),e.$maskRect.copyFrom(t)):e.$maskRect=null)},Object.defineProperty(s.prototype,"filters",{get:function(){return this.$filters},set:function(t){var e,i,r=this,n=r.$filters;if(!n&&!t)return r.$filters=t,void(g.nativeRender?r.$nativeDisplayObject.setFilters(null):(r.$updateRenderMode(),(e=r.$parent)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()),(i=r.$maskedObject)&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())));t&&t.length?(t=t.concat(),r.$filters=t,g.nativeRender&&r.$nativeDisplayObject.setFilters(t)):(r.$filters=t,g.nativeRender&&r.$nativeDisplayObject.setFilters(null)),g.nativeRender||(r.$updateRenderMode(),(e=r.$parent)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()),(i=r.$maskedObject)&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp()))},enumerable:!0,configurable:!0}),s.prototype.getTransformedBounds=function(t,e){return this.$getTransformedBounds(t=t||this,e)},s.prototype.getBounds=function(t,e){void 0===e&&(e=!0);var i=this;return t=i.$getTransformedBounds(i,t),e&&(0!=i.$anchorOffsetX&&(t.x-=i.$anchorOffsetX),0!=i.$anchorOffsetY&&(t.y-=i.$anchorOffsetY)),t},s.prototype.$getTransformedBounds=function(t,e){var i,r=this.$getOriginalBounds();return(e=e||new g.Rectangle).copyFrom(r),t==this||(t?(i=g.$TempMatrix,t.$getInvertedConcatenatedMatrix().$preMultiplyInto(this.$getConcatenatedMatrix(),i)):i=this.$getConcatenatedMatrix(),i.$transformBounds(e)),e},s.prototype.globalToLocal=function(t,e,i){if(void 0===t&&(t=0),void 0===e&&(e=0),g.nativeRender){egret_native.updateNativeRender();var r=egret_native.nrGlobalToLocal(this.$nativeDisplayObject.id,t,e).split(","),n=parseFloat(r[0]),r=parseFloat(r[1]);return i?i.setTo(n,r):i=new g.Point(n,r),i}return this.$getInvertedConcatenatedMatrix().transformPoint(t,e,i)},s.prototype.localToGlobal=function(t,e,i){if(void 0===t&&(t=0),void 0===e&&(e=0),g.nativeRender){egret_native.updateNativeRender();var r=egret_native.nrLocalToGlobal(this.$nativeDisplayObject.id,t,e).split(","),n=parseFloat(r[0]),r=parseFloat(r[1]);return i?i.setTo(n,r):i=new g.Point(n,r),i}return this.$getConcatenatedMatrix().transformPoint(t,e,i)},s.prototype.$getOriginalBounds=function(){var t=this.$getContentBounds();this.$measureChildBounds(t);var e=this.$measureFiltersOffset(!1);return e&&(t.x+=e.minX,t.y+=e.minY,t.width+=-e.minX+e.maxX,t.height+=-e.minY+e.maxY),t},s.prototype.$measureChildBounds=function(t){},s.prototype.$getContentBounds=function(){var t=g.$TempRectangle;return t.setEmpty(),this.$measureContentBounds(t),t},s.prototype.$measureContentBounds=function(t){},s.prototype.$getRenderNode=function(){var t=this,e=t.$renderNode;return e?(t.$renderDirty&&(e.cleanBeforeRender(),t.$updateRenderNode(),t.$renderDirty=!1,e=t.$renderNode),e):null},s.prototype.$updateRenderMode=function(){var t=this;!t.$visible||t.$alpha<=0||t.$maskedObject?t.$renderMode=1:t.filters&&0<t.filters.length?t.$renderMode=2:0!==t.$blendMode||t.$mask&&t.$mask.$stage?t.$renderMode=3:t.$scrollRect||t.$maskRect?t.$renderMode=4:t.$renderMode=null},s.prototype.$measureFiltersOffset=function(t){for(var e=this,i=0,r=0,n=0,o=0;e;){var a=e.$filters;if(a&&a.length)for(var s=a.length,h=0;h<s;h++){var l,u,c,p,d,f,_=a[h];"blur"==_.type?(i-=l=_.blurX,r-=u=_.blurY,n+=l,o+=u):"glow"==_.type?(i-=l=_.blurX,r-=u=_.blurY,n+=l,o+=u,c=_.distance||0,p=_.angle||0,(f=d=0)!=c&&(i+=d=0<(d=c*g.NumberUtils.cos(p))?Math.ceil(d):Math.floor(d),n+=d,r+=f=0<(f=c*g.NumberUtils.sin(p))?Math.ceil(f):Math.floor(f),o+=f)):"custom"==_.type&&(i-=_=_.padding,r-=_,n+=_,o+=_)}e=t?e.$parent:null}return{minX:i=Math.min(i,0),minY:r=Math.min(r,0),maxX:n=Math.max(n,0),maxY:o=Math.max(o,0)}},s.prototype.$getConcatenatedMatrixAt=function(t,e){var i=t.$getInvertedConcatenatedMatrix();if(0!==i.a&&0!==i.d||0!==i.b&&0!==i.c)i.$preMultiplyInto(e,e);else{var r=this,n=t.$nestLevel;for(e.identity();r.$nestLevel>n;){var o=r.$scrollRect;o&&e.concat(g.$TempMatrix.setTo(1,0,0,1,-o.x,-o.y)),e.concat(r.$getMatrix()),r=r.$parent}}},s.prototype.$updateRenderNode=function(){},s.prototype.$hitTest=function(t,e){var i=this;if(!g.nativeRender&&!i.$renderNode||!i.$visible||0==i.$scaleX||0==i.$scaleY)return null;var r=i.$getInvertedConcatenatedMatrix();if(0==r.a&&0==r.b&&0==r.c&&0==r.d)return null;var n=i.$getContentBounds(),o=r.a*t+r.c*e+r.tx,r=r.b*t+r.d*e+r.ty;if(n.contains(o,r)){if(!i.$children){n=i.$scrollRect||i.$maskRect;if(n&&!n.contains(o,r))return null;if(i.$mask&&!i.$mask.$hitTest(t,e))return null}return i}return null},s.prototype.hitTestPoint=function(t,e,i){var r=this;if(i){var n=(h=r.$getInvertedConcatenatedMatrix()).a*t+h.c*e+h.tx,o=h.b*t+h.d*e+h.ty,a=void 0;if(g.nativeRender){(s=g.sys.customHitTestBuffer).resize(3,3),egret_native.forHitTest=!0,egret_native.activateBuffer(s),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject2(r.$nativeDisplayObject.id,1-n,1-o,!0);try{a=new Uint8Array(4),egret_native.nrGetPixels(1,1,1,1,a)}catch(t){throw new Error(g.sys.tr(1039))}return egret_native.activateBuffer(null),egret_native.forHitTest=!1,0===a[3]?!1:!0}i=r.$displayList;if(i){var s=i.renderBuffer;try{a=s.getPixels(n-i.offsetX,o-i.offsetY)}catch(t){throw new Error(g.sys.tr(1039))}}else{(s=g.sys.customHitTestBuffer).resize(3,3);i=g.Matrix.create();i.identity(),i.translate(1-n,1-o),g.sys.systemRenderer.render(this,s,i,!0),g.Matrix.release(i);try{a=s.getPixels(1,1)}catch(t){throw new Error(g.sys.tr(1039))}}return 0!==a[3]}if(0==r.$scaleX||0==r.$scaleY)return!1;var h=r.$getInvertedConcatenatedMatrix(),a=r.getBounds(null,!1),n=h.a*t+h.c*e+h.tx,o=h.b*t+h.d*e+h.ty;if(a.contains(n,o)){r=r.$scrollRect||r.$maskRect;return r&&!r.contains(n,o)?!1:!0}return!1},s.prototype.$addListener=function(t,e,i,r,n,o){a.prototype.$addListener.call(this,t,e,i,r,n,o);o=t==g.Event.ENTER_FRAME;!o&&t!=g.Event.RENDER||-1==(o=o?s.$enterFrameCallBackList:s.$renderCallBackList).indexOf(this)&&o.push(this)},s.prototype.removeEventListener=function(t,e,i,r){a.prototype.removeEventListener.call(this,t,e,i,r);r=t==g.Event.ENTER_FRAME;!r&&t!=g.Event.RENDER||this.hasEventListener(t)||-1!==(r=(t=r?s.$enterFrameCallBackList:s.$renderCallBackList).indexOf(this))&&t.splice(r,1)},s.prototype.dispatchEvent=function(t){if(!t.$bubbles)return a.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),i=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,i),!t.$isDefaultPrevented},s.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var i=e.concat();return i.reverse(),e=i.concat(e)},s.prototype.$dispatchPropagationEvent=function(t,e,i){for(var r=e.length,n=i-1,o=0;o<r;o++){var a=e[o];if(t.$currentTarget=a,t.$eventPhase=o<n?1:o==i||o==n?2:3,a.$notifyListener(t,o<i),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},s.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},Object.defineProperty(s.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,g.nativeRender?this.$nativeDisplayObject.setTint&&this.$nativeDisplayObject.setTint(t):this.$tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!0,configurable:!0}),s.prototype.sortChildren=function(){this.$sortDirty=!1},Object.defineProperty(s.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,g.nativeRender?this.$nativeDisplayObject.setZIndex&&this.$nativeDisplayObject.setZIndex(t):this.parent&&(this.parent.$sortDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"sortableChildren",{get:function(){return this._sortableChildren},set:function(t){this._sortableChildren=t,this.$nativeDisplayObject&&this.$nativeDisplayObject.setSortableChildren&&this.$nativeDisplayObject.setSortableChildren(t)},enumerable:!0,configurable:!0}),s.defaultTouchEnabled=!1,s.$enterFrameCallBackList=[],s.$renderCallBackList=[],s);function s(){var t=a.call(this)||this;return t.$children=null,t.$name="",t.$parent=null,t.$stage=null,t.$nestLevel=0,t.$useTranslate=!1,t.$matrix=new g.Matrix,t.$matrixDirty=!1,t.$x=0,t.$y=0,t.$scaleX=1,t.$scaleY=1,t.$rotation=0,t.$skewX=0,t.$skewXdeg=0,t.$skewY=0,t.$skewYdeg=0,t.$explicitWidth=NaN,t.$explicitHeight=NaN,t.$anchorOffsetX=0,t.$anchorOffsetY=0,t.$visible=!0,t.$displayList=null,t.$cacheAsBitmap=!1,t.$cacheDirty=!1,t.$alpha=1,t.$touchEnabled=s.defaultTouchEnabled,t.$scrollRect=null,t.$blendMode=0,t.$maskedObject=null,t.$mask=null,t.$maskRect=null,t.$parentDisplayList=null,t.$renderNode=null,t.$renderDirty=!1,t.$renderMode=null,t._tint=0,t.$tintRGB=0,t.$sortDirty=!1,t._zIndex=0,t.$lastSortedIndex=0,t._sortableChildren=!1,g.nativeRender&&t.createNativeDisplayObject(),t.tint=16777215,t}g.DisplayObject=t,__reflect(t.prototype,"egret.DisplayObject")}(egret=egret||{}),function(e){var i,t=(i=e.HashObject,__extends(r,i),r.prototype.$toJson=function(){return""},r.prototype.updatePadding=function(){},r.prototype.onPropertyChange=function(){var t=this;t.updatePadding(),e.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(t.$id,t.paddingTop,t.paddingBottom,t.paddingLeft,t.paddingRight),egret_native.NativeDisplayObject.setDataToFilter(t))},r);function r(){var t=i.call(this)||this;return t.type=null,t.$id=null,t.paddingTop=0,t.paddingBottom=0,t.paddingLeft=0,t.paddingRight=0,t.$uniforms={},e.nativeRender&&egret_native.NativeDisplayObject.createFilter(t),t}e.Filter=t,__reflect(t.prototype,"egret.Filter")}(egret=egret||{}),function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret=egret||{}),function(a){(a.sys||(a.sys={})).tr=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=a.$locale_strings[a.$language][t];if(!r)return"{"+t+"}";for(var n=e.length,o=0;o<n;o++)r=r.replace("{"+o+"}",e[o]);return r}}(egret=egret||{}),function(u){var i,t=(i=u.HashObject,__extends(e,i),e.prototype.getTexture=function(t){return this._textureMap[t]},e.prototype.createTexture=function(t,e,i,r,n,o,a,s,h){void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=o+r),void 0===h&&(h=a+n);var l=new u.Texture;return l.disposeBitmapData=!1,l.$bitmapData=this.$texture.$bitmapData,l.$initData(this._bitmapX+e,this._bitmapY+i,r,n,o,a,s,h,this.$texture.$sourceWidth,this.$texture.$sourceHeight),this._textureMap[t]=l},e.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},e);function e(t){var e=i.call(this)||this;return e._bitmapX=0,e._bitmapY=0,e._textureMap=u.createMap(),e.$texture=t,e._bitmapX=t.$bitmapX-t.$offsetX,e._bitmapY=t.$bitmapY-t.$offsetY,e}u.SpriteSheet=t,__reflect(t.prototype,"egret.SpriteSheet")}(egret=egret||{}),function(t){var o,e=(o=t.HashObject,__extends(n,o),Object.defineProperty(n.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),n.prototype.$setTarget=function(t){return this.$target=t,!0},n.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},n.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},n.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},n.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},n.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},n.dispatchEvent=function(t,e,i,r){e=n.create(n,e,i=void 0===i?!1:i),i=n._getPropertyData(n);null!=r&&(i.data=r);t=t.dispatchEvent(e);return n.release(e),t},n._getPropertyData=function(t){return t._props||(t._props={})},n.create=function(t,e,i,r){if((n=(n=t.hasOwnProperty("eventPool")?t.eventPool:n)||(t.eventPool=[])).length){var n=n.pop();return n.$type=e,n.$bubbles=!!i,n.$cancelable=!!r,n.$isDefaultPrevented=!1,n.$isPropagationStopped=!1,n.$isPropagationImmediateStopped=!1,n.$eventPhase=2,n}return new t(e,i,r)},n.release=function(t){t.clean(),Object.getPrototypeOf(t).constructor.eventPool.push(t)},n.ADDED_TO_STAGE="addedToStage",n.REMOVED_FROM_STAGE="removedFromStage",n.ADDED="added",n.REMOVED="removed",n.ENTER_FRAME="enterFrame",n.RENDER="render",n.RESIZE="resize",n.CHANGE="change",n.CHANGING="changing",n.COMPLETE="complete",n.LOOP_COMPLETE="loopComplete",n.FOCUS_IN="focusIn",n.FOCUS_OUT="focusOut",n.ENDED="ended",n.ACTIVATE="activate",n.DEACTIVATE="deactivate",n.CLOSE="close",n.CONNECT="connect",n.LEAVE_STAGE="leaveStage",n.SOUND_COMPLETE="soundComplete",n);function n(t,e,i,r){var n=o.call(this)||this;return n.$eventPhase=2,n.$currentTarget=null,n.$target=null,n.$isDefaultPrevented=!1,n.$isPropagationStopped=!1,n.$isPropagationImmediateStopped=!1,n.$type=t,n.$bubbles=!!e,n.$cancelable=!!i,n.data=r,n}t.Event=e,__reflect(e.prototype,"egret.Event")}(egret=egret||{}),function(u){var c,t=(c=u.DisplayObject,__extends(s,c),Object.defineProperty(s.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),s.prototype.setChildrenSortMode=function(t){u.nativeRender&&this.$nativeDisplayObject.setChildrenSortMode&&this.$nativeDisplayObject.setChildrenSortMode(t)},s.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},s.prototype.addChildAt=function(t,e){return((e=0|+e)<0||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},s.prototype.$doAddChild=function(t,e,i){void 0===i&&(i=!0);var r=this;t==r?u.$error(1005):t instanceof u.DisplayObjectContainer&&t.contains(r)&&u.$error(1004);var n=t.$parent;if(n==r)return r.doSetChildIndex(t,e),t;n&&n.removeChild(t),r.$children.splice(e,0,t),t.$setParent(r),u.nativeRender&&r.$nativeDisplayObject.addChildAt(t.$nativeDisplayObject.id,e);n=r.$stage;if(n&&t.$onAddToStage(n,r.$nestLevel+1),i&&t.dispatchEventWith(u.Event.ADDED,!0),n)for(var o=s.$EVENT_ADD_TO_STAGE_LIST;o.length;){var a=o.shift();a.$stage&&i&&a.dispatchEventWith(u.Event.ADDED_TO_STAGE)}return u.nativeRender||(t.$maskedObject&&t.$maskedObject.$updateRenderMode(),r.$cacheDirty||(r.$cacheDirty=!0,(n=r.$parent)&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp()),(r=r.$maskedObject)&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp()))),this.$childAdded(t,e),t},s.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},s.prototype.getChildAt=function(t){return 0<=(t=0|+t)&&t<this.$children.length?this.$children[t]:(u.$error(1007),null)},s.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},s.prototype.getChildByName=function(t){for(var e,i=this.$children,r=i.length,n=0;n<r;n++)if((e=i[n]).name==t)return e;return null},s.prototype.removeChild=function(t){t=this.$children.indexOf(t);return 0<=t?this.$doRemoveChild(t):(u.$error(1006),null)},s.prototype.removeChildAt=function(t){return 0<=(t=0|+t)&&t<this.$children.length?this.$doRemoveChild(t):(u.$error(1007),null)},s.prototype.$doRemoveChild=function(t,e){void 0===e&&(e=!0);var i=this,r=this.$children,n=r[t=0|+t];if(this.$childRemoved(n,t),e&&n.dispatchEventWith(u.Event.REMOVED,!0),this.$stage){n.$onRemoveFromStage();for(var o=s.$EVENT_REMOVE_FROM_STAGE_LIST;0<o.length;){var a=o.shift();e&&a.$hasAddToStage&&(a.$hasAddToStage=!1,a.dispatchEventWith(u.Event.REMOVED_FROM_STAGE)),a.$hasAddToStage=!1,a.$stage=null}}this.$displayList||this.$parentDisplayList;n.$setParent(null);t=r.indexOf(n);return-1!=t&&r.splice(t,1),u.nativeRender?i.$nativeDisplayObject.removeChild(n.$nativeDisplayObject.id):(n.$maskedObject&&n.$maskedObject.$updateRenderMode(),i.$cacheDirty||(i.$cacheDirty=!0,(t=i.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(i=i.$maskedObject)&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp()))),n},s.prototype.setChildIndex=function(t,e){((e=0|+e)<0||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},s.prototype.doSetChildIndex=function(t,e){var i=this.$children.indexOf(t);i<0&&u.$error(1006),i!=e&&(this.$childRemoved(t,i),this.$children.splice(i,1),this.$children.splice(e,0,t),this.$childAdded(t,e),u.nativeRender?(this.$nativeDisplayObject.removeChild(t.$nativeDisplayObject.id),this.$nativeDisplayObject.addChildAt(t.$nativeDisplayObject.id,e)):this.$cacheDirty||(this.$cacheDirty=!0,(e=this.$parent)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()),(e=this.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},s.prototype.swapChildrenAt=function(t,e){e=0|+e,0<=(t=0|+t)&&t<this.$children.length&&0<=e&&e<this.$children.length?this.doSwapChildrenAt(t,e):u.$error(1007)},s.prototype.swapChildren=function(t,e){t=this.$children.indexOf(t),e=this.$children.indexOf(e);-1==t||-1==e?u.$error(1006):this.doSwapChildrenAt(t,e)},s.prototype.doSwapChildrenAt=function(t,e){if(e<t){var i=e;e=t,t=i}else if(t==e)return;var r=this.$children,n=r[t],i=r[e];this.$childRemoved(n,t),this.$childRemoved(i,e),r[t]=i,r[e]=n,this.$childAdded(i,t),this.$childAdded(n,e),u.nativeRender?this.$nativeDisplayObject.swapChild(t,e):this.$cacheDirty||(this.$cacheDirty=!0,(e=this.$parent)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()),(e=this.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()))},s.prototype.removeChildren=function(){for(var t=this.$children.length-1;0<=t;t--)this.$doRemoveChild(t)},s.prototype.$childAdded=function(t,e){},s.prototype.$childRemoved=function(t,e){},s.prototype.$onAddToStage=function(t,e){c.prototype.$onAddToStage.call(this,t,e);var i=this.$children.length;e++;for(var r=0;r<i;r++){var n=this.$children[r];n.$onAddToStage(t,e),n.$maskedObject&&n.$maskedObject.$updateRenderMode()}},s.prototype.$onRemoveFromStage=function(){c.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,e=t.length,i=0;i<e;i++)t[i].$onRemoveFromStage()},s.prototype.$measureChildBounds=function(t){var e=this.$children,i=e.length;if(0!=i){for(var r=0,n=0,o=0,a=0,s=!1,h=-1;h<i;h++){var l=void 0;(l=-1==h?t:(e[h].getBounds(u.$TempRectangle),e[h].$getMatrix().$transformBounds(u.$TempRectangle),u.$TempRectangle)).isEmpty()||(a=s?(r=Math.min(r,l.x),n=Math.max(n,l.x+l.width),o=Math.min(o,l.y),Math.max(a,l.y+l.height)):(s=!0,n=(r=l.x)+l.width,(o=l.y)+l.height))}t.setTo(r,o,n-r,a-o)}},Object.defineProperty(s.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),s.prototype.$getTouchChildren=function(){return this.$touchChildren},s.prototype.$setTouchChildren=function(t){return this.$touchChildren!=t&&(this.$touchChildren=t,!0)},s.prototype.$hitTest=function(t,e){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),r=i.a*t+i.c*e+i.tx,n=i.b*t+i.d*e+i.ty,i=this.$scrollRect||this.$maskRect;if(i&&!i.contains(r,n))return null;if(this.$mask&&!this.$mask.$hitTest(t,e))return null;for(var o=this.$children,a=!1,s=null,h=o.length-1;0<=h;h--){var l=o[h];if(!l.$maskedObject&&(s=l.$hitTest(t,e))){if(a=!0,s.$touchEnabled)break;s=null}}return s?this.$touchChildren?s:this:a?this:c.prototype.$hitTest.call(this,t,e)},s.prototype._sortChildrenFunc=function(t,e){return t.zIndex===e.zIndex?t.$lastSortedIndex-e.$lastSortedIndex:t.zIndex-e.zIndex},s.prototype.sortChildren=function(){if(c.prototype.sortChildren.call(this),this.$nativeDisplayObject&&this.$nativeDisplayObject.sortChildren)this.$nativeDisplayObject.sortChildren();else{for(var t=this.$sortDirty=!1,e=this.$children,i=null,r=0,n=e.length;r<n;++r)(i=e[r]).$lastSortedIndex=r,t||0===i.zIndex||(t=!0);t&&1<e.length&&e.sort(this._sortChildrenFunc)}},s.$EVENT_ADD_TO_STAGE_LIST=[],s.$EVENT_REMOVE_FROM_STAGE_LIST=[],s);function s(){var t=c.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}u.DisplayObjectContainer=t,__reflect(t.prototype,"egret.DisplayObjectContainer")}(egret=egret||{}),function(i){var r,n=[],o=Math.PI/180,t=(r=i.HashObject,__extends(a,r),a.release=function(t){t&&n.push(t)},a.create=function(t,e){return(n.pop()||new a).setTo(t,e)},Object.defineProperty(a.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),a.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},a.prototype.clone=function(){return new a(this.x,this.y)},a.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},a.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},a.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},a.prototype.add=function(t){return new a(this.x+t.x,this.y+t.y)},a.interpolate=function(t,e,i){var r=1-i;return new a(t.x*i+e.x*r,t.y*i+e.y*r)},a.prototype.normalize=function(t){0==this.x&&0==this.y||(t=t/this.length,this.x*=t,this.y*=t)},a.prototype.offset=function(t,e){this.x+=t,this.y+=e},a.polar=function(t,e){return new a(t*i.NumberUtils.cos(e/o),t*i.NumberUtils.sin(e/o))},a.prototype.subtract=function(t){return new a(this.x-t.x,this.y-t.y)},a.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},a);function a(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=r.call(this)||this;return i.x=t,i.y=e,i}i.Point=t,__reflect(t.prototype,"egret.Point"),i.$TempPoint=new t}(egret=egret||{}),function(n){var r,t=(r=n.DisplayObject,__extends(i,r),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},i.prototype.$onAddToStage=function(t,e){r.prototype.$onAddToStage.call(this,t,e);e=this.$texture;e&&e.$bitmapData&&n.BitmapData.$addDisplayObject(this,e.$bitmapData)},i.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this);var t=this.$texture;t&&n.BitmapData.$removeDisplayObject(this,t.$bitmapData)},Object.defineProperty(i.prototype,"texture",{get:function(){return this.$texture},set:function(t){this.$setTexture(t),t&&this.$renderNode&&(this.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),i.prototype.$setTexture=function(t){var e=this,i=e.$texture;if(t==i)return!1;if(!(e.$texture=t)){i&&n.BitmapData.$removeDisplayObject(e,i.$bitmapData),e.setImageData(null,0,0,0,0,0,0,0,0,0,0),e.$renderDirty=!0;var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());r=e.$maskedObject;return r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp()),n.nativeRender&&this.setBitmapDataToWasm(null),!0}if(e.$refreshImageData(),e.$stage){if(i&&i.$bitmapData){if(i.$bitmapData.hashCode==(t.$bitmapData?t.$bitmapData.hashCode:-1)){e.$renderDirty=!0;r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());r=e.$maskedObject;return r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp()),!0}n.BitmapData.$removeDisplayObject(e,i.$bitmapData)}n.BitmapData.$addDisplayObject(e,t.$bitmapData)}e.$renderDirty=!0;t=e.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp());e=e.$maskedObject;return e&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()),!0},i.prototype.$setBitmapData=function(t){this.$setTexture(t)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setTexture(t)},i.prototype.$refreshImageData=function(){var t=this.$texture;t?(n.nativeRender&&this.setBitmapDataToWasm(t),this.setImageData(t.$bitmapData,t.$bitmapX,t.$bitmapY,t.$bitmapWidth,t.$bitmapHeight,t.$offsetX,t.$offsetY,t.$getTextureWidth(),t.$getTextureHeight(),t.$sourceWidth,t.$sourceHeight)):n.nativeRender&&this.setBitmapDataToWasm(null)},i.prototype.setImageData=function(t,e,i,r,n,o,a,s,h,l,u){this.$bitmapData=t,this.$bitmapX=e,this.$bitmapY=i,this.$bitmapWidth=r,this.$bitmapHeight=n,this.$offsetX=o,this.$offsetY=a,this.$textureWidth=s,this.$textureHeight=h,this.$sourceWidth=l,this.$sourceHeight=u},Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),i.prototype.$setScale9Grid=function(t){var e=this;e.$scale9Grid=t,e.$renderDirty=!0,n.nativeRender?t?e.$nativeDisplayObject.setScale9Grid(t.x,t.y,t.width,t.height):e.$nativeDisplayObject.setScale9Grid(0,0,-1,-1):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()))},Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(t){var e=this;return t!=e.$fillMode&&(e.$fillMode=t,n.nativeRender?e.$nativeDisplayObject.setBitmapFillMode(e.$fillMode):(e.$renderDirty=!0,(t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())),!0)},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t,this.$renderNode.smoothing=t,n.nativeRender||((t=this.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(t=this.$maskedObject)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())))},enumerable:!0,configurable:!0}),i.prototype.$setWidth=function(t){var e=this;return!(t<0||t==e.$explicitBitmapWidth)&&(e.$explicitBitmapWidth=t,e.$renderDirty=!0,n.nativeRender?e.$nativeDisplayObject.setWidth(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())),!0)},i.prototype.$setHeight=function(t){var e=this;return!(t<0||t==e.$explicitBitmapHeight)&&(e.$explicitBitmapHeight=t,e.$renderDirty=!0,n.nativeRender?e.$nativeDisplayObject.setHeight(t):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())),!0)},i.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},i.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},i.prototype.$measureContentBounds=function(t){var e,i;i=this.$bitmapData?(e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight):(e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight),t.setTo(0,0,e,i)},i.prototype.$updateRenderNode=function(){var t,e,i;this.$texture&&(t=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,e=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,(i=this.scale9Grid||this.$texture.scale9Grid)?(this.$renderNode instanceof n.sys.NormalBitmapNode&&(this.$renderNode=new n.sys.BitmapNode),n.sys.BitmapNode.$updateTextureDataWithScale9Grid(this.$renderNode,this.$bitmapData,i,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,t,e,this.$sourceWidth,this.$sourceHeight,this.$smoothing)):(this.fillMode==n.BitmapFillMode.REPEAT&&this.$renderNode instanceof n.sys.NormalBitmapNode&&(this.$renderNode=new n.sys.BitmapNode),n.sys.BitmapNode.$updateTextureData(this.$renderNode,this.$bitmapData,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,t,e,this.$sourceWidth,this.$sourceHeight,this.$fillMode,this.$smoothing)))},Object.defineProperty(i.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,e){var i=r.prototype.$hitTest.call(this,t,e);return i&&this._pixelHitTest&&(this.hitTestPoint(t,e,!0)||(i=null)),i},i.defaultSmoothing=!0,i);function i(t){var e=r.call(this)||this;return e.$texture=null,e.$bitmapData=null,e.$bitmapX=0,e.$bitmapY=0,e.$bitmapWidth=0,e.$bitmapHeight=0,e.$offsetX=0,e.$offsetY=0,e.$textureWidth=0,e.$textureHeight=0,e.$sourceWidth=0,e.$sourceHeight=0,e.$smoothing=i.defaultSmoothing,e.$explicitBitmapWidth=NaN,e.$explicitBitmapHeight=NaN,e.$scale9Grid=null,e.$fillMode="scale",e._pixelHitTest=!1,e.$renderNode=new n.sys.NormalBitmapNode,e.$setTexture(t),t&&(e.$renderNode.rotated=t.$rotated),e}n.Bitmap=t,__reflect(t.prototype,"egret.Bitmap")}(egret=egret||{}),function(t){var u,e=(u=t.Filter,__extends(i,u),Object.defineProperty(i.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.$uniforms.blurX=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.$uniforms.blurY=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1)},enumerable:!0,configurable:!0}),i.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},i.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},i);function i(t,e,i,r,n,o,a,s){void 0===t&&(t=16711680),void 0===e&&(e=1),void 0===i&&(i=6),void 0===r&&(r=6),void 0===n&&(n=2),void 0===o&&(o=1),void 0===a&&(a=!1),void 0===s&&(s=!1);var h=u.call(this)||this,l=h;return l.type="glow",l.$color=t,l.$blue=255&t,l.$green=(65280&t)>>8,l.$red=t>>16,l.$alpha=e,l.$blurX=i,l.$blurY=r,l.$strength=n,l.$quality=o,l.$inner=a,l.$knockout=s,l.$uniforms.color={x:h.$red/255,y:h.$green/255,z:h.$blue/255,w:1},l.$uniforms.alpha=e,l.$uniforms.blurX=i,l.$uniforms.blurY=r,l.$uniforms.strength=n,l.$uniforms.inner=a?1:0,l.$uniforms.knockout=s?0:1,l.$uniforms.dist=0,l.$uniforms.angle=0,l.$uniforms.hideObject=0,l.onPropertyChange(),h}t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret=egret||{}),function(p){p.$TextureScaleFactor=1;var e,t=(e=p.HashObject,__extends(i,e),Object.defineProperty(i.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),i.prototype.$getTextureWidth=function(){return this.$textureWidth},Object.defineProperty(i.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),i.prototype.$getTextureHeight=function(){return this.$textureHeight},i.prototype.$getScaleBitmapWidth=function(){return this.$bitmapWidth*p.$TextureScaleFactor},i.prototype.$getScaleBitmapHeight=function(){return this.$bitmapHeight*p.$TextureScaleFactor},Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.$bitmapData},set:function(t){this.$ktxData=null,this._setBitmapData(t)},enumerable:!0,configurable:!0}),i.prototype._setBitmapData=function(t){this.$bitmapData=t;var e=p.$TextureScaleFactor,i=t.width*e,e=t.height*e;this.$initData(0,0,i,e,0,0,i,e,t.width,t.height)},Object.defineProperty(i.prototype,"ktxData",{get:function(){return this.$ktxData},set:function(t){this._setKtxData(t)},enumerable:!0,configurable:!0}),i.prototype._setKtxData=function(t){var e;t?t!=this.$ktxData&&((e=new p.KTXContainer(t,1)).isInvalid?p.error("ktx data is invalid"):(this.$ktxData=t,(t=new p.BitmapData(t)).format="ktx",e.uploadLevels(t,!1),this._setBitmapData(t))):p.error("ktx data is null")},i.prototype.$initData=function(t,e,i,r,n,o,a,s,h,l,u){void 0===u&&(u=!1);var c=p.$TextureScaleFactor;this.$bitmapX=t/c,this.$bitmapY=e/c,this.$bitmapWidth=i/c,this.$bitmapHeight=r/c,this.$offsetX=n,this.$offsetY=o,this.$textureWidth=a,this.$textureHeight=s,this.$sourceWidth=h,this.$sourceHeight=l,this.$rotated=u,p.BitmapData.$invalidate(this.$bitmapData)},i.prototype.getPixel32=function(t,e){throw new Error},i.prototype.getPixels=function(t,e,i,r){throw void 0===i&&(i=1),void 0===r&&(r=1),new Error},i.prototype.toDataURL=function(t,e,i){throw new Error},i.prototype.saveToFile=function(t,e,i){throw new Error},i.prototype.dispose=function(){this.$bitmapData&&(this.disposeBitmapData&&this.$bitmapData.$dispose(),this.$bitmapData=null)},i);function i(){var t=e.call(this)||this;return t.disposeBitmapData=!0,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0,t.$bitmapData=null,t.$ktxData=null,t.$rotated=!1,t}p.Texture=t,__reflect(t.prototype,"egret.Texture")}(egret=egret||{}),function(t){var e;function i(){this.type=0,this.drawData=[],this.renderCount=0}e=t.sys||(t.sys={}),i.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},i.prototype.$getRenderCount=function(){return this.renderCount},t=i,e.RenderNode=t,__reflect(t.prototype,"egret.sys.RenderNode")}(egret=egret||{}),function(t){var e;function i(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}e=t.sys||(t.sys={}),i.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},i.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},i.prototype.curveTo=function(t,e,i,r){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=i,this.$data[n++]=r,this.dataPosition=n},i.prototype.cubicCurveTo=function(t,e,i,r,n,o){this.$commands[this.commandPosition++]=4;var a=this.dataPosition;this.$data[a++]=t,this.$data[a++]=e,this.$data[a++]=i,this.$data[a++]=r,this.$data[a++]=n,this.$data[a++]=o,this.dataPosition=a},i.prototype.drawRect=function(t,e,i,r){i=t+i,r=e+r;this.moveTo(t,e),this.lineTo(i,e),this.lineTo(i,r),this.lineTo(t,r),this.lineTo(t,e)},i.prototype.drawRoundRect=function(t,e,i,r,n,o){var a,s,h,l,u=.5*n|0,c=o?.5*o|0:u;u&&c?((l=.5*r)<c&&(c=l),(s=.5*i)!==(u=s<u?s:u)||l!==c?(h=t+u,n=(a=t+i)-u,o=e+c,this.moveTo(a,l=(s=e+r)-c),this.curveTo(a,s,n,s),this.lineTo(h,s),this.curveTo(t,s,t,l),this.lineTo(t,o),this.curveTo(t,e,h,e),this.lineTo(n,e),this.curveTo(a,e,a,o),this.lineTo(a,l)):u===c?this.drawCircle(t+u,e+c,u):this.drawEllipse(t,e,2*u,2*c)):this.drawRect(t,e,i,r)},i.prototype.drawCircle=function(t,e,i){this.arcToBezier(t,e,i,i,0,2*Math.PI)},i.prototype.drawEllipse=function(t,e,i,r){i*=.5,r*=.5;this.arcToBezier(t+=i,e+=r,i,r,0,2*Math.PI)},i.prototype.drawArc=function(t,e,i,r,n,o){o?r<=n&&(n-=2*Math.PI):n<=r&&(n+=2*Math.PI),this.arcToBezier(t,e,i,i,r,n,o)},i.prototype.arcToBezier=function(t,e,i,r,n,o,a){var s=.5*Math.PI,h=n,l=h;a?(l+=-s-h%s)<o&&(l=o):o<(l+=s-h%s)&&(l=o);var u=t+Math.cos(h)*i,c=e+Math.sin(h)*r;this.$lastX==u&&this.$lastY==c||this.moveTo(u,c);for(var p=Math.cos(h),d=Math.sin(h),f=0;f<4;f++){var _=4*Math.tan((l-h)/4)/3,g=u-d*_*i,y=c+p*_*r,u=t+(p=Math.cos(l))*i,c=e+(d=Math.sin(l))*r;if(this.cubicCurveTo(g,y,u+d*_*i,c-p*_*r,u,c),l===o)break;h=l,a?(l=h-s)<o&&(l=o):o<(l=h+s)&&(l=o)}},t=i,e.Path2D=t,__reflect(t.prototype,"egret.sys.Path2D")}(egret=egret||{}),(egret=egret||{}).fontMapping={},(egret||(egret={})).createMap=function(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t},global.DEBUG=!0,global.RELEASE=!1,function(n){n.getString=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return n.sys.tr.apply(n.sys,arguments)},n.$error=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=n.sys.tr.apply(null,arguments);throw n.sys.$errorToFPS("Error #"+t+": "+r),new Error("#"+t+": "+r)},n.$warn=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=n.sys.tr.apply(null,arguments);n.sys.$warnToFPS("Warning #"+t+": "+r),n.warn("Warning #"+t+": "+r)},n.$markCannotUse=function(e,i,t){Object.defineProperty(e.prototype,i,{get:function(){return n.$warn(1009,n.getQualifiedClassName(e),i),t},set:function(t){n.$error(1009,n.getQualifiedClassName(e),i)},enumerable:!0,configurable:!0})}}(egret=egret||{}),(egret=egret||{}).BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"},function(i){var e,t=(e=i.DisplayObjectContainer,__extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(13)},Object.defineProperty(r.prototype,"frameRate",{get:function(){return i.ticker.$frameRate},set:function(t){i.ticker.$setFrameRate(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),r.prototype.invalidate=function(){i.sys.$invalidateRenderFlag=!0},r.prototype.registerImplementation=function(t,e){i.registerImplementation(t,e)},r.prototype.getImplementation=function(t){return i.getImplementation(t)},Object.defineProperty(r.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textureScaleFactor",{get:function(){return i.$TextureScaleFactor},set:function(t){i.$TextureScaleFactor=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),r.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},r);function r(){var t=e.call(this)||this;return t.$stageWidth=0,t.$stageHeight=0,t.$scaleMode=i.StageScaleMode.SHOW_ALL,t.$orientation=i.OrientationMode.AUTO,t.$maxTouches=99,t.$drawToSurfaceAutoClear=function(){this.$displayList&&this.$displayList.drawToSurface()},t.$drawToSurface=function(){this.$displayList&&this.$displayList.$stageRenderToSurface()},t.$resize=function(t,e){this.$stageWidth=t,this.$stageHeight=e,this.$displayList.renderBuffer.resize(t,e),this.dispatchEventWith(i.Event.RESIZE)},(t.$stage=t).$nestLevel=1,t}i.Stage=t,__reflect(t.prototype,"egret.Stage"),i.$markCannotUse(t,"alpha",1),i.$markCannotUse(t,"visible",!0),i.$markCannotUse(t,"x",0),i.$markCannotUse(t,"y",0),i.$markCannotUse(t,"scaleX",1),i.$markCannotUse(t,"scaleY",1),i.$markCannotUse(t,"rotation",0),i.$markCannotUse(t,"cacheAsBitmap",!1),i.$markCannotUse(t,"scrollRect",null),i.$markCannotUse(t,"filters",null),i.$markCannotUse(t,"blendMode",null),i.$markCannotUse(t,"touchEnabled",!0),i.$markCannotUse(t,"matrix",null)}(egret=egret||{}),function(t){var e=(i.NORMAL="normal",i.ADD="add",i.ERASE="erase",i);function i(){}t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret=egret||{}),function(t){!function(t){for(var e=["normal","add","erase"],i={},r=e.length,n=0;n<r;n++)i[e[n]]=n;t.blendModeToNumber=function(t){return void 0===(t=i[t])?0:t},t.numberToBlendMode=function(t){return void 0===(t=e[t])?"normal":t}}(t.sys||(t.sys={}))}(egret=egret||{}),(egret=egret||{}).ChildrenSortMode={DEFAULT:"default",INCREASE_Y:"increaseY",DECREASE_Y:"decreaseY"},(egret=egret||{}).CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"},function(n){var t=(o.compileProgram=function(t,e,i){var r=o.compileFragmentShader(t,i),i=o.compileVertexShader(t,e),e=t.createProgram();return t.attachShader(e,i),t.attachShader(e,r),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)||n.$warn(1020),e},o.compileFragmentShader=function(t,e){return o._compileShader(t,e,t.FRAGMENT_SHADER)},o.compileVertexShader=function(t,e){return o._compileShader(t,e,t.VERTEX_SHADER)},o._compileShader=function(t,e,i){i=t.createShader(i);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:null},o.checkCanUseWebGL=function(){if(null==o.canUseWebGL)try{var t=document.createElement("canvas");o.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){o.canUseWebGL=!1}return o.canUseWebGL},o.deleteWebGLTexture=function(t){var e;t&&(t[n.engine_default_empty_texture]?console.warn("deleteWebGLTexture:"+n.engine_default_empty_texture):(e=t[n.glContext])?e.deleteTexture(t):console.error("deleteWebGLTexture gl = "+e))},o.premultiplyTint=function(t,e){return 1===e?(255*e<<24)+t:0===e?0:(255*e<<24)+(((t>>16&255)*e+.5|0)<<16)+(((t>>8&255)*e+.5|0)<<8)+((255&t)*e+.5|0)},o);function o(){}n.WebGLUtils=t,__reflect(t.prototype,"egret.WebGLUtils")}(egret=egret||{}),function(t){var r,e=(r=t.Event,__extends(i,r),i.FOCUS_IN="focusIn",i.FOCUS_OUT="focusOut",i);function i(t,e,i){return r.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this}t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret=egret||{}),function(t){var e,i=(e=t.Event,__extends(r,e),r.PERMISSION_DENIED="permissionDenied",r.UNAVAILABLE="unavailable",r);function r(){return null!==e&&e.apply(this,arguments)||this}t.GeolocationEvent=i,__reflect(i.prototype,"egret.GeolocationEvent")}(egret=egret||{}),function(r){var n,t=(n=r.Event,__extends(o,n),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),o.dispatchHTTPStatusEvent=function(t,e){var i=r.Event.create(o,o.HTTP_STATUS);i._status=e;t=t.dispatchEvent(i);return r.Event.release(i),t},o.HTTP_STATUS="httpStatus",o);function o(t,e,i){i=n.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this;return i._status=0,i}r.HTTPStatusEvent=t,__reflect(t.prototype,"egret.HTTPStatusEvent")}(egret=egret||{}),function(i){var r,t=(r=i.Event,__extends(n,r),n.dispatchIOErrorEvent=function(t){var e=i.Event.create(n,n.IO_ERROR),t=t.dispatchEvent(e);return i.Event.release(e),t},n.IO_ERROR="ioError",n);function n(t,e,i){return r.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this}i.IOErrorEvent=t,__reflect(t.prototype,"egret.IOErrorEvent")}(egret=egret||{}),function(t){var e,i=(e=t.Event,__extends(r,e),r);function r(){return null!==e&&e.apply(this,arguments)||this}t.MotionEvent=i,__reflect(i.prototype,"egret.MotionEvent")}(egret=egret||{}),function(t){var e,i=(e=t.Event,__extends(r,e),r);function r(){return null!==e&&e.apply(this,arguments)||this}t.OrientationEvent=i,__reflect(i.prototype,"egret.OrientationEvent")}(egret=egret||{}),function(n){var o,t=(o=n.Event,__extends(a,o),a.dispatchProgressEvent=function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);e=n.Event.create(a,e);e.bytesLoaded=i,e.bytesTotal=r;t=t.dispatchEvent(e);return n.Event.release(e),t},a.PROGRESS="progress",a.SOCKET_DATA="socketData",a);function a(t,e,i,r,n){void 0===r&&(r=0),void 0===n&&(n=0);i=o.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this;return i.bytesLoaded=0,i.bytesTotal=0,i.bytesLoaded=r,i.bytesTotal=n,i}n.ProgressEvent=t,__reflect(t.prototype,"egret.ProgressEvent")}(egret=egret||{}),function(i){var r,t=(r=i.Event,__extends(n,r),n.dispatchStageOrientationEvent=function(t,e){e=i.Event.create(n,e),t=t.dispatchEvent(e);return i.Event.release(e),t},n.ORIENTATION_CHANGE="orientationChange",n);function n(t,e,i){return r.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this}i.StageOrientationEvent=t,__reflect(t.prototype,"egret.StageOrientationEvent")}(egret=egret||{}),function(r){var n,t=(n=r.Event,__extends(o,n),o.dispatchTextEvent=function(t,e,i){e=r.Event.create(o,e);e.text=i;t=t.dispatchEvent(e);return r.Event.release(e),t},o.LINK="link",o);function o(t,e,i,r){void 0===r&&(r="");i=n.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this;return i.text=r,i}r.TextEvent=t,__reflect(t.prototype,"egret.TextEvent")}(egret=egret||{}),function(n){var r,t=(r=n.Event,__extends(o,r),o.prototype.updateAfterEvent=function(){n.sys.$requestRenderingFlag=!0},o.dispatchTimerEvent=function(t,e,i,r){r=n.Event.create(o,e,i,r),t=t.dispatchEvent(r);return n.Event.release(r),t},o.TIMER="timer",o.TIMER_COMPLETE="timerComplete",o);function o(t,e,i){return r.call(this,t,e,i)||this}n.TimerEvent=t,__reflect(t.prototype,"egret.TimerEvent")}(egret=egret||{}),function(s){var t=function(){};s.CompressedTextureData=t,__reflect(t.prototype,"egret.CompressedTextureData"),s.etc_alpha_mask="etc_alpha_mask",s.engine_default_empty_texture="engine_default_empty_texture",s.is_compressed_texture="is_compressed_texture",s.glContext="glContext",s.UNPACK_PREMULTIPLY_ALPHA_WEBGL="UNPACK_PREMULTIPLY_ALPHA_WEBGL";var r,t=(r=s.HashObject,__extends(h,r),Object.defineProperty(h.prototype,"source",{get:function(){return this.$source},set:function(t){this.$source=t,s.nativeRender&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,t)},enumerable:!0,configurable:!0}),h.create=function(t,e,i){var r="",n="image/png";"/"===(r="arraybuffer"===t?s.Base64Util.encode(e):e).charAt(0)?n="image/jpeg":"R"===r.charAt(0)?n="image/gif":"i"===r.charAt(0)&&(n="image/png");var o=new Image;o.src="data:"+n+";base64,"+r,o.crossOrigin="*";var a=new h(o);return o.onload=function(){o.onload=void 0,a.source=o,a.height=o.height,a.width=o.width,i&&i(a)},a},h.prototype.$dispose=function(){"webgl"==s.Capabilities.renderMode&&this.webGLTexture&&(s.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source&&this.source.src&&(this.source.src=""),this.source=null,this.clearCompressedTextureData(),this.debugCompressedTextureURL="",this.etcAlphaMask=null,s.nativeRender&&egret_native.NativeDisplayObject.disposeNativeBitmapData(this.$nativeBitmapData),h.$dispose(this)},h.$addDisplayObject=function(t,e){var i;!e||(i=e.hashCode)&&(h._displayList[i]?(e=h._displayList[i]).indexOf(t)<0&&e.push(t):h._displayList[i]=[t])},h.$removeDisplayObject=function(t,e){!e||(e=e.hashCode)&&(!h._displayList[e]||0<=(t=(e=h._displayList[e]).indexOf(t))&&e.splice(t,1))},h.$invalidate=function(t){if(t){t=t.hashCode;if(t&&h._displayList[t])for(var e=h._displayList[t],i=0;i<e.length;i++){e[i]instanceof s.Bitmap&&e[i].$refreshImageData();var r=e[i];r.$renderDirty=!0;var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());r=r.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}}},h.$dispose=function(t){if(t){t=t.hashCode;if(t&&h._displayList[t]){for(var e=0,i=h._displayList[t];e<i.length;e++){var r=i[e];r instanceof s.Bitmap&&(r.$bitmapData=null),r.$renderDirty=!0;var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());r=r.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}delete h._displayList[t]}}},h.prototype._getCompressedTextureData=function(t,e){t=this.compressedTextureData[t];return t?t[e]:null},h.prototype.getCompressed2dTextureData=function(){return this._getCompressedTextureData(0,0)},h.prototype.$setCompressed2dTextureData=function(t){s.nativeRender&&0==this.compressedTextureData.length&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,t[0]),this.compressedTextureData.push(t)},h.prototype.hasCompressed2d=function(){return!!this.getCompressed2dTextureData()},h.prototype.clearCompressedTextureData=function(){this.compressedTextureData.length=0},Object.defineProperty(h.prototype,"etcAlphaMask",{get:function(){return this.$etcAlphaMask},set:function(t){s.nativeRender&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,t),this.$etcAlphaMask=t},enumerable:!0,configurable:!0}),h._displayList=s.createMap(),h);function h(t){var e,i=r.call(this)||this;return i.format="image",i.$deleteSource=!0,i.compressedTextureData=[],i.debugCompressedTextureURL="",i.$etcAlphaMask=null,s.nativeRender&&((e=new egret_native.NativeBitmapData).$init(),i.$nativeBitmapData=e),i.source=t,i.source&&(i.width=+t.width,i.height=+t.height),i}s.BitmapData=t,__reflect(t.prototype,"egret.BitmapData")}(egret=egret||{}),function(h){var a,t=new h.Point,e=(a=h.Event,__extends(l,a),l.prototype.$initTo=function(t,e,i){this.touchPointID=+i||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(l.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),l.prototype.getLocalXY=function(){this.targetChanged=!1,this.$target.$getInvertedConcatenatedMatrix().transformPoint(this.$stageX,this.$stageY,t),this._localX=t.x,this._localY=t.y},l.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},l.prototype.updateAfterEvent=function(){h.sys.$requestRenderingFlag=!0},l.dispatchTouchEvent=function(t,e,i,r,n,o,a,s){if(void 0===s&&(s=!1),!i&&!t.hasEventListener(e))return!0;r=h.Event.create(l,e,i,r);r.$initTo(n,o,a),r.touchDown=s;t=t.dispatchEvent(r);return h.Event.release(r),t},l.TOUCH_MOVE="touchMove",l.TOUCH_BEGIN="touchBegin",l.TOUCH_END="touchEnd",l.TOUCH_CANCEL="touchCancel",l.TOUCH_TAP="touchTap",l.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",l);function l(t,e,i,r,n,o){i=a.call(this,t,e,i)||this;return i.targetChanged=!0,i.touchDown=!1,i.$initTo(r,n,o),i}h.TouchEvent=e,__reflect(e.prototype,"egret.TouchEvent")}(egret=egret||{}),function(i){var o,t=(o=i.Filter,__extends(e,o),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.blurXFilter.blurX=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.blurYFilter.blurY=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},e.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},e.prototype.onPropertyChange=function(){var t=this;t.updatePadding(),i.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(t.blurXFilter.$id,0,0,t.paddingLeft,t.paddingRight),egret_native.NativeDisplayObject.setFilterPadding(t.blurYFilter.$id,t.paddingTop,t.paddingBottom,0,0),egret_native.NativeDisplayObject.setDataToFilter(t))},e);function e(t,e,i){void 0===t&&(t=4),void 0===e&&(e=4),void 0===i&&(i=1);var r=o.call(this)||this,n=r;return n.type="blur",n.$blurX=t,n.$blurY=e,n.$quality=i,n.blurXFilter=new a(t),n.blurYFilter=new h(e),n.onPropertyChange(),r}i.BlurFilter=t,__reflect(t.prototype,"egret.BlurFilter");var r,a=(r=i.Filter,__extends(n,r),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),n);function n(t){void 0===t&&(t=4);var e=r.call(this)||this;return i.nativeRender?e.type="blur":e.type="blurX",e.$uniforms.blur={x:t,y:0},e.onPropertyChange(),e}__reflect(a.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var s,h=(s=i.Filter,__extends(l,s),Object.defineProperty(l.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),l);function l(t){void 0===t&&(t=4);var e=s.call(this)||this;return i.nativeRender?e.type="blur":e.type="blurY",e.$uniforms.blur={x:0,y:t},e.onPropertyChange(),e}__reflect(h.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(egret=(egret=egret||{})||{}),function(t){var i,e=(i=t.Filter,__extends(r,i),Object.defineProperty(r.prototype,"matrix",{get:function(){for(var t=0;t<20;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t)},enumerable:!0,configurable:!0}),r.prototype.setMatrix=function(t){if(t)for(var e=0;e<20;e++)this.$matrix[e]=t[e];else for(e=0;e<20;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var i=this.$matrix,r=this.$uniforms.matrix,n=this.$uniforms.colorAdd,e=0,o=0;e<i.length;e++)4===e?n.x=i[e]/255:9===e?n.y=i[e]/255:14===e?n.z=i[e]/255:19===e?n.w=i[e]/255:(r[o]=i[e],o++);this.onPropertyChange()},r.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},r);function r(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.$matrix=[],e.matrix2=[],e.type="colorTransform",e.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.$uniforms.colorAdd={x:0,y:0,z:0,w:0},e.setMatrix(t),e.onPropertyChange(),e}t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret=egret||{}),function(e){var n,o,a={},s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),h=new Array(36),l=0,t=(o=e.Filter,__extends(i,o),Object.defineProperty(i.prototype,"padding",{get:function(){return this.$padding},set:function(t){this.$padding!=t&&(this.$padding=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),i.prototype.onPropertyChange=function(){var t;e.nativeRender&&(t=this,egret_native.NativeDisplayObject.setFilterPadding(t.$id,t.$padding,t.$padding,t.$padding,t.$padding),egret_native.NativeDisplayObject.setDataToFilter(t))},i);function i(t,e,i){void 0===i&&(i={});var r=o.call(this)||this;r.$padding=0;e=(r.$vertexSrc=t)+(r.$fragmentSrc=e);return a[e]||(a[e]=function(){for(var t=0;t<36;t++)8===t||13===t||18===t||23===t?h[t]="-":14===t?h[t]="4":(l<=2&&(l=33554432+16777216*Math.random()|0),n=15&l,l>>=4,h[t]=s[19===t?3&n|8:n]);return h.join("")}()),r.$shaderKey=a[e],r.$uniforms=i,r.type="custom",r.onPropertyChange(),r}e.CustomFilter=t,__reflect(t.prototype,"egret.CustomFilter")}(egret=egret||{}),function(o){var c,t=(c=o.GlowFilter,__extends(e,c),Object.defineProperty(e.prototype,"distance",{get:function(){return this.$distance},set:function(t){this.$distance!=t&&(this.$distance=t,this.$uniforms.dist=t,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.$angle},set:function(t){this.$angle!=t&&(this.$angle=t,this.$uniforms.angle=t/180*Math.PI,this.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0)},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},e.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY;var e=t.distance||0,i=t.angle||0,r=0,n=0;0!=e&&(r=0<(r=e*o.NumberUtils.cos(i))?Math.ceil(r):Math.floor(r),n=0<(n=e*o.NumberUtils.sin(i))?Math.ceil(n):Math.floor(n),t.paddingLeft+=r,t.paddingRight+=r,t.paddingTop+=n,t.paddingBottom+=n)},e);function e(t,e,i,r,n,o,a,s,h,l,u){void 0===t&&(t=4),void 0===e&&(e=45),void 0===u&&(u=!1);h=c.call(this,i=void 0===i?0:i,r=void 0===r?1:r,n=void 0===n?4:n,o=void 0===o?4:o,a=void 0===a?1:a,s=void 0===s?1:s,h=void 0===h?!1:h,l=void 0===l?!1:l)||this,l=h;return l.$distance=t,l.$angle=e,l.$hideObject=u,l.$uniforms.dist=t,l.$uniforms.angle=e/180*Math.PI,l.$uniforms.hideObject=u?1:0,l.onPropertyChange(),h}o.DropShadowFilter=t,__reflect(t.prototype,"egret.DropShadowFilter")}(egret=egret||{}),function(t){var e=(i.LINEAR="linear",i.RADIAL="radial",i);function i(){}t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret=egret||{}),function(p){function h(t){return(t%=2*Math.PI)<0&&(t+=2*Math.PI),t}function c(t,e){for(var i=[],r=0;r<e;r++){var n=function(t,e){var i=0,r=0,n=0,o=t.length;{var a,s,h,l,u,c;o/2==3?(a=t[i++],s=t[i++],h=t[i++],l=t[i++],u=t[i++],c=t[i++],r=d(a,h,u,e),n=d(s,l,c,e)):o/2==4&&(a=t[i++],s=t[i++],h=t[i++],l=t[i++],u=t[i++],c=t[i++],o=t[i++],i=t[i++],r=f(a,h,u,o,e),n=f(s,l,c,i,e))}return p.Point.create(r,n)}(t,r/e);n&&i.push(n)}return i}function d(t,e,i,r){return Math.pow(1-r,2)*t+2*r*(1-r)*e+Math.pow(r,2)*i}function f(t,e,i,r,n){return Math.pow(1-n,3)*t+3*n*Math.pow(1-n,2)*e+3*(1-n)*Math.pow(n,2)*i+Math.pow(n,3)*r}var e,t=(e=p.HashObject,__extends(i,e),i.prototype.$setTarget=function(t){this.$targetDisplay&&(this.$targetDisplay.$renderNode=null),t.$renderNode=this.$renderNode,this.$targetDisplay=t,this.$targetIsSprite=t instanceof p.Sprite},i.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},i.prototype.beginFill=function(t,e){t=+t||0,e=+(e=void 0===e?1:e)||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginFill(t,e),this.fillPath=this.$renderNode.beginFill(t,e,this.strokePath),1<this.$renderNode.drawData.length&&this.fillPath.moveTo(this.lastX,this.lastY)},i.prototype.beginGradientFill=function(t,e,i,r,n){void 0===n&&(n=null),p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginGradientFill(t,e,i,r,n),this.fillPath=this.$renderNode.beginGradientFill(t,e,i,r,n,this.strokePath),1<this.$renderNode.drawData.length&&this.fillPath.moveTo(this.lastX,this.lastY)},i.prototype.endFill=function(){p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setEndFill(),this.fillPath=null},i.prototype.lineStyle=function(t,e,i,r,n,o,a,s,h){void 0===r&&(r=!1),void 0===n&&(n="normal"),void 0===o&&(o=null),void 0===a&&(a=null),t=+(t=void 0===t?NaN:t)||0,e=+(e=void 0===e?0:e)||0,i=+(i=void 0===i?1:i)||0,s=+(s=void 0===s?3:s)||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineStyle(t,e,i,r,n,o,a,s),t<=0?(this.strokePath=null,this.setStrokeWidth(0)):(this.setStrokeWidth(t),this.strokePath=this.$renderNode.lineStyle(t,e,i,o,a,s,h),1<this.$renderNode.drawData.length&&this.strokePath.moveTo(this.lastX,this.lastY))},i.prototype.drawRect=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRect(t,e,i,r);var n=this.fillPath,o=this.strokePath;n&&n.drawRect(t,e,i,r),o&&o.drawRect(t,e,i,r),this.extendBoundsByPoint(t+i,e+r),this.updatePosition(t,e),this.dirty()},i.prototype.drawRoundRect=function(t,e,i,r,n,o){t=+t||0,e=+e||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRoundRect(t,e,i,r,n,o);var a=this.fillPath,s=this.strokePath;a&&a.drawRoundRect(t,e,i,r,n,o),s&&s.drawRoundRect(t,e,i,r,n,o);i=t+i,r=e+r,n=r-(o?.5*o|0:.5*n|0);this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(i,r),this.updatePosition(i,n),this.dirty()},i.prototype.drawCircle=function(t,e,i){t=+t||0,e=+e||0,i=+i||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawCircle(t,e,i);var r=this.fillPath,n=this.strokePath;r&&r.drawCircle(t,e,i),n&&n.drawCircle(t,e,i),this.extendBoundsByPoint(t-i-1,e-i-1),this.extendBoundsByPoint(t+i+2,e+i+2),this.updatePosition(t+i,e),this.dirty()},i.prototype.drawEllipse=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawEllipse(t,e,i,r);var n=this.fillPath,o=this.strokePath;n&&n.drawEllipse(t,e,i,r),o&&o.drawEllipse(t,e,i,r),this.extendBoundsByPoint(t-1,e-1),this.extendBoundsByPoint(t+i+2,e+r+2),this.updatePosition(t+i,e+.5*r),this.dirty()},i.prototype.moveTo=function(t,e){t=+t||0,e=+e||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setMoveTo(t,e);var i=this.fillPath,r=this.strokePath;i&&i.moveTo(t,e),r&&r.moveTo(t,e),this.includeLastPosition=!1,this.lastX=t,this.lastY=e,this.dirty()},i.prototype.lineTo=function(t,e){t=+t||0,e=+e||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineTo(t,e);var i=this.fillPath,r=this.strokePath;i&&i.lineTo(t,e),r&&r.lineTo(t,e),this.updatePosition(t,e),this.dirty()},i.prototype.curveTo=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCurveTo(t,e,i,r);var n=this.fillPath,o=this.strokePath;n&&n.curveTo(t,e,i,r),o&&o.curveTo(t,e,i,r);for(var a=c([this.lastX||0,this.lastY||0,t,e,i,r],50),s=0;s<a.length;s++){var h=a[s];this.extendBoundsByPoint(h.x,h.y),p.Point.release(h)}this.extendBoundsByPoint(i,r),this.updatePosition(i,r),this.dirty()},i.prototype.cubicCurveTo=function(t,e,i,r,n,o){t=+t||0,e=+e||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0,p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCubicCurveTo(t,e,i,r,n,o);var a=this.fillPath,s=this.strokePath;a&&a.cubicCurveTo(t,e,i,r,n,o),s&&s.cubicCurveTo(t,e,i,r,n,o);for(var h=c([this.lastX||0,this.lastY||0,t,e,i,r,n,o],50),l=0;l<h.length;l++){var u=h[l];this.extendBoundsByPoint(u.x,u.y),p.Point.release(u)}this.extendBoundsByPoint(n,o),this.updatePosition(n,o),this.dirty()},i.prototype.drawArc=function(t,e,i,r,n,o){var a,s;i<0||r===n||(t=+t||0,e=+e||0,i=+i||0,n=+n||0,o=!!o,r=h(r=+r||0),n=h(n),p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawArc(t,e,i,r,n,o),a=this.fillPath,s=this.strokePath,a&&(a.$lastX=this.lastX,a.$lastY=this.lastY,a.drawArc(t,e,i,r,n,o)),s&&(s.$lastX=this.lastX,s.$lastY=this.lastY,s.drawArc(t,e,i,r,n,o)),o?this.arcBounds(t,e,i,n,r):this.arcBounds(t,e,i,r,n),t=t+Math.cos(n)*i,i=e+Math.sin(n)*i,this.updatePosition(t,i),this.dirty())},i.prototype.dirty=function(){var t,e;this.$renderNode.dirtyRender=!0,p.nativeRender||((e=this.$targetDisplay).$cacheDirty=!0,(t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()))},i.prototype.arcBounds=function(t,e,i,r,n){var o=Math.PI;if(Math.abs(r-n)<.01)return this.extendBoundsByPoint(t-i,e-i),void this.extendBoundsByPoint(t+i,e+i);n<r&&(n+=2*o);for(var a=Math.cos(r)*i,s=Math.cos(n)*i,h=Math.min(a,s),l=Math.max(a,s),a=Math.sin(r)*i,s=Math.sin(n)*i,u=Math.min(a,s),c=Math.max(a,s),p=n/(.5*o),d=Math.ceil(r/(.5*o));d<=p;d++)switch(d%4){case 0:l=i;break;case 1:c=i;break;case 2:h=-i;break;case 3:u=-i}h=Math.floor(h),u=Math.floor(u),l=Math.ceil(l),c=Math.ceil(c),this.extendBoundsByPoint(h+t,u+e),this.extendBoundsByPoint(l+t,c+e)},i.prototype.clear=function(){p.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setGraphicsClear(),this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.dirty()},i.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},i.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},i.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},i.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},i.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},i.prototype.$hitTest=function(t,e){var i=this.$targetDisplay,r=i.$getInvertedConcatenatedMatrix(),n=r.a*t+r.c*e+r.tx,o=r.b*t+r.d*e+r.ty,t=p.sys.canvasHitTestBuffer;t.resize(3,3);e=this.$renderNode,r=p.Matrix.create();r.identity(),r.translate(1-n,1-o),p.sys.canvasRenderer.drawNodeToBuffer(e,t,r,!0),p.Matrix.release(r);try{if(0===t.getPixels(1,1)[3])return null}catch(t){throw new Error(p.sys.tr(1039))}return i},i.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean(),p.nativeRender&&egret_native.NativeDisplayObject.disposeGraphicData(this)},i);function i(){var t=e.call(this)||this;return t.lastX=0,t.lastY=0,t.fillPath=null,t.strokePath=null,t.topLeftStrokeWidth=0,t.bottomRightStrokeWidth=0,t.minX=1/0,t.minY=1/0,t.maxX=-1/0,t.maxY=-1/0,t.includeLastPosition=!0,t.$renderNode=new p.sys.GraphicsNode,t}p.Graphics=t,__reflect(t.prototype,"egret.Graphics")}(egret=egret||{}),function(h){var s,t=Math.PI,a=2*t,l=t/180,e=[],i=(s=h.HashObject,__extends(r,s),r.release=function(t){t&&e.push(t)},r.create=function(){return e.pop()||new r},r.prototype.clone=function(){return new r(this.a,this.b,this.c,this.d,this.tx,this.ty)},r.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,o=this.tx*t.a+t.tx,a=this.ty*t.d+t.ty;0===this.b&&0===this.c&&0===t.b&&0===t.c||(e+=this.b*t.c,n+=this.c*t.b,i+=this.a*t.b+this.b*t.d,r+=this.c*t.a+this.d*t.c,o+=this.ty*t.c,a+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=o,this.ty=a},r.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},r.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},r.prototype.invert=function(){this.$invertInto(this)},r.prototype.$invertInto=function(t){var e,i,r=this.a,n=this.b,o=this.c,a=this.d,s=this.tx,h=this.ty;0!=n||0!=o?0!=(e=r*a-n*o)?(i=t.a=a*(e=1/e),n=t.b=-n*e,o=t.c=-o*e,a=t.d=r*e,t.tx=-(i*s+o*h),t.ty=-(n*s+a*h)):t.identity():(t.b=t.c=0)==r||0==a?t.a=t.d=t.tx=t.ty=0:(r=t.a=1/r,a=t.d=1/a,t.tx=-r*s,t.ty=-a*h)},r.prototype.rotate=function(t){var e,i,r,n,o,a,s;0!==(t=+t)&&(e=h.NumberUtils.cos(t/=l),i=h.NumberUtils.sin(t),r=this.a,n=this.b,o=this.c,a=this.d,s=this.tx,t=this.ty,this.a=r*e-n*i,this.b=r*i+n*e,this.c=o*e-a*i,this.d=o*i+a*e,this.tx=s*e-t*i,this.ty=s*i+t*e)},r.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},r.prototype.setTo=function(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this},r.prototype.transformPoint=function(t,e,i){var r=this.a*t+this.c*e+this.tx,e=this.b*t+this.d*e+this.ty;return i?(i.setTo(r,e),i):new h.Point(r,e)},r.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},r.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},r.prototype.prepend=function(t,e,i,r,n,o){var a,s,h=this.tx;return 1==t&&0==e&&0==i&&1==r||(a=this.a,s=this.c,this.a=a*t+this.b*i,this.b=a*e+this.b*r,this.c=s*t+this.d*i,this.d=s*e+this.d*r),this.tx=h*t+this.ty*i+n,this.ty=h*e+this.ty*r+o,this},r.prototype.append=function(t,e,i,r,n,o){var a=this.a,s=this.b,h=this.c,l=this.d;return 1==t&&0==e&&0==i&&1==r||(this.a=t*a+e*h,this.b=t*s+e*l,this.c=i*a+r*h,this.d=i*s+r*l),this.tx=n*a+o*h+this.tx,this.ty=n*s+o*l+this.ty,this},r.prototype.deltaTransformPoint=function(t){var e=this.a*t.x+this.c*t.y,t=this.b*t.x+this.d*t.y;return new h.Point(e,t)},r.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},r.prototype.createBox=function(t,e,i,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var o,a=this;0!==(i=void 0===i?0:i)?(o=h.NumberUtils.cos(i/=l),i=h.NumberUtils.sin(i),a.a=o*t,a.b=i*e,a.c=-i*t,a.d=o*e):(a.a=t,a.b=0,a.c=0,a.d=e),a.tx=r,a.ty=n},r.prototype.createGradientBox=function(t,e,i,r,n){this.createBox(t/1638.4,e/1638.4,i=void 0===i?0:i,(r=void 0===r?0:r)+t/2,(n=void 0===n?0:n)+e/2)},r.prototype.$transformBounds=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,o=this.tx,a=this.ty,s=t.x,h=t.y,l=s+t.width,u=h+t.height,c=e*s+r*h+o,p=i*s+n*h+a,d=e*l+r*h+o,f=i*l+n*h+a,h=e*l+r*u+o,l=i*l+n*u+a,o=e*s+r*u+o,u=i*s+n*u+a,a=0;d<c&&(a=c,c=d,d=a),o<h&&(a=h,h=o,o=a),t.x=Math.floor(c<h?c:h),t.width=Math.ceil((o<d?d:o)-t.x),f<p&&(a=p,p=f,f=a),u<l&&(a=l,l=u,u=a),t.y=Math.floor(p<l?p:l),t.height=Math.ceil((u<f?f:u)-t.y)},r.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},r.prototype.$getScaleX=function(){var t=this;if(0==t.b)return t.a;t=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-t:t},r.prototype.$getScaleY=function(){var t=this;if(0==t.c)return t.d;t=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-t:t},r.prototype.$getSkewX=function(){return this.d<0?Math.atan2(this.d,this.c)+t/2:Math.atan2(this.d,this.c)-t/2},r.prototype.$getSkewY=function(){return this.a<0?Math.atan2(this.b,this.a)-t:Math.atan2(this.b,this.a)},r.prototype.$updateScaleAndRotation=function(t,e,i,r){if(!(0!=i&&i!=a||0!=r&&r!=a))return this.a=t,this.b=this.c=0,void(this.d=e);r/=l;var n=h.NumberUtils.cos(i/=l),o=h.NumberUtils.sin(i);i==r?(this.a=n*t,this.b=o*t):(this.a=h.NumberUtils.cos(r)*t,this.b=h.NumberUtils.sin(r)*t),this.c=-o*e,this.d=n*e},r.prototype.$preMultiplyInto=function(t,e){var i=t.a*this.a,r=0,n=0,o=t.d*this.d,a=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;0===t.b&&0===t.c&&0===this.b&&0===this.c||(i+=t.b*this.c,o+=t.c*this.b,r+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,a+=t.ty*this.c,s+=t.tx*this.b),e.a=i,e.b=r,e.c=n,e.d=o,e.tx=a,e.ty=s},r);function r(t,e,i,r,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0);var a=s.call(this)||this;return a.a=t,a.b=e,a.c=i,a.d=r,a.tx=n,a.ty=o,a}h.Matrix=i,__reflect(i.prototype,"egret.Matrix"),h.$TempMatrix=new i}(egret=egret||{}),function(t){var o,e=[],i=(o=t.HashObject,__extends(r,o),r.release=function(t){t&&e.push(t)},r.create=function(){return e.pop()||new r},Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.setTo=function(t,e,i,r){return this.x=t,this.y=e,this.width=i,this.height=r,this},r.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},r.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},r.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},r.prototype.$intersectInPlace=function(t){var e=this.x,i=this.y,r=t.x,n=t.y,o=Math.max(e,r),e=Math.min(e+this.width,r+t.width);if(o<=e){r=Math.max(i,n),t=Math.min(i+this.height,n+t.height);if(r<=t)return this.setTo(o,r,e-o,t-r),this}return this.setEmpty(),this},r.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y},r.prototype.containsRect=function(t){var e=t.x+t.width,i=t.y+t.height,r=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<r&&t.y>=this.y&&t.y<n&&e>this.x&&e<=r&&i>this.y&&i<=n},r.prototype.equals=function(t){return this===t||this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},r.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},r.prototype.offset=function(t,e){this.x+=t,this.y+=e},r.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},r.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},r.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var i=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return e.setTo(i,r,Math.max(e.right,t.right)-i,Math.max(e.bottom,t.bottom)-r),e},r.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),t=Math.abs(Math.sin(t));return e*this.width+t*this.height},r.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t));return Math.abs(Math.sin(t))*this.width+e*this.height},r);function r(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0);var n=o.call(this)||this;return n.x=t,n.y=e,n.width=i,n.height=r,n}t.Rectangle=i,__reflect(i.prototype,"egret.Rectangle"),t.$TempRectangle=new i}(egret=egret||{}),function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};t=t.$locale_strings.en_US;t[1001]="Could not find Egret entry class: {0}\u3002",t[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",t[1003]="Parameter {0} must be non-null.",t[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",t[1005]="An object cannot be added as a child of itself.",t[1006]="The supplied DisplayObject must be a child of the caller.",t[1007]="An index specified for a parameter was out of range.",t[1008]="Instantiate singleton error\uff0csingleton class {0} can not create multiple instances.",t[1009]='the Class {0} cannot use the property "{1}"',t[1010]='the property "{1}" of the Class "{0}" is readonly',t[1011]="Stream Error. URL: {0}",t[1012]="The type of parameter {0} must be Class.",t[1013]="Variable assignment is NaN, please see the code!",t[1014]='the constant "{1}" of the Class "{0}" is read-only',t[1015]="xml not found!",t[1016]="{0}has been obsoleted",t[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",t[1018]="the scale9Grid is not correct",t[1019]="Network ab:{0}",t[1020]="Cannot initialize Shader",t[1021]="Current browser does not support webgl",t[1022]="{0} ArgumentError",t[1023]="This method is not available in the ScrollView!",t[1025]="end of the file",t[1026]="! EncodingError The code point {0} could not be encoded.",t[1027]="DecodingError",t[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",t[1029]="Function.prototype.bind - what is trying to be bound is not callable",t[1033]="Photos can not be used across domains toDataURL to convert base64",t[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',t[1035]="Native does not support this feature!",t[1036]="Sound has stopped, please recall Sound.play () to play the sound!",t[1037]="Non-load the correct blob!",t[1038]="XML format error!",t[1039]="Cross domains pictures can not get pixel information!",t[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",t[1041]="{0} is deprecated, please use {1} replace",t[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",t[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",t[1044]="The current version of the Runtime does not support video playback, please use the latest version",t[1045]="The resource url is not found",t[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",t[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",t[1048]="Video loading failed",t[1049]="In the absence of sound is not allowed to play after loading",t[1050]="ExternalInterface calls the method without js registration: {0}",t[1051]="runtime only support webgl render mode",t[1052]="network request timeout{0}",t[3e3]="Theme configuration file failed to load: {0}",t[3001]="Cannot find the skin name which is configured in Theme: {0}",t[3002]='Index:"{0}" is out of the collection element index range',t[3003]="Cannot be available in this component. If this component is container, please continue to use",t[3004]="addChild(){0}addElement() replace",t[3005]="addChildAt(){0}addElementAt() replace",t[3006]="removeChild(){0}removeElement() replace",t[3007]="removeChildAt(){0}removeElementAt() replace",t[3008]="setChildIndex(){0}setElementIndex() replace",t[3009]="swapChildren(){0}swapElements() replace",t[3010]="swapChildrenAt(){0}swapElementsAt() replace",t[3011]='Index:"{0}" is out of the visual element index range',t[3012]="This method is not available in Scroller component!",t[3013]="UIStage is GUI root container, and only one such instant is in the display list\uff01",t[3014]="set fullscreen error",t[3100]="Current browser does not support WebSocket",t[3101]="Please connect Socket firstly",t[3102]="Please set the type of binary type",t[3200]="getResByUrl must be called after loadConfig",t[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",t[4001]="Abstract class can not be instantiated!",t[4002]="Unnamed data!",t[4003]="Nonsupport version!",t[4500]="The platform does not support {0} adapter mode and has been automatically replaced with {1} mode, please modify your code adapter logic"}(egret=egret||{}),(egret=egret||{}).JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"},function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};t=t.$locale_strings.zh_CN;t[1001]="\u627e\u4e0d\u5230Egret\u5165\u53e3\u7c7b: {0}\u3002",t[1002]="Egret\u5165\u53e3\u7c7b {0} \u5fc5\u987b\u7ee7\u627f\u81eaegret.DisplayObject\u3002",t[1003]="\u53c2\u6570 {0} \u4e0d\u80fd\u4e3a null\u3002",t[1004]="\u65e0\u6cd5\u5c06\u5bf9\u8c61\u6dfb\u52a0\u4e3a\u5b83\u7684\u4e00\u4e2a\u5b50\u5bf9\u8c61\uff08\u6216\u5b50\u5bf9\u8c61\u7684\u5b50\u5bf9\u8c61\u7b49\uff09\u7684\u5b50\u5bf9\u8c61\u3002",t[1005]="\u4e0d\u80fd\u5c06\u5bf9\u8c61\u6dfb\u52a0\u4e3a\u5176\u81ea\u8eab\u7684\u5b50\u5bf9\u8c61\u3002",t[1006]="\u63d0\u4f9b\u7684 DisplayObject \u5fc5\u987b\u662f\u8c03\u7528\u8005\u7684\u5b50\u7ea7\u3002",t[1007]="\u4e3a\u53c2\u6570\u6307\u5b9a\u7684\u7d22\u5f15\u4e0d\u5728\u8303\u56f4\u5185\u3002",t[1008]="\u5b9e\u4f8b\u5316\u5355\u4f8b\u51fa\u9519\uff0c\u4e0d\u5141\u8bb8\u5b9e\u4f8b\u5316\u591a\u4e2a {0} \u5bf9\u8c61\u3002",t[1009]="\u7c7b {0} \u4e0d\u53ef\u4ee5\u4f7f\u7528\u5c5e\u6027 {1}",t[1010]="\u7c7b {0} \u5c5e\u6027 {1} \u662f\u53ea\u8bfb\u7684",t[1011]="\u6d41\u9519\u8bef\u3002URL: {0}",t[1012]="\u53c2\u6570 {0} \u7684\u7c7b\u578b\u5fc5\u987b\u4e3a Class\u3002",t[1013]="\u53d8\u91cf\u8d4b\u503c\u4e3aNaN\uff0c\u8bf7\u67e5\u770b\u4ee3\u7801\uff01",t[1014]="\u7c7b {0} \u5e38\u91cf {1} \u662f\u53ea\u8bfb\u7684",t[1015]="xml not found!",t[1016]="{0}\u5df2\u7ecf\u5e9f\u5f03",t[1017]="JSON\u6587\u4ef6\u683c\u5f0f\u4e0d\u6b63\u786e: {0}\ndata: {1}",t[1018]="9\u5bab\u683c\u8bbe\u7f6e\u9519\u8bef",t[1019]="\u7f51\u7edc\u5f02\u5e38:{0}",t[1020]="\u65e0\u6cd5\u521d\u59cb\u5316\u7740\u8272\u5668",t[1021]="\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301webgl",t[1022]="{0} ArgumentError",t[1023]="\u6b64\u65b9\u6cd5\u5728ScrollView\u5185\u4e0d\u53ef\u7528!",t[1025]="\u9047\u5230\u6587\u4ef6\u5c3e",t[1026]="EncodingError! The code point {0} could not be encoded.",t[1027]="DecodingError",t[1028]="\u8c03\u7528\u4e86\u672a\u914d\u7f6e\u7684\u6ce8\u5165\u89c4\u5219:{0}\u3002 \u8bf7\u5148\u5728\u9879\u76ee\u521d\u59cb\u5316\u91cc\u914d\u7f6e\u6307\u5b9a\u7684\u6ce8\u5165\u89c4\u5219\uff0c\u518d\u8c03\u7528\u5bf9\u5e94\u5355\u4f8b\u3002",t[1029]="Function.prototype.bind - what is trying to be bound is not callable",t[1033]="\u8de8\u57df\u56fe\u7247\u4e0d\u53ef\u4ee5\u4f7f\u7528toDataURL\u6765\u8f6c\u6362\u6210base64",t[1034]='\u97f3\u4e50\u6587\u4ef6\u89e3\u7801\u5931\u8d25\uff1a"{0}"\uff0c\u8bf7\u4f7f\u7528\u6807\u51c6\u7684\u8f6c\u6362\u5de5\u5177\u91cd\u65b0\u8f6c\u6362\u4e0bmp3\u3002',t[1035]="Native \u4e0b\u6682\u672a\u5b9e\u73b0\u6b64\u529f\u80fd\uff01",t[1036]="\u58f0\u97f3\u5df2\u505c\u6b62\uff0c\u8bf7\u91cd\u65b0\u8c03\u7528 Sound.play() \u6765\u64ad\u653e\u58f0\u97f3\uff01",t[1037]="\u975e\u6b63\u786e\u7684blob\u52a0\u8f7d\uff01",t[1038]="XML \u683c\u5f0f\u9519\u8bef!",t[1039]="\u8de8\u57df\u56fe\u7247\u4e0d\u80fd\u83b7\u53d6\u50cf\u7d20\u4fe1\u606f!",t[1040]="hitTestPoint \u4e0d\u80fd\u5bf9\u8de8\u57df\u56fe\u7247\u8fdb\u884c\u68c0\u6d4b! \u8bf7\u68c0\u67e5\u8be5\u663e\u793a\u5bf9\u8c61\u5185\u662f\u5426\u542b\u6709\u8de8\u57df\u5143\u7d20",t[1041]="{0} \u5df2\u5e9f\u5f03,\u8bf7\u4f7f\u7528 {1} \u4ee3\u66ff",t[1042]="drawToTexture\u65b9\u6cd5\u4f20\u5165\u7684\u533a\u57df\u5404\u4e2a\u53c2\u6570\u9700\u8981\u4e3a\u6574\u6570,\u5426\u5219\u67d0\u4e9b\u6d4f\u89c8\u5668\u7ed8\u5236\u4f1a\u51fa\u73b0\u5f02\u5e38",t[1043]="{0} \u4e2d\u5b58\u5728\u7f16\u8bd1\u9519\u8bef\uff0c\u5c5e\u6027\u540d : {1}\uff0c\u5c5e\u6027\u503c : {2}",t[1044]="\u5f53\u524d\u7684 runtime \u7248\u672c\u4e0d\u652f\u6301\u89c6\u9891\u64ad\u653e,\u8bf7\u4f7f\u7528\u6700\u65b0\u7684\u7248\u672c",t[1045]="\u6ca1\u6709\u8bbe\u7f6e\u8981\u52a0\u8f7d\u7684\u8d44\u6e90\u5730\u5740",t[1046]="BitmapText \u627e\u4e0d\u5230\u5bf9\u5e94\u5b57\u7b26:{0}\uff0c\u8bf7\u68c0\u67e5\u914d\u7f6e\u6587\u4ef6",t[1047]="egret.localStorage.setItem\u4fdd\u5b58\u5931\u8d25,key={0}&value={1}",t[1048]="\u89c6\u9891\u52a0\u8f7d\u5931\u8d25",t[1049]="\u58f0\u97f3\u5728\u6ca1\u6709\u52a0\u8f7d\u5b8c\u4e4b\u524d\u4e0d\u5141\u8bb8\u64ad\u653e",t[1050]="ExternalInterface\u8c03\u7528\u4e86js\u6ca1\u6709\u6ce8\u518c\u7684\u65b9\u6cd5: {0}",t[1051]="runtime \u53ea\u652f\u6301 webgl \u6e32\u67d3\u6a21\u5f0f",t[1052]="\u7f51\u7edc\u8bf7\u6c42\u8d85\u65f6:{0}",t[3e3]="\u4e3b\u9898\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u5931\u8d25: {0}",t[3001]="\u627e\u4e0d\u5230\u4e3b\u9898\u4e2d\u6240\u914d\u7f6e\u7684\u76ae\u80a4\u7c7b\u540d: {0}",t[3002]='\u7d22\u5f15:"{0}"\u8d85\u51fa\u96c6\u5408\u5143\u7d20\u7d22\u5f15\u8303\u56f4',t[3003]="\u5728\u6b64\u7ec4\u4ef6\u4e2d\u4e0d\u53ef\u7528\uff0c\u82e5\u6b64\u7ec4\u4ef6\u4e3a\u5bb9\u5668\u7c7b\uff0c\u8bf7\u4f7f\u7528",t[3004]="addChild(){0}addElement()\u4ee3\u66ff",t[3005]="addChildAt(){0}addElementAt()\u4ee3\u66ff",t[3006]="removeChild(){0}removeElement()\u4ee3\u66ff",t[3007]="removeChildAt(){0}removeElementAt()\u4ee3\u66ff",t[3008]="setChildIndex(){0}setElementIndex()\u4ee3\u66ff",t[3009]="swapChildren(){0}swapElements()\u4ee3\u66ff",t[3010]="swapChildrenAt(){0}swapElementsAt()\u4ee3\u66ff",t[3011]='\u7d22\u5f15:"{0}"\u8d85\u51fa\u53ef\u89c6\u5143\u7d20\u7d22\u5f15\u8303\u56f4',t[3012]="\u6b64\u65b9\u6cd5\u5728Scroller\u7ec4\u4ef6\u5185\u4e0d\u53ef\u7528!",t[3013]="UIStage\u662fGUI\u6839\u5bb9\u5668\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u6b64\u5b9e\u4f8b\u5728\u663e\u793a\u5217\u8868\u4e2d\uff01",t[3014]="\u8bbe\u7f6e\u5168\u5c4f\u6a21\u5f0f\u5931\u8d25",t[3100]="\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301WebSocket",t[3101]="\u8bf7\u5148\u8fde\u63a5WebSocket",t[3102]="\u8bf7\u5148\u8bbe\u7f6etype\u4e3a\u4e8c\u8fdb\u5236\u7c7b\u578b",t[3200]="getResByUrl \u5fc5\u987b\u5728 loadConfig \u4e4b\u540e\u8c03\u7528",t[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",t[4001]="Abstract class can not be instantiated!",t[4002]="Unnamed data!",t[4003]="Nonsupport version!",t[4500]="\u8be5\u5e73\u53f0\u4e0d\u652f\u6301 {0} \u9002\u914d\u6a21\u5f0f\uff0c\u5df2\u7ecf\u81ea\u52a8\u66ff\u6362\u4e3a {1} \u6a21\u5f0f\uff0c\u8bf7\u4fee\u6539\u60a8\u7684\u4ee3\u7801\u9002\u914d\u903b\u8f91"}(egret=egret||{}),function(t){t.localStorage||(t.localStorage={})}(egret=egret||{}),function(t){var e;(e=t.sys||(t.sys={})).usingChannel=[],e.$pushSoundChannel=function(t){e.usingChannel.indexOf(t)<0&&e.usingChannel.push(t)},e.$popSoundChannel=function(t){return 0<=(t=e.usingChannel.indexOf(t))&&(e.usingChannel.splice(t,1),!0)}}(egret=egret||{}),function(t){(t=t.HttpMethod||(t.HttpMethod={})).GET="GET",t.POST="POST"}(egret=(egret=(egret=egret||{})||{})||{}),function(t){var e=(i.TEXT="text",i.ARRAY_BUFFER="arraybuffer",i);function i(){}t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret=(egret=egret||{})||{}),function(o){var a,i,t;function s(t){var e=i.call(this)||this;return e.isStage=!1,e.$renderNode=new a.BitmapNode,e.renderBuffer=null,e.offsetX=0,e.offsetY=0,e.offsetMatrix=new o.Matrix,e.$canvasScaleX=1,e.$canvasScaleY=1,e.$stageRenderToSurface=function(){a.systemRenderer.render(this.root,this.renderBuffer,this.offsetMatrix)},e.root=t,e.isStage=t instanceof o.Stage,e}a=o.sys||(o.sys={}),i=o.HashObject,__extends(s,i),s.create=function(t){var e=new o.sys.DisplayList(t);try{var i=new a.RenderBuffer;e.renderBuffer=i}catch(t){return null}return e.root=t,e},s.prototype.$getRenderNode=function(){return this.$renderNode},s.prototype.setClipRect=function(t,e){this.renderBuffer.resize(t*=s.$canvasScaleX,e*=s.$canvasScaleY)},s.prototype.drawToSurface=function(){var t;this.$canvasScaleX=this.offsetMatrix.a=s.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=s.$canvasScaleY,this.isStage||this.changeSurfaceSize();var e,i,r,n=this.renderBuffer;return n.clear(),t=a.systemRenderer.render(this.root,n,this.offsetMatrix),this.isStage||(e=n.surface,(i=this.$renderNode).drawData.length=0,r=e.width,n=e.height,this.bitmapData?(this.bitmapData.source=e,this.bitmapData.width=r,this.bitmapData.height=n):this.bitmapData=new o.BitmapData(e),i.image=this.bitmapData,i.imageWidth=r,i.imageHeight=n,i.drawImage(0,0,r,n,-this.offsetX,-this.offsetY,r/this.$canvasScaleX,n/this.$canvasScaleY)),t},s.prototype.changeSurfaceSize=function(){this.root;var t=this.offsetX,e=this.offsetY,i=this.root.$getOriginalBounds(),r=this.$canvasScaleX,n=this.$canvasScaleY;this.offsetX=-i.x,this.offsetY=-i.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var o=this.renderBuffer,r=Math.max(257,i.width*r),n=Math.max(257,i.height*n);this.offsetX==t&&this.offsetY==e&&o.surface.width==r&&o.surface.height==n||o.resize(r,n)},s.$setCanvasScale=function(t,e){s.$canvasScaleX=t,s.$canvasScaleY=e,o.nativeRender&&egret_native.nrSetCanvasScaleFactor(s.$canvasScaleFactor,t,e)},s.$canvasScaleFactor=1,s.$canvasScaleX=1,s.$canvasScaleY=1,t=s,a.DisplayList=t,__reflect(t.prototype,"egret.sys.DisplayList")}(egret=(egret=egret||{})||{}),function(f){!function(h){var n,t=(n=f.HashObject,__extends(e,n),e.prototype.createDisplayList=function(t,e){var i=new h.DisplayList(t);return i.renderBuffer=e,t.$displayList=i},e.prototype.start=function(){!this.isPlaying&&this.stage&&(h.$TempStage=h.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),f.ticker.$addPlayer(this))},e.prototype.initialize=function(){var t;(t=this.entryClassName?f.getDefinitionByName(this.entryClassName):t)?(t=new t,(this.root=t)instanceof f.DisplayObject?this.stage.addChild(t):f.$error(1002,this.entryClassName)):f.$error(1001,this.entryClassName)},e.prototype.stop=function(){this.pause(),this.stage=null},e.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,f.ticker.$removePlayer(this))},e.prototype.$render=function(t,e){if(f.nativeRender)return egret_native.updateNativeRender(),void egret_native.nrRender();f.sys.systemRenderer.renderClear&&f.sys.systemRenderer.renderClear();var i=this.stage,r=f.getTimer(),n=i.$displayList.drawToSurface(),i=f.getTimer();t&&this.showFPS&&l.update(n,i-r,e)},e.prototype.updateStageSize=function(t,e){var i=this.stage;i.$stageWidth=t,i.$stageHeight=e,f.nativeRender?egret_native.nrResize(t,e):(this.screenDisplayList.setClipRect(t,e),this.stageDisplayList&&this.stageDisplayList.setClipRect(t,e)),i.dispatchEventWith(f.Event.RESIZE)},e.prototype.displayFPS=function(t,e,i,r){if((e=!!e)&&(f.log=function(){for(var t=arguments.length,e="",i=0;i<t;i++)e+=arguments[i]+" ";h.$logToFPS(e),console.log.apply(console,d(arguments))},f.warn=function(){for(var t=arguments.length,e="",i=0;i<t;i++)e+=arguments[i]+" ";h.$warnToFPS(e),console.warn.apply(console,d(arguments))},f.error=function(){for(var t=arguments.length,e="",i=0;i<t;i++)e+=arguments[i]+" ";h.$errorToFPS(e),console.error.apply(console,d(arguments))}),this.showFPS=!!t,this.showLog=e,!l){l=new FPS(this.stage,t,e,i,r);for(var n=u.length,o=0;o<n;o++)l.updateInfo(u[o]);u=null;for(var a=c.length,o=0;o<a;o++)l.updateWarn(c[o]);c=null;for(var s=p.length,o=0;o<s;o++)l.updateError(p[o]);p=null}},e);function e(t,e,i){var r=n.call(this)||this;return r.isPlaying=!1,t||f.$error(1003,"buffer"),r.entryClassName=i,r.stage=e,r.screenDisplayList=r.createDisplayList(e,t),r.showFPS=!1,r.showLog=!1,r.stageDisplayList=null,f.nativeRender&&(egret_native.rootWebGLBuffer=t),r}h.Player=t,__reflect(t.prototype,"egret.sys.Player");var l,u=[],c=[],p=[];h.$logToFPS=function(t){l?l.updateInfo(t):u.push(t)},h.$warnToFPS=function(t){l?l.updateWarn(t):c.push(t)},h.$errorToFPS=function(t){l?l.updateError(t):p.push(t)};i.prototype.update=function(t,e,i){var r=f.getTimer();this.totalTime+=r-this.lastTime,this.lastTime=r,this.totalTick++,this.drawCalls+=t,this.costRender+=e,this.costTicker+=i,1e3<=this.totalTime&&(r=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),f.ticker.$frameRate),t=Math.round(this.drawCalls/this.totalTick),e=Math.round(this.costRender/this.totalTick),i=Math.round(this.costTicker/this.totalTick),this.fpsDisplay.update({fps:r,draw:t,costTicker:i,costRender:e}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.costRender=0,this.costTicker=0)},i.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},i.prototype.updateWarn=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateWarn?this.fpsDisplay.updateWarn(t):this.fpsDisplay.updateInfo("[Warning]"+t))},i.prototype.updateError=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateError?this.fpsDisplay.updateError(t):this.fpsDisplay.updateInfo("[Error]"+t))},t=i;function i(t,e,i,r,n){var o;this.showFPS=e,this.showLog=i,this.logFilter=r,this.styles=n,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this._stage=t,this.showFPS=e,this.showLog=i,this.logFilter=r,this.styles=n,this.fpsDisplay=new f.FPSDisplay(t,e,i,r,n);try{o=r?new RegExp(r):null}catch(t){f.log(t)}this.filter=function(t){return o?o.test(t):!r||0==t.indexOf(r)}}function d(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}__reflect(t.prototype,"FPSImpl"),__global.FPS=t,f.warn=function(){console.warn.apply(console,d(arguments))},f.error=function(){console.error.apply(console,d(arguments))},f.assert=function(){console.assert.apply(console,d(arguments))},f.log=function(){console.log.apply(console,d(arguments))}}(f.sys||(f.sys={}))}(egret=(egret=(egret=egret||{})||{})||{}),function(t){var e,i,r;t.nativeRender=__global.nativeRender,t.nativeRender&&(e=egret_native.nrABIVersion,i=egret_native.nrMinEgretVersion,e<5?(t.nativeRender=!1,t.sys.$warnToFPS(r="\u9700\u8981\u5347\u7ea7\u5fae\u7aef\u7248\u672c\u5230 0.1.14 \u624d\u53ef\u4ee5\u5f00\u542f\u539f\u751f\u6e32\u67d3\u52a0\u901f"),t.warn(r)):5<e&&(t.nativeRender=!1,t.sys.$warnToFPS(r="\u9700\u8981\u5347\u7ea7\u5f15\u64ce\u7248\u672c\u5230 "+i+" \u624d\u53ef\u4ee5\u5f00\u542f\u539f\u751f\u6e32\u67d3\u52a0\u901f"),t.warn(r)))}(egret=egret||{}),function(t){(t=t.pro||(t.pro={})).egret2dDriveMode=!1,t.createTextureFrom3dScene=function(t,e,i,r){return void 0===e&&(e=512),void 0===i&&(i=512),void 0===r&&(r=1),Application.instance.egretProUtil.execute("createTextureFrom3dScene",t,e,i,r)},t.createTextureForCameras=function(t,e,i,r,n){return void 0===i&&(i=512),void 0===r&&(r=512),void 0===n&&(n=1),Application.instance.egretProUtil.execute("createTextureForCameras",t,e,i,r,n)},t.execute=function(t){for(var e,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];return(e=Application.instance.egretProUtil).execute.apply(e,[t].concat(i))},t.register=function(t,e,i){return Application.instance.egretProUtil.register(t,e,i)},t.addEventListener=function(t,e,i,r){return Application.instance.egretProUtil.addEventListener(t,e,i,r)},t.removeEventListener=function(t,e,i){return Application.instance.egretProUtil.removeEventListener(t,e,i)},t.dispatch=function(t,e){for(var i,r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return(i=Application.instance.egretProUtil).dispatch.apply(i,[t,e].concat(r))}}(egret=egret||{}),function(t){t.sys||(t.sys={})}(egret=egret||{}),function(c){var t,e,i;function r(){return e.call(this)||this}t=c.sys||(c.sys={}),e=c.HashObject,__extends(r,e),r.prototype.calculateStageSize=function(t,e,i,r,n){var o=e,a=i,s=r,h=n,l=e/s||0,u=i/h||0;switch(t){case c.StageScaleMode.EXACT_FIT:break;case c.StageScaleMode.FIXED_HEIGHT:s=Math.round(e/u);break;case c.StageScaleMode.FIXED_WIDTH:h=Math.round(i/l);break;case c.StageScaleMode.NO_BORDER:u<l?a=Math.round(h*l):o=Math.round(s*u);break;case c.StageScaleMode.SHOW_ALL:u<l?o=Math.round(s*u):a=Math.round(h*l);break;case c.StageScaleMode.FIXED_NARROW:u<l?s=Math.round(e/u):h=Math.round(i/l);break;case c.StageScaleMode.FIXED_WIDE:u<l?h=Math.round(i/l):s=Math.round(e/u);break;default:s=e,h=i}return c.Capabilities.runtimeType!=c.RuntimeType.WXGAME&&(s%2!=0&&(s+=1),h%2!=0&&(h+=1),o%2!=0&&(o+=1),a%2!=0&&(a+=1)),{stageWidth:s,stageHeight:h,displayWidth:o,displayHeight:a}},i=r,t.DefaultScreenAdapter=i,__reflect(i.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(egret=egret||{}),function(t){var e=(i.NO_SCALE="noScale",i.SHOW_ALL="showAll",i.NO_BORDER="noBorder",i.EXACT_FIT="exactFit",i.FIXED_WIDTH="fixedWidth",i.FIXED_HEIGHT="fixedHeight",i.FIXED_NARROW="fixedNarrow",i.FIXED_WIDE="fixedWide",i);function i(){}t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret=egret||{}),function(t){(t=t.sys||(t.sys={})).mainCanvas=function(t,e){return console.error("empty sys.mainCanvas = "+t+", "+e),null},t.createCanvas=function(t,e){return console.error("empty sys.createCanvas = "+t+", "+e),null},t.resizeContext=function(t,e,i,r){console.error("empty sys.resizeContext = "+t+", "+e+", "+i+", "+r)},t.getContextWebGL=function(t){return console.error("empty sys.getContextWebGL = "+t),null},t.getContext2d=function(t){return console.error("empty sys.getContext2d = "+t),null},t.createTexture=function(t,e){return console.error("empty sys.createTexture = "+e),null},t._createTexture=function(t,e,i,r){return console.error("empty sys._createTexture = "+e+", "+i+", "+r),null},t.drawTextureElements=function(t,e,i){return console.error("empty sys.drawTextureElements = "+t+", "+e+", "+i),0},t.measureTextWith=function(t,e){return console.error("empty sys.measureTextWith = "+t+", "+e),0},t.createCanvasRenderBufferSurface=function(t,e,i,r){return console.error("empty sys.createCanvasRenderBufferSurface = "+e+", "+i),null},t.resizeCanvasRenderBuffer=function(t,e,i,r){console.error("empty sys.resizeContext = "+t+", "+e+", "+i+", "+r)}}(egret=egret||{}),function(f){!function(d){d.$START_TIME=0,d.$invalidateRenderFlag=!1,d.$requestRenderingFlag=!1;var t=(e.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(egret_stages.push(t.stage),this.playerList=this.playerList.concat(),this.playerList.push(t))},e.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);-1!==e&&(t=egret_stages.indexOf(t.stage),egret_stages.splice(t,1),this.playerList=this.playerList.concat(),this.playerList.splice(e,1))},e.prototype.$startTick=function(t,e){-1==this.getTickIndex(t,e)&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},e.prototype.$stopTick=function(t,e){e=this.getTickIndex(t,e);-1!=e&&(this.concatTick(),this.callBackList.splice(e,1),this.thisObjectList.splice(e,1))},e.prototype.getTickIndex=function(t,e){for(var i=this.callBackList,r=this.thisObjectList,n=i.length-1;0<=n;n--)if(i[n]==t&&r[n]==e)return n;return-1},e.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},e.prototype.$setFrameRate=function(t){return!(t<=0)&&(this.$frameRate!=t&&(this.$frameRate=t,this.frameDeltaTime=1e3/(t=60<t?60:t),this.lastCount=this.frameInterval=Math.round(6e4/t),!0))},e.prototype.pause=function(){this.isPaused=!0},e.prototype.resume=function(){this.isPaused=!1},e.prototype.update=function(t){for(var e=f.getTimer(),i=this.callBackList,r=this.thisObjectList,n=i.length,o=d.$requestRenderingFlag,a=f.getTimer(),s=0,h=f.lifecycle.contexts;s<h.length;s++){var l=h[s];l.onUpdate&&l.onUpdate()}if(this.isPaused)this.lastTimeStamp=a;else{this.callLaterAsyncs();for(var u=0;u<n;u++)i[u].call(r[u],a)&&(o=!0);var c=f.getTimer(),p=a-this.lastTimeStamp;if(this.lastTimeStamp=a,p>=this.frameDeltaTime||t)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,0<this.lastCount)return void(o&&this.render(!1,this.costEnterFrame+c-e));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+c-e);c=f.getTimer();this.broadcastEnterFrame();e=f.getTimer();this.costEnterFrame=e-c}},e.prototype.render=function(t,e){var i=this.playerList,r=i.length;if(0!=r){this.callLaters(),d.$invalidateRenderFlag&&(this.broadcastRender(),d.$invalidateRenderFlag=!1);for(var n=0;n<r;n++)i[n].$render(t,e);d.$requestRenderingFlag=!1}},e.prototype.broadcastEnterFrame=function(){var t=(e=f.DisplayObject.$enterFrameCallBackList).length;if(0!=t)for(var e=e.concat(),i=0;i<t;i++)e[i].dispatchEventWith(f.Event.ENTER_FRAME)},e.prototype.broadcastRender=function(){var t=(e=f.DisplayObject.$renderCallBackList).length;if(0!=t)for(var e=e.concat(),i=0;i<t;i++)e[i].dispatchEventWith(f.Event.RENDER)},e.prototype.callLaters=function(){var t,e,i;if(0<f.$callLaterFunctionList.length&&(t=f.$callLaterFunctionList,f.$callLaterFunctionList=[],e=f.$callLaterThisList,f.$callLaterThisList=[],i=f.$callLaterArgsList,f.$callLaterArgsList=[]),t)for(var r=t.length,n=0;n<r;n++){var o=t[n];null!=o&&o.apply(e[n],i[n])}},e.prototype.callLaterAsyncs=function(){if(0<f.$callAsyncFunctionList.length){var t=f.$callAsyncFunctionList,e=f.$callAsyncThisList,i=f.$callAsyncArgsList;f.$callAsyncFunctionList=[],f.$callAsyncThisList=[],f.$callAsyncArgsList=[];for(var r=0;r<t.length;r++){var n=t[r];null!=n&&n.apply(e[r],i[r])}}},e);function e(){var h=this;this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,this.$beforeRender=function(){for(var t=h.callBackList,e=h.thisObjectList,i=t.length,r=f.getTimer(),n=0,o=f.lifecycle.contexts;n<o.length;n++){var a=o[n];a.onUpdate&&a.onUpdate()}if(h.isPaused)h.lastTimeStamp=r;else{h.callLaterAsyncs();for(var s=0;s<i;s++)t[s].call(e[s],r);h.callLaters(),d.$invalidateRenderFlag&&(h.broadcastRender(),d.$invalidateRenderFlag=!1)}},this.$afterRender=function(){h.broadcastEnterFrame()},f.ticker&&f.$error(1008,"egret.sys.SystemTicker"),d.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}d.SystemTicker=t,__reflect(t.prototype,"egret.sys.SystemTicker")}(f.sys||(f.sys={}))}(egret=egret||{}),function(n){!function(i){i.contexts=[];var t=!0,r=(e.prototype.pause=function(){t&&(t=!1,i.stage.dispatchEvent(new n.Event(n.Event.DEACTIVATE)),i.onPause&&i.onPause())},e.prototype.resume=function(){t||(t=!0,i.stage.dispatchEvent(new n.Event(n.Event.ACTIVATE)),i.onResume&&i.onResume())},e);function e(){}i.LifecycleContext=r,__reflect(r.prototype,"egret.lifecycle.LifecycleContext"),i.addLifecycleListener=function(t){var e=new r;i.contexts.push(e),t(e)}}(n.lifecycle||(n.lifecycle={})),n.ticker=new n.sys.SystemTicker}(egret=egret||{}),global.egret_stages=[],function(o){var t,i,e;function r(t){var e=i.call(this)||this;return e.maxTouches=0,e.useTouchesCount=0,e.touchDownTarget={},e.lastTouchX=-1,e.lastTouchY=-1,e.$updateMaxTouches=function(t){this.maxTouches=t},e.stage=t,e}t=o.sys||(o.sys={}),i=o.HashObject,__extends(r,i),r.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},r.prototype.onTouchBegin=function(t,e,i){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=t,this.lastTouchY=e;var r=this.findTarget(t,e);return null==this.touchDownTarget[i]&&(this.touchDownTarget[i]=r,this.useTouchesCount++),o.TouchEvent.dispatchTouchEvent(r,o.TouchEvent.TOUCH_BEGIN,!0,!0,t,e,i,!0),r!==this.stage}},r.prototype.onTouchMove=function(t,e,i){if(null!=this.touchDownTarget[i]&&(this.lastTouchX!=t||this.lastTouchY!=e)){this.lastTouchX=t,this.lastTouchY=e;var r=this.findTarget(t,e);return o.TouchEvent.dispatchTouchEvent(r,o.TouchEvent.TOUCH_MOVE,!0,!0,t,e,i,!0),r!==this.stage}},r.prototype.onTouchEnd=function(t,e,i){if(null!=this.touchDownTarget[i]){var r=this.findTarget(t,e),n=this.touchDownTarget[i];return delete this.touchDownTarget[i],this.useTouchesCount--,o.TouchEvent.dispatchTouchEvent(r,o.TouchEvent.TOUCH_END,!0,!0,t,e,i,!1),n==r?o.TouchEvent.dispatchTouchEvent(r,o.TouchEvent.TOUCH_TAP,!0,!0,t,e,i,!1):o.TouchEvent.dispatchTouchEvent(n,o.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,t,e,i,!1),r!==this.stage}},r.prototype.findTarget=function(t,e){return this.stage.$hitTest(t,e)||this.stage},e=r,t.TouchHandler=e,__reflect(e.prototype,"egret.sys.TouchHandler")}(egret=egret||{}),function(C){var t,e,i;function w(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=NaN,t.filter=null,t.rotated=!1,t.type=1,t}t=C.sys||(C.sys={}),e=t.RenderNode,__extends(w,e),w.prototype.drawImage=function(t,e,i,r,n,o,a,s){this.drawData.push(t,e,i,r,n,o,a,s),this.renderCount++},w.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=NaN,this.filter=null},w.$updateTextureData=function(t,e,i,r,n,o,a,s,h,l,u,c,p,d,f,_){if(e){var g=C.$TextureScaleFactor;if(t.smoothing=_,t.image=e,t.imageWidth=p,t.imageHeight=d,f==C.BitmapFillMode.SCALE){p=u/h*g,d=c/l*g;t.drawImage(i,r,n,o,p*a,d*s,p*n,d*o)}else if(f==C.BitmapFillMode.CLIP){var y=Math.min(h,u),m=Math.min(l,c),v=n*g,b=o*g;w.drawClipImage(t,g,i,r,v,b,a,s,y,m)}else for(var v=n*g,b=o*g,T=0;T<u;T+=h)for(var x=0;x<c;x+=l){y=Math.min(u-T,h),m=Math.min(c-x,l);w.drawClipImage(t,g,i,r,v,b,a,s,y,m,T,x)}}},w.$updateTextureDataWithScale9Grid=function(t,e,i,r,n,o,a,s,h,l,u,c,p,d,f,_){t.smoothing=_,t.image=e,t.imageWidth=d,t.imageHeight=f,c-=l-o*C.$TextureScaleFactor,p-=u-a*C.$TextureScaleFactor;var g=i.x-s,y=i.y-h,m=g/C.$TextureScaleFactor,v=y/C.$TextureScaleFactor,b=i.width/C.$TextureScaleFactor,T=i.height/C.$TextureScaleFactor;0==T&&(T=1,a<=v&&v--),0==b&&(b=1,o<=m&&m--);var x=r,w=x+m,S=w+b,_=o-m-b,e=n,d=e+v,f=d+T,l=a-v-T,u=_*C.$TextureScaleFactor,i=l*C.$TextureScaleFactor;(m+_)*C.$TextureScaleFactor>c||(v+l)*C.$TextureScaleFactor>p?t.drawImage(r,n,o,a,s,h,c,p):(n=(r=s)+g,o=r+(c-u),a=c-g-u,c=(s=h)+y,h=s+p-i,p=p-y-i,0<v&&(0<m&&t.drawImage(x,e,m,v,r,s,g,y),0<b&&t.drawImage(w,e,b,v,n,s,a,y),0<_&&t.drawImage(S,e,_,v,o,s,u,y)),0<T&&(0<m&&t.drawImage(x,d,m,T,r,c,g,p),0<b&&t.drawImage(w,d,b,T,n,c,a,p),0<_&&t.drawImage(S,d,_,T,o,c,u,p)),0<l&&(0<m&&t.drawImage(x,f,m,l,r,h,g,i),0<b&&t.drawImage(w,f,b,l,n,h,a,i),0<_&&t.drawImage(S,f,_,l,o,h,u,i)))},w.drawClipImage=function(t,e,i,r,n,o,a,s,h,l,u,c){h=a+n-h;0<h&&(n-=h),0<(h=s+o-l)&&(o-=h),t.drawImage(i,r,n/e,o/e,(u=void 0===u?0:u)+a,(c=void 0===c?0:c)+s,n,o)},i=w,t.BitmapNode=i,__reflect(i.prototype,"egret.sys.BitmapNode")}(egret=egret||{}),function(h){var l,e,u,c,t;function i(){var t=e.call(this)||this;return t.dirtyRender=!0,t.type=3,t}l=h.sys||(h.sys={}),u=["none","round","square"],c=["bevel","miter","round"],e=l.RenderNode,__extends(i,e),i.prototype.beginFill=function(t,e,i){void 0===e&&(e=1);var r=new l.FillPath;return r.fillColor=t,r.fillAlpha=e,i?(i=this.drawData.lastIndexOf(i),this.drawData.splice(i,0,r)):this.drawData.push(r),this.renderCount++,r},i.prototype.beginGradientFill=function(t,e,i,r,n,o){var a=new h.Matrix;n?(a.a=819.2*n.a,a.b=819.2*n.b,a.c=819.2*n.c,a.d=819.2*n.d,a.tx=n.tx,a.ty=n.ty):(a.a=100,a.d=100);n=new l.GradientFillPath;return n.gradientType=t,n.colors=e,n.alphas=i,n.ratios=r,n.matrix=a,o?(o=this.drawData.lastIndexOf(o),this.drawData.splice(o,0,n)):this.drawData.push(n),this.renderCount++,n},i.prototype.lineStyle=function(t,e,i,r,n,o,a){void 0===i&&(i=1),void 0===o&&(o=3),void 0===a&&(a=[]),-1==u.indexOf(r)&&(r="round"),-1==c.indexOf(n)&&(n="round");var s=new l.StrokePath;return s.lineWidth=t,s.lineColor=e,s.lineAlpha=i,s.caps=r||h.CapsStyle.ROUND,s.joints=n,s.miterLimit=o,s.lineDash=a,this.drawData.push(s),this.renderCount++,s},i.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0,this.renderCount=0},i.prototype.cleanBeforeRender=function(){},i.prototype.clean=function(){this.$texture&&(h.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},t=i,l.GraphicsNode=t,__reflect(t.prototype,"egret.sys.GraphicsNode")}(egret=egret||{}),function(t){var e,i;function r(){var t=i.call(this)||this;return t.type=4,t}e=t.sys||(t.sys={}),i=e.RenderNode,__extends(r,i),r.prototype.addNode=function(t){this.drawData.push(t)},r.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;0<=e;e--)t[e].cleanBeforeRender()},r.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,i=e.length-1;0<=i;i--)t+=e[i].$getRenderCount();return t},t=r,e.GroupNode=t,__reflect(t.prototype,"egret.sys.GroupNode")}(egret=egret||{}),function(e){var t,i,r;function n(){var t=i.call(this)||this;return t.image=null,t.smoothing=!0,t.bounds=new e.Rectangle,t.blendMode=null,t.alpha=NaN,t.filter=null,t.rotated=!1,t.type=5,t.vertices=[],t.uvs=[],t.indices=[],t}t=e.sys||(e.sys={}),i=t.RenderNode,__extends(n,i),n.prototype.drawMesh=function(t,e,i,r,n,o,a,s){this.drawData.push(t,e,i,r,n,o,a,s),this.renderCount++},n.prototype.cleanBeforeRender=function(){i.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},r=n,t.MeshNode=r,__reflect(r.prototype,"egret.sys.MeshNode")}(egret=egret||{}),function(t){var e,i;function r(){var t=i.call(this)||this;return t.image=null,t.smoothing=!0,t.rotated=!1,t.type=6,t}e=t.sys||(t.sys={}),i=e.RenderNode,__extends(r,i),r.prototype.drawImage=function(t,e,i,r,n,o,a,s){var h=this;h.sourceX=t,h.sourceY=e,h.sourceW=i,h.sourceH=r,h.drawX=n,h.drawY=o,h.drawW=a,h.drawH=s,h.renderCount=1},r.prototype.cleanBeforeRender=function(){i.prototype.cleanBeforeRender.call(this),this.image=null},t=r,e.NormalBitmapNode=t,__reflect(t.prototype,"egret.sys.NormalBitmapNode")}(egret=egret||{}),function(p){var t=(d.prototype.uploadLevels=function(t,e){this.loadType===d.COMPRESSED_2D&&this._upload2DCompressedLevels(t,e)},d.prototype._upload2DCompressedLevels=function(t,e){t.clearCompressedTextureData();for(var i=d.HEADER_LEN+this.bytesOfKeyValueData,r=this.pixelWidth,n=this.pixelHeight,o=e?this.numberOfMipmapLevels:1,a=0;a<o;a++){var s=new Int32Array(this.arrayBuffer,i,1)[0];i+=4;for(var h=[],l=0;l<this.numberOfFaces;l++){var u=new Uint8Array(this.arrayBuffer,i,s),c=new p.CompressedTextureData;c.glInternalFormat=this.glInternalFormat,c.width=r,c.height=n,c.byteArray=u,c.face=l,c.level=a,h.push(c),i+=s,i+=3-(s+3)%4}t.$setCompressed2dTextureData(h),r=Math.max(1,.5*r),n=Math.max(1,.5*n)}e=t.getCompressed2dTextureData();e&&(t.width=e.width,t.height=e.height)},d.HEADER_LEN=64,d.COMPRESSED_2D=0,d.COMPRESSED_3D=1,d.TEX_2D=2,d.TEX_3D=3,d);function d(t,e,i,r){this.arrayBuffer=t,this.isInvalid=!1;var n=new Uint8Array(this.arrayBuffer,0,12);if(171!==n[0]||75!==n[1]||84!==n[2]||88!==n[3]||32!==n[4]||49!==n[5]||49!==n[6]||187!==n[7]||13!==n[8]||10!==n[9]||26!==n[10]||10!==n[11])return this.isInvalid=!0,void console.error("texture missing KTX identifier");var o=Uint32Array.BYTES_PER_ELEMENT,t=new DataView(this.arrayBuffer,12,13*o),n=67305985===t.getUint32(0,!0);this.glType=t.getUint32(+o,n),this.glTypeSize=t.getUint32(2*o,n),this.glFormat=t.getUint32(3*o,n),this.glInternalFormat=t.getUint32(4*o,n),this.glBaseInternalFormat=t.getUint32(5*o,n),this.pixelWidth=t.getUint32(6*o,n),this.pixelHeight=t.getUint32(7*o,n),this.pixelDepth=t.getUint32(8*o,n),this.numberOfArrayElements=t.getUint32(9*o,n),this.numberOfFaces=t.getUint32(10*o,n),this.numberOfMipmapLevels=t.getUint32(11*o,n),this.bytesOfKeyValueData=t.getUint32(12*o,n),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===e?this.loadType=d.COMPRESSED_2D:console.error("number of faces expected"+e+", but found "+this.numberOfFaces):console.error("texture arrays not currently supported"):console.error("only 2D textures currently supported")):console.error("only compressed formats currently supported")}p.KTXContainer=t,__reflect(t.prototype,"egret.KTXContainer")}(egret=egret||{}),function(t){var e,i,r;function n(){var t=i.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}e=t.sys||(t.sys={}),i=e.RenderNode,__extends(n,i),n.prototype.drawText=function(t,e,i,r){this.drawData.push(t,e,i,r),this.renderCount++,this.dirtyRender=!0},n.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},n.prototype.cleanBeforeRender=function(){i.prototype.cleanBeforeRender.call(this),this.dirtyRender=!0},r=n,e.TextNode=r,__reflect(r.prototype,"egret.sys.TextNode")}(egret=egret||{}),function(t){var e,i;function r(){var t=i.call(this)||this;return t.type=1,t}e=t.sys||(t.sys={}),i=e.Path2D,__extends(r,i),t=r,e.FillPath=t,__reflect(t.prototype,"egret.sys.FillPath")}(egret=egret||{}),function(t){var e,i;function r(){var t=i.call(this)||this;return t.type=2,t}e=t.sys||(t.sys={}),i=e.Path2D,__extends(r,i),t=r,e.GradientFillPath=t,__reflect(t.prototype,"egret.sys.GradientFillPath")}(egret=egret||{}),function(o){var e,t=(e=o.Bitmap,__extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(12)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setBitmapDataToMesh(t)},i.prototype.$updateRenderNode=function(){var t,e,i,r,n=this.$bitmapData;n&&(o.$TextureScaleFactor,(t=this.$renderNode).smoothing=this.$smoothing,t.image=n,t.imageWidth=this.$sourceWidth,t.imageHeight=this.$sourceHeight,i=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,r=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,e=i/this.$textureWidth,n=r/this.$textureHeight,i=this.$bitmapWidth,r=this.$bitmapHeight,t.drawMesh(this.$bitmapX,this.$bitmapY,i,r,this.$offsetX*e,this.$offsetY*n,e*i,n*r))},i.prototype.$updateVertices=function(){var t;this._verticesDirty=!0,this.$renderDirty=!0,o.nativeRender?(t=this.$renderNode,this.$nativeDisplayObject.setDataToMesh(t.vertices,t.indices,t.uvs)):((t=this.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(t=this.$maskedObject)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()))},i.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,i=e.vertices;if(i.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0,n=i.length;r<n;r+=2){var o=i[r],a=i[r+1];this._bounds.x>o&&(this._bounds.x=o),this._bounds.width<o&&(this._bounds.width=o),this._bounds.y>a&&(this._bounds.y=a),this._bounds.height<a&&(this._bounds.height=a)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},i);function i(t){t=e.call(this,t)||this;return t._verticesDirty=!0,t._bounds=new o.Rectangle,t.$renderNode=new o.sys.MeshNode,t}o.Mesh=t,__reflect(t.prototype,"egret.Mesh")}(egret=egret||{}),function(t){var e,i;function r(){var t=i.call(this)||this;return t.type=3,t}e=t.sys||(t.sys={}),i=e.Path2D,__extends(r,i),t=r,e.StrokePath=t,__reflect(t.prototype,"egret.sys.StrokePath")}(egret=egret||{}),function(y){var P=["source-over","lighter","destination-out"],D="source-over",l="#000000",u={none:"butt",square:"square",round:"round"},O=[],T=[],t=(e.prototype.render=function(t,e,i,r){this.nestLevel++;e=e.context;e.transform(i.a,i.b,i.c,i.d,0,0);r=this.drawDisplayObject(t,e,i.tx,i.ty,!0),t=y.Matrix.create();if(i.$invertInto(t),e.transform(t.a,t.b,t.c,t.d,0,0),y.Matrix.release(t),this.nestLevel--,0===this.nestLevel){6<O.length&&(O.length=6);for(var n=O.length,o=0;o<n;o++)O[o].resize(0,0)}return r},e.prototype.drawDisplayObject=function(t,e,i,r,n){var o=0,a=t.$displayList,s=a&&!n?((t.$cacheDirty||t.$renderDirty||a.$canvasScaleX!=y.sys.DisplayList.$canvasScaleX||a.$canvasScaleY!=y.sys.DisplayList.$canvasScaleY)&&(o+=a.drawToSurface()),a.$renderNode):t.$renderDirty?t.$getRenderNode():t.$renderNode;if(t.$cacheDirty=!1,s){switch(o++,e.$offsetX=i,e.$offsetY=r,s.type){case 1:this.renderBitmap(s,e);break;case 2:this.renderText(s,e);break;case 3:this.renderGraphics(s,e);break;case 4:this.renderGroup(s,e);break;case 5:this.renderMesh(s,e);break;case 6:this.renderNormalBitmap(s,e)}e.$offsetX=0,e.$offsetY=0}if(a&&!n)return o;var h=t.$children;if(h)for(var l=h.length,u=0;u<l;u++){var c=h[u],p=void 0,d=void 0;d=c.$useTranslate?(f=c.$getMatrix(),p=i+c.$x,d=r+c.$y,e.save(),e.transform(f.a,f.b,f.c,f.d,p,d),p=-c.$anchorOffsetX,-c.$anchorOffsetY):(p=i+c.$x-c.$anchorOffsetX,r+c.$y-c.$anchorOffsetY);var f=void 0;switch(1!=c.$alpha&&(f=e.globalAlpha,e.globalAlpha*=c.$alpha),c.$renderMode){case 1:break;case 2:o+=this.drawWithFilter(c,e,p,d);break;case 3:o+=this.drawWithClip(c,e,p,d);break;case 4:o+=this.drawWithScrollRect(c,e,p,d);break;default:o+=this.drawDisplayObject(c,e,p,d)}c.$useTranslate?e.restore():f&&(e.globalAlpha=f)}return o},e.prototype.drawWithFilter=function(t,e,i,r){if(t.$children&&0==t.$children.length&&(!t.$renderNode||0==t.$renderNode.$getRenderCount()))return 0;var n,o=0,a=t.$filters,s=a.length,h=0!==t.$blendMode;h&&(n=(n=P[t.$blendMode])||D);var l=t.$getOriginalBounds(),u=l.x,c=l.y,p=l.width,l=l.height;if(p<=0||l<=0)return o;var d=this.createRenderBuffer(p-u,l-c,!0),l=d.context;if(t.$mask?o+=this.drawWithClip(t,l,-u,-c):t.$scrollRect||t.$maskRect?o+=this.drawWithScrollRect(t,l,-u,-c):o+=this.drawDisplayObject(t,l,-u,-c),0<o){h&&(e.globalCompositeOperation=n),o++;for(var f=l.getImageData(0,0,d.surface.width,d.surface.height),_=0;_<s;_++){var g,y,m,v,b=a[_];"colorTransform"==b.type?I(f.data,d.surface.width,d.surface.height,b.$matrix):"blur"==b.type?x(f.data,d.surface.width,d.surface.height,b.$blurX,b.$blurY):"glow"==b.type?(g=b.$red,y=b.$green,m=b.$blue,v=b.$alpha,b.$inner||b.$knockout||b.$hideObject?function(t,e,i,r,n,o,a,s,h,l,u,c){var p;p=new(N?Uint8ClampedArray:Array)(t.length);for(var d,f,_=r[3],g=0,y=0,m=s*Math.cos(a),v=s*Math.sin(a),b=3.141592653589793,T=n/7,x=o/7,w=0;w<e;w++)for(var S=0;S<i;S++){for(var C=S*e*4+4*w,E=0,P=0,D=t[C]/255,O=t[1+C]/255,I=t[2+C]/255,$=t[3+C]/255,A=0;A<=2*b;A+=2*b/12){d=Math.cos(A+0),f=Math.sin(A+0);for(var R=0;R<7;R++){g=R*T*d,y=R*x*f;var B=Math.round(w+g-m),M=Math.round(S+y-v),L=0;L=e<=B||B<0||M<0||i<=M?0:t[3+(M*e*4+4*B)]/255,E+=(7-R)*L,P+=7-R}}$=Math.max($,1e-4);var F=E/P*h*_*(1-l)*Math.max(Math.min(c,u),1-$),k=(P-E)/P*h*_*l*$;$=Math.max($*u*(1-c),1e-4);var j=k/(k+$),D=U(D,r[0],j),O=U(O,r[1],j),I=U(I,r[2],j),j=F/(k+$+F),D=U(D,r[0],j),O=U(O,r[1],j),j=U(I,r[2],j),k=Math.min($+F+k,1);p[C]=255*D,p[1+C]=255*O,p[2+C]=255*j,p[3+C]=255*k}N?t.set(p):G(t,p)}(f.data,d.surface.width,d.surface.height,[g/255,y/255,m/255,v],b.$blurX,b.$blurY,b.$angle?b.$angle/180*Math.PI:0,b.$distance||0,b.$strength,b.$inner?1:0,b.$knockout?0:1,b.$hideObject?1:0):function(t,e,i,r,n,o,a,s,h){r=function(t,e){e=e||[0,0,0,0];var i;N?i=new Uint8ClampedArray(t):G(i=new Array(t.length),t);for(var r=e[0],n=e[1],o=e[2],a=e[3],s=0,h=i.length;s<h;s+=4){var l=i[s+3];i[s+0]=r*l,i[s+1]=n*l,i[s+2]=o*l,i[s+3]=a*l}return i}(t,r);(function(t,e,i,r,n){var o,a,s=Math.sin(r)*n|0,h=Math.cos(r)*n|0;if(N){o=new Int32Array(t.buffer),a=new Int32Array(o.length);for(var l=0;l<i;l++)if(!((c=l+s)<0||i<c))for(var u=0;u<e;u++)(p=u+h)<0||e<p||(a[c*e+p]=o[l*e+u]);o.set(a)}else{o=t,a=new Array(o.length);for(var c,l=0;l<i;l++)if(!((c=l+s)<0||i<c))for(var p,u=0;u<e;u++)(p=u+h)<0||e<p||(a[4*(c*e+p)+0]=o[4*(l*e+u)+0],a[4*(c*e+p)+1]=o[4*(l*e+u)+1],a[4*(c*e+p)+2]=o[4*(l*e+u)+2],a[4*(c*e+p)+3]=o[4*(l*e+u)+3]);G(o,a)}})(r,e,i,a,s),x(r,e,i,n,o),function(t,e){for(var i=0,r=t.length;i<r;i+=4)t[i+3]*=e}(r,h),function(t,e){for(var i=0,r=t.length;i<r;i+=4){var n=t[i+0],o=t[i+1],a=t[i+2],s=t[i+3]/255,h=e[i+0],l=e[i+1],u=e[i+2],c=e[i+3]/255;t[i+0]=h+n*(1-c),t[i+1]=l+o*(1-c),t[i+2]=u+a*(1-c),t[i+3]=255*(c+s*(1-c))}}(r,t),t.set(r),N?t.set(r):G(t,r)}(f.data,d.surface.width,d.surface.height,[g/255,y/255,m/255,v],b.$blurX,b.$blurY,b.$angle?b.$angle/180*Math.PI:0,b.$distance||0,b.$strength)):b.type}l.putImageData(f,0,0),e.drawImage(d.surface,i+u,r+c),h&&(e.globalCompositeOperation=D)}return T.push(d),o},e.prototype.drawWithClip=function(t,e,i,r){var n,o=0,a=0!==t.$blendMode;a&&(n=(n=P[t.$blendMode])||D);var s=t.$scrollRect||t.$maskRect,h=t.$mask;if(h){var l=h.$getMatrix();if(0==l.a&&0==l.b||0==l.c&&0==l.d)return o}if(!(h||t.$children&&0!=t.$children.length))return s&&(e.save(),e.beginPath(),e.rect(s.x+i,s.y+r,s.width,s.height),e.clip()),a&&(e.globalCompositeOperation=n),o+=this.drawDisplayObject(t,e,i,r),a&&(e.globalCompositeOperation=D),s&&e.restore(),o;if(h){var u=h.$getRenderNode();if((!h.$children||0==h.$children.length)&&u&&3==u.type&&1==u.drawData.length&&1==u.drawData[0].type&&1==u.drawData[0].fillAlpha){this.renderingMask=!0,e.save(),(g=y.Matrix.create()).copyFrom(h.$getConcatenatedMatrix()),h.$getConcatenatedMatrixAt(t,g),g.prepend(1,0,0,1,i,r),e.transform(g.a,g.b,g.c,g.d,g.tx,g.ty);var c=this.drawDisplayObject(h,e,0,0);return this.renderingMask=!1,g.$invertInto(g),e.transform(g.a,g.b,g.c,g.d,g.tx,g.ty),y.Matrix.release(g),s&&(e.beginPath(),e.rect(s.x+i,s.y+r,s.width,s.height),e.clip()),c+=this.drawDisplayObject(t,e,i,r),e.restore(),c}}var p=t.$getOriginalBounds(),d=p.x,f=p.y,_=p.width,l=p.height;if(_<=0||l<=0)return o;var g,c=this.createRenderBuffer(_,l),p=c.context;return p?(o+=this.drawDisplayObject(t,p,-d,-f),h&&(u=h.$getRenderNode(),(g=y.Matrix.create()).copyFrom(h.$getConcatenatedMatrix()),h.$getConcatenatedMatrixAt(t,g),g.translate(-d,-f),u&&1==u.$getRenderCount()||h.$displayList?(p.globalCompositeOperation="destination-in",p.save(),p.setTransform(g.a,g.b,g.c,g.d,g.tx,g.ty),o+=this.drawDisplayObject(h,p,0,0),p.restore()):((l=(_=this.createRenderBuffer(_,l)).context).setTransform(g.a,g.b,g.c,g.d,g.tx,g.ty),o+=this.drawDisplayObject(h,l,0,0),p.globalCompositeOperation="destination-in",p.drawImage(_.surface,0,0),O.push(_)),y.Matrix.release(g)),0<o&&(o++,a&&(e.globalCompositeOperation=n),s&&(e.save(),e.beginPath(),e.rect(s.x+i,s.y+r,s.width,s.height),e.clip()),e.drawImage(c.surface,i+d,r+f),s&&e.restore(),a&&(e.globalCompositeOperation=D)),O.push(c),o):o+=this.drawDisplayObject(t,e,i,r)},e.prototype.drawWithScrollRect=function(t,e,i,r){var n=0,o=t.$scrollRect||t.$maskRect;return o.isEmpty()||(t.$scrollRect&&(i-=o.x,r-=o.y),e.save(),e.beginPath(),e.rect(o.x+i,o.y+r,o.width,o.height),e.clip(),n+=this.drawDisplayObject(t,e,i,r),e.restore()),n},e.prototype.drawNodeToBuffer=function(t,e,i,r){e=e.context;e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,e,r)},e.prototype.drawDisplayToBuffer=function(t,e,i){var r=e.context;i&&r.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);var n,o=0;if(n=t.$renderDirty?t.$getRenderNode():t.$renderNode)switch(o++,n.type){case 1:this.renderBitmap(n,r);break;case 2:this.renderText(n,r);break;case 3:this.renderGraphics(n,r);break;case 4:this.renderGroup(n,r);break;case 5:this.renderMesh(n,r);break;case 6:this.renderNormalBitmap(n,r)}var a=t.$children;if(a)for(var s=a.length,h=0;h<s;h++){var l=a[h];switch(l.$renderMode){case 1:break;case 2:o+=this.drawWithFilter(l,r,0,0);break;case 3:o+=this.drawWithClip(l,r,0,0);break;case 4:o+=this.drawWithScrollRect(l,r,0,0);break;default:o+=this.drawDisplayObject(l,r,0,0)}}return o},e.prototype.renderNode=function(t,e,i){var r=0;switch(t.type){case 1:r=this.renderBitmap(t,e);break;case 2:r=1,this.renderText(t,e);break;case 3:r=this.renderGraphics(t,e,i);break;case 4:r=this.renderGroup(t,e);break;case 5:r=this.renderMesh(t,e);break;case 6:r+=this.renderNormalBitmap(t,e)}return r},e.prototype.renderNormalBitmap=function(t,e){var i,r,n,o,a,s,h,l,u=t.image;return u&&u.source?(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),t.rotated?(i=t.sourceX,r=t.sourceY,n=t.sourceW,o=t.sourceH,a=t.drawX,s=t.drawY,h=t.drawW,l=t.drawH,e.save(),e.transform(0,-1,1,0,0,l),e.drawImage(u.source,i,r,o,n,a+e.$offsetX,s+e.$offsetY,l,h),e.restore()):e.drawImage(u.source,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX+e.$offsetX,t.drawY+e.$offsetY,t.drawW,t.drawH),1):0},e.prototype.renderBitmap=function(t,e){var i=t.image;if(!i||!i.source)return 0;e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing);var r,n,o,a=t.drawData,s=a.length,h=0,l=t.matrix,u=t.blendMode,c=t.alpha,p=!1;l&&(e.save(),p=!0,0==e.$offsetX&&0==e.$offsetY||(e.translate(e.$offsetX,e.$offsetY),r=e.$offsetX,n=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(l.a,l.b,l.c,l.d,l.tx,l.ty)),u&&(e.globalCompositeOperation=P[u]),c==c&&(o=e.globalAlpha,e.globalAlpha*=c);var d,f,_=0,g=t.filter;if(g&&8==s){var y=a[0],m=a[1],v=a[2],b=a[3],T=a[4],x=a[5],w=a[6],S=a[7];t.rotated&&(v=a[3],b=a[2],w=a[7],S=a[6]);var C=this.createRenderBuffer(w,S),E=C.context;_++,t.rotated&&e.transform(0,-1,1,0,0,w),E.drawImage(i.source,y,m,v,b,0,0,w,S),_++;l=E.getImageData(0,0,w,S);I(l.data,w,S,g.$matrix),E.putImageData(l,0,0),e.drawImage(C.surface,0,0,w,S,T+e.$offsetX,x+e.$offsetY,w,S),O.push(C)}else for(;h<s;)_++,t.rotated?(y=a[h++],m=a[h++],b=a[h++],v=a[h++],d=a[h++],f=a[h++],S=a[h++],w=a[h++],e.save(),e.transform(0,-1,1,0,0,w),e.drawImage(i.source,y,m,v,b,d+e.$offsetX,f+e.$offsetY,w,S),e.restore()):e.drawImage(i.source,a[h++],a[h++],a[h++],a[h++],a[h++]+e.$offsetX,a[h++]+e.$offsetY,a[h++],a[h++]);return p?e.restore():(u&&(e.globalCompositeOperation=D),c==c&&(e.globalAlpha=o)),r&&(e.$offsetX=r),n&&(e.$offsetY=n),_},e.prototype.renderMesh=function(t,e){var i,r,n,o=t.image,a=t.drawData,s=a.length,h=0,l=t.matrix,u=t.blendMode,c=t.alpha,p=!1,d=0;for(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),l&&(e.save(),p=!0,0==e.$offsetX&&0==e.$offsetY||(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,r=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(l.a,l.b,l.c,l.d,l.tx,l.ty)),u&&(e.globalCompositeOperation=P[u]),c==c&&(n=e.globalAlpha,e.globalAlpha*=c);h<s;)d+=this.drawMesh(o,a[h++],a[h++],a[h++],a[h++],a[h++],a[h++],a[h++],a[h++],t.uvs,t.vertices,t.indices,t.bounds,t.rotated,e);return u&&(e.globalCompositeOperation=D),c==c&&(e.globalAlpha=n),i&&(e.$offsetX=i),r&&(e.$offsetY=r),p&&e.restore(),d},e.prototype.drawMesh=function(t,e,i,r,n,o,a,s,h,l,u,c,p,d,f){if(f&&t){var _,g,y,m,v,b,T=0,x=r,w=n,S=s,C=h;d&&(x=n,w=r,S=h,C=s);for(var E,P,D,O,I,$,A=c.length,R=0;R<A;R+=3){I=2*c[R],$=2*c[R+1],B=2*c[R+2],_=l[I]*r,m=l[1+I]*n,g=l[$]*r,v=l[1+$]*n,y=l[B]*r,b=l[1+B]*n,E=u[I],P=u[1+I],D=u[$],O=u[1+$],I=u[B],$=u[1+B],f.save(),f.beginPath(),f.moveTo(E,P),f.lineTo(D,O),f.lineTo(I,$),f.closePath(),f.clip();var B=1/(_*v+m*y+g*b-v*y-m*g-_*b);f.transform((E*v+m*I+D*b-v*I-m*D-E*b)*B,(P*v+m*$+O*b-v*$-m*O-P*b)*B,(_*D+E*y+g*I-D*y-E*g-_*I)*B,(_*O+P*y+g*$-O*y-P*g-_*$)*B,(_*v*I+m*D*y+E*g*b-E*v*y-m*g*I-_*D*b)*B,(_*v*$+m*O*y+P*g*b-P*v*y-m*g*$-_*O*b)*B),d&&f.transform(0,-1,1,0,0,S),f.drawImage(t.source,e,i,x,w,o+f.$offsetX,a+f.$offsetY,S,C),f.restore(),T++}return T}},e.prototype.renderText=function(t,e){e.textAlign="left",e.textBaseline="middle",e.lineJoin="round";for(var i=t.drawData,r=i.length,n=0;n<r;){var o=i[n++],a=i[n++],s=i[n++],h=i[n++];e.font=c(t,h);var l=(null==h.textColor?t:h).textColor,u=(null==h.strokeColor?t:h).strokeColor,h=(null==h.stroke?t:h).stroke;e.fillStyle=y.toColorString(l),e.strokeStyle=y.toColorString(u),h&&(e.lineWidth=2*h,e.strokeText(s,o+e.$offsetX,a+e.$offsetY)),e.fillText(s,o+e.$offsetX,a+e.$offsetY)}},e.prototype.renderGraphics=function(t,e,i){var r=t.drawData,n=r.length;i=!!i;for(var o=0;o<n;o++){var a=r[o];switch(a.type){case 1:e.fillStyle=i?l:p(a.fillColor,a.fillAlpha),this.renderPath(a,e),this.renderingMask?e.clip():e.fill();break;case 2:var s=a;e.fillStyle=i?l:function(t,e,i,r,n){var o;o=e==y.GradientType.LINEAR?t.createLinearGradient(-1,0,1,0):t.createRadialGradient(0,0,0,0,0,1);for(var a=i.length,s=0;s<a;s++)o.addColorStop(n[s]/255,p(i[s],r[s]));return o}(e,s.gradientType,s.colors,s.alphas,s.ratios,s.matrix),e.save();var h=s.matrix;this.renderPath(a,e),e.transform(h.a,h.b,h.c,h.d,h.tx,h.ty),e.fill(),e.restore();break;case 3:s=a,h=s.lineWidth;e.lineWidth=h,e.strokeStyle=i?l:p(s.lineColor,s.lineAlpha),e.lineCap=u[s.caps],e.lineJoin=s.joints,e.miterLimit=s.miterLimit,e.setLineDash&&e.setLineDash(s.lineDash);h=1===h||3===h;h&&e.translate(.5,.5),this.renderPath(a,e),e.stroke(),h&&e.translate(-.5,-.5)}}return 0==n?0:1},e.prototype.renderPath=function(t,e){e.beginPath();for(var i=t.$data,r=t.$commands,n=r.length,o=0,a=0;a<n;a++)switch(r[a]){case 4:e.bezierCurveTo(i[o++]+e.$offsetX,i[o++]+e.$offsetY,i[o++]+e.$offsetX,i[o++]+e.$offsetY,i[o++]+e.$offsetX,i[o++]+e.$offsetY);break;case 3:e.quadraticCurveTo(i[o++]+e.$offsetX,i[o++]+e.$offsetY,i[o++]+e.$offsetX,i[o++]+e.$offsetY);break;case 2:e.lineTo(i[o++]+e.$offsetX,i[o++]+e.$offsetY);break;case 1:e.moveTo(i[o++]+e.$offsetX,i[o++]+e.$offsetY)}},e.prototype.renderGroup=function(t,e){var i,r,n=t.matrix,o=!1;n&&(e.save(),o=!0,0==e.$offsetX&&0==e.$offsetY||(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,r=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty));for(var a=0,s=t.drawData,h=s.length,l=0;l<h;l++){var u=s[l];a+=this.renderNode(u,e)}return o&&e.restore(),i&&(e.$offsetX=i),r&&(e.$offsetY=r),a},e.prototype.createRenderBuffer=function(t,e,i){i=(i?T:O).pop();return i?i.resize(t,e,!0):i=new y.sys.CanvasRenderBuffer(t,e),i},e.prototype.renderClear=function(){},e);function e(){this.nestLevel=0,this.renderingMask=!1}function c(t,e){var i=(null==e.italic?t:e).italic?"italic ":"normal ";return i+=(null==e.bold?t:e).bold?"bold ":"normal ",i+=(null==e.size?t:e).size+"px "+(e.fontFamily||t.fontFamily)}function p(t,e){return"rgba("+(t>>16)+","+(t>>8&255)+","+(255&t)+","+e+")"}y.CanvasRenderer=t,__reflect(t.prototype,"egret.CanvasRenderer"),y.getFontString=c,y.getRGBAString=p;var N=!1;try{N=!0}catch(t){}function G(t,e,i){void 0===i&&(i=0);for(var r=0,n=e.length;r<n;r++)t[r+i]=e[r]}function I(t,e,i,r){for(var n=r[0],o=r[1],a=r[2],s=r[3],h=r[4],l=r[5],u=r[6],c=r[7],p=r[8],d=r[9],f=r[10],_=r[11],g=r[12],y=r[13],m=r[14],v=r[15],b=r[16],T=r[17],x=r[18],w=r[19],S=0,C=e*i*4;S<C;S+=4){var E=t[S+0],P=t[S+1],D=t[S+2],O=t[S+3];t[S+0]=n*E+o*P+a*D+s*O+h,t[S+1]=l*E+u*P+c*D+p*O+d,t[S+2]=f*E+_*P+g*D+y*O+m,t[S+3]=v*E+b*P+T*D+x*O+w}}function x(t,e,i,r,n){!function(t,e,i,r){var n;n=new(N?Uint8ClampedArray:Array)(4*e);for(var o=4*e,a=2*r+1,s=0;s<i;s++){for(var h=s*o,l=0,u=0,c=0,p=0,d=0,f=0,_=4*-r,g=4*r+4;_<g;_+=4){var y=h+_;y<h||h+o<=y||(d=t[y+3],l+=t[y+0]*d,u+=t[y+1]*d,c+=t[y+2]*d,p+=d)}for(var g=h+o,m=0,v=(_=h)-4*r,b=_+4*(r+1);_<g;_+=4,m+=4,b+=4,v+=4)0===p?(n[m+0]=0,n[m+1]=0,n[m+2]=0,n[m+3]=0):(n[m+0]=l/p,n[m+1]=u/p,n[m+2]=c/p,n[m+3]=p/a),d=t[b+3],f=t[v+3],d||0==d?f||0==f?(l+=t[b+0]*d-t[v+0]*f,u+=t[b+1]*d-t[v+1]*f,c+=t[b+2]*d-t[v+2]*f,p+=d-f):(l+=t[b+0]*d,u+=t[b+1]*d,c+=t[b+2]*d,p+=d):!f&&0!=f||(l+=-t[v+0]*f,u+=-t[v+1]*f,c+=-t[v+2]*f,p+=-f);N?t.set(n,h):G(t,n,h)}}(t,e,i,r),function(t,e,i,r){var n;n=new(N?Uint8ClampedArray:Array)(4*i);for(var o=4*e,a=2*r+1,s=0;s<e;s++){for(var h=4*s,l=0,u=0,c=0,p=0,d=0,f=0,_=-r*o,g=r*o+o;_<g;_+=o){var y=h+_;y<h||h+i*o<=y||(d=t[y+3],l+=t[y+0]*d,u+=t[y+1]*d,c+=t[y+2]*d,p+=d)}for(var _=h,g=h+i*o,m=0,v=h-r*o,b=h+(r+1)*o;_<g;_+=o,m+=4,b+=o,v+=o)0===p?(n[m+0]=0,n[m+1]=0,n[m+2]=0,n[m+3]=0):(n[m+0]=l/p,n[m+1]=u/p,n[m+2]=c/p,n[m+3]=p/a),d=t[b+3],f=t[v+3],d||0==d?f||0==f?(l+=t[b+0]*d-t[v+0]*f,u+=t[b+1]*d-t[v+1]*f,c+=t[b+2]*d-t[v+2]*f,p+=d-f):(l+=t[b+0]*d,u+=t[b+1]*d,c+=t[b+2]*d,p+=d):!f&&0!=f||(l+=-t[v+0]*f,u+=-t[v+1]*f,c+=-t[v+2]*f,p+=-f);for(var T=4*s,g=T+i*o,x=0;T<g;T+=o,x+=4)t[T+0]=n[x+0],t[T+1]=n[x+1],t[T+2]=n[x+2],t[T+3]=n[x+3]}}(t,e,i,n)}function U(t,e,i){return t*(1-i)+e*i}}(egret=egret||{}),(egret=egret||{}).DeviceOrientation=null,function(t){(e=t.RuntimeType||(t.RuntimeType={})).WEB="web",e.NATIVE="native",e.RUNTIME2="runtime2",e.MYGAME="mygame",e.WXGAME="wxgame",e.BAIDUGAME="baidugame",e.QGAME="qgame",e.OPPOGAME="oppogame",e.QQGAME="qqgame",e.VIVOGAME="vivogame",e.QHGAME="qhgame",e.TTGAME="ttgame",e.FASTGAME="fastgame",e.TBCREATIVEAPP="tbcreativeapp";var e=(Object.defineProperty(i,"supportedCompressedTexture",{get:function(){return this._supportedCompressedTexture&&null!=this._supportedCompressedTexture.pvrtc&&null!=this._supportedCompressedTexture||t.web&&t.web.WebGLRenderContext.getInstance().getSupportedCompressedTexture(),this._supportedCompressedTexture},enumerable:!0,configurable:!0}),i.language="zh-CN",i.os="Unknown",i.runtimeType=t.RuntimeType.WEB,i.engineVersion="5.4.1",i.renderMode="Unknown",i.boundingClientWidth=0,i.boundingClientHeight=0,i._supportedCompressedTexture={},i);function i(){}t.Capabilities=e,__reflect(e.prototype,"egret.Capabilities")}(egret=(egret=(egret=egret||{})||{})||{}),(egret=egret||{}).OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"},function(t){var i={};t.registerImplementation=function(t,e){i[t]=e},t.getImplementation=function(t){return i[t]}}(egret=egret||{}),function(c){var i,t=(i=c.Texture,__extends(e,i),e.prototype.drawToTexture=function(t,e,i){if(void 0===i&&(i=1),e&&(0==e.width||0==e.height))return!1;var r=e||t.$getOriginalBounds();if(0==r.width||0==r.height)return!1;i/=c.$TextureScaleFactor;var n=(r.x+r.width)*i,o=(r.y+r.height)*i;e&&(n=r.width*i,o=r.height*i);var a,s,h,l,u=this.$renderBuffer;return!!u&&(u.resize(n,o),this.$bitmapData.width=n,this.$bitmapData.height=o,c.nativeRender?(egret_native.activateBuffer(this.$renderBuffer),a=!1,l=r=h=s=0,e&&(a=!0,s=e.x,h=e.y,r=e.width,l=e.height),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject(t.$nativeDisplayObject.id,i,a,s,h,r,l),egret_native.activateBuffer(null)):((l=c.Matrix.create()).identity(),l.scale(i,i),e&&l.translate(-e.x,-e.y),c.sys.systemRenderer.render(t,u,l,!0),c.Matrix.release(l)),this.$initData(0,0,n,o,0,0,n,o,n,o),!0)},e.prototype.getPixel32=function(t,e){var i;return this.$renderBuffer&&(i=c.$TextureScaleFactor,t=Math.round(t/i),e=Math.round(e/i),i=this.$renderBuffer.getPixels(t,e,1,1)),i},e.prototype.dispose=function(){i.prototype.dispose.call(this),this.$renderBuffer=null},e);function e(){var t=i.call(this)||this;t.$renderBuffer=new c.sys.RenderBuffer;var e=new c.BitmapData(t.$renderBuffer.surface);return e.$deleteSource=!1,t._setBitmapData(e),t}c.RenderTexture=t,__reflect(t.prototype,"egret.RenderTexture")}(egret=egret||{}),function(t){var i,e=(i=t.SpriteSheet,__extends(r,i),r.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var i=this.charList[t];if(!i)return null;e=this.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH),this._textureMap[t]=e}return e},r.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},r.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var i=e.sourceH;if(!((i=void 0===i?(t=void 0===(t=e.h)?0:t)+(e=void 0===(e=e.offY)?0:e):i)<=0)){this.firstCharHeight=i;break}}}return this.firstCharHeight},r.prototype.parseConfig=function(t){for(var e=(t=t.split("\r\n").join("\n")).split("\n"),i=this.getConfigByKey(e[3],"count"),r={},n=4;n<4+i;n++){var o=e[n],a={};(r[String.fromCharCode(this.getConfigByKey(o,"id"))]=a).x=this.getConfigByKey(o,"x"),a.y=this.getConfigByKey(o,"y"),a.w=this.getConfigByKey(o,"width"),a.h=this.getConfigByKey(o,"height"),a.offX=this.getConfigByKey(o,"xoffset"),a.offY=this.getConfigByKey(o,"yoffset"),a.xadvance=this.getConfigByKey(o,"xadvance")}return r},r.prototype.getConfigByKey=function(t,e){for(var i=t.split(" "),r=0,n=i.length;r<n;r++){var o=i[r];if(e==o.substring(0,e.length)){o=o.substring(e.length+1);return parseInt(o)}}return 0},r);function r(t,e){t=i.call(this,t)||this;return t.firstCharHeight=0,"string"==typeof e?t.charList=t.parseConfig(e):e&&e.hasOwnProperty("frames")?t.charList=e.frames:t.charList={},t}t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret=egret||{}),function(I){var e,t=(e=I.DisplayObject,__extends($,e),$.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty($.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t,I.nativeRender||((t=this.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(t=this.$maskedObject)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())))},enumerable:!0,configurable:!0}),Object.defineProperty($.prototype,"text",{get:function(){return this.$text},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),$.prototype.$setText=function(t){return(t=null==t?"":String(t))!=this.$text&&(this.$text=t,this.$invalidateContentBounds(),!0)},$.prototype.$getWidth=function(){var t=this.$textFieldWidth;return isNaN(t)?this.$getContentBounds().width:t},$.prototype.$setWidth=function(t){return!(t<0||t==this.$textFieldWidth)&&(this.$textFieldWidth=t,this.$invalidateContentBounds(),!0)},$.prototype.$invalidateContentBounds=function(){var t;this.$renderDirty=!0,this.$textLinesChanged=!0,this.$updateRenderNode(),I.nativeRender||((t=this.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(t=this.$maskedObject)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()))},$.prototype.$getHeight=function(){var t=this.$textFieldHeight;return isNaN(t)?this.$getContentBounds().height:t},$.prototype.$setHeight=function(t){return!(t<0||t==this.$textFieldHeight)&&(this.$textFieldHeight=t,this.$invalidateContentBounds(),!0)},Object.defineProperty($.prototype,"font",{get:function(){return this.$font},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),$.prototype.$setFont=function(t){return this.$font!=t&&(this.$font=t,this.$fontStringChanged=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty($.prototype,"lineSpacing",{get:function(){return this.$lineSpacing},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),$.prototype.$setLineSpacing=function(t){return this.$lineSpacing!=t&&(this.$lineSpacing=t,this.$invalidateContentBounds(),!0)},Object.defineProperty($.prototype,"letterSpacing",{get:function(){return this.$letterSpacing},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),$.prototype.$setLetterSpacing=function(t){return this.$letterSpacing!=t&&(this.$letterSpacing=t,this.$invalidateContentBounds(),!0)},Object.defineProperty($.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),$.prototype.$setTextAlign=function(t){return this.$textAlign!=t&&(this.$textAlign=t,this.$invalidateContentBounds(),!0)},Object.defineProperty($.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),$.prototype.$setVerticalAlign=function(t){return this.$verticalAlign!=t&&(this.$verticalAlign=t,this.$invalidateContentBounds(),!0)},$.prototype.$updateRenderNode=function(){var t=this,e=this.$getTextLines(),i=e.length;if(0!=i){var r,n=[],o=this.$textLinesWidth,a=t.$font;I.nativeRender||(r=this.$renderNode,a.$texture&&(r.image=a.$texture.$bitmapData),r.smoothing=t.$smoothing);for(var s=a._getFirstCharHeight(),h=Math.ceil(s*$.EMPTY_FACTOR),l=!isNaN(t.$textFieldHeight),u=t.$textWidth,c=t.$textFieldWidth,p=t.$textFieldHeight,d=t.$textAlign,f=this.$textOffsetY+this.$textStartY,_=this.$lineHeights,g=0;g<i;g++){var y=_[g];if(l&&0<g&&p<f+y)break;var m,v=e[g],b=v.length,T=this.$textOffsetX;d!=I.HorizontalAlign.LEFT&&(m=u<c?c:u,d==I.HorizontalAlign.RIGHT?T+=m-o[g]:d==I.HorizontalAlign.CENTER&&(T+=Math.floor((m-o[g])/2)));for(var x=0;x<b;x++){var w,S,C=v.charAt(x),E=a.getTexture(C);E?(w=E.$bitmapWidth,S=E.$bitmapHeight,I.nativeRender?n.push(E.$bitmapX,E.$bitmapY,w,S,T+E.$offsetX,f+E.$offsetY,E.$getScaleBitmapWidth(),E.$getScaleBitmapHeight(),E.$sourceWidth,E.$sourceHeight):(r.imageWidth=E.$sourceWidth,r.imageHeight=E.$sourceHeight,r.drawImage(E.$bitmapX,E.$bitmapY,w,S,T+E.$offsetX,f+E.$offsetY,E.$getScaleBitmapWidth(),E.$getScaleBitmapHeight())),T+=(a.getConfig(C,"xadvance")||E.$getTextureWidth())+t.$letterSpacing):" "==C?T+=h:I.$warn(1046,C)}f+=y+t.$lineSpacing}I.nativeRender&&(t.$nativeDisplayObject.setDataToBitmapNode(t.$nativeDisplayObject.id,a.$texture,n),s=t.$getContentBounds(),t.$nativeDisplayObject.setWidth(s.width),t.$nativeDisplayObject.setHeight(s.height))}else I.nativeRender&&t.$font&&(t.$nativeDisplayObject.setDataToBitmapNode(t.$nativeDisplayObject.id,t.$font.$texture,[]),t.$nativeDisplayObject.setWidth(0),t.$nativeDisplayObject.setHeight(0))},$.prototype.$measureContentBounds=function(t){0==this.$getTextLines().length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$textWidth-this.$textOffsetX,this.$textHeight-this.$textOffsetY)},Object.defineProperty($.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$textWidth},enumerable:!0,configurable:!0}),Object.defineProperty($.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$textHeight},enumerable:!0,configurable:!0}),$.prototype.$getTextLines=function(){var t=this;if(!t.$textLinesChanged)return t.textLines;var e=[];t.textLines=e;var i=[];t.$textLinesWidth=i,t.$textLinesChanged=!1;var r=[];if(t.$lineHeights=r,!t.$text||!t.$font)return t.$textWidth=0,t.$textHeight=0,e;for(var n,o=t.$lineSpacing,a=t.$letterSpacing,s=0,h=0,l=!isNaN(t.$textFieldWidth),u=t.$textFieldWidth,c=t.$textFieldHeight,p=t.$font,d=p._getFirstCharHeight(),f=Math.ceil(d*$.EMPTY_FACTOR),_=t.$text.split(/(?:\r\n|\r|\n)/),g=_.length,y=0;y<g;y++){for(var m=_[y],v=m.length,b=0,T=0,x=!0,w=!1,S=0;S<v;S++){x||(T+=a);var C=m.charAt(S),E=void 0,P=void 0,D=p.getTexture(C);if(D)E=D.$getTextureWidth(),P=D.$getTextureHeight(),D.$offsetX,D.$offsetY;else{if(" "!=C){I.$warn(1046,C),x=x&&!1;continue}E=f,P=d}if(x=x&&!1,l&&0<S&&u<T+E){if(!O(m.substring(0,S)))break;v=(m=m.substring(S)).length,T=(S=0)!=v-1&&p.getConfig(C,"xadvance")||E,b=P}else T+=S!=v-1&&p.getConfig(C,"xadvance")||E,b=Math.max(P,b)}if(c&&0<y&&c<h)break;if(w=!0,!O(m))break}function O(t){return!(c&&0<e.length&&c<h)&&(h+=b+o,x||w||(T-=a),e.push(t),r.push(b),i.push(T),s=Math.max(T,s),1)}return h-=o,t.$textWidth=s,t.$textHeight=h,this.$textOffsetX=0,this.$textOffsetY=0,this.$textStartX=0,this.$textStartY=0,s<u&&((n=t.$textAlign)==I.HorizontalAlign.RIGHT?this.$textStartX=u-s:n==I.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor((u-s)/2))),h<c&&((n=t.$verticalAlign)==I.VerticalAlign.BOTTOM?this.$textStartY=c-h:n==I.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((c-h)/2))),e},$.EMPTY_FACTOR=.33,$);function $(){var t=e.call(this)||this;return t.$smoothing=I.Bitmap.defaultSmoothing,t.$text="",t.$textFieldWidth=NaN,t.$textLinesChanged=!1,t.$textFieldHeight=NaN,t.$font=null,t.$fontStringChanged=!1,t.$lineSpacing=0,t.$letterSpacing=0,t.$textAlign=I.HorizontalAlign.LEFT,t.$verticalAlign=I.VerticalAlign.TOP,t.$textWidth=NaN,t.$textHeight=NaN,t.$textOffsetX=0,t.$textOffsetY=0,t.$textStartX=0,t.$textStartY=0,t.textLines=[],t.$lineHeights=[],I.nativeRender||(t.$renderNode=new I.sys.BitmapNode),t}I.BitmapText=t,__reflect(t.prototype,"egret.BitmapText")}(egret=egret||{}),function(t){(t=t.sys||(t.sys={})).fontResourceCache={},t.registerFontMapping=function(t,e){console.error("empty sys.registerFontMapping = "+t+", "+e)}}(egret=egret||{}),function(i){i.registerFontMapping||(i.registerFontMapping=function(t,e){i.sys.registerFontMapping(t,e)})}(egret=egret||{}),function(t){var e=(i.LEFT="left",i.RIGHT="right",i.CENTER="center",i.JUSTIFY="justify",i.CONTENT_JUSTIFY="contentJustify",i);function i(){}t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret=egret||{}),function(o){var t=(e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var i=this.replaceArr[e][0],r=this.replaceArr[e][1];t=t.replace(i,r)}return t},e.prototype.parse=function(t){this.stackArray=[],this.resutlArr=[];for(var e=0,i=t.length;e<i;)var r,n=t.indexOf("<",e),e=n<0?(this.addToResultArr(t.substring(e)),i):(this.addToResultArr(t.substring(e,n)),-1==(r=t.indexOf(">",n))?(o.$error(1038),r=n):"/"==t.charAt(n+1)?this.stackArray.pop():this.addToArray(t.substring(n+1,r)),r+1);return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),0<this.stackArray.length?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){var e,i={};if("i"==(t=t.trim()).charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(i,t,"true");else if(e=t.match(/^(font|a)\s/)){t=t.substring(e[0].length).trim();for(var r,n=0;r=t.match(this.getHeadReg());){var o=r[0],a="";'"'==(t=t.substring(o.length).trim()).charAt(0)?(n=t.indexOf('"',1),a=t.substring(1,n),n+=1):"'"==t.charAt(0)?(n=t.indexOf("'",1),a=t.substring(1,n),n+=1):n=(a=t.match(/(\S)+/)[0]).length,this.addProperty(i,o.substring(0,o.length-1).trim(),a.trim()),t=t.substring(n).trim()}}return i},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,i){switch(e.toLowerCase()){case"color":case"textcolor":i=i.replace(/#/,"0x"),t.textColor=parseInt(i);break;case"strokecolor":i=i.replace(/#/,"0x"),t.strokeColor=parseInt(i);break;case"stroke":t.stroke=parseInt(i);break;case"b":case"bold":t.bold="true"==i;break;case"u":t.underline="true"==i;break;case"i":case"italic":t.italic="true"==i;break;case"size":t.size=parseInt(i);break;case"fontfamily":t.fontFamily=i;break;case"href":t.href=this.replaceSpecial(i);break;case"target":t.target=this.replaceSpecial(i)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var i,r=this.stackArray[this.stackArray.length-1];for(i in r)null==e[i]&&(e[i]=r[i]);this.stackArray.push(e)}},e);function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}o.HtmlTextParser=t,__reflect(t.prototype,"egret.HtmlTextParser")}(egret=egret||{}),function(a){var e,t=(e=a.HashObject,__extends(i,e),i.prototype.init=function(t){this._text=t,this.stageText=new a.StageText,this.stageText.$setTextField(this._text)},i.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(a.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this._text.addEventListener(a.TouchEvent.TOUCH_MOVE,this.onMouseMoveHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},i.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(a.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this._text.addEventListener(a.TouchEvent.TOUCH_MOVE,this.onMouseMoveHandler,this),this.tempStage.removeEventListener(a.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},i.prototype._getText=function(){return this.stageText.$getText()},i.prototype._setText=function(t){this.stageText.$setText(t)},i.prototype._setColor=function(t){this.stageText.$setColor(t)},i.prototype.focusHandler=function(t){this._isFocus||(this._isFocus=!0,t.showing||this._text.$setIsTyping(!0),this._text.dispatchEvent(new a.FocusEvent(a.FocusEvent.FOCUS_IN,!0)))},i.prototype.blurHandler=function(t){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(a.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$setIsTyping(!1),this.stageText.$onBlur(),this._text.dispatchEvent(new a.FocusEvent(a.FocusEvent.FOCUS_OUT,!0)))},i.prototype.onMouseDownHandler=function(t){this.$onFocus()},i.prototype.onMouseMoveHandler=function(t){this.stageText.$hide()},i.prototype.$onFocus=function(t){var e=this;void 0===t&&(t=!1),this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(a.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),a.callLater(function(){e.tempStage.addEventListener(a.TouchEvent.TOUCH_BEGIN,e.onStageDownHandler,e)},this),a.nativeRender&&this.stageText.$setText(this._text.$TextField[13]),this.stageText.$show(t)))},i.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},i.prototype.updateTextHandler=function(t){var e,i,r=this._text.$TextField,n=this.stageText.$getText(),o=!1;null!=r[35]&&(e=new RegExp("["+r[35]+"]","g"),n=(i=n.match(e))?i.join(""):"",o=!0),null!=r[36]&&(e=new RegExp("[^"+r[36]+"]","g"),n=(i=n.match(e))?i.join(""):"",o=!0),o&&this.stageText.$getText()!=n&&this.stageText.$setText(n),this.resetText(),this._text.dispatchEvent(new a.Event(a.Event.CHANGE,!0))},i.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},i.prototype._hideInput=function(){this.stageText.$removeFromStage()},i.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},i.prototype._updateProperties=function(){if(this._isFocus)return this.stageText.$resetStageText(),void this.updateInput();this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),this.updateInput()},i);function i(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}a.InputController=t,__reflect(t.prototype,"egret.InputController")}(egret=egret||{}),function(B){var M,n="(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![0-9])(?![\u3002\uff0c\uff01\u3001\u300b\u2026\uff09)}\u201d\u3011\\.\\,\\!\\?\\]\\:])",o=[],a={Vietnamese:"?![\u1eae\u1eb0\u1eb2\u1eb4\u1eb6\u0102\u1ea4\u1ea6\u1ea8\u1eaa\u1eac\xc2\xc1\xc0\xc3\u1ea2\u1ea0\u0110\u1ebe\u1ec0\u1ec2\u1ec4\u1ec6\xca\xc9\xc8\u1eba\u1ebc\u1eb8\xcd\xcc\u1ec8\u0128\u1eca\u1ed0\u1ed2\u1ed4\u1ed6\u1ed8\xd4\u1eda\u1edc\u1ede\u1ee0\u1ee2\u01a0\xd3\xd2\xd5\u1ece\u1ecc\u1ee8\u1eea\u1eec\u1eee\u1ef0\u01af\xda\xd9\u1ee6\u0168\u1ee4\xdd\u1ef2\u1ef6\u1ef8\u1ef4A-Z]"};function i(){for(var t=n,e=0,i=o;e<i.length;e++){var r=i[e];a[r]&&(t+="("+a[r]+")")}M=new RegExp(t,"i")}function L(t,e,i){var r=null==(i=i||{}).italic?e[16]:i.italic,n=null==i.bold?e[15]:i.bold,o=null==i.size?e[0]:i.size,e=i.fontFamily||e[8]||s.default_fontFamily;return B.sys.measureText(t,e,o,n,r)}B.addLanguageWordWrapRegex=function(t,e){null!=e&&(a[t]=e),o.indexOf(t)<0&&null!=a[t]&&o.push(t),i()},B.getAllSupportLanguageWordWrap=function(){var t,e=[];for(t in a)e.push(t);return e},B.getUsingWordWrap=function(){return o},B.cancelLanguageWordWrapRegex=function(t){-1<(t=o.indexOf(t))&&o.splice(t,1),i()},i();var r,s=(r=B.DisplayObject,__extends(v,r),v.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(7)},v.prototype.isInput=function(){return this.$TextField[24]==B.TextFieldType.INPUT},v.prototype.$setTouchEnabled=function(t){r.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(v.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),v.prototype.$setFontFamily=function(t){var e=this.$TextField;return e[8]!=t&&(e[8]=t,this.invalidateFontString(),B.nativeRender&&this.$nativeDisplayObject.setFontFamily(t),!0)},Object.defineProperty(v.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),v.prototype.$setSize=function(t){var e=this.$TextField;return e[0]!=t&&(e[0]=t,this.invalidateFontString(),B.nativeRender&&this.$nativeDisplayObject.setFontSize(t),!0)},Object.defineProperty(v.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),v.prototype.$setBold=function(t){var e=this.$TextField;return t!=e[15]&&(e[15]=t,this.invalidateFontString(),B.nativeRender&&this.$nativeDisplayObject.setBold(t),!0)},Object.defineProperty(v.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),v.prototype.$setItalic=function(t){var e=this.$TextField;return t!=e[16]&&(e[16]=t,this.invalidateFontString(),B.nativeRender&&this.$nativeDisplayObject.setItalic(t),!0)},v.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(v.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),v.prototype.$setTextAlign=function(t){var e=this.$TextField;return e[9]!=t&&(e[9]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setTextAlign(t),!0)},Object.defineProperty(v.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),v.prototype.$setVerticalAlign=function(t){var e=this.$TextField;return e[10]!=t&&(e[10]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setVerticalAlign(t),!0)},Object.defineProperty(v.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),v.prototype.$setLineSpacing=function(t){var e=this.$TextField;return e[1]!=t&&(e[1]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setLineSpacing(t),!0)},Object.defineProperty(v.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),v.prototype.$setTextColor=function(t){var e=this.$TextField;return e[2]!=t&&(e[2]=t,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setTextColor(t),!0)},Object.defineProperty(v.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),v.prototype.$setWordWrap=function(t){var e=this.$TextField;t!=e[19]&&(e[20]||(e[19]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setWordWrap(t)))},Object.defineProperty(v.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),v.prototype.$setType=function(t){var e=this.$TextField;return e[24]!=t&&(e[24]=t,B.nativeRender&&this.$nativeDisplayObject.setType(t),t==B.TextFieldType.INPUT?(isNaN(e[3])&&this.$setWidth(100),isNaN(e[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new B.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0)},Object.defineProperty(v.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(t){this.$TextField[37]!=t&&(this.$TextField[37]=t,B.nativeRender&&this.$nativeDisplayObject.setInputType(t))},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),v.prototype.$getText=function(){return this.$TextField[24]==B.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},v.prototype.$setBaseText=function(t){t=null==t?"":t.toString(),this.isFlow=!1;var e=this.$TextField;if(e[13]==t)return!1;this.$invalidateTextField(),e[13]=t;var i="",i=e[20]?this.changeToPassText(t):t;return B.nativeRender&&this.$nativeDisplayObject.setText(i),this.setMiddleStyle([{text:i}]),!0},v.prototype.$setText=function(t){t=this.$setBaseText(t=null==t?"":t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),t},Object.defineProperty(v.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),v.prototype.$setDisplayAsPassword=function(t){var e=this.$TextField;if(e[20]==t)return!1;e[20]=t,this.$invalidateTextField();var i="",i=t?this.changeToPassText(e[13]):e[13];return B.nativeRender&&this.$nativeDisplayObject.setText(i),this.setMiddleStyle([{text:i}]),!0},Object.defineProperty(v.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),v.prototype.$setStrokeColor=function(t){var e=this.$TextField;return e[25]!=t&&(this.$invalidateTextField(),e[25]=t,B.nativeRender&&this.$nativeDisplayObject.setStrokeColor(t),e[26]=B.toColorString(t),!0)},Object.defineProperty(v.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),v.prototype.$setStroke=function(t){return this.$TextField[27]!=t&&(this.$invalidateTextField(),this.$TextField[27]=t,B.nativeRender&&this.$nativeDisplayObject.setStroke(t),!0)},Object.defineProperty(v.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),v.prototype.$setMaxChars=function(t){return this.$TextField[21]!=t&&(this.$TextField[21]=t,B.nativeRender&&this.$nativeDisplayObject.setMaxChars(t),!0)},Object.defineProperty(v.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(t){(t=Math.max(t,1))!=this.$TextField[28]&&(this.$TextField[28]=t,B.nativeRender&&this.$nativeDisplayObject.setScrollV(t),this.$invalidateTextField())},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-B.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),v.prototype.$setSelection=function(t,e){return!1},v.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(v.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),v.prototype.$setMultiline=function(t){return this.$TextField[30]!=t&&(this.$TextField[30]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setMultiline(t),!0)},Object.defineProperty(v.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var i=-1;i<t.length&&0!=(i=t.indexOf("^",i))&&0<i&&"\\"==t.charAt(i-1);)i++;0==i?(e[35]=null,e[36]=t.substring(i+1)):0<i?(e[35]=t.substring(0,i),e[36]=t.substring(i+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),v.prototype.$setWidth=function(t){B.nativeRender&&this.$nativeDisplayObject.setTextFieldWidth(t);var e=this.$TextField;if(isNaN(t)){if(isNaN(e[3]))return!1;e[3]=NaN}else{if(e[3]==t)return!1;e[3]=t}return!((t=+t)<0)&&(this.$invalidateTextField(),!0)},v.prototype.$setHeight=function(t){B.nativeRender&&this.$nativeDisplayObject.setTextFieldHeight(t);var e=this.$TextField;if(isNaN(t)){if(isNaN(e[4]))return!1;e[4]=NaN}else{if(e[4]==t)return!1;e[4]=t}return!((t=+t)<0)&&(this.$invalidateTextField(),!0)},v.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},v.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(v.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),v.prototype.$setBorder=function(t){this.$TextField[31]!=(t=!!t)&&(this.$TextField[31]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setBorder(t))},Object.defineProperty(v.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),v.prototype.$setBorderColor=function(t){this.$TextField[32]!=(t=+t||0)&&(this.$TextField[32]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setBorderColor(t))},Object.defineProperty(v.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),v.prototype.$setBackground=function(t){this.$TextField[33]!=t&&(this.$TextField[33]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setBackground(t))},Object.defineProperty(v.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),v.prototype.$setBackgroundColor=function(t){this.$TextField[34]!=t&&(this.$TextField[34]=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setBackgroundColor(t))},v.prototype.fillBackground=function(t){var e=this.$graphicsNode;e&&e.clear();var i,r=this.$TextField;if(r[33]||r[31]||t&&0<t.length){e||(e=this.$graphicsNode=new B.sys.GraphicsNode,B.nativeRender?this.$renderNode=this.textNode:((i=new B.sys.GroupNode).addNode(e),i.addNode(this.textNode),this.$renderNode=i));var n=void 0;if(r[33]&&e.beginFill(r[34]).drawRect(0,0,this.$getWidth(),this.$getHeight()),r[31]&&(n=e.lineStyle(1,r[32])).drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1),t&&0<t.length)for(var o=r[2],a=-1,s=t.length,h=0;h<s;h+=4){var l=t[h],u=t[h+1],c=t[h+2],p="number"==typeof t[h+3]?t[h+3]:o;(n=a<0||a!=p?e.lineStyle(2,a=p,1,B.CapsStyle.NONE):n).moveTo(l,u),n.lineTo(l+c,u)}}e&&(r=this.$getRenderBounds(),e.x=r.x,e.y=r.y,e.width=r.width,e.height=r.height,B.Rectangle.release(r))},v.prototype.setFocus=function(){this.type==B.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus(!0)},v.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==B.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&(this.textNode.clean(),B.nativeRender&&egret_native.NativeDisplayObject.disposeTextData(this))},v.prototype.$onAddToStage=function(t,e){r.prototype.$onAddToStage.call(this,t,e),this.addEvent(),this.$TextField[24]==B.TextFieldType.INPUT&&this.inputUtils._addStageText()},v.prototype.$invalidateTextField=function(){var t,e=this;e.$renderDirty=!0,e.$TextField[18]=!0,e.$TextField[38]=!0,B.nativeRender||((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp()))},v.prototype.$getRenderBounds=function(){var t=this.$getContentBounds(),e=B.Rectangle.create();e.copyFrom(t),this.$TextField[31]&&(e.width+=2,e.height+=2);t=2*this.$TextField[27];return 0<t&&(e.width+=2*t,e.height+=2*t),e.x-=2+t,e.y-=2+t,e.width=Math.ceil(e.width)+4,e.height=Math.ceil(e.height)+4,e},v.prototype.$measureContentBounds=function(t){this.$getLinesArr();var e=0,i=0,i=B.nativeRender?(e=egret_native.nrGetTextFieldWidth(this.$nativeDisplayObject.id),egret_native.nrGetTextFieldHeight(this.$nativeDisplayObject.id)):(e=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],isNaN(this.$TextField[4])?B.TextFieldUtils.$getTextHeight(this):this.$TextField[4]);t.setTo(0,0,e,i)},v.prototype.$updateRenderNode=function(){if(this.$TextField[24]==B.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var t=this.$graphicsNode;return void(t&&t.clear())}var e=this.drawText();this.fillBackground(e);t=this.$getRenderBounds(),e=this.textNode;e.x=t.x,e.y=t.y,e.width=Math.ceil(t.width),e.height=Math.ceil(t.height),B.Rectangle.release(t)},Object.defineProperty(v.prototype,"textFlow",{get:function(){return this.textArr},set:function(t){this.isFlow=!0;var e="";null==t&&(t=[]);for(var i=0;i<t.length;i++)e+=t[i].text;this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.setMiddleStyle(t),B.nativeRender&&this.$nativeDisplayObject.setTextFlow(t))},enumerable:!0,configurable:!0}),v.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",i=0,r=t.length;i<r;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},v.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.$TextField[38]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(v.prototype,"textWidth",{get:function(){return this.$getLinesArr(),B.nativeRender?egret_native.nrGetTextWidth(this.$nativeDisplayObject.id):this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"textHeight",{get:function(){return this.$getLinesArr(),B.nativeRender?egret_native.nrGetTextHeight(this.$nativeDisplayObject.id):B.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),v.prototype.appendText=function(t){this.appendElement({text:t})},v.prototype.appendElement=function(t){var e=this.$TextField[13]+t.text;if(B.nativeRender)return this.textArr.push(t),this.$TextField[13]=e,this.$TextField[18]=!0,this.$TextField[38]=!0,void this.$nativeDisplayObject.setTextFlow(this.textArr);this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.textArr.push(t),this.setMiddleStyle(this.textArr))},v.prototype.$getLinesArr=function(){var t=this.$TextField;if(!B.nativeRender||!t[38])return this.$getLinesArr2();egret_native.updateNativeRender(),t[38]=!1},v.prototype.$getLinesArr2=function(){var t=this.$TextField;if(!t[18])return this.linesArr;t[18]=!1;var e=this.textArr;this.linesArr.length=0,t[6]=0,t[5]=0;var i=t[3];if(!isNaN(i)&&0==i)return[{width:t[29]=0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var r,n=this.linesArr,o=0,a=0,s=0,h=0,l=0,u=e.length;l<u;l++){var c=e[l];if(c.text){c.style=c.style||{};for(var p=c.text.toString().split(/(?:\r\n|\r|\n)/),d=0,f=p.length;d<f;d++){null==n[h]&&(n[h]=r={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},a=s=o=0);var s=t[24]==B.TextFieldType.INPUT?t[0]:Math.max(s,"number"==typeof c.style.size?c.style.size:t[0]),_=!0;if(""==p[d])d==f-1&&(_=!1);else{var g=L(p[d],t,c.style);if(isNaN(i))o+=g,a+=p[d].length,r.elements.push({width:g,text:p[d],style:c.style}),d==f-1&&(_=!1);else if(o+g<=i)r.elements.push({width:g,text:p[d],style:c.style}),o+=g,a+=p[d].length,d==f-1&&(_=!1);else{for(var y=0,m=0,v=p[d],b=void 0,T=(b=t[19]?v.split(M):v.match(/./g)).length,x=0;y<T;y++){var w=!1;if(g=1==(P=b[y].length)&&y<T-1?(D=b[y].charCodeAt(0),O=b[y+1].charCodeAt(0),55296<=D&&D<=56319&&56320==(64512&O)?(P=2,w=!0,L(b[y]+b[y+1],t,c.style)):L(b[y],t,c.style)):L(b[y],t,c.style),0!=o&&i<o+g&&o+y!=0)break;if(i<m+g)for(var S=b[y].match(/./g),C=0,E=S.length;C<E;C++){var P,D,O,I=!1;if(g=1==(P=S[C].length)&&C<E-1?(D=S[C].charCodeAt(0),O=S[C+1].charCodeAt(0),55296<=D&&D<=56319&&56320==(64512&O)?(P=2,I=!0,L(S[C]+S[C+1],t,c.style)):L(S[C],t,c.style)):L(S[C],t,c.style),0<C&&i<o+g)break;m+=g,o+=g,a+=x+=P,I&&C++}else m+=g,o+=g,a+=x+=P;w&&y++}if(0<y){r.elements.push({width:m,text:v.substring(0,x),style:c.style});for(var $=v.substring(x),A=void 0,R=$.length,A=0;A<R&&" "==$.charAt(A);A++);p[d]=$.substring(A)}""!=p[d]&&(d--,_=!1)}}_&&(a++,r.hasNextLine=!0),d<p.length-1&&(r.width=o,r.height=s,r.charNum=a,t[5]=Math.max(t[5],o),t[6]+=s,h++)}l==e.length-1&&r&&(r.width=o,r.height=s,r.charNum=a,t[5]=Math.max(t[5],o),t[6]+=s)}else r&&(r.width=o,r.height=s,r.charNum=a,t[5]=Math.max(t[5],o),t[6]+=s)}return t[29]=n.length,n},v.prototype.$setIsTyping=function(t){this.$isTyping=t,this.$invalidateTextField(),B.nativeRender&&this.$nativeDisplayObject.setIsTyping(t)},v.prototype.drawText=function(){var t=this.textNode,e=this.$TextField;t.bold=e[15],t.fontFamily=e[8]||v.default_fontFamily,t.italic=e[16],t.size=e[0],t.stroke=e[27],t.strokeColor=e[25],t.textColor=e[2];var i=this.$getLinesArr();if(0==e[5])return[];var r=isNaN(e[3])?e[5]:e[3],n=B.TextFieldUtils.$getTextHeight(this),o=0,a=B.TextFieldUtils.$getStartLine(this),s=e[4];!isNaN(s)&&n<s&&(o+=B.TextFieldUtils.$getValign(this)*(s-n));for(var o=Math.round(o),h=B.TextFieldUtils.$getHalign(this),l=0,u=[],c=a,p=e[29];c<p;c++){var d=i[c],f=d.height;if(o+=f/2,c!=a){if(e[24]==B.TextFieldType.INPUT&&!e[30])break;if(!isNaN(s)&&s<o)break}for(var l=Math.round((r-d.width)*h),_=0,g=d.elements.length;_<g;_++){var y=d.elements[_],m="number"==typeof y.style.size?y.style.size:e[0];t.drawText(l,o+(f-m)/2,y.text,y.style),y.style.underline&&u.push(l,o+f/2,y.width,y.style.textColor),l+=y.width}o+=f/2+e[1]}return u},v.prototype.addEvent=function(){this.addEventListener(B.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},v.prototype.removeEvent=function(){this.removeEventListener(B.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},v.prototype.onTapHandler=function(t){var e;this.$TextField[24]!=B.TextFieldType.INPUT&&(null==(e=B.TextFieldUtils.$getTextElement(this,t.localX,t.localY))||(t=e.style)&&t.href&&(t.href.match(/^event:/)?(e=t.href.match(/^event:/)[0],B.TextEvent.dispatchTextEvent(this,B.TextEvent.LINK,t.href.substring(e.length))):open(t.href,t.target||"_blank")))},v.default_fontFamily="Arial",v.default_size=30,v.default_textColor=16777215,v);function v(){var t=r.call(this)||this;t.$inputEnabled=!1,t.inputUtils=null,t.$graphicsNode=null,t.isFlow=!1,t.textArr=[],t.linesArr=[],t.$isTyping=!1;var e=new B.sys.TextNode;return e.fontFamily=v.default_fontFamily,t.textNode=e,t.$renderNode=e,t.$TextField={0:v.default_size,1:0,2:v.default_textColor,3:NaN,4:NaN,5:0,6:0,7:0,8:v.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:B.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:B.TextFieldInputType.TEXT,38:!1},B.nativeRender&&(t.$nativeDisplayObject.setFontFamily(v.default_fontFamily),t.$nativeDisplayObject.setFontSize(v.default_size)),t}B.TextField=s,__reflect(s.prototype,"egret.TextField")}(egret=(egret=egret||{})||{}),function(t){var e=(i.TEXT="text",i.TEL="tel",i.PASSWORD="password",i);function i(){}t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret=egret||{}),function(t){var e=(i.DYNAMIC="dynamic",i.INPUT="input",i);function i(){}t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret=egret||{}),function(r){var t=(f.$getStartLine=function(t){var e=t.$TextField,i=f.$getTextHeight(t),r=0,t=e[4];return isNaN(t)||(i<t||t<i&&(r=Math.max(e[28]-1,0),r=Math.min(e[29]-1,r)),e[30]||(r=Math.max(e[28]-1,0),0<e[29]&&(r=Math.min(e[29]-1,r)))),r},f.$getHalign=function(t){var e=t.$getLinesArr2(),i=0;return t.$TextField[9]==r.HorizontalAlign.CENTER?i=.5:t.$TextField[9]==r.HorizontalAlign.RIGHT&&(i=1),i=t.$TextField[24]==r.TextFieldType.INPUT&&!t.$TextField[30]&&1<e.length?0:i},f.$getTextHeight=function(t){return r.TextFieldType.INPUT!=t.$TextField[24]||t.$TextField[30]?t.$TextField[6]+(t.$TextField[29]-1)*t.$TextField[1]:t.$TextField[0]},f.$getValign=function(t){var e=f.$getTextHeight(t),i=t.$TextField[4];if(!isNaN(i)&&e<i){i=0;return t.$TextField[10]==r.VerticalAlign.MIDDLE?i=.5:t.$TextField[10]==r.VerticalAlign.BOTTOM&&(i=1),i}return 0},f.$getTextElement=function(t,e,i){i=f.$getHit(t,e,i),t=t.$getLinesArr2();return i&&t[i.lineIndex]&&t[i.lineIndex].elements[i.textElementIndex]?t[i.lineIndex].elements[i.textElementIndex]:null},f.$getHit=function(t,e,i){var r=t.$getLinesArr2();if(0==t.$TextField[3])return null;var n=0,o=f.$getTextHeight(t),a=0,s=t.$TextField[4];!isNaN(s)&&o<s&&0!=(a=f.$getValign(t)*(s-o))&&(i-=a);for(var h=0,l=f.$getStartLine(t);l<r.length;l++){var u=r[l];if(h+u.height>=i){h<i&&(n=l+1);break}if((h+=u.height)+t.$TextField[1]>i)return null;h+=t.$TextField[1]}if(0==n)return null;var c=r[n-1],a=t.$TextField[3];isNaN(a)&&(a=t.textWidth),e-=f.$getHalign(t)*(a-c.width);for(var p=0,l=0;l<c.elements.length;l++){var d=c.elements[l];if(p+d.width<=e)p+=d.width;else if(p<e)return{lineIndex:n-1,textElementIndex:l}}return null},f.$getScrollNum=function(t){var e,i,r=1;return t.$TextField[30]&&(e=t.height,(i=t.size)/2<e-(i+(t=t.lineSpacing))*(r=Math.floor(e/(i+t)))&&r++),r},f);function f(){}r.TextFieldUtils=t,__reflect(t.prototype,"egret.TextFieldUtils")}(egret=egret||{}),function(t){t.sys||(t.sys={})}(egret=egret||{}),function(t){var e=(i.TOP="top",i.BOTTOM="bottom",i.MIDDLE="middle",i.JUSTIFY="justify",i.CONTENT_JUSTIFY="contentJustify",i);function i(){}t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret=egret||{}),function(t){var e=(i.encode=function(t){for(var e=new Uint8Array(t),i=e.length,r="",n=0;n<i;n+=3)r+=chars[e[n]>>2],r+=chars[(3&e[n])<<4|e[n+1]>>4],r+=chars[(15&e[n+1])<<2|e[n+2]>>6],r+=chars[63&e[n+2]];return i%3==2?r=r.substring(0,r.length-1)+"=":i%3==1&&(r=r.substring(0,r.length-2)+"=="),r},i.decode=function(t){var e,i,r,n,o=.75*t.length,a=t.length,s=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);for(var o=new ArrayBuffer(o),h=new Uint8Array(o),l=0;l<a;l+=4)e=lookup[t.charCodeAt(l)],i=lookup[t.charCodeAt(l+1)],r=lookup[t.charCodeAt(l+2)],n=lookup[t.charCodeAt(l+3)],h[s++]=e<<2|i>>4,h[s++]=(15&i)<<4|r>>2,h[s++]=(3&r)<<6|63&n;return o},i);function i(){}t.Base64Util=e,__reflect(e.prototype,"egret.Base64Util")}(egret=egret||{});for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;!function(o){var a=(t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t);function t(){}o.Endian=a,__reflect(a.prototype,"egret.Endian");var e=(Object.defineProperty(i.prototype,"endian",{get:function(){return 0==this.$endian?a.LITTLE_ENDIAN:a.BIG_ENDIAN},set:function(t){this.$endian=t==a.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),i.prototype.setArrayBuffer=function(t){},Object.defineProperty(i.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e=t.byteLength,i=new Uint8Array(t),t=this.bufferExtSize;(t=0==t?new Uint8Array(e):new Uint8Array((1+(e/t|0))*t)).set(i),this.write_position=e,this._bytes=t,this.data=new DataView(t.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(t){(this._position=t)>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),i.prototype._validateBuffer=function(t){var e,i;this.data.byteLength<t&&(i=void 0,(i=0==(e=this.bufferExtSize)?new Uint8Array(t):new Uint8Array((1+(t/e>>0))*e)).set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer))},Object.defineProperty(i.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),i.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},i.prototype.readBoolean=function(){if(this.validate(1))return!!this._bytes[this.position++]},i.prototype.readByte=function(){if(this.validate(1))return this.data.getInt8(this.position++)},i.prototype.readBytes=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),t){var r=this._position,n=this.write_position-r;if(n<0)o.$error(1025);else{if(0==i)i=n;else if(n<i)return void o.$error(1025);n=t._position;t._position=0,t.validateBuffer(e+i),t._position=n,t._bytes.set(this._bytes.subarray(r,r+i),e),this.position+=i}}},i.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},i.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUnsignedByte=function(){if(this.validate(1))return this._bytes[this.position++]},i.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUTF=function(){var t=this.readUnsignedShort();return 0<t?this.readUTFBytes(t):""},i.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,e=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(e)}},i.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},i.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},i.prototype.writeBytes=function(t,e,i){void 0===i&&(i=0),(e=void 0===e?0:e)<0||i<0||0<(i=0==i?t.length-e:Math.min(t.length-e,i))&&(this.validateBuffer(i),this._bytes.set(t._bytes.subarray(e,e+i),this._position),this.position=this._position+i)},i.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},i.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),t=e.length;this.validateBuffer(2+t),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},i.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},i.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},i.prototype._writeUint8Array=function(t,e){var i=this._position,r=i+t.length;(e=void 0===e?!0:e)&&this.validateBuffer(r),this.bytes.set(t,i),this.position=r},i.prototype.validate=function(t){var e=this._bytes.length;if(0<e&&this._position+t<=e)return!0;o.$error(1025)},i.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},i.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var n=i[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))r.push(n);else{var o=void 0,a=void 0;for(this.inRange(n,128,2047)?(o=1,a=192):this.inRange(n,2048,65535)?(o=2,a=224):this.inRange(n,65536,1114111)&&(o=3,a=240),r.push(this.div(n,Math.pow(64,o))+a);0<o;){var s=this.div(n,Math.pow(64,o-1));r.push(128+s%64),--o}}}return new Uint8Array(r)},i.prototype.decodeUTF8=function(t){for(var e=0,i="",r=0,n=0,o=0,a=0;t.length>e;){var s,h,l=t[e++];null!==(l=l==this.EOF_byte?0!=n?this.decoderError(!1):this.EOF_code_point:0==n?this.inRange(l,0,127)?l:(this.inRange(l,194,223)?(n=1,a=128,r=l-192):this.inRange(l,224,239)?(n=2,a=2048,r=l-224):this.inRange(l,240,244)?(n=3,a=65536,r=l-240):this.decoderError(!1),r*=Math.pow(64,n),null):this.inRange(l,128,191)?(o+=1,r+=(l-128)*Math.pow(64,n-o),o!==n?null:(s=r,h=a,a=o=n=r=0,this.inRange(s,h,1114111)&&!this.inRange(s,55296,57343)?s:this.decoderError(!1,l))):(a=o=n=r=0,e--,this.decoderError(!1,l)))&&l!==this.EOF_code_point&&(l<=65535?0<l&&(i+=String.fromCharCode(l)):(l-=65536,i+=String.fromCharCode(55296+(l>>10&1023)),i+=String.fromCharCode(56320+(1023&l))))}return i},i.prototype.encoderError=function(t){o.$error(1026,t)},i.prototype.decoderError=function(t,e){return t&&o.$error(1027),e||65533},i.prototype.inRange=function(t,e,i){return e<=t&&t<=i},i.prototype.div=function(t,e){return Math.floor(t/e)},i.prototype.stringToCodePoints=function(t){for(var e=[],i=0,r=t.length;i<t.length;){var n,o=t.charCodeAt(i);this.inRange(o,55296,57343)?this.inRange(o,56320,57343)||i==r-1?e.push(65533):(n=t.charCodeAt(i+1),this.inRange(n,56320,57343)?(i+=1,e.push(65536+((1023&o)<<10)+(1023&n))):e.push(65533)):e.push(o),i+=1}return e},i);function i(t,e){void 0===e&&(e=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,this.bufferExtSize=e=e<0?0:e;var i,r,n=0;t?(i=void 0,t instanceof Uint8Array?n=(i=t).length:(n=t.byteLength,i=new Uint8Array(t)),(r=0==e?new Uint8Array(n):new Uint8Array((1+(n/e|0))*e)).set(i)):r=new Uint8Array(e),this.write_position=n,this._position=0,this._bytes=r,this.data=new DataView(r.buffer),this.endian=a.BIG_ENDIAN}o.ByteArray=e,__reflect(e.prototype,"egret.ByteArray")}(egret=egret||{}),function(e){var r,t=(r=e.DisplayObject,__extends(i,r),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(8)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$hitTest=function(t,e){var i=r.prototype.$hitTest.call(this,t,e);return i=i==this?this.$graphics.$hitTest(t,e):i},i.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i);function i(){var t=r.call(this)||this;return t.$graphics=new e.Graphics,t.$graphics.$setTarget(t),t}e.Shape=t,__reflect(t.prototype,"egret.Shape")}(egret=egret||{}),function(h){h.registerClass=function(t,e,i){t||h.$error(1003,"classDefinition"),t.prototype||h.$error(1012,"classDefinition"),void 0===e&&h.$error(1003,"className"),t=t.prototype,Object.defineProperty(t,"__class__",{value:e,enumerable:!1,writable:!0});var r=[e];i&&(r=r.concat(i));var n=t.__types__;if(t.__types__)for(var o=n.length,a=0;a<o;a++){var s=n[a];-1==r.indexOf(s)&&r.push(s)}Object.defineProperty(t,"__types__",{value:r,enumerable:!1,writable:!0})}}(egret=egret||{}),function(u){var e,t=(e=u.DisplayObjectContainer,__extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(9)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,e){if(!this.$visible)return null;var i=this.$getInvertedConcatenatedMatrix(),r=i.a*t+i.c*e+i.tx,n=i.b*t+i.d*e+i.ty,i=this.$scrollRect||this.$maskRect;if(i&&!i.contains(r,n))return null;if(this.$mask&&!this.$mask.$hitTest(t,e))return null;for(var o=this.$children,a=!1,s=null,h=o.length-1;0<=h;h--){var l=o[h];if(!l.$maskedObject&&(s=l.$hitTest(t,e))){if(a=!0,s.$touchEnabled)break;s=null}}return s?this.$touchChildren?s:this:a?this:s=(s=u.DisplayObject.prototype.$hitTest.call(this,t,e))&&this.$graphics.$hitTest(t,e)},i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i);function i(){var t=e.call(this)||this;return t.$graphics=new u.Graphics,t.$graphics.$setTarget(t),t}u.Sprite=t,__reflect(t.prototype,"egret.Sprite")}(egret=egret||{}),function(t){var e=(Object.defineProperty(i,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),i.ALL="all",i.DEBUG="debug",i.INFO="info",i.WARN="warn",i.ERROR="error",i.OFF="off",i);function i(){}t.Logger=e,__reflect(e.prototype,"egret.Logger")}(egret=egret||{}),function(t){var e=(n.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},n.sin=function(t){var e=Math.floor(t),i=e+1,r=n.sinInt(e);return e==t?r:(t-e)*n.sinInt(i)+(i-t)*r},n.sinInt=function(t){return(t%=360)<0&&(t+=360),egret_sin_map[t]},n.cos=function(t){var e=Math.floor(t),i=e+1,r=n.cosInt(e);return e==t?r:(t-e)*n.cosInt(i)+(i-t)*r},n.cosInt=function(t){return(t%=360)<0&&(t+=360),egret_cos_map[t]},n.convertStringToHashCode=function(t){if(0===t.length)return 0;for(var e=0,i=0,r=t.length;i<r;++i){e=(e<<5)-e+t.charCodeAt(i);e|=0}return e},n);function n(){}t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret=egret||{});for(var language,egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;NumberUtils_i<360;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);function e(){return r.apply(this instanceof n&&t?this:t,i.concat(Array.prototype.slice.call(arguments)))}var i=Array.prototype.slice.call(arguments,1),r=this,n=function(){};return n.prototype=this.prototype,e.prototype=new n,e}),function(e){var r,t=(r=e.EventDispatcher,__extends(i,r),Object.defineProperty(i.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay!=(t=t<1?1:t)&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this.stop(),this._currentCount=0},i.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=e.getTimer(),e.ticker.$startTick(this.$update,this),this._running=!0)},i.prototype.stop=function(){this._running&&(e.stopTick(this.$update,this),this._running=!1)},i.prototype.$update=function(t){if(t-this.lastTimeStamp>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,0<this.lastCount)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=t,this._currentCount++;t=0<this.repeatCount&&this._currentCount>=this.repeatCount;return(0==this.repeatCount||this._currentCount<=this.repeatCount)&&e.TimerEvent.dispatchTimerEvent(this,e.TimerEvent.TIMER),t&&(this.stop(),e.TimerEvent.dispatchTimerEvent(this,e.TimerEvent.TIMER_COMPLETE)),!1},i);function i(t,e){void 0===e&&(e=0);var i=r.call(this)||this;return i._delay=0,i._currentCount=0,i._running=!1,i.updateInterval=1e3,i.lastCount=1e3,i.lastTimeStamp=0,i.delay=t,i.repeatCount=0|+e,i}e.Timer=t,__reflect(t.prototype,"egret.Timer")}(egret=egret||{}),function(n){n.$callLaterFunctionList=[],n.$callLaterThisList=[],n.$callLaterArgsList=[],n.callLater=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];n.$callLaterFunctionList.push(t),n.$callLaterThisList.push(e),n.$callLaterArgsList.push(i)},n.$callAsyncFunctionList=[],n.$callAsyncThisList=[],n.$callAsyncArgsList=[],n.$callAsync=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];n.$callAsyncFunctionList.push(t),n.$callAsyncThisList.push(e),n.$callAsyncArgsList.push(i)}}(egret=(egret=egret||{})||{}),function(t){t.superSetter=function(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var o=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}});var a,s=(a=t.__sets__)[i];if(s)return s.apply(e,r);var h=Object.getPrototypeOf(o);if(null!=h){for(;!h.hasOwnProperty(i);)if(null==(h=Object.getPrototypeOf(h)))return;s=Object.getOwnPropertyDescriptor(h,i).set,(a[i]=s).apply(e,r)}},t.superGetter=function(t,e,i){var r,n=t.prototype;if(t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),t=(r=t.__gets__)[i])return t.call(e);var o=Object.getPrototypeOf(n);if(null!=o){for(;!o.hasOwnProperty(i);)if(null==(o=Object.getPrototypeOf(o)))return;return t=Object.getOwnPropertyDescriptor(o,i).get,(r[i]=t).call(e)}}}(egret=egret||{}),function(t){var o={};t.getDefinitionByName=function(t){if(!t)return null;var e=o[t];if(e)return e;var i=t.split("."),r=i.length;e=global;for(var n=0;n<r;n++)if(!(e=e[i[n]]))return null;return o[t]=e},t.cleanCache=function(){o={}}}(egret=egret||{}),((egret=egret||{})||(egret={})).getQualifiedClassName=function(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var i=t.prototype||Object.getPrototypeOf(t);return i.hasOwnProperty("__class__")?i.__class__:(e=i.constructor.toString().trim(),t=e.indexOf("("),t=e.substring(9,t),Object.defineProperty(i,"__class__",{value:t,enumerable:!1,writable:!0}),t)},function(e){e.getQualifiedSuperclassName=function(t){return!t||"object"!=typeof t&&!t.prototype?null:(t=t.prototype||Object.getPrototypeOf(t),(t=Object.getPrototypeOf(t))&&(t=e.getQualifiedClassName(t.constructor))||null)}}(egret=egret||{}),function(t){t.getTimer=function(){return Date.now()-t.sys.$START_TIME}}(egret=egret||{}),function(e){e.hasDefinition=function(t){return!!e.getDefinitionByName(t)}}(egret=egret||{}),(egret||(egret={})).is=function(t,e){return!(!t||"object"!=typeof t)&&(!!(t=(t=Object.getPrototypeOf(t))?t.__types__:null)&&-1!==t.indexOf(e))},function(i){i.startTick=function(t,e){t||i.$error(1003,"callBack"),i.ticker.$startTick(t,e)}}(egret=egret||{}),function(i){i.stopTick=function(t,e){t||i.$error(1003,"callBack"),i.ticker.$stopTick(t,e)}}(egret=egret||{}),(egret||(egret={})).toColorString=function(t){for(var e=(t=16777215<(t=t<0?0:t)?16777215:t).toString(16).toUpperCase();6<e.length;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e},window.__isqq__||(__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},function(n){var t,e,i;function r(t){var r=e.call(this)||this;return r.onUpdate=function(t){var e=new n.GeolocationEvent(n.Event.CHANGE),t=t.coords;e.altitude=t.altitude,e.heading=t.heading,e.accuracy=t.accuracy,e.latitude=t.latitude,e.longitude=t.longitude,e.speed=t.speed,e.altitudeAccuracy=t.altitudeAccuracy,r.dispatchEvent(e)},r.onError=function(t){var e=n.GeolocationEvent.UNAVAILABLE;t.code==t.PERMISSION_DENIED&&(e=n.GeolocationEvent.PERMISSION_DENIED);var i=new n.GeolocationEvent(n.IOErrorEvent.IO_ERROR);i.errorType=e,i.errorMessage=t.message,r.dispatchEvent(i)},r.geolocation=navigator.geolocation,r}t=n.web||(n.web={}),e=n.EventDispatcher,__extends(r,e),r.prototype.start=function(){var t=this.geolocation;t?this.watchId=t.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:n.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},r.prototype.stop=function(){this.geolocation.clearWatch(this.watchId)},i=r,t.WebGeolocation=i,__reflect(i.prototype,"egret.web.WebGeolocation",["egret.Geolocation"])}(egret=egret||{}),function(o){var t,e,i;function r(){var n=null!==e&&e.apply(this,arguments)||this;return n.onChange=function(t){var e=new o.MotionEvent(o.Event.CHANGE),i={x:t.acceleration.x,y:t.acceleration.y,z:t.acceleration.z},r={x:t.accelerationIncludingGravity.x,y:t.accelerationIncludingGravity.y,z:t.accelerationIncludingGravity.z},t={alpha:t.rotationRate.alpha,beta:t.rotationRate.beta,gamma:t.rotationRate.gamma};e.acceleration=i,e.accelerationIncludingGravity=r,e.rotationRate=t,n.dispatchEvent(e)},n}t=o.web||(o.web={}),e=o.EventDispatcher,__extends(r,e),r.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},r.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},i=r,t.WebMotion=i,__reflect(i.prototype,"egret.web.WebMotion",["egret.Motion"])}(egret=egret||{}),function(U){var H,t;function e(){this.vertSize=5,this.vertByteSize=4*this.vertSize,this.maxQuadsCount=2048,this.maxVertexCount=4*this.maxQuadsCount,this.maxIndicesCount=6*this.maxQuadsCount,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1,this._vertices=null,this._verticesFloat32View=null,this._verticesUint32View=null,this._vertices=new ArrayBuffer(this.maxVertexCount*this.vertByteSize),this._verticesFloat32View=new Float32Array(this._vertices),this._verticesUint32View=new Uint32Array(this._vertices),this.vertices=this._verticesFloat32View;var t=this.maxIndicesCount;this.indices=new Uint16Array(t),this.indicesForMesh=new Uint16Array(t);for(var e=0,i=0;e<t;e+=6,i+=4)this.indices[e+0]=i+0,this.indices[e+1]=i+1,this.indices[e+2]=i+2,this.indices[e+3]=i+0,this.indices[e+4]=i+2,this.indices[e+5]=i+3}H=U.web||(U.web={}),e.prototype.reachMaxSize=function(t,e){return void 0===e&&(e=6),this.vertexIndex>this.maxVertexCount-(t=void 0===t?4:t)||this.indexIndex>this.maxIndicesCount-e},e.prototype.getVertices=function(){return this.vertices.subarray(0,this.vertexIndex*this.vertSize)},e.prototype.getIndices=function(){return this.indices},e.prototype.getMeshIndices=function(){return this.indicesForMesh},e.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;t<e;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},e.prototype.isMesh=function(){return this.hasMesh},e.prototype.cacheArrays=function(t,e,i,r,n,o,a,s,h,l,u,c,p,d,f){var _=t.globalAlpha,_=Math.min(_,1),g=t.globalTintColor||16777215,y=t.currentTexture;_=_<1&&y&&y[U.UNPACK_PREMULTIPLY_ALPHA_WEBGL]?U.WebGLUtils.premultiplyTint(g,_):g+(255*_<<24);var g=t.globalMatrix,m=g.a,v=g.b,b=g.c,T=g.d,x=g.tx,w=g.ty,g=t.$offsetX,t=t.$offsetY;if(0==g&&0==t||(x=g*m+t*b+x,w=g*v+t*T+w),p||(0==o&&0==a||(x=o*m+a*b+x,w=o*v+a*T+w),1!=(N=s/r)&&(m*=N,v*=N),1!=(G=h/n)&&(b*=G,T*=G)),p)if(H.isIOS14Device()){var S=[],C=this.vertices,E=this._verticesUint32View,P=this.vertexIndex*this.vertSize,D=0,O=0,I=0,$=0,A=0,R=0,B=0;for(D=0,I=c.length;D<I;D+=2)O=P+5*D/2,R=p[D],B=p[D+1],$=c[D],A=c[D+1],f?S.push([m*R+b*B+x,v*R+T*B+w,(e+(1-A)*n)/l,(i+$*r)/u]):S.push([m*R+b*B+x,v*R+T*B+w,(e+$*r)/l,(i+A*n)/u]),E[O+4]=_;for(var M=0;M<d.length;M+=3){var L=S[d[M]];C[P++]=L[0],C[P++]=L[1],C[P++]=L[2],C[P++]=L[3],E[P++]=_;L=S[d[M+1]];C[P++]=L[0],C[P++]=L[1],C[P++]=L[2],C[P++]=L[3],E[P++]=_;L=S[d[M+2]];C[P++]=L[0],C[P++]=L[1],C[P++]=L[2],C[P++]=L[3],E[P++]=_,C[P++]=L[0],C[P++]=L[1],C[P++]=L[2],C[P++]=L[3],E[P++]=_}var F=d.length/3;this.vertexIndex+=4*F,this.indexIndex+=6*F}else{C=this.vertices,E=this._verticesUint32View,P=this.vertexIndex*this.vertSize,D=0,O=0,I=0,$=0,A=0,R=0,B=0;for(D=0,I=c.length;D<I;D+=2)R=p[D],B=p[D+1],$=c[D],A=c[D+1],C[(O=P+5*D/2)+0]=m*R+b*B+x,C[O+1]=v*R+T*B+w,f?(C[O+2]=(e+(1-A)*n)/l,C[O+3]=(i+$*r)/u):(C[O+2]=(e+$*r)/l,C[O+3]=(i+A*n)/u),E[O+4]=_;if(this.hasMesh)for(var k=0,j=d.length;k<j;++k)this.indicesForMesh[this.indexIndex+k]=d[k]+this.vertexIndex;this.vertexIndex+=c.length/2,this.indexIndex+=d.length}else{var s=l,N=u,h=r,G=n;e/=s,i/=N;C=this.vertices,E=this._verticesUint32View,P=this.vertexIndex*this.vertSize;f?(F=r,r=n/s,n=F/N,C[P++]=x,C[P++]=w,C[P++]=r+e,C[P++]=i,E[P++]=_,C[P++]=m*h+x,C[P++]=v*h+w,C[P++]=r+e,C[P++]=n+i,E[P++]=_,C[P++]=m*h+b*G+x,C[P++]=T*G+v*h+w,C[P++]=e,C[P++]=n+i,E[P++]=_,C[P++]=b*G+x,C[P++]=T*G+w,C[P++]=e,C[P++]=i):(r/=s,n/=N,C[P++]=x,C[P++]=w,C[P++]=e,C[P++]=i,E[P++]=_,C[P++]=m*h+x,C[P++]=v*h+w,C[P++]=r+e,C[P++]=i,E[P++]=_,C[P++]=m*h+b*G+x,C[P++]=T*G+v*h+w,C[P++]=r+e,C[P++]=n+i,E[P++]=_,C[P++]=b*G+x,C[P++]=T*G+w,C[P++]=e,C[P++]=n+i),E[P++]=_,this.hasMesh&&((G=this.indicesForMesh)[this.indexIndex+0]=0+this.vertexIndex,G[this.indexIndex+1]=1+this.vertexIndex,G[this.indexIndex+2]=2+this.vertexIndex,G[this.indexIndex+3]=0+this.vertexIndex,G[this.indexIndex+4]=2+this.vertexIndex,G[this.indexIndex+5]=3+this.vertexIndex),this.vertexIndex+=4,this.indexIndex+=6}},e.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},t=e,H.WebGLVertexArrayObject=t,__reflect(t.prototype,"egret.web.WebGLVertexArrayObject"),H.isIOS14Device=function(){return!1}}(egret=egret||{}),function(t){function e(t){if(window.location){var e=location.search;if(""==e)return"";for(var i=(e=e.slice(1)).split("&"),r=i.length,n=0;n<r;n++){var o=i[n].split("=");if(o[0]==t)return o[1]}}return""}(t.web||(t.web={})).getOption=e,t.getOption=e}(egret=egret||{}),function(a){!function(r){var o=(i.decodeAudios=function(){var e;i.decodeArr.length<=0||i.isDecoding||(i.isDecoding=!0,e=i.decodeArr.shift(),i.ctx.decodeAudioData(e.buffer,function(t){e.self.audioBuffer=t,e.success&&e.success(),i.isDecoding=!1,i.decodeAudios()},function(){a.log("sound decode error"),e.fail&&e.fail(),i.isDecoding=!1,i.decodeAudios()}))},i.decodeArr=[],i.isDecoding=!1,i);function i(){}r.WebAudioDecode=o,__reflect(o.prototype,"egret.web.WebAudioDecode");var e,t=(e=a.EventDispatcher,__extends(n,e),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(t){var e=this;(this.url=t)||a.$error(3002);var i=new XMLHttpRequest;function r(){e.loaded=!0,e.dispatchEventWith(a.Event.COMPLETE)}function n(){e.dispatchEventWith(a.IOErrorEvent.IO_ERROR)}i.open("GET",t,!0),i.responseType="arraybuffer",i.addEventListener("load",function(){400<=i.status?e.dispatchEventWith(a.IOErrorEvent.IO_ERROR):(o.decodeArr.push({buffer:i.response,success:r,fail:n,self:e,url:e.url}),o.decodeAudios())}),i.addEventListener("error",function(){e.dispatchEventWith(a.IOErrorEvent.IO_ERROR)}),i.send()},n.prototype.play=function(t,e){t=+t||0,e=+e||0,0==this.loaded&&a.$error(1049);var i=new r.WebAudioSoundChannel;return i.$url=this.url,i.$loops=e,i.$audioBuffer=this.audioBuffer,i.$startTime=t,i.$play(),a.sys.$pushSoundChannel(i),i},n.prototype.close=function(){},n.MUSIC="music",n.EFFECT="effect",n);function n(){var t=e.call(this)||this;return t.loaded=!1,t}r.WebAudioSound=t,__reflect(t.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(a.web||(a.web={}))}(egret=egret||{}),function(r){var e,i,t;function n(){var t=i.call(this)||this;return t.$startTime=0,t.bufferSource=null,t.context=e.WebAudioDecode.ctx,t.isStopped=!1,t._currentTime=0,t._volume=1,t.onPlayEnd=function(){if(1==t.$loops)return t.stop(),void t.dispatchEventWith(r.Event.SOUND_COMPLETE);0<t.$loops&&t.$loops--,t.$play()},t._startTime=0,t.initGain(),t}e=r.web||(r.web={}),i=r.EventDispatcher,__extends(n,i),n.prototype.initGain=function(){this.gain=null,this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()},n.prototype.$play=function(){var t,e,i;this.isStopped?r.$error(1036):(this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null),t=this.context,e=this.gain,i=t.createBufferSource(),(this.bufferSource=i).buffer=this.$audioBuffer,i.connect(e),e.connect(t.destination),i.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,i.start(0,this.$startTime),this._currentTime=0)},n.prototype.stop=function(){var t;this.bufferSource&&((t=this.bufferSource).stop?t.stop(0):t.noteOff(0),t.onended=null,t.disconnect(),this.bufferSource=null,this.$audioBuffer=null),this.isStopped||r.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(t){this.isStopped?r.$error(1036):(this._volume=t,this.gain.gain.value=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),t=n,e.WebAudioSoundChannel=t,__reflect(t.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(egret=egret||{}),function(o){var t,r,e;function i(t,e){void 0===e&&(e=!0);var i=r.call(this)||this;return i.loaded=!1,i.closed=!1,i.heightSet=NaN,i.widthSet=NaN,i.waiting=!1,i.userPause=!1,i.userPlay=!1,i.isPlayed=!1,i.screenChanged=function(t){var e=document.fullscreenEnabled||document.webkitIsFullScreen;e||(i.checkFullScreen(!1),o.Capabilities.isMobile||(i._fullscreen=e))},i._fullscreen=!0,i.onVideoLoaded=function(){i.video.removeEventListener("canplay",i.onVideoLoaded);var t=i.video;i.loaded=!0,i.posterData&&(i.posterData.width=i.getPlayWidth(),i.posterData.height=i.getPlayHeight()),t.width=t.videoWidth,t.height=t.videoHeight,window.setTimeout(function(){i.dispatchEventWith(o.Event.COMPLETE)},200)},i.$renderNode=new o.sys.BitmapNode,i.src=t,i.once(o.Event.ADDED_TO_STAGE,i.loadPoster,i),t&&i.load(),i}t=o.web||(o.web={}),r=o.DisplayObject,__extends(i,r),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},i.prototype.load=function(t,e){var i,r,n=this;void 0===e&&(e=!0),t=t||this.src,(this.src=t)||o.$error(3002),this.video&&this.video.src==t||(!this.video||o.Capabilities.isMobile?(i=document.createElement("video"),(this.video=i).controls=null):i=this.video,-1==t.indexOf("http://")&&-1==t.indexOf("HTTP://")&&-1==t.indexOf("https://")&&-1==t.indexOf("HTTPS://")||(i.crossOrigin="anonymous"),i.src=t,i.setAttribute("autoplay","autoplay"),i.setAttribute("webkit-playsinline","true"),i.setAttribute("playsinline","true"),i.setAttribute("x5-video-player-type","h5-page"),i.addEventListener("canplay",this.onVideoLoaded),i.addEventListener("error",function(){return n.onVideoError()}),i.addEventListener("ended",function(){return n.onVideoEnded()}),r=!1,i.addEventListener("canplay",function(){n.waiting=!1,r?n.userPause?n.pause():n.userPlay&&n.play():(r=!0,i.pause())}),i.addEventListener("waiting",function(){n.waiting=!0}),i.load(),this.videoPlay(),i.style.position="absolute",i.style.top="0px",i.style.zIndex="-88888",i.style.left="0px",i.height=1,i.width=1)},i.prototype.play=function(e,i){var r=this;if(void 0===i&&(i=!1),0==this.loaded)return this.load(this.src),void this.once(o.Event.COMPLETE,function(t){return r.play(e,i)},this);this.isPlayed=!0;var t=this.video;null!=e&&(t.currentTime=+e||0),t.loop=!!i,o.Capabilities.isMobile?t.style.zIndex="-88888":t.style.zIndex="9999",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.height=t.videoHeight,t.width=t.videoWidth,"Windows PC"!=o.Capabilities.os&&"Mac OS"!=o.Capabilities.os&&window.setTimeout(function(){t.width=0},1e3),this.checkFullScreen(this._fullscreen)},i.prototype.videoPlay=function(){this.userPause=!1,this.waiting?this.userPlay=!0:(this.userPlay=!1,this.video.play())},i.prototype.checkFullScreen=function(t){var e=this.video;if(t)null==e.parentElement&&(e.removeAttribute("webkit-playsinline"),e.removeAttribute("playsinline"),document.body.appendChild(e)),o.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=e.parentElement&&e.parentElement.removeChild(e),e.setAttribute("webkit-playsinline","true"),e.setAttribute("playsinline","true"),this.setFullScreenMonitor(!1),o.startTick(this.markDirty,this),o.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},i.prototype.goFullscreen=function(){var t=this.video,e=o.web.getPrefixStyleName("requestFullscreen",t);return(t[e]||t[e=o.web.getPrefixStyleName("requestFullScreen",t)])&&(t.removeAttribute("webkit-playsinline"),t[e](),this.setFullScreenMonitor(!0)),!0},i.prototype.setFullScreenMonitor=function(t){var e=this.video;t?(e.addEventListener("mozfullscreenchange",this.screenChanged),e.addEventListener("webkitfullscreenchange",this.screenChanged),e.addEventListener("mozfullscreenerror",this.screenError),e.addEventListener("webkitfullscreenerror",this.screenError)):(e.removeEventListener("mozfullscreenchange",this.screenChanged),e.removeEventListener("webkitfullscreenchange",this.screenChanged),e.removeEventListener("mozfullscreenerror",this.screenError),e.removeEventListener("webkitfullscreenerror",this.screenError))},i.prototype.screenError=function(){o.$error(3014)},i.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():this.video.style.display="none",this.video&&this.video.parentElement&&this.video.parentElement.removeChild(this.video)},i.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this._fullscreen&&this.exitFullscreen(),this.dispatchEventWith(o.Event.ENDED)},i.prototype.onVideoError=function(){console.error("video errorCode:",this.video.error.code),this.dispatchEventWith(o.IOErrorEvent.IO_ERROR)},i.prototype.close=function(){var t=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return t.onVideoError()}),this.video.removeEventListener("ended",function(){return t.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},i.prototype.pause=function(){this.userPlay=!1,this.waiting?this.userPause=!0:(this.userPause=!1,this.video.pause(),o.stopTick(this.markDirty,this))},Object.defineProperty(i.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(t){o.Capabilities.isMobile||(this._fullscreen=!!t,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new o.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),i.prototype.loadPoster=function(){var i,r=this,t=this.poster;t&&((i=new o.ImageLoader).once(o.Event.COMPLETE,function(t){var e;i.data;r.posterData=i.data,r.$renderDirty=!0,r.posterData.width=r.getPlayWidth(),r.posterData.height=r.getPlayHeight(),o.nativeRender&&((e=new o.Texture)._setBitmapData(r.posterData),r.$nativeDisplayObject.setTexture(e))},this),i.load(t))},i.prototype.$measureContentBounds=function(t){var e=this.bitmapData,i=this.posterData;e||i?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},i.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:NaN:this.widthSet},i.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:NaN:this.heightSet},i.prototype.$updateRenderNode=function(){var t=this.$renderNode,e=this.bitmapData,i=this.posterData,r=this.getPlayWidth(),n=this.getPlayHeight();this.isPlayed&&!o.Capabilities.isMobile||!i?this.isPlayed&&e&&(t.image=e,t.imageWidth=e.width,t.imageHeight=e.height,o.WebGLUtils.deleteWebGLTexture(e.webGLTexture),e.webGLTexture=null,t.drawImage(0,0,e.width,e.height,0,0,r,n)):(t.image=i,t.imageWidth=r,t.imageHeight=n,t.drawImage(0,0,i.width,i.height,0,0,r,n))},i.prototype.markDirty=function(){return this.$renderDirty=!0},i.prototype.$setHeight=function(t){var e;this.heightSet=t,this.paused&&((e=this).$renderDirty=!0,window.setTimeout(function(){e.$renderDirty=!1},200)),r.prototype.$setHeight.call(this,t)},i.prototype.$setWidth=function(t){var e;this.widthSet=t,this.paused&&((e=this).$renderDirty=!0,window.setTimeout(function(){e.$renderDirty=!1},200)),r.prototype.$setWidth.call(this,t)},Object.defineProperty(i.prototype,"paused",{get:function(){return!this.video||this.video.paused},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),e=i,t.WebVideo=e,__reflect(e.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),o.Video=e}(egret=egret||{}),function(n){var t,e,i;function r(){var t=e.call(this)||this;return t.timeout=0,t._url="",t._method="",t}t=n.web||(n.web={}),e=n.EventDispatcher,__extends(r,e),Object.defineProperty(r.prototype,"response",{get:function(){return this._xhr?null!=this._xhr.response?this._xhr.response:"text"==this._responseType?this._xhr.responseText:"arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)?window.convertResponseBodyToText(this._xhr.responseBody):"document"==this._responseType?this._xhr.responseXML:null:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),r.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},r.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e,this._xhr&&(this._xhr.abort(),this._xhr=null);e=this.getXHR();window.XMLHttpRequest?(e.addEventListener("load",this.onload.bind(this)),e.addEventListener("error",this.onerror.bind(this))):e.onreadystatechange=this.onReadyStateChange.bind(this),e.onprogress=this.updateProgress.bind(this),e.ontimeout=this.onTimeout.bind(this),e.open(this._method,this._url,!0),this._xhr=e},r.prototype.send=function(t){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var e in this.headerObj)this._xhr.setRequestHeader(e,this.headerObj[e]);this._xhr.timeout=this.timeout,this._xhr.send(t)},r.prototype.abort=function(){this._xhr&&this._xhr.abort()},r.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var t=this._xhr.getAllResponseHeaders();return t||""},r.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},r.prototype.getResponseHeader=function(t){if(!this._xhr)return null;t=this._xhr.getResponseHeader(t);return t||""},r.prototype.onTimeout=function(){n.$warn(1052,this._url),this.dispatchEventWith(n.IOErrorEvent.IO_ERROR)},r.prototype.onReadyStateChange=function(){var t,e,i,r=this._xhr;4==r.readyState&&(t=400<=r.status||0==r.status,e=this._url,i=this,window.setTimeout(function(){t?(i.hasEventListener(n.IOErrorEvent.IO_ERROR)||n.$error(1011,e),i.dispatchEventWith(n.IOErrorEvent.IO_ERROR)):i.dispatchEventWith(n.Event.COMPLETE)},0))},r.prototype.updateProgress=function(t){t.lengthComputable&&n.ProgressEvent.dispatchProgressEvent(this,n.ProgressEvent.PROGRESS,t.loaded,t.total)},r.prototype.onload=function(){var t=this,e=this._xhr,i=this._url,r=400<=e.status;window.setTimeout(function(){r?(t.hasEventListener(n.IOErrorEvent.IO_ERROR)||n.$error(1011,i),t.dispatchEventWith(n.IOErrorEvent.IO_ERROR)):t.dispatchEventWith(n.Event.COMPLETE)},0)},r.prototype.onerror=function(){var t=this._url,e=this;window.setTimeout(function(){e.hasEventListener(n.IOErrorEvent.IO_ERROR)||n.$error(1011,t),e.dispatchEventWith(n.IOErrorEvent.IO_ERROR)},0)},i=r,t.WebHttpRequest=i,__reflect(i.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),n.HttpRequest=i}(egret=egret||{}),function(i){var r,e,n,t;function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t.currentImage=null,t.request=null,t}r=i.web||(i.web={}),n=window.URL||window.webkitURL,e=i.EventDispatcher,__extends(o,e),Object.defineProperty(o.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),o.prototype.load=function(t){var e;r.Html5Capatibility._canUseBlob&&0!=t.indexOf("wxLocalResource:")&&0!=t.indexOf("data:")&&0!=t.indexOf("http:")&&0!=t.indexOf("https:")?((e=this.request)||((e=this.request=new i.web.WebHttpRequest).addEventListener(i.Event.COMPLETE,this.onBlobLoaded,this),e.addEventListener(i.IOErrorEvent.IO_ERROR,this.onBlobError,this),e.responseType="blob"),this.currentURL=t,e.open(t),e.send()):this.loadImage(t)},o.prototype.onBlobLoaded=function(t){var e=this.request.response;this.request=void 0,this.loadImage(n.createObjectURL(e))},o.prototype.onBlobError=function(t){this.dispatchIOError(this.currentURL),this.request=void 0},o.prototype.loadImage=function(t){var e=new Image;this.data=null,this.currentImage=e,this._hasCrossOriginSet?this._crossOrigin&&(e.crossOrigin=this._crossOrigin):o.crossOrigin&&(e.crossOrigin=o.crossOrigin),e.onload=this.onImageComplete.bind(this),e.onerror=this.onLoadError.bind(this),e.src=t},o.prototype.onImageComplete=function(t){var e,t=this.getImage(t);t&&(this.data=new i.BitmapData(t),e=this,window.setTimeout(function(){e.dispatchEventWith(i.Event.COMPLETE)},0))},o.prototype.onLoadError=function(t){t=this.getImage(t);t&&this.dispatchIOError(t.src)},o.prototype.dispatchIOError=function(t){var e=this;window.setTimeout(function(){e.hasEventListener(i.IOErrorEvent.IO_ERROR)||i.$error(1011,t),e.dispatchEventWith(i.IOErrorEvent.IO_ERROR)},0)},o.prototype.getImage=function(t){t=t.target;if(0==t.src.indexOf("blob:"))try{n.revokeObjectURL(t.src)}catch(t){i.$warn(1037)}return t.onerror=null,t.onload=null,this.currentImage!==t?null:(this.currentImage=null,t)},o.crossOrigin=null,t=o,r.WebImageLoader=t,__reflect(t.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),i.ImageLoader=t}(egret=egret||{}),function(h){var t,e,i;function r(){var t=e.call(this)||this;return t._isNeedShow=!1,t.inputElement=null,t.inputDiv=null,t._gscaleX=0,t._gscaleY=0,t.textValue="",t.colorValue=16777215,t._styleInfoes={},t}t=h.web||(h.web={}),e=h.EventDispatcher,__extends(r,e),r.prototype.$setTextField=function(t){return this.$textfield=t,!0},r.prototype.$addToStage=function(){this.htmlInput=h.web.$getTextAdapter(this.$textfield)},r.prototype._initElement=function(){var t=this.$textfield.localToGlobal(0,0),e=t.x,i=t.y,r=this.htmlInput.$scaleX,t=this.htmlInput.$scaleY;this.inputDiv.style.left=e*r+"px",this.inputDiv.style.top=i*t+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=i*t+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*t+"px"):(this.inputDiv.style.top=i*t+"px",this.inputElement.style.top="0px");for(var n=this.$textfield,o=1,a=1,s=0;n.parent;)o*=n.scaleX,a*=n.scaleY,s+=n.rotation,n=n.parent;i=h.web.getPrefixStyleName("transform");this.inputDiv.style[i]="rotate("+s+"deg)",this._gscaleX=r*o,this._gscaleY=t*a},r.prototype.$show=function(t){void 0===t&&(t=!0),this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":("password"==this.inputElement.type&&"password"!=this.$textfield.inputType&&(this.htmlInput.initInputElement(!1),this.inputElement=this.htmlInput.getInputElement(this)),this.inputElement.type=this.$textfield.inputType),this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement(),t&&this.activeShowKeyboard()},r.prototype.activeShowKeyboard=function(){this.htmlInput._needShow?(this._isNeedShow=!1,this.dispatchEvent(new h.Event("focus")),this.executeShow(),this.htmlInput.show()):(this.htmlInput.blurInputElement(),this.htmlInput.disposeInputElement())},r.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},r.prototype.onFocusHandler=function(){var t=this;window.setTimeout(function(){t.inputElement&&t.inputElement.scrollIntoView()},200)},r.prototype.executeShow=function(){this.inputElement.value!==this.$getText()&&(this.inputElement.value=this.$getText()),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),null==this.inputElement.onfocus&&(this.inputElement.onfocus=this.onFocusHandler.bind(this)),this.$resetStageText(),0<this.$textfield.maxChars?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars+""):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},r.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},r.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},r.prototype.$setText=function(t){return this.textValue=t,this.resetText(),!0},r.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},r.prototype.$setColor=function(t){return this.colorValue=t,this.resetColor(),!0},r.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",h.toColorString(this.colorValue))},r.prototype.$onBlur=function(){},r.prototype._onInput=function(){var t=this;window.setTimeout(function(){t.inputElement&&t.inputElement.selectionStart==t.inputElement.selectionEnd&&(t.textValue=t.inputElement.value,h.Event.dispatchEvent(t,"updateText",!1))},0)},r.prototype.setAreaHeight=function(){var t,e,i=this.$textfield;i.multiline&&(e=h.TextFieldUtils.$getTextHeight(i),i.height<=i.size?(this.setElementStyle("height",i.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",i.size*this._gscaleY+"px")):(i.height<e?(this.setElementStyle("height",i.height*this._gscaleY+"px"),this.setElementStyle("padding","0px")):(this.setElementStyle("height",(e+i.lineSpacing)*this._gscaleY+"px"),e=(t=(i.height-e)*this._gscaleY)*h.TextFieldUtils.$getValign(i),this.setElementStyle("padding",e+"px 0px "+(t-e)+"px 0px")),this.setElementStyle("lineHeight",(i.size+i.lineSpacing)*this._gscaleY+"px")))},r.prototype._onClickHandler=function(t){this._isNeedShow&&(t.stopImmediatePropagation(),this._isNeedShow=!1,this.dispatchEvent(new h.Event("focus")),this.executeShow())},r.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new h.Event("blur"))},r.prototype.setElementStyle=function(t,e){this.inputElement&&this._styleInfoes[t]!=e&&(this.inputElement.style[t]=e)},r.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},r.prototype.$resetStageText=function(){var t,e,i,r,n;this.inputElement&&(t=this.$textfield,this.setElementStyle("fontFamily",t.fontFamily),this.setElementStyle("fontStyle",t.italic?"italic":"normal"),this.setElementStyle("fontWeight",t.bold?"bold":"normal"),this.setElementStyle("textAlign",t.textAlign),this.setElementStyle("fontSize",t.size*this._gscaleY+"px"),this.setElementStyle("color",h.toColorString(t.textColor)),e=void 0,i=(e=t.stage?(e=t.localToGlobal(0,0).x,Math.min(t.width,t.stage.stageWidth-e)):t.width)*this._gscaleX,r=t.scaleX*h.sys.DisplayList.$canvasScaleX/(t.scaleY*h.sys.DisplayList.$canvasScaleY),this.setElementStyle("width",i/r+"px"),this.setElementStyle("transform","scale("+r+",  1)"),this.setElementStyle("left",(r-1)*i/r/2+"px"),this.setElementStyle("verticalAlign",t.verticalAlign),t.multiline?this.setAreaHeight():(this.setElementStyle("lineHeight",t.size*this._gscaleY+"px"),t.height<t.size?(this.setElementStyle("height",t.size*this._gscaleY+"px"),n=t.size/2*this._gscaleY,this.setElementStyle("padding","0px 0px "+n+"px 0px")):(this.setElementStyle("height",t.size*this._gscaleY+"px"),(n=(r=(t.height-t.size)*this._gscaleY)-(r=r*h.TextFieldUtils.$getValign(t)))<t.size/2*this._gscaleY&&(n=t.size/2*this._gscaleY),this.setElementStyle("padding",r+"px 0px "+n+"px 0px"))),this.inputDiv.style.clip="rect(0px "+t.width*this._gscaleX+"px "+t.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=t.height*this._gscaleY+"px",this.inputDiv.style.width=e*this._gscaleX+"px")},i=r,t.HTML5StageText=i,__reflect(i.prototype,"egret.web.HTML5StageText",["egret.StageText"]),h.StageText=i}(egret=egret||{}),function(r){var t,e;function i(){var e=this;this._needShow=!1,this.$scaleX=1,this.$scaleY=1,this.stageTextClickHandler=function(t){e._needShow?(e._needShow=!1,e._stageText._onClickHandler(t),e.show()):(e.blurInputElement(),e.disposeInputElement())}}t=r.web||(r.web={}),i.prototype.isInputOn=function(){return null!=this._stageText},i.prototype.isCurrentStageText=function(t){return this._stageText==t},i.prototype.initValue=function(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0",t.ontouchmove=function(t){t.preventDefault()}},i.prototype.$updateSize=function(){var t;this.canvas&&(this.$scaleX=r.sys.DisplayList.$canvasScaleX,this.$scaleY=r.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top,t=r.web.getPrefixStyleName("transform"),this.StageDelegateDiv.style[t]=this.canvas.style[t],this.StageDelegateDiv.style[r.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px")},i.prototype._initStageDelegateDiv=function(t,e){this.canvas=e;var i,e=this;i||(i=document.createElement("div"),(this.StageDelegateDiv=i).id="StageDelegateDiv",t.appendChild(i),e.initValue(i),e._inputDIV=document.createElement("div"),e.initValue(e._inputDIV),e._inputDIV.style.width="0px",e._inputDIV.style.height="0px",e._inputDIV.style.left="0px",e._inputDIV.style.top="-100px",e._inputDIV.style[r.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",i.appendChild(e._inputDIV),this.canvas.addEventListener("click",this.stageTextClickHandler),e.initInputElement(!0),e.initInputElement(!1))},i.prototype.initInputElement=function(t){var e,i=this;t?((e=document.getElementById("egretTextarea"))&&e.parentNode&&e.parentNode.removeChild(e),(e=document.createElement("textarea")).style.resize="none",(i._multiElement=e).id="egretTextarea"):((e=document.getElementById("egretInput"))&&e.parentNode&&e.parentNode.removeChild(e),e=document.createElement("input"),(i._simpleElement=e).id="egretInput"),e.type="text",i._inputDIV.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",i.initValue(e),e.style.outline="thin",e.style.background="none",e.style.overflow="hidden",e.style.wordBreak="break-all";var r=!(e.style.opacity="0");e.oninput=function(){i._stageText&&!r&&i._stageText._onInput()},e.addEventListener("compositionstart",function(){r=!0}),e.addEventListener("compositionend",function(){r=!1,i._stageText&&!r&&i._stageText._onInput()})},i.prototype.show=function(){var t=this._inputElement;r.$callAsync(function(){t.style.opacity="1"},this)},i.prototype.disconnectStageText=function(t){null!=this._stageText&&this._stageText!=t||(this._inputElement&&this._inputElement.blur(),this.clearInputElement(),this._inputElement&&this._inputDIV.contains(this._inputElement)&&this._inputDIV.removeChild(this._inputElement),this._needShow=!1)},i.prototype.clearInputElement=function(){var t=this;t._inputElement&&(t._inputElement.value="",t._inputElement.onblur=null,t._inputElement.onfocus=null,t._inputElement.style.width="1px",t._inputElement.style.height="12px",t._inputElement.style.left="0px",t._inputElement.style.top="0px",t._inputElement.style.opacity="0",(t._simpleElement==t._inputElement?t._multiElement:t._simpleElement).style.display="block",t._inputDIV.style.left="0px",t._inputDIV.style.top="-100px",t._inputDIV.style.height="0px",t._inputDIV.style.width="0px",t._inputElement.blur()),t._stageText&&(t._stageText._onDisconnect(),t._stageText=null,this.canvas.userTyping=!1,this.finishUserTyping&&this.finishUserTyping())},i.prototype.getInputElement=function(t){var e=this;return e.clearInputElement(),e._stageText=t,this.canvas.userTyping=!0,e._stageText.$textfield.multiline?e._inputElement=e._multiElement:e._inputElement=e._simpleElement,(e._simpleElement==e._inputElement?e._multiElement:e._simpleElement).style.display="none",this._inputElement&&!this._inputDIV.contains(this._inputElement)&&this._inputDIV.appendChild(this._inputElement),e._inputElement},i.prototype.blurInputElement=function(){this._inputElement&&(this.clearInputElement(),this._inputElement.blur())},i.prototype.disposeInputElement=function(){this._inputElement=null},e=i,t.HTMLInput=e,__reflect(e.prototype,"egret.web.HTMLInput")}(egret=egret||{}),function(t){var n,o,a;t=t.web||(t.web={}),n={},o={},a={},t.$getTextAdapter=function(t){var e=t.stage?t.stage.$hashCode:0,i=n[e],r=o[e],t=a[e];return r&&t&&(delete o[e],delete a[e]),i},t.$cacheTextAdapter=function(t,e,i,r){t._initStageDelegateDiv(i,r),n[e.$hashCode]=t,o[e.$hashCode]=r,a[e.$hashCode]=i}}(egret=egret||{}),function(a){var s;a.web||(a.web={});s=null,a.sys.measureText=function(t,e,i,r,n){s||((s=a.sys.canvasHitTestBuffer.context).textAlign="left",s.textBaseline="middle");var o="";return n&&(o+="italic "),r&&(o+="bold "),o+=("number"==typeof i&&0<i?i:12)+"px ",s.font=o+="string"==typeof e&&""!=e?e:"Arial",a.sys.measureTextWith(s,t)}}(egret=egret||{}),function(a){var t,e;function r(t,e){var e=a.sys.createCanvas(t,e),i=e.getContext("2d");if(void 0===i.imageSmoothingEnabled){for(var r,n=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],o=n.length-1;0<=o&&void 0===i[r=n[o]];o--);try{Object.defineProperty(i,"imageSmoothingEnabled",{get:function(){return this[r]},set:function(t){this[r]=t}})}catch(t){i.imageSmoothingEnabled=i[r]}}return e}function i(t,e,i){this.surface=a.sys.createCanvasRenderBufferSurface(r,t,e,i),this.context=this.surface.getContext("2d"),this.context&&(this.context.$offsetX=0,this.context.$offsetY=0),this.resize(t,e)}t=a.web||(a.web={}),Object.defineProperty(i.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),i.prototype.resize=function(t,e,i){a.sys.resizeCanvasRenderBuffer(this,t,e,i)},i.prototype.getPixels=function(t,e,i,r){return this.context.getImageData(t,e,i=void 0===i?1:i,r=void 0===r?1:r).data},i.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},i.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},e=i,t.CanvasRenderBuffer=e,__reflect(e.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(egret=egret||{}),function(o){var t,r,e;function i(t,e){var i=r.call(this)||this;return i.onTouchBegin=function(t){var e=i.getLocation(t);i.touch.onTouchBegin(e.x,e.y,t.identifier)},i.onMouseMove=function(t){0==t.buttons?i.onTouchEnd(t):i.onTouchMove(t)},i.onTouchMove=function(t){var e=i.getLocation(t);i.touch.onTouchMove(e.x,e.y,t.identifier)},i.onTouchEnd=function(t){var e=i.getLocation(t);i.touch.onTouchEnd(e.x,e.y,t.identifier)},i.scaleX=1,i.scaleY=1,i.rotation=0,i.canvas=e,i.touch=new o.sys.TouchHandler(t),i.addListeners(),i}t=o.web||(o.web={}),r=o.HashObject,__extends(i,r),i.prototype.addListeners=function(){var e=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(t){t.identifier=t.pointerId,e.onTouchBegin(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerMove",function(t){t.identifier=t.pointerId,e.onTouchMove(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerUp",function(t){t.identifier=t.pointerId,e.onTouchEnd(t),e.prevent(t)},!1)):(o.Capabilities.isMobile||this.addMouseListener(),this.addTouchListener())},i.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},i.prototype.addTouchListener=function(){var r=this;this.canvas.addEventListener("touchstart",function(t){for(var e=t.changedTouches.length,i=0;i<e;i++)r.onTouchBegin(t.changedTouches[i]);r.prevent(t)},!1),this.canvas.addEventListener("touchmove",function(t){for(var e=t.changedTouches.length,i=0;i<e;i++)r.onTouchMove(t.changedTouches[i]);r.prevent(t)},!1),this.canvas.addEventListener("touchend",function(t){for(var e=t.changedTouches.length,i=0;i<e;i++)r.onTouchEnd(t.changedTouches[i]);r.prevent(t)},!1),this.canvas.addEventListener("touchcancel",function(t){for(var e=t.changedTouches.length,i=0;i<e;i++)r.onTouchEnd(t.changedTouches[i]);r.prevent(t)},!1)},i.prototype.prevent=function(t){t.stopPropagation(),1==t.isScroll||this.canvas.userTyping||t.preventDefault()},i.prototype.getLocation=function(t){t.identifier=+t.identifier||0;var e=document.documentElement,i=this.canvas.getBoundingClientRect(),r=i.left+window.pageXOffset-e.clientLeft,n=i.top+window.pageYOffset-e.clientTop,e=t.pageX-r,r=e,t=t.pageY-n,n=t;return 90==this.rotation?(r=t,n=i.width-e):-90==this.rotation&&(r=i.height-t,n=e),r/=this.scaleX,n/=this.scaleY,o.$TempPoint.setTo(Math.round(r),Math.round(n))},i.prototype.updateScaleMode=function(t,e,i){this.scaleX=t,this.scaleY=e,this.rotation=i},i.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},e=i,t.WebTouchHandler=e,__reflect(e.prototype,"egret.web.WebTouchHandler")}(egret=egret||{}),function(t){var s;(s=t.web||(t.web={})).WebLifeCycleHandler=function(t){function e(){t.resume(),s.Html5Capatibility._audioType==s.AudioType.WEB_AUDIO&&s.WebAudioDecode.initAudioContext&&s.WebAudioDecode.initAudioContext()}function i(){t.pause()}var r;window.addEventListener("focus",e,!1),window.addEventListener("blur",i,!1),void 0!==document.hidden?(r="hidden",a="visibilitychange"):void 0!==document.mozHidden?(r="mozHidden",a="mozvisibilitychange"):void 0!==document.msHidden?(r="msHidden",a="msvisibilitychange"):void 0!==document.webkitHidden?(r="webkitHidden",a="webkitvisibilitychange"):void 0!==document.oHidden&&(r="oHidden",a="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",e,!1),window.addEventListener("pagehide",i,!1)),r&&a&&document.addEventListener(a,function(){(document[r]?i:e)()},!1);var n=navigator.userAgent,o=/micromessenger/gi.test(n),a=/mqq/gi.test(n);(a=/mobile.*qq/gi.test(n)||o?!1:a)&&((a=window.browser||{}).execWebFn=a.execWebFn||{},a.execWebFn.postX5GamePlayerMessage=function(t){t=t.type;"app_enter_background"==t?i():"app_enter_foreground"==t&&e()},window.browser=a)}}(egret=egret||{}),function(h){!function(o){var a=(t.WEB_AUDIO=2,t.HTML5_AUDIO=3,t);function t(){}o.AudioType=a,__reflect(a.prototype,"egret.web.AudioType");var e,i=(e=h.HashObject,__extends(s,e),s.$init=function(){var t=navigator.userAgent.toLowerCase();s.ua=t,s._canUseBlob=!1;var e=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,i=0<=t.indexOf("iphone")||0<=t.indexOf("ipad")||0<=t.indexOf("ipod");if(e)try{o.WebAudioDecode.initAudioContext=function(){if(o.WebAudioDecode.ctx)try{o.WebAudioDecode.ctx.close()}catch(t){}o.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);for(var t=0,e=h.sys.usingChannel;t<e.length;t++){var i=e[t];i.context=o.WebAudioDecode.ctx,i.initGain(),i.$startTime=i.position,i.$play()}},o.WebAudioDecode.initAudioContext()}catch(t){e=!1}var r,n=s._audioType;n==a.WEB_AUDIO&&e||n==a.HTML5_AUDIO?(r=!1,s.setAudioType(n)):!i&&0<=t.indexOf("safari")&&-1===t.indexOf("chrome")?(r=!1,s.setAudioType(a.WEB_AUDIO)):(r=!0,s.setAudioType(a.HTML5_AUDIO)),0<=t.indexOf("android")?r&&e&&s.setAudioType(a.WEB_AUDIO):i&&7<=s.getIOSVersion()&&(s._canUseBlob=!0,r&&e&&s.setAudioType(a.WEB_AUDIO)),window.URL||window.webkitURL||(s._canUseBlob=!1),0<=t.indexOf("egretnative")&&(s.setAudioType(a.HTML5_AUDIO),s._canUseBlob=!0),h.Sound=s._AudioClass},s.setAudioType=function(t){switch(s._audioType=t){case a.WEB_AUDIO:s._AudioClass=h.web.WebAudioSound;break;case a.HTML5_AUDIO:s._AudioClass=h.web.HtmlSound}},s.getIOSVersion=function(){var t=s.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/);if(!t||0==t.length)return 0;t=t[0];return parseInt(t.match(/\d+(_\d)*/)[0])||0},s._canUseBlob=!1,s._audioType=0,s.ua="",s);function s(){return e.call(this)||this}o.Html5Capatibility=i,__reflect(i.prototype,"egret.web.Html5Capatibility");var r=null;function n(t,e){if(t in e)return"";t=t.charAt(0).toUpperCase()+t.substring(1,t.length);for(var i=["webkit","ms","Moz","O"],r=0;r<i.length;r++)if(i[r]+t in e)return i[r];return""}o.getPrefixStyleName=function(t,e){var i="";return""==(i=null!=e?n(t,e):(null==r&&(e=document.createElement("div").style,r=n("transform",e)),r))?t:i+t.charAt(0).toUpperCase()+t.substring(1,t.length)},o.getPrefix=n}(h.web||(h.web={}))}(egret=egret||{}),function(a){var o;function i(t,e){var i=document.createElement("canvas");return isNaN(t)||isNaN(e)||(i.width=t,i.height=e),i}function t(t,e,i,r){var n;t&&(t=(n=t).surface,r?(t.width<e&&(t.width=e),t.height<i&&(t.height=i)):(t.width!==e&&(t.width=e),t.height!==i&&(t.height=i)),n.onResize())}function e(t){return t?t.getContext("2d"):null}o=a.web||(a.web={}),a.sys.mainCanvas=function(t,e){return e=i(t,e),a.pro.egret2dDriveMode&&(a.pro.mainCanvas=e),e},a.sys.createCanvas=i,o.resizeContext=t,a.sys.resizeContext=t,a.sys.getContextWebGL=function(t){for(var e={antialias:o.WebGLRenderContext.antialias,stencil:!0},i=null,r=["webgl","experimental-webgl"],n=0;n<r.length;++n){try{i=t.getContext(r[n],e)}catch(t){}if(i)break}return i||a.$error(1021),i},o.getContext2d=e,a.sys.getContext2d=e,a.sys.createTexture=function(t,e){var i=t,r=i.context;if(t=r.createTexture())return(t[a.glContext]=r).bindTexture(r.TEXTURE_2D,t),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),t[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),t;i.contextLost=!0},a.sys._createTexture=function(t,e,i,r){var n=t,o=n.context;return(t=o.createTexture())?((t[a.glContext]=o).bindTexture(o.TEXTURE_2D,t),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),t[a.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,i,0,o.RGBA,o.UNSIGNED_BYTE,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),t):(n.contextLost=!0,null)},a.sys.drawTextureElements=function(t,e,i){return(t=t.context).activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e.texture),e=3*e.count,t.drawElements(t.TRIANGLES,e,t.UNSIGNED_SHORT,2*i),e},a.sys.measureTextWith=function(t,e){return t.measureText(e).width},a.sys.createCanvasRenderBufferSurface=function(t,e,i,r){return t(e,i)},a.sys.resizeCanvasRenderBuffer=function(t,e,i,r){var n=t,t=n.surface;r?(r=!1,t.width<e&&(t.width=e,r=!0),t.height<i&&(t.height=i,r=!0),r||(n.context.globalCompositeOperation="source-over",n.context.setTransform(1,0,0,1,0,0),n.context.globalAlpha=1)):(t.width!=e&&(t.width=e),t.height!=i&&(t.height=i)),n.clear()},a.Geolocation=a.web.WebGeolocation,a.Motion=a.web.WebMotion,a.sys.registerFontMapping=function(t,e){if(!window.FontFace)return i=t,r=e,(n=document.createElement("style")).type="text/css",n.textContent='\n            @font-face\n            {\n                font-family:"'+i+'";\n                src:url("'+r+'");\n            }',n.onerror=function(t){console.error("loadFontError:",t)},void document.body.appendChild(n);var i,r,n;n=t,t=e,(e=a.sys.fontResourceCache)&&e[t]?(e=e[t],e=new window.FontFace(n,e),document.fonts.add(e),e.load().catch(function(t){console.error("loadFontError:",t)})):console.warn("registerFontMapping_WARN: Can not find TTF file:"+t+", please load file first.")},o.isIOS14Device=function(){return a.Capabilities.runtimeType==a.RuntimeType.WEB&&"iOS"==a.Capabilities.os&&a.Capabilities.isMobile&&/iPhone OS 14/.test(window.navigator.userAgent)}}(egret=egret||{}),function(_){!function(l){var u=!1;function c(t){"webgl"==t&&_.WebGLUtils.checkCanUseWebGL()?(_.sys.RenderBuffer=l.WebGLRenderBuffer,_.sys.systemRenderer=new l.WebGLRenderer,_.sys.canvasRenderer=new _.CanvasRenderer,_.sys.customHitTestBuffer=new l.WebGLRenderBuffer(3,3),_.sys.canvasHitTestBuffer=new l.CanvasRenderBuffer(3,3),_.Capabilities.renderMode="webgl"):(_.sys.RenderBuffer=l.CanvasRenderBuffer,_.sys.systemRenderer=new _.CanvasRenderer,_.sys.canvasRenderer=_.sys.systemRenderer,_.sys.customHitTestBuffer=new l.CanvasRenderBuffer(3,3),_.sys.canvasHitTestBuffer=_.sys.customHitTestBuffer,_.Capabilities.renderMode="canvas")}function p(e){var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;(i=i||function(t){return window.setTimeout(t,1e3/60)})(function t(){i(t);e.update()})}_.sys.setRenderMode=c,window.isNaN=function(t){return(t=+t)!=t},_.runEgret=function(a){if(!u){u=!0,a=a||{};var t=navigator.userAgent.toLowerCase();if(0<=t.indexOf("egretnative")&&-1==t.indexOf("egretwebview")&&(_.Capabilities.runtimeType=_.RuntimeType.RUNTIME2),a.pro){_.pro.egret2dDriveMode=!0;try{window.startup?window.startup():console.error("EgretPro.js don't has function:window.startup")}catch(t){console.error(t)}}if(0<=t.indexOf("egretnative")&&_.nativeRender)egret_native.addModuleCallback(function(){var t;l.Html5Capatibility.$init(),"webgl"==a.renderMode&&(t=a.antialias,l.WebGLRenderContext.antialias=!!t),_.sys.CanvasRenderBuffer=l.CanvasRenderBuffer,c(a.renderMode),egret_native.nrSetRenderMode(2),t=a.canvasScaleFactor||(a.calculateCanvasScaleFactor?a.calculateCanvasScaleFactor(_.sys.canvasHitTestBuffer.context):window.devicePixelRatio),_.sys.DisplayList.$canvasScaleFactor=t,p(_.ticker),a.screenAdapter?_.sys.screenAdapter=a.screenAdapter:_.sys.screenAdapter||(_.sys.screenAdapter=new _.sys.DefaultScreenAdapter);for(var e=document.querySelectorAll(".egret-player"),i=e.length,r=0;r<i;r++){var n=e[r],o=new l.WebPlayer(n,a);n["egret-player"]=o}window.addEventListener("resize",function(){isNaN(d)&&(d=window.setTimeout(f,300))})},null),egret_native.initNativeRender();else{l.Html5Capatibility._audioType=a.audioType,l.Html5Capatibility.$init();var e,i=a.renderMode;"webgl"==i&&(e=a.antialias,l.WebGLRenderContext.antialias=!!e),_.sys.CanvasRenderBuffer=l.CanvasRenderBuffer,0<=t.indexOf("egretnative")&&"webgl"!=i&&(_.$warn(1051),i="webgl"),c(i);t=void 0;t=a.canvasScaleFactor||(a.calculateCanvasScaleFactor?a.calculateCanvasScaleFactor(_.sys.canvasHitTestBuffer.context):(i=(i=_.sys.canvasHitTestBuffer.context).backingStorePixelRatio||i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1,(window.devicePixelRatio||1)/i)),_.sys.DisplayList.$canvasScaleFactor=t,p(_.ticker),a.screenAdapter?_.sys.screenAdapter=a.screenAdapter:_.sys.screenAdapter||(_.sys.screenAdapter=new _.sys.DefaultScreenAdapter);for(var r=document.querySelectorAll(".egret-player"),n=r.length,o=0;o<n;o++){var s=r[o],h=new l.WebPlayer(s,a);s["egret-player"]=h}window.addEventListener("resize",function(){isNaN(d)&&(d=window.setTimeout(f,300))})}}},_.updateAllScreens=function(){if(u)for(var t=document.querySelectorAll(".egret-player"),e=t.length,i=0;i<e;i++)t[i]["egret-player"].updateScreenSize()};var d=NaN;function f(){d=NaN,_.updateAllScreens()}}(_.web||(_.web={}))}(egret=egret||{}),(language=(language=navigator.language||navigator.browserLanguage||"en_US").replace("-","_"))in egret.$locale_strings&&(egret.$language=language),function(i){var t,e;function r(){}t=i.web||(i.web={}),r.detect=function(){var t=i.Capabilities,e=navigator.userAgent.toLowerCase();t.isMobile=-1!=e.indexOf("mobile")||-1!=e.indexOf("android"),t.isMobile?e.indexOf("windows")<0&&(-1!=e.indexOf("iphone")||-1!=e.indexOf("ipad")||-1!=e.indexOf("ipod"))?t.os="iOS":-1!=e.indexOf("android")&&-1!=e.indexOf("linux")?t.os="Android":-1!=e.indexOf("windows")&&(t.os="Windows Phone"):-1!=e.indexOf("windows nt")?t.os="Windows PC":"MacIntel"==navigator.platform&&1<navigator.maxTouchPoints?(t.os="iOS",t.isMobile=!0):-1!=e.indexOf("mac os")&&(t.os="Mac OS");e=(navigator.language||navigator.browserLanguage).toLowerCase().split("-");1<e.length&&(e[1]=e[1].toUpperCase()),t.language=e.join("-"),r.injectUIntFixOnIE9()},r.injectUIntFixOnIE9=function(){/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document.write("\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n<\/script>\r\n\x3c!-- convertResponseBodyToText --\x3e\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n<\/script>\r\n")},e=r,t.WebCapability=e,__reflect(e.prototype,"egret.web.WebCapability"),e.detect()}(egret=egret||{}),function(a){var t,e;function i(t,e,i,r,n){var o;this.showPanle=!0,this.fpsHeight=0,this.WIDTH=101,this.HEIGHT=20,this.bgCanvasColor="#18304b",this.fpsFrontColor="#18fefe",this.WIDTH_COST=50,this.cost1Color="#18fefe",this.cost3Color="#ff0000",this.arrFps=[],this.arrCost=[],this.arrLog=[],(e||i)&&("canvas"==a.Capabilities.renderMode?this.renderMode="Canvas":this.renderMode="WebGL",this.panelX=void 0===n.x?0:parseInt(n.x),this.panelY=void 0===n.y?0:parseInt(n.y),this.fontColor=void 0===n.textColor?"#ffffff":n.textColor.replace("0x","#"),this.fontSize=void 0===n.size?12:parseInt(n.size),a.Capabilities.isMobile&&(this.fontSize-=2),(o=document.createElement("div")).style.position="absolute",o.style.background="rgba(0,0,0,"+n.bgAlpha+")",o.style.left=this.panelX+"px",o.style.top=this.panelY+"px",o.style.pointerEvents="none",o.id="egret-fps-panel",document.body.appendChild(o),(n=document.createElement("div")).style.color=this.fontColor,n.style.fontSize=this.fontSize+"px",n.style.lineHeight=this.fontSize+"px",n.style.margin="4px 4px 4px 4px",this.container=n,o.appendChild(n),e&&this.addFps(),i&&this.addLog())}t=a.web||(a.web={}),i.prototype.addFps=function(){var t=document.createElement("div");t.style.display="inline-block",this.containerFps=t,this.container.appendChild(t);var e=document.createElement("div");e.style.paddingBottom="2px",this.fps=e,this.containerFps.appendChild(e),e.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var i=document.createElement("canvas");this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT;var r=(this.canvasFps=i).getContext("2d");(this.contextFps=r).fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);t=document.createElement("div");t.style.float="left",t.innerHTML="Draw<br/>Cost",n.appendChild(t);e=document.createElement("div");e.style.paddingLeft=t.offsetWidth+20+"px",n.appendChild(e);n=document.createElement("div");(this.divDraw=n).innerHTML="0<br/>",e.appendChild(n);n=document.createElement("div");(this.divCost=n).innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',e.appendChild(n),i=document.createElement("canvas"),this.canvasCost=i,this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT,r=i.getContext("2d"),(this.contextCost=r).fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT),r.fillStyle="#000000",r.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},i.prototype.addLog=function(){var t=document.createElement("div");t.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",t.style.wordWrap="break-word",this.log=t,this.container.appendChild(t)},i.prototype.update=function(t,e){var i,r;(e=void 0===e?!1:e)?(d=this.arrFps[this.arrFps.length-1],i=this.arrCost[this.arrCost.length-1][0],r=this.arrCost[this.arrCost.length-1][1]):(d=t.fps,i=t.costTicker,r=t.costRender,this.lastNumDraw=t.draw,this.arrFps.push(d),this.arrCost.push([i,r]));var n=0,o=this.arrFps.length;101<o&&(o=101,this.arrFps.shift(),this.arrCost.shift());for(var a=this.arrFps[0],s=this.arrFps[0],h=0;h<o;h++){var l=this.arrFps[h];n+=l,l<a?a=l:s<l&&(s=l)}var u=this.WIDTH,c=this.HEIGHT,p=this.contextFps;p.drawImage(this.canvasFps,1,0,u-1,c,0,0,u-1,c),p.fillStyle=this.bgCanvasColor,p.fillRect(u-1,0,1,c);e=Math.floor(d/60*20);e<1&&(e=1),p.fillStyle=this.fpsFrontColor,p.fillRect(u-1,20-e,1,e);t=this.WIDTH_COST;(p=this.contextCost).drawImage(this.canvasCost,1,0,t-1,c,0,0,t-1,c),p.drawImage(this.canvasCost,t+2,0,t-1,c,t+1,0,t-1,c);u=Math.floor(i/2);u<1?u=1:20<u&&(u=20);e=Math.floor(r/2);e<1?e=1:20<e&&(e=20),p.fillStyle=this.bgCanvasColor,p.fillRect(t-1,0,1,c),p.fillRect(2*t,0,1,c),p.fillRect(3*t+1,0,1,c),p.fillStyle=this.cost1Color,p.fillRect(t-1,20-u,1,u),p.fillStyle=this.cost3Color,p.fillRect(2*t,20-e,1,e);var e=Math.floor(n/o),d=d+" FPS "+this.renderMode;this.showPanle&&(d+="<br/>min"+a+" max"+s+" avg"+e,this.divDraw.innerHTML=this.lastNumDraw+"<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+i+'<font/> <font  style="color:#ff0000">'+r+"<font/>"),this.fps.innerHTML=d},i.prototype.updateInfo=function(t){this.arrLog.push(t),this.updateLogLayout()},i.prototype.updateWarn=function(t){this.arrLog.push("[Warning]"+t),this.updateLogLayout()},i.prototype.updateError=function(t){this.arrLog.push("[Error]"+t),this.updateLogLayout()},i.prototype.updateLogLayout=function(){for(this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},e=i,t.WebFps=e,__reflect(e.prototype,"egret.web.WebFps",["egret.FPSDisplay"]),a.FPSDisplay=e}(egret=egret||{}),function(r){!function(t){t.web||(t.web={});t.getItem=function(t){return window.localStorage.getItem(t)},t.setItem=function(e,i){try{return window.localStorage.setItem(e,i),!0}catch(t){return r.$warn(1047,e,i),!1}},t.removeItem=function(t){window.localStorage.removeItem(t)},t.clear=function(){window.localStorage.clear()}}(r.localStorage||(r.localStorage={}))}(egret=egret||{}),function(c){var h,r,t;function e(t,e){var i=r.call(this)||this;return i.updateAfterTyping=!1,i.init(t,e),i.initOrientation(),i}h=c.web||(c.web={}),r=c.HashObject,__extends(e,r),e.prototype.init=function(t,e){var i=this;console.log("Egret Engine Version:",c.Capabilities.engineVersion);var r=this.readOption(t,e),n=new c.Stage;n.$screen=this,n.$scaleMode=r.scaleMode,n.$orientation=r.orientation,n.$maxTouches=r.maxTouches,n.frameRate=r.frameRate,n.textureScaleFactor=r.textureScaleFactor;var o=new c.sys.RenderBuffer(void 0,void 0,!0),a=o.surface;this.attachCanvas(t,a);var s=new h.WebTouchHandler(n,a),e=new c.sys.Player(o,n,r.entryClassName);c.lifecycle.stage=n,c.lifecycle.addLifecycleListener(h.WebLifeCycleHandler);o=new h.HTMLInput;(r.showFPS||r.showLog)&&(c.nativeRender||e.displayFPS(r.showFPS,r.showLog,r.logFilter,r.fpsStyles)),this.playerOption=r,this.container=t,this.canvas=a,this.stage=n,this.player=e,this.webTouchHandler=s,(this.webInput=o).finishUserTyping=function(){i.updateAfterTyping&&setTimeout(function(){i.updateScreenSize(),i.updateAfterTyping=!1},300)},c.web.$cacheTextAdapter(o,n,t,a),this.updateScreenSize(),this.updateMaxTouches(),e.start()},e.prototype.initOrientation=function(){var t=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){c.StageOrientationEvent.dispatchStageOrientationEvent(t.stage,c.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},e.prototype.readOption=function(t,e){var i={};i.entryClassName=t.getAttribute("data-entry-class"),i.scaleMode=t.getAttribute("data-scale-mode")||c.StageScaleMode.NO_SCALE,i.frameRate=+t.getAttribute("data-frame-rate")||30,i.contentWidth=+t.getAttribute("data-content-width")||480,i.contentHeight=+t.getAttribute("data-content-height")||800,i.orientation=t.getAttribute("data-orientation")||c.OrientationMode.AUTO,i.maxTouches=+t.getAttribute("data-multi-fingered")||2,i.textureScaleFactor=+t.getAttribute("texture-scale-factor")||1,i.showFPS="true"==t.getAttribute("data-show-fps");for(var r=(t.getAttribute("data-show-fps-style")||"").split(","),n={},o=0;o<r.length;o++){var a=r[o].split(":");n[a[0]]=a[1]}return i.fpsStyles=n,i.showLog="true"==t.getAttribute("data-show-log"),i.logFilter=t.getAttribute("data-log-filter"),i},e.prototype.attachCanvas=function(t,e){var i=e.style;i.cursor="inherit",i.position="absolute",i.top="0",i.bottom="0",i.left="0",i.right="0",t.appendChild(e),(i=t.style).overflow="hidden",i.position="absolute"},e.prototype.updateScreenSize=function(){var t,e,i,r,n,o,a,s,h,l,u=this.canvas;u.userTyping?this.updateAfterTyping=!0:(l=this.playerOption,s=(e=this.container.getBoundingClientRect()).width,o=e.height,(a=0)!=s&&0!=o&&(e.top<0&&(o+=e.top,a=-e.top),t=!1,i=(t=(n=this.stage.$orientation)!=c.OrientationMode.AUTO?n!=c.OrientationMode.PORTRAIT&&s<o||n==c.OrientationMode.PORTRAIT&&o<s:t)?o:s,h=t?s:o,c.Capabilities.boundingClientWidth=i,c.Capabilities.boundingClientHeight=h,e=(r=c.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,i,h,l.contentWidth,l.contentHeight)).stageWidth,i=r.stageHeight,h=r.displayWidth,l=r.displayHeight,u.style[c.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",u.width!=e&&(u.width=e),u.height!=i&&(u.height=i),r=0,t?n==c.OrientationMode.LANDSCAPE?(r=90,u.style.top=a+(o-h)/2+"px",u.style.left=(s+l)/2+"px"):(r=-90,u.style.top=a+(o+h)/2+"px",u.style.left=(s-l)/2+"px"):(u.style.top=a+(o-l)/2+"px",u.style.left=(s-h)/2+"px"),a=(n=h/e)*c.sys.DisplayList.$canvasScaleFactor,s=(o=l/i)*c.sys.DisplayList.$canvasScaleFactor,a=Math.ceil(a),s=Math.ceil(s),(h=c.Matrix.create()).identity(),h.scale(n/a,o/s),h.rotate(r*Math.PI/180),l="matrix("+h.a+","+h.b+","+h.c+","+h.d+","+h.tx+","+h.ty+")",c.Matrix.release(h),u.style[c.web.getPrefixStyleName("transform")]=l,c.sys.DisplayList.$setCanvasScale(a,s),this.webTouchHandler.updateScaleMode(n,o,r),this.webInput.$updateSize(),this.player.updateStageSize(e,i),c.nativeRender&&(u.width=e*a,u.height=i*s)))},e.prototype.setContentSize=function(t,e){var i=this.playerOption;i.contentWidth=t,i.contentHeight=e,this.updateScreenSize()},e.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},t=e,h.WebPlayer=t,__reflect(t.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(egret=egret||{}),function(p){var d,f;function o(t,e){d||(d=p.sys.createCanvas(),f=d.getContext("2d"));var i=t.$getTextureWidth(),r=t.$getTextureHeight();null==e&&((e=p.$TempRectangle).x=0,e.y=0,e.width=i,e.height=r),e.x=Math.min(e.x,i-1),e.y=Math.min(e.y,r-1),e.width=Math.min(e.width,i-e.x),e.height=Math.min(e.height,r-e.y);var n=e.width,o=e.height,a=d;if(a.style.width=n+"px",a.style.height=o+"px",d.width=n,d.height=o,"webgl"==p.Capabilities.renderMode){var s=void 0;t.$renderBuffer?s=t:(p.sys.systemRenderer.renderClear&&p.sys.systemRenderer.renderClear(),(s=new p.RenderTexture).drawToTexture(new p.Bitmap(t)));for(var h=s.$renderBuffer.getPixels(e.x,e.y,n,o),l=new ImageData(n,o),u=0;u<h.length;u++)l.data[u]=h[u];return f.putImageData(l,0,0),t.$renderBuffer||s.dispose(),a}var c=t,n=Math.round(c.$offsetX),o=Math.round(c.$offsetY),s=c.$bitmapWidth,t=c.$bitmapHeight;return f.drawImage(c.$bitmapData.source,c.$bitmapX+e.x/p.$TextureScaleFactor,c.$bitmapY+e.y/p.$TextureScaleFactor,s*e.width/i,t*e.height/r,n,o,e.width,e.height),a}function n(t,e,i){try{return o(this,e).toDataURL(t,i)}catch(t){p.$error(1033)}return null}p.web||(p.web={}),p.Texture.prototype.toDataURL=n,p.Texture.prototype.saveToFile=function(t,e,i,r){null!=(i=n.call(this,t,i,r))&&(r=i.replace(/^data:image[^;]*/,"data:image/octet-stream"),(i=document.createElement("a")).download=e,i.href=r,(r=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(r))},p.Texture.prototype.getPixel32=function(t,e){return p.$warn(1041,"getPixel32","getPixels"),this.getPixels(t,e)},p.Texture.prototype.getPixels=function(t,e,i,r){if(void 0===i&&(i=1),void 0===r&&(r=1),"webgl"==p.Capabilities.renderMode){var n=void 0;return this.$renderBuffer?n=this:(n=new p.RenderTexture).drawToTexture(new p.Bitmap(this)),n.$renderBuffer.getPixels(t,e,i,r)}try{o(this);return f.getImageData(t,e,i,r).data}catch(t){p.$error(1039)}}}(egret=egret||{}),function(s){!function(t){function e(t,e){this.nodeType=t,this.parent=e}t.XMLNode=e,__reflect(e.prototype,"egret.web.XMLNode");var o,_=(__extends(i,o=e),i);function i(t,e,i,r,n){e=o.call(this,1,e)||this;return e.attributes={},e.children=[],e.localName=t,e.prefix=i,e.namespace=r,e.name=n,e}t.XML=_,__reflect(_.prototype,"egret.web.XML");var r,g=(__extends(n,r=e),n);function n(t,e){e=r.call(this,3,e)||this;return e.text=t,e}t.XMLText=g,__reflect(g.prototype,"egret.web.XMLText");var a=new DOMParser;s.XML={parse:function(t){for(var e=a.parseFromString(t,"text/xml"),i=e.childNodes.length,r=0;r<i;r++){var n=e.childNodes[r];if(1==n.nodeType)return function t(e,i){if("parsererror"==e.localName)throw new Error(e.textContent);var r=new _(e.localName,i,e.prefix,e.namespaceURI,e.nodeName);var n=e.attributes;var o=r.attributes;var a=n.length;for(var s=0;s<a;s++){var h=n[s],l=h.name;0!=l.indexOf("xmlns:")&&(o[l]=h.value,r["$"+l]=h.value)}var u=e.childNodes;a=u.length;var c=r.children;for(s=0;s<a;s++){var p=u[s],d=p.nodeType,f=null;1==d?f=t(p,r):3!=d||(p=p.textContent.trim())&&(f=new g(p,r)),f&&c.push(f)}return r}(n,null)}return null}}}(s.web||(s.web={}))}(egret=egret||{}),function(r){var t,e,i;function n(){var i=null!==e&&e.apply(this,arguments)||this;return i.onChange=function(t){var e=new r.OrientationEvent(r.Event.CHANGE);e.beta=t.beta,e.gamma=t.gamma,e.alpha=t.alpha,i.dispatchEvent(e)},i}t=r.web||(r.web={}),e=r.EventDispatcher,__extends(n,e),n.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},n.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},i=n,t.WebDeviceOrientation=i,__reflect(i.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(egret=egret||{}),egret.DeviceOrientation=egret.web.WebDeviceOrientation,function(t){var e,i;function r(){}e=t.web||(t.web={}),r.call=function(t,e){},r.addCallback=function(t,e){},i=r,e.WebExternalInterface=i,__reflect(i.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]),navigator.userAgent.toLowerCase().indexOf("egretnative")<0&&(t.ExternalInterface=i)}(egret=egret||{}),function(r){var t,n,e;function i(){}t=r.web||(r.web={}),n={},i.call=function(t,e){var i={};i.functionName=t,i.value=e,egret_native.sendInfoToPlugin(JSON.stringify(i))},i.addCallback=function(t,e){n[t]=e},e=i,t.NativeExternalInterface=e,__reflect(e.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]),0<=navigator.userAgent.toLowerCase().indexOf("egretnative")&&(r.ExternalInterface=e,egret_native.receivedPluginInfo=function(t){var e=JSON.parse(t),i=e.functionName;(t=n[i])?(e=e.value,t.call(null,e)):r.$warn(1050,i)})}(egret=egret||{}),function(r){var t,n,e;function i(){}t=r.web||(r.web={}),n={},i.call=function(t,e){__global.ExternalInterface.call(t,e)},i.addCallback=function(t,e){n[t]=e},i.invokeCallback=function(t,e){var i=n[t];i?i.call(null,e):r.$warn(1050,t)},e=i,t.WebViewExternalInterface=e,__reflect(e.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]),0<=navigator.userAgent.toLowerCase().indexOf("egretwebview")&&(r.ExternalInterface=e)}(egret=egret||{}),function(h){var r,e,t;function l(){var t=e.call(this)||this;return t.loaded=!1,t}r=h.web||(h.web={}),e=h.EventDispatcher,__extends(l,e),Object.defineProperty(l.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),l.prototype.load=function(t){var e=this;(this.url=t)||h.$error(3002);var i=new Audio(t);i.addEventListener("canplaythrough",o),i.addEventListener("error",a);var r=navigator.userAgent.toLowerCase();0<=r.indexOf("firefox")&&(i.autoplay=!0,i.muted=!0);var n=0<=r.indexOf("edge")||0<=r.indexOf("trident");function o(){delete l.loadingSoundMap[t],l.$recycle(e.url,i),s(),0<=r.indexOf("firefox")&&(i.pause(),i.muted=!1),n&&document.body.appendChild(i),e.loaded=!0,e.dispatchEventWith(h.Event.COMPLETE)}function a(){s(),e.dispatchEventWith(h.IOErrorEvent.IO_ERROR)}function s(){i.removeEventListener("canplaythrough",o),i.removeEventListener("error",a),n&&document.body.removeChild(i)}n&&document.body.appendChild(i),i.load(),l.loadingSoundMap[t]=i,this.originAudio=i,l.clearAudios[this.url]&&delete l.clearAudios[this.url]},l.prototype.play=function(t,e){t=+t||0,e=+e||0,0==this.loaded&&h.$error(1049);var i=l.$pop(this.url);(i=null==i?this.originAudio.cloneNode():i).autoplay=!0;i=new r.HtmlSoundChannel(i);return i.$url=this.url,i.$loops=e,i.$startTime=t,i.$play(),h.sys.$pushSoundChannel(i),i},l.prototype.close=function(){this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),l.$clear(this.url),this.loaded=!1},l.$clear=function(t){l.clearAudios[t]=!0;t=l.audios[t];t&&(t.length=0)},l.$pop=function(t){t=l.audios[t];return t&&0<t.length?t.pop():null},l.$recycle=function(t,e){var i;l.clearAudios[t]||(i=l.audios[t],(i=null==l.audios[t]?l.audios[t]=[]:i).push(e))},l.MUSIC="music",l.EFFECT="effect",l.loadingSoundMap={},l.audios={},l.clearAudios={},t=l,r.HtmlSound=t,__reflect(t.prototype,"egret.web.HtmlSound",["egret.Sound"])}(egret=egret||{}),function(e){var i;e.web||(e.web={});Object.defineProperty(e.Logger,"logLevel",{set:function(t){switch(null==i&&(i={error:console.error,debug:console.debug,warn:console.warn,info:console.info,log:console.log}),t){case e.Logger.OFF:console.error=function(){};case e.Logger.ERROR:console.warn=function(){};case e.Logger.WARN:console.info=function(){},console.log=function(){};case e.Logger.INFO:console.debug=function(){}}switch(t){case e.Logger.ALL:case e.Logger.DEBUG:console.debug=i.debug;case e.Logger.INFO:console.log=i.log,console.info=i.info;case e.Logger.WARN:console.warn=i.warn;case e.Logger.ERROR:console.error=i.error}},enumerable:!0,configurable:!0})}(egret=egret||{}),function(t){var e;function i(){this.drawData=[],this.drawDataLen=0}e=t.web||(t.web={}),i.prototype.pushDrawRect=function(){var t;0!=this.drawDataLen&&1==this.drawData[this.drawDataLen-1].type||((t=this.drawData[this.drawDataLen]||{}).type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++),this.drawData[this.drawDataLen-1].count+=2},i.prototype.pushDrawTexture=function(t,e,i,r,n){var o;void 0===e&&(e=2),i?((o=this.drawData[this.drawDataLen]||{}).type=0,o.texture=t,o.filter=i,o.count=e,o.textureWidth=r,o.textureHeight=n,this.drawData[this.drawDataLen]=o,this.drawDataLen++):(0!=this.drawDataLen&&0==this.drawData[this.drawDataLen-1].type&&t==this.drawData[this.drawDataLen-1].texture&&!this.drawData[this.drawDataLen-1].filter||((o=this.drawData[this.drawDataLen]||{}).type=0,o.texture=t,o.count=0,this.drawData[this.drawDataLen]=o,this.drawDataLen++),this.drawData[this.drawDataLen-1].count+=e)},i.prototype.pushChangeSmoothing=function(t,e){t.smoothing=e;var i=this.drawData[this.drawDataLen]||{};i.type=10,i.texture=t,i.smoothing=e,this.drawData[this.drawDataLen]=i,this.drawDataLen++},i.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},i.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},i.prototype.pushSetBlend=function(t){for(var e=!1,i=this.drawDataLen-1;0<=i;i--){var r=this.drawData[i];if(r)if((e=0==r.type||1==r.type?!0:e)||4!=r.type){if(4==r.type){if(r.value==t)return;break}}else this.drawData.splice(i,1),this.drawDataLen--}var n=this.drawData[this.drawDataLen]||{};n.type=4,n.value=t,this.drawData[this.drawDataLen]=n,this.drawDataLen++},i.prototype.pushResize=function(t,e,i){var r=this.drawData[this.drawDataLen]||{};r.type=5,r.buffer=t,r.width=e,r.height=i,this.drawData[this.drawDataLen]=r,this.drawDataLen++},i.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},i.prototype.pushActivateBuffer=function(t){for(var e=!1,i=this.drawDataLen-1;0<=i;i--){var r=this.drawData[i];r&&((e=4!=r.type&&7!=r.type?!0:e)||7!=r.type||(this.drawData.splice(i,1),this.drawDataLen--))}var n=this.drawData[this.drawDataLen]||{};n.type=7,n.buffer=t,n.width=t.rootRenderTarget.width,n.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=n,this.drawDataLen++},i.prototype.pushEnableScissor=function(t,e,i,r){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=t,n.y=e,n.width=i,n.height=r,this.drawData[this.drawDataLen]=n,this.drawDataLen++},i.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},i.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.value="",e.buffer=null,e.width=0,e.height=0,e.textureWidth=0,e.textureHeight=0,e.smoothing=!1,e.x=0,e.y=0}this.drawDataLen=0},t=i,e.WebGLDrawCmdManager=t,__reflect(t.prototype,"egret.web.WebGLDrawCmdManager")}(egret=egret||{}),function(i){var r,n,t;function e(t){var e=n.call(this)||this;return e.$startTime=0,e.audio=null,e.isStopped=!1,e.canPlay=function(){e.audio.removeEventListener("canplay",e.canPlay);try{e.audio.currentTime=e.$startTime}catch(t){}finally{e.audio.play()}},e.onPlayEnd=function(){if(1==e.$loops)return e.stop(),void e.dispatchEventWith(i.Event.SOUND_COMPLETE);0<e.$loops&&e.$loops--,e.$play()},e._volume=1,t.addEventListener("ended",e.onPlayEnd),e.audio=t,e}r=i.web||(i.web={}),n=i.EventDispatcher,__extends(e,n),e.prototype.$play=function(){if(this.isStopped)i.$error(1036);else{try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(t){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()}},e.prototype.stop=function(){var t,e;this.audio&&(this.isStopped||i.sys.$popSoundChannel(this),this.isStopped=!0,(t=this.audio).removeEventListener("ended",this.onPlayEnd),t.removeEventListener("canplay",this.canPlay),t.volume=0,this._volume=0,this.audio=null,e=this.$url,window.setTimeout(function(){t.pause(),r.HtmlSound.$recycle(e,t)},200))},Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this.isStopped?i.$error(1036):(this._volume=t,this.audio&&(this.audio.volume=t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),t=e,r.HtmlSoundChannel=t,__reflect(t.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(egret=egret||{}),function(i){var e,n,t;function r(t,e,i){var r=n.call(this)||this;return r.clearColor=[0,0,0,0],r.useFrameBuffer=!0,r.gl=t,r._resize(e,i),r}e=i.web||(i.web={}),n=i.HashObject,__extends(r,n),r.prototype._resize=function(t,e){e=e||1,(t=t||1)<1&&(i.warn("WebGLRenderTarget _resize width = "+t),t=1),e<1&&(i.warn("WebGLRenderTarget _resize height = "+e),e=1),this.width=t,this.height=e},r.prototype.resize=function(t,e){this._resize(t,e);e=this.gl;this.frameBuffer&&(e.bindTexture(e.TEXTURE_2D,this.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null)),this.stencilBuffer&&(e.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},r.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},r.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},r.prototype.initFrameBuffer=function(){var t;this.frameBuffer||(t=this.gl,this.texture=this.createTexture(),this.frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0))},r.prototype.createTexture=function(){var t=e.WebGLRenderContext.getInstance(0,0);return i.sys._createTexture(t,this.width,this.height,null)},r.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},r.prototype.enabledStencil=function(){var t;this.frameBuffer&&!this.stencilBuffer&&((t=this.gl).bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer))},r.prototype.dispose=function(){i.WebGLUtils.deleteWebGLTexture(this.texture)},t=r,e.WebGLRenderTarget=t,__reflect(t.prototype,"egret.web.WebGLRenderTarget")}(egret=egret||{}),function(u){var v,h,t;function r(t,e,i){this._defaultEmptyTexture=null,this.glID=null,this.projectionX=NaN,this.projectionY=NaN,this.contextLost=!1,this._supportedCompressedTextureInfo=[],this.$scissorState=!1,this.vertexCountPerTriangle=3,this.triangleCountPerQuad=2,this.dataCountPerVertex=5,this.vertSize=5,this.$beforeRender=function(){var t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.disable(t.STENCIL_TEST),t.colorMask(!0,!0,!0,!0),this.setBlendMode("source-over"),t.activeTexture(t.TEXTURE0),this.currentProgram=null},this.surface=u.sys.mainCanvas(t,e),u.nativeRender||(this.initWebGL(i),this.getSupportedCompressedTexture(),this.$bufferStack=[],i=this.context,this.vertexBuffer=i.createBuffer(),this.indexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new v.WebGLDrawCmdManager,this.vao=new v.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over"))}v=u.web||(u.web={}),h={},r.getInstance=function(t,e,i){return this.instance||(this.instance=new r(t,e,i),this.instance)},r.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},r.prototype.popBuffer=function(){var t;this.$bufferStack.length<=1||(this.$bufferStack.pop()!=(t=this.$bufferStack[this.$bufferStack.length-1])&&this.drawCmdManager.pushActivateBuffer(t),this.currentBuffer=t)},r.prototype.activateBuffer=function(t,e,i){t.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),t.restoreStencil(),t.restoreScissor(),this.onResize(e,i)},r.prototype.uploadVerticesArray=function(t){var e=this.context;e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},r.prototype.uploadIndicesArray=function(t){var e=this.context;e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.bindIndices=!0},r.prototype.destroy=function(){this.surface.width=this.surface.height=0},r.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2,this.context&&this.context.viewport(0,0,t,e)},r.prototype.resize=function(t,e,i){u.sys.resizeContext(this,t,e,i)},r.prototype._buildSupportedCompressedTextureInfo=function(t){for(var e=[],i=0,r=t;i<r.length;i++){var n=r[i];if(n){var o={extensionName:n.name,supportedFormats:[]};for(a in n)o.supportedFormats.push([a,n[a]]);if(1,0===o.supportedFormats.length)console.error("buildSupportedCompressedTextureInfo failed = "+n.name);else for(var a in u.log("support: "+n.name),n)u.log(a,n[a],"0x"+n[a].toString(16));e.push(o)}}return e},r.prototype.initWebGL=function(t){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),t?this.setContext(t):this.getWebGLContext();t=this.context;this.$maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)},r.prototype.getSupportedCompressedTexture=function(){var t=this.context||u.sys.getContextWebGL(this.surface);this.pvrtc=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.pvrtc&&(this.pvrtc.name="WEBGL_compressed_texture_pvrtc"),this.etc1=t.getExtension("WEBGL_compressed_texture_etc1")||t.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),this.etc1&&(this.etc1.name="WEBGL_compressed_texture_etc1"),u.Capabilities._supportedCompressedTexture?(u.Capabilities._supportedCompressedTexture=u.Capabilities._supportedCompressedTexture||{},u.Capabilities._supportedCompressedTexture.pvrtc=!!this.pvrtc,u.Capabilities._supportedCompressedTexture.etc1=!!this.etc1):(u.Capabilities.supportedCompressedTexture=u.Capabilities._supportedCompressedTexture||{},u.Capabilities.supportedCompressedTexture.pvrtc=!!this.pvrtc,u.Capabilities.supportedCompressedTexture.etc1=!!this.etc1),this._supportedCompressedTextureInfo=this._buildSupportedCompressedTextureInfo([this.etc1,this.pvrtc])},r.prototype.handleContextLost=function(){this.contextLost=!0},r.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},r.prototype.getWebGLContext=function(){var t=u.sys.getContextWebGL(this.surface);return this.setContext(t),t},r.prototype.setContext=function(t){(this.context=t).id=r.glContextId++,this.glID=t.id,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,!0),t.activeTexture(t.TEXTURE0)},r.prototype.enableStencilTest=function(){var t=this.context;t.enable(t.STENCIL_TEST)},r.prototype.disableStencilTest=function(){var t=this.context;t.disable(t.STENCIL_TEST)},r.prototype.enableScissorTest=function(t){var e=this.context;e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},r.prototype.disableScissorTest=function(){var t=this.context;t.disable(t.SCISSOR_TEST)},r.prototype.getPixels=function(t,e,i,r,n){var o=this.context;o.readPixels(t,e,i,r,o.RGBA,o.UNSIGNED_BYTE,n)},r.prototype.createTexture=function(t){return u.sys.createTexture(this,t)},r.prototype.checkCompressedTextureInternalFormat=function(t,e){for(var i=0,r=t.length;i<r;++i)for(var n=t[i].supportedFormats,o=0,a=n.length;o<a;++o)if(n[o][1]===e)return!0;return!1},r.prototype.$debugLogCompressedTextureNotSupported=function(t,e){if(!h[e]){h[e]=!0,u.log("internalFormat = "+e+":0x"+e.toString(16)+", the current hardware does not support the corresponding compression format.");for(var i=0,r=t.length;i<r;++i){var n=t[i];if(0<n.supportedFormats.length){u.log("support = "+n.extensionName);for(var o=0,a=n.supportedFormats.length;o<a;++o){var s=n.supportedFormats[o];u.log(s[0]+" : "+s[1]+" : 0x"+s[1].toString(16))}}}}},r.prototype.createCompressedTexture=function(t,e,i,r,n){if(!this.checkCompressedTextureInternalFormat(this._supportedCompressedTextureInfo,n))return this.$debugLogCompressedTextureNotSupported(this._supportedCompressedTextureInfo,n),this.defaultEmptyTexture;var o=this.context,a=o.createTexture();if(a)return a[u.glContext]=o,a[u.is_compressed_texture]=!0,o.bindTexture(o.TEXTURE_2D,a),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a[u.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,o.compressedTexImage2D(o.TEXTURE_2D,r,n,e,i,0,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.bindTexture(o.TEXTURE_2D,null),a;this.contextLost=!0},r.prototype.updateTexture=function(t,e){var i=this.context;i.bindTexture(i.TEXTURE_2D,t),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)},Object.defineProperty(r.prototype,"defaultEmptyTexture",{get:function(){var t,e;return this._defaultEmptyTexture||(t=u.sys.createCanvas(16,16),(e=u.sys.getContext2d(t)).fillStyle="white",e.fillRect(0,0,16,16),this._defaultEmptyTexture=this.createTexture(t),this._defaultEmptyTexture[u.engine_default_empty_texture]=!0),this._defaultEmptyTexture},enumerable:!0,configurable:!0}),r.prototype.getWebGLTexture=function(t){var e;return t.webGLTexture||("image"!=t.format||t.hasCompressed2d()?t.hasCompressed2d()&&(e=t.getCompressed2dTextureData(),t.webGLTexture=this.createCompressedTexture(e.byteArray,e.width,e.height,e.level,e.glInternalFormat),!(e=t.etcAlphaMask)||(e=this.getWebGLTexture(e))&&(t.webGLTexture[u.etc_alpha_mask]=e)):t.webGLTexture=this.createTexture(t.source),t.$deleteSource&&t.webGLTexture&&(t.source&&(t.source.src="",t.source=null),t.clearCompressedTextureData()),t.webGLTexture&&(t.webGLTexture.smoothing=!0)),t.webGLTexture},r.prototype.clearRect=function(t,e,i,r){var n,o;0!=t||0!=e||i!=this.surface.width||r!=this.surface.height?!(n=this.currentBuffer).$hasScissor&&0==(o=n.globalMatrix).b&&0==o.c?(t=t*o.a+o.tx,e=e*o.d+o.ty,i*=o.a,r*=o.d,this.enableScissor(t,-e-r+n.height,i,r),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,i,r),this.setGlobalCompositeOperation("source-over")):this.clear()},r.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},r.prototype.drawImage=function(t,e,i,r,n,o,a,s,h,l,u,c,p){var d,f,_,g=this.currentBuffer;if(!this.contextLost&&t&&g){if(t.texture||t.source&&t.source.texture)d=t.texture||t.source.texture,g.saveTransform(),f=g.$offsetX,_=g.$offsetY,g.useOffset(),g.transform(1,0,0,-1,0,h+2*a);else{if(!t.source&&!t.webGLTexture)return;d=this.getWebGLTexture(t)}d&&(this.drawTexture(d,e,i,r,n,o,a,s,h,l,u,void 0,void 0,void 0,void 0,c,p),t.source&&t.source.texture&&(g.$offsetX=f,g.$offsetY=_,g.restoreTransform()))}},r.prototype.drawMesh=function(t,e,i,r,n,o,a,s,h,l,u,c,p,d,f,_,g){var y,m,v,b=this.currentBuffer;if(!this.contextLost&&t&&b){if(t.texture||t.source&&t.source.texture)y=t.texture||t.source.texture,b.saveTransform(),m=b.$offsetX,v=b.$offsetY,b.useOffset(),b.transform(1,0,0,-1,0,h+2*a);else{if(!t.source&&!t.webGLTexture)return;y=this.getWebGLTexture(t)}y&&(this.drawTexture(y,e,i,r,n,o,a,s,h,l,u,c,p,d,f,_,g),(t.texture||t.source&&t.source.texture)&&(b.$offsetX=m,b.$offsetY=v,b.restoreTransform()))}},r.prototype.drawTexture=function(t,e,i,r,n,o,a,s,h,l,u,c,p,d,f,_,g){var y,m=this.currentBuffer;!this.contextLost&&t&&m&&(g=v.isIOS14Device()?(y=d&&d.length/3||0,d?this.vao.reachMaxSize(4*y,6*y)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),null!=g&&t.smoothing!=g&&this.drawCmdManager.pushChangeSmoothing(t,g),d?2*y:2):(p&&d?this.vao.reachMaxSize(p.length/2,d.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),null!=g&&t.smoothing!=g&&this.drawCmdManager.pushChangeSmoothing(t,g),c&&this.vao.changeToMeshIndices(),d?d.length/3:2),this.drawCmdManager.pushDrawTexture(t,g,this.$filter,l,u),m.currentTexture=t,this.vao.cacheArrays(m,e,i,r,n,o,a,s,h,l,u,c,p,d,_))},r.prototype.drawRect=function(t,e,i,r){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,i,r,t,e,i,r,i,r))},r.prototype.pushMask=function(t,e,i,r){var n=this.currentBuffer;!this.contextLost&&n&&(n.$stencilList.push({x:t,y:e,width:i,height:r}),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPushMask(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,i,r,t,e,i,r,i,r))},r.prototype.popMask=function(){var t,e=this.currentBuffer;!this.contextLost&&e&&(t=e.$stencilList.pop(),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPopMask(),e.currentTexture=null,this.vao.cacheArrays(e,0,0,t.width,t.height,t.x,t.y,t.width,t.height,t.width,t.height))},r.prototype.clear=function(){this.drawCmdManager.pushClearColor()},r.prototype.enableScissor=function(t,e,i,r){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,i,r),n.$hasScissor=!0},r.prototype.disableScissor=function(){var t=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},r.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){var t=this.vao.getIndices(),e=this.vao.getVertices();v.isIOS14Device()||this.uploadVerticesArray(e),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var i=this.drawCmdManager.drawDataLen,r=0,n=0;n<i;n++){var o=this.drawCmdManager.drawData[n],a=0==o.type||1==o.type||2==o.type||3==o.type;v.isIOS14Device()&&!this.vao.isMesh()&&a?(this.uploadIndicesArray(t.subarray(0,o.count*this.vertexCountPerTriangle)),this.uploadVerticesArray(this.vao.vertices.subarray(r/this.vertexCountPerTriangle*this.triangleCountPerQuad*this.dataCountPerVertex,(r+o.count*this.vertexCountPerTriangle)/this.vertexCountPerTriangle*this.triangleCountPerQuad*this.dataCountPerVertex)),this.drawData(o,0),r+=o.count*this.vertexCountPerTriangle):r=this.drawData(o,r),7==o.type&&(this.activatedBuffer=o.buffer),a&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},r.prototype.drawData=function(t,e){if(t){var i,r=this.context,n=t.filter;switch(t.type){case 0:n?"custom"===n.type?i=v.EgretWebGLProgram.getProgram(r,n.$vertexSrc,n.$fragmentSrc,n.$shaderKey):"colorTransform"===n.type?i=t.texture[u.etc_alpha_mask]?(r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,t.texture[u.etc_alpha_mask]),v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.colorTransform_frag_etc_alphamask_frag,"colorTransform_frag_etc_alphamask_frag")):v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===n.type||"blurY"===n.type?i=v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.blur_frag,"blur"):"glow"===n.type&&(i=v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.glow_frag,"glow")):t.texture[u.etc_alpha_mask]?(i=v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.texture_etc_alphamask_frag,u.etc_alpha_mask),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,t.texture[u.etc_alpha_mask])):i=v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.texture_frag,"texture"),this.activeProgram(r,i),this.syncUniforms(i,n,t.textureWidth,t.textureHeight),e+=this.drawTextureElements(t,e);break;case 1:i=v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(r,i),this.syncUniforms(i,n,t.textureWidth,t.textureHeight),e+=this.drawRectElements(t,e);break;case 2:i=v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(r,i),this.syncUniforms(i,n,t.textureWidth,t.textureHeight),e+=this.drawPushMaskElements(t,e);break;case 3:i=v.EgretWebGLProgram.getProgram(r,v.EgretShaderLib.default_vert,v.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(r,i),this.syncUniforms(i,n,t.textureWidth,t.textureHeight),e+=this.drawPopMaskElements(t,e);break;case 4:this.setBlendMode(t.value);break;case 5:t.buffer.rootRenderTarget.resize(t.width,t.height),this.onResize(t.width,t.height);break;case 6:this.activatedBuffer&&(0==(i=this.activatedBuffer.rootRenderTarget).width&&0==i.height||i.clear(!0));break;case 7:this.activateBuffer(t.buffer,t.width,t.height);break;case 8:var o=this.activatedBuffer;o&&(o.rootRenderTarget&&o.rootRenderTarget.enabledStencil(),o.enableScissor(t.x,t.y,t.width,t.height));break;case 9:(o=this.activatedBuffer)&&o.disableScissor();break;case 10:r.bindTexture(r.TEXTURE_2D,t.texture),t.smoothing?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST))}return e}},r.prototype.activeProgram=function(t,e){if(u.pro.egret2dDriveMode||e!=this.currentProgram){t.useProgram(e.id);var i,r=e.attributes;for(i in r)"aVertexPosition"===i?(t.vertexAttribPointer(r.aVertexPosition.location,2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(r.aVertexPosition.location)):"aTextureCoord"===i?(t.vertexAttribPointer(r.aTextureCoord.location,2,t.FLOAT,!1,20,8),t.enableVertexAttribArray(r.aTextureCoord.location)):"aColor"===i&&(t.vertexAttribPointer(r.aColor.location,4,t.UNSIGNED_BYTE,!0,20,16),t.enableVertexAttribArray(r.aColor.location));this.currentProgram=e}},r.prototype.syncUniforms=function(t,e,i,r){var n,o=t.uniforms;e&&e.type;for(n in o)if("$filterScale"!=n)if("projectionVector"===n)o[n].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===n)o[n].setValue({x:i,y:r});else if("uSampler"===n)o[n].setValue(0);else if("uSamplerAlphaMask"===n)o[n].setValue(1);else{var a=e.$uniforms[n];if(void 0!==a){if("glow"==e.type||0==e.type.indexOf("blur"))if("blurX"==n||"blurY"==n||"dist"==n)a*=e.$uniforms.$filterScale||1;else if("blur"==n&&null!=a.x&&null!=a.y){var s={x:0,y:0};s.x=a.x*(null!=e.$uniforms.$filterScale?e.$uniforms.$filterScale:1),s.y=a.y*(null!=e.$uniforms.$filterScale?e.$uniforms.$filterScale:1),o[n].setValue(s);continue}o[n].setValue(a)}}},r.prototype.drawTextureElements=function(t,e){return u.sys.drawTextureElements(this,t,e)},r.prototype.drawRectElements=function(t,e){var i=this.context,t=3*t.count;return i.drawElements(i.TRIANGLES,t,i.UNSIGNED_SHORT,2*e),t},r.prototype.drawPushMaskElements=function(t,e){var i=this.context,r=3*t.count,n=this.activatedBuffer;return n&&(n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),i.clear(i.STENCIL_BUFFER_BIT)),t=n.stencilHandleCount,n.stencilHandleCount++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,t,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,t+1,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)),r},r.prototype.drawPopMaskElements=function(t,e){var i=this.context,r=3*t.count,t=this.activatedBuffer;return t&&(t.stencilHandleCount--,0==t.stencilHandleCount?t.disableStencil():(t=t.stencilHandleCount,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,t+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,t,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP))),r},r.prototype.setBlendMode=function(t){var e=this.context,t=r.blendModesForGL[t];t&&e.blendFunc(t[0],t[1])},r.prototype.drawTargetWidthFilters=function(t,e){var i=e,r=t.length;if(1<r)for(var n=0;n<r-1;n++){var o=t[n],a=e.rootRenderTarget.width,s=e.rootRenderTarget.height,a=v.WebGLRenderBuffer.create(a,s),s=Math.max(u.sys.DisplayList.$canvasScaleFactor,2);a.setTransform(s,0,0,s,0,0),a.globalAlpha=1,this.drawToRenderTarget(o,e,a),e!=i&&v.WebGLRenderBuffer.release(e),e=a}var h=t[r-1];this.drawToRenderTarget(h,e,this.currentBuffer),e!=i&&v.WebGLRenderBuffer.release(e)},r.prototype.drawToRenderTarget=function(t,e,i){var r,n,o,a,s,h,l;this.contextLost||(this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(i),n=(r=e).rootRenderTarget.width,o=e.rootRenderTarget.height,"blur"==t.type&&(l=t.blurXFilter,a=t.blurYFilter,t=0!=l.blurX&&0!=a.blurY?(s=v.WebGLRenderBuffer.create(n,o),h=Math.max(u.sys.DisplayList.$canvasScaleFactor,2),s.setTransform(1,0,0,1,0,0),s.transform(h,0,0,h,0,0),s.globalAlpha=1,this.drawToRenderTarget(t.blurXFilter,e,s),e!=r&&v.WebGLRenderBuffer.release(e),e=s,a):0===l.blurX?a:l),i.saveTransform(),l=Math.max(u.sys.DisplayList.$canvasScaleFactor,2),i.transform(1/l,0,0,1/l,0,0),i.transform(1,0,0,-1,0,o),i.currentTexture=e.rootRenderTarget.texture,this.vao.cacheArrays(i,0,0,n,o,0,0,n,o,n,o),i.restoreTransform(),this.drawCmdManager.pushDrawTexture(e.rootRenderTarget.texture,2,t,n,o),e!=r&&v.WebGLRenderBuffer.release(e),this.popBuffer())},r.initBlendMode=function(){(r.blendModesForGL={})["source-over"]=[1,771],r.blendModesForGL.lighter=[1,1],r.blendModesForGL["lighter-in"]=[770,771],r.blendModesForGL["destination-out"]=[0,771],r.blendModesForGL["destination-in"]=[0,770]},r.glContextId=0,r.blendModesForGL=null,t=r,v.WebGLRenderContext=t,__reflect(t.prototype,"egret.web.WebGLRenderContext",["egret.sys.RenderContext"]),t.initBlendMode(),u.sys.WebGLRenderContext=t}(egret=egret||{}),function(p){!function(n){var o,t=(o=p.HashObject,__extends(a,o),a.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},a.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},a.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},a.prototype.enableScissor=function(t,e,i,r){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,i,r),this.context.enableScissorTest(this.scissorRect))},a.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},a.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(a.prototype,"width",{get:function(){return(p.nativeRender?this.surface:this.rootRenderTarget).width},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return(p.nativeRender?this.surface:this.rootRenderTarget).height},enumerable:!0,configurable:!0}),a.prototype.resize=function(t,e,i){t=t||1,e=e||1,p.nativeRender?this.surface.resize(t,e):(this.context.pushBuffer(this),t==this.rootRenderTarget.width&&e==this.rootRenderTarget.height||(this.context.drawCmdManager.pushResize(this,t,e),this.rootRenderTarget.width=t,this.rootRenderTarget.height=e),this.root&&this.context.resize(t,e,i),this.context.clear(),this.context.popBuffer())},a.prototype.getPixels=function(t,e,i,r){void 0===i&&(i=1),void 0===r&&(r=1);var n,o=new Uint8Array(4*i*r);p.nativeRender?(egret_native.activateBuffer(this),egret_native.nrGetPixels(t,e,i,r,o),egret_native.activateBuffer(null)):(n=this.rootRenderTarget.useFrameBuffer,this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(t,this.height-e-r,i,r,o),this.rootRenderTarget.useFrameBuffer=n,this.rootRenderTarget.activate());for(var a=new Uint8Array(4*i*r),s=0;s<r;s++)for(var h=0;h<i;h++){var l=4*(i*(r-s-1)+h),u=4*(i*s+h),c=o[3+u];a[l]=Math.round(o[u]/c*255),a[1+l]=Math.round(o[1+u]/c*255),a[2+l]=Math.round(o[2+u]/c*255),a[3+l]=o[3+u]}return a},a.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},a.prototype.destroy=function(){this.context.destroy()},a.prototype.onRenderFinish=function(){this.$drawCalls=0},a.prototype.drawFrameBufferToSurface=function(t,e,i,r,n,o,a,s,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,i,r,n,o,a,s,i,r,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},a.prototype.drawSurfaceToFrameBuffer=function(t,e,i,r,n,o,a,s,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,i,r,n,o,a,s,i,r,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},a.prototype.clear=function(){this.context.pushBuffer(this),this.context.clear(),this.context.popBuffer()},a.prototype.setTransform=function(t,e,i,r,n,o){var a=this.globalMatrix;a.a=t,a.b=e,a.c=i,a.d=r,a.tx=n,a.ty=o},a.prototype.transform=function(t,e,i,r,n,o){var a=this.globalMatrix,s=a.a,h=a.b,l=a.c,u=a.d;1==t&&0==e&&0==i&&1==r||(a.a=t*s+e*l,a.b=t*h+e*u,a.c=i*s+r*l,a.d=i*h+r*u),a.tx=n*s+o*l+a.tx,a.ty=n*h+o*u+a.ty},a.prototype.useOffset=function(){0==this.$offsetX&&0==this.$offsetY||(this.globalMatrix.append(1,0,0,1,this.$offsetX,this.$offsetY),this.$offsetX=this.$offsetY=0)},a.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},a.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},a.create=function(t,e){var i,r=s.pop();return r?(r.resize(t,e),(i=r.globalMatrix).a=1,i.b=0,i.c=0,i.d=1,i.tx=0,i.ty=0,r.globalAlpha=1,r.$offsetX=0,r.$offsetY=0):(r=new a(t,e)).$computeDrawCall=!1,r},a.release=function(t){s.push(t)},a.autoClear=!0,a);function a(t,e,i){var r=o.call(this)||this;return r.currentTexture=null,r.globalAlpha=1,r.globalTintColor=16777215,r.stencilState=!1,r.$stencilList=[],r.stencilHandleCount=0,r.$scissorState=!1,r.scissorRect=new p.Rectangle,r.$hasScissor=!1,r.$drawCalls=0,r.$computeDrawCall=!1,r.globalMatrix=new p.Matrix,r.savedGlobalMatrix=new p.Matrix,r.$offsetX=0,r.$offsetY=0,r.context=n.WebGLRenderContext.getInstance(t,e),p.nativeRender?(r.surface=i?r.context.surface:new egret_native.NativeRenderSurface(r,t,e,i),r.rootRenderTarget=null):(r.rootRenderTarget=new n.WebGLRenderTarget(r.context.context,3,3),t&&e&&r.resize(t,e),r.root=i,r.root?(r.context.pushBuffer(r),r.surface=r.context.surface,r.$computeDrawCall=!0):((i=r.context.activatedBuffer)&&i.rootRenderTarget.activate(),r.rootRenderTarget.initFrameBuffer(),r.surface=r.rootRenderTarget)),r}n.WebGLRenderBuffer=t,__reflect(t.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var s=[]}(p.web||(p.web={}))}(egret=egret||{}),function(b){var T,g,y,m,t;function e(){this.wxiOS10=!1,this.nestLevel=0}T=b.web||(b.web={}),g=["source-over","lighter","destination-out"],y="source-over",m=[],e.prototype.render=function(t,e,i,r){this.nestLevel++;var n=e,e=n.context;e.pushBuffer(n),n.transform(i.a,i.b,i.c,i.d,0,0),this.drawDisplayObject(t,n,i.tx,i.ty,!0),e.$drawWebGL();t=n.$drawCalls;n.onRenderFinish(),e.popBuffer();e=b.Matrix.create();if(i.$invertInto(e),n.transform(e.a,e.b,e.c,e.d,0,0),b.Matrix.release(e),this.nestLevel--,0===this.nestLevel){6<m.length&&(m.length=6);for(var o=m.length,a=0;a<o;a++)m[a].resize(0,0)}return t},e.prototype.drawDisplayObject=function(t,e,i,r,n){var o=0,a=t.$displayList,s=a&&!n?((t.$cacheDirty||t.$renderDirty||a.$canvasScaleX!=b.sys.DisplayList.$canvasScaleX||a.$canvasScaleY!=b.sys.DisplayList.$canvasScaleY)&&(o+=a.drawToSurface()),a.$renderNode):t.$renderDirty?t.$getRenderNode():t.$renderNode;if(t.$cacheDirty=!1,s){switch(o++,e.$offsetX=i,e.$offsetY=r,s.type){case 1:this.renderBitmap(s,e);break;case 2:this.renderText(s,e);break;case 3:this.renderGraphics(s,e);break;case 4:this.renderGroup(s,e);break;case 5:this.renderMesh(s,e);break;case 6:this.renderNormalBitmap(s,e)}e.$offsetX=0,e.$offsetY=0}if(a&&!n)return o;var h=t.$children;if(h){t.sortableChildren&&t.$sortDirty&&t.sortChildren();for(var l=h.length,u=0;u<l;u++){var c=h[u],p=void 0,d=void 0,f=void 0,_=void 0;1!=c.$alpha&&(f=e.globalAlpha,e.globalAlpha*=c.$alpha),16777215!==c.tint&&(_=e.globalTintColor,e.globalTintColor=c.$tintRGB);var g,y,m=void 0;switch(d=c.$useTranslate?(y=c.$getMatrix(),p=i+c.$x,d=r+c.$y,g=e.globalMatrix,(m=b.Matrix.create()).a=g.a,m.b=g.b,m.c=g.c,m.d=g.d,m.tx=g.tx,m.ty=g.ty,e.transform(y.a,y.b,y.c,y.d,p,d),p=-c.$anchorOffsetX,-c.$anchorOffsetY):(p=i+c.$x-c.$anchorOffsetX,r+c.$y-c.$anchorOffsetY),c.$renderMode){case 1:break;case 2:o+=this.drawWithFilter(c,e,p,d);break;case 3:o+=this.drawWithClip(c,e,p,d);break;case 4:o+=this.drawWithScrollRect(c,e,p,d);break;default:o+=this.drawDisplayObject(c,e,p,d)}f&&(e.globalAlpha=f),_&&(e.globalTintColor=_),m&&((y=e.globalMatrix).a=m.a,y.b=m.b,y.c=m.c,y.d=m.d,y.tx=m.tx,y.ty=m.ty,b.Matrix.release(m))}}return o},e.prototype.drawWithFilter=function(t,e,i,r){var n=0;if(t.$children&&0==t.$children.length&&(!t.$renderNode||0==t.$renderNode.$getRenderCount()))return n;var o,a=t.$filters,s=0!==t.$blendMode;s&&(o=(o=g[t.$blendMode])||y);var h=t.$getOriginalBounds(),l=h.x,u=h.y,c=h.width,p=h.height;if(c<=0||p<=0)return n;if(!t.mask&&1==a.length&&("colorTransform"==a[0].type||"custom"===a[0].type&&0===a[0].padding)){h=this.getRenderCount(t);if(!t.$children||1==h)return s&&e.context.setGlobalCompositeOperation(o),e.context.$filter=a[0],t.$mask?n+=this.drawWithClip(t,e,i,r):t.$scrollRect||t.$maskRect?n+=this.drawWithScrollRect(t,e,i,r):n+=this.drawDisplayObject(t,e,i,r),e.context.$filter=null,s&&e.context.setGlobalCompositeOperation(y),n}var d=Math.max(b.sys.DisplayList.$canvasScaleFactor,2);a.forEach(function(t){(t instanceof b.GlowFilter||t instanceof b.BlurFilter)&&(t.$uniforms.$filterScale=d,"blur"==t.type&&((t=t).blurXFilter.$uniforms.$filterScale=d,t.blurYFilter.$uniforms.$filterScale=d))});p=this.createRenderBuffer(d*c,d*p);return p.saveTransform(),p.transform(d,0,0,d,0,0),p.context.pushBuffer(p),t.$mask?n+=this.drawWithClip(t,p,-l,-u):t.$scrollRect||t.$maskRect?n+=this.drawWithScrollRect(t,p,-l,-u):n+=this.drawDisplayObject(t,p,-l,-u),p.context.popBuffer(),p.restoreTransform(),0<n&&(s&&e.context.setGlobalCompositeOperation(o),n++,e.$offsetX=i+l,e.$offsetY=r+u,r=b.Matrix.create(),u=e.globalMatrix,r.a=u.a,r.b=u.b,r.c=u.c,r.d=u.d,r.tx=u.tx,r.ty=u.ty,e.useOffset(),e.context.drawTargetWidthFilters(a,p),u.a=r.a,u.b=r.b,u.c=r.c,u.d=r.d,u.tx=r.tx,u.ty=r.ty,b.Matrix.release(r),s&&e.context.setGlobalCompositeOperation(y)),m.push(p),n},e.prototype.getRenderCount=function(t){var e=0,i=t.$getRenderNode();if(i&&(e+=i.$getRenderCount()),t.$children)for(var r=0,n=t.$children;r<n.length;r++){var o=n[r],a=o.$filters;if(a&&0<a.length)return 2;o.$children?e+=this.getRenderCount(o):(o=o.$getRenderNode())&&(e+=o.$getRenderCount())}return e},e.prototype.drawWithClip=function(t,e,i,r){var n,o=0,a=0!==t.$blendMode;a&&(n=(n=g[t.$blendMode])||y);var s=t.$scrollRect||t.$maskRect,h=t.$mask;if(h){var l=h.$getMatrix();if(0==l.a&&0==l.b||0==l.c&&0==l.d)return o}if(h||t.$children&&0!=t.$children.length){var u=t.$getOriginalBounds(),c=u.x,p=u.y,d=u.width,l=u.height;if(d<=0||l<=0)return o;var f,_,u=this.createRenderBuffer(d,l);return u.context.pushBuffer(u),o+=this.drawDisplayObject(t,u,-c,-p),h&&((_=this.createRenderBuffer(d,l)).context.pushBuffer(_),(f=b.Matrix.create()).copyFrom(h.$getConcatenatedMatrix()),h.$getConcatenatedMatrixAt(t,f),f.translate(-c,-p),_.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),b.Matrix.release(f),o+=this.drawDisplayObject(h,_,0,0),_.context.popBuffer(),u.context.setGlobalCompositeOperation("destination-in"),u.setTransform(1,0,0,-1,0,_.height),h=_.rootRenderTarget.width,f=_.rootRenderTarget.height,u.context.drawTexture(_.rootRenderTarget.texture,0,0,h,f,0,0,h,f,h,f),u.setTransform(1,0,0,1,0,0),u.context.setGlobalCompositeOperation("source-over"),_.setTransform(1,0,0,1,0,0),m.push(_)),u.context.setGlobalCompositeOperation(y),u.context.popBuffer(),0<o&&(o++,a&&e.context.setGlobalCompositeOperation(n),s&&e.context.pushMask(s.x+i,s.y+r,s.width,s.height),f=b.Matrix.create(),_=e.globalMatrix,f.a=_.a,f.b=_.b,f.c=_.c,f.d=_.d,f.tx=_.tx,f.ty=_.ty,_.append(1,0,0,-1,i+c,r+p+u.height),c=u.rootRenderTarget.width,p=u.rootRenderTarget.height,e.context.drawTexture(u.rootRenderTarget.texture,0,0,c,p,0,0,c,p,c,p),s&&u.context.popMask(),a&&e.context.setGlobalCompositeOperation(y),(p=e.globalMatrix).a=f.a,p.b=f.b,p.c=f.c,p.d=f.d,p.tx=f.tx,p.ty=f.ty,b.Matrix.release(f)),m.push(u),o}return s&&e.context.pushMask(s.x+i,s.y+r,s.width,s.height),a&&e.context.setGlobalCompositeOperation(n),o+=this.drawDisplayObject(t,e,i,r),a&&e.context.setGlobalCompositeOperation(y),s&&e.context.popMask(),o},e.prototype.drawWithScrollRect=function(t,e,i,r){var n=0,o=t.$scrollRect||t.$maskRect;if(o.isEmpty())return n;t.$scrollRect&&(i-=o.x,r-=o.y);var a,s,h,l,u,c,p,d,f,_,g,y,m,v=e.globalMatrix,b=e.context,T=!1;return e.$hasScissor||0!=v.b||0!=v.c?e.context.pushMask(o.x+i,o.y+r,o.width,o.height):(a=v.a,s=v.d,d=v.tx,g=v.ty,_=o.x+i,p=o.y+r,h=_+o.width,f=p+o.height,m=c=u=l=void 0,m=1==a&&1==s?(l=_+d,u=p+g,c=h+d,f+g):(y=0,(v=a*h+d)<(o=a*_+d)&&(y=o,o=v,v=y),(_=a*_+d)<(d=a*h+d)&&(y=d,d=_,_=y),l=o<d?o:d,c=_<v?v:_,(p=_=s*p+g)<_&&(y=_,_=p,p=y),(g=f=s*f+g)<f&&(y=f,f=g,g=y),u=_<f?_:f,g<p?p:g),b.enableScissor(l,-m+e.height,c-l,m-u),T=!0),n+=this.drawDisplayObject(t,e,i,r),T?b.disableScissor():b.popMask(),n},e.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e;n.context.pushBuffer(n),n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,e,0,0,r),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},e.prototype.drawDisplayToBuffer=function(t,e,i){e.context.pushBuffer(e),i&&e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);var r,n=0;if(r=t.$renderDirty?t.$getRenderNode():t.$renderNode)switch(n++,r.type){case 1:this.renderBitmap(r,e);break;case 2:this.renderText(r,e);break;case 3:this.renderGraphics(r,e);break;case 4:this.renderGroup(r,e);break;case 5:this.renderMesh(r,e);break;case 6:this.renderNormalBitmap(r,e)}var o=t.$children;if(o)for(var a=o.length,s=0;s<a;s++){var h=o[s];switch(h.$renderMode){case 1:break;case 2:n+=this.drawWithFilter(h,e,0,0);break;case 3:n+=this.drawWithClip(h,e,0,0);break;case 4:n+=this.drawWithScrollRect(h,e,0,0);break;default:n+=this.drawDisplayObject(h,e,0,0)}}return e.context.$drawWebGL(),e.onRenderFinish(),e.context.popBuffer(),n},e.prototype.renderNode=function(t,e,i,r,n){switch(e.$offsetX=i,e.$offsetY=r,t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,n);break;case 4:this.renderGroup(t,e);break;case 5:this.renderMesh(t,e);break;case 6:this.renderNormalBitmap(t,e)}},e.prototype.renderNormalBitmap=function(t,e){var i=t.image;i&&e.context.drawImage(i,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX,t.drawY,t.drawW,t.drawH,t.imageWidth,t.imageHeight,t.rotated,t.smoothing)},e.prototype.renderBitmap=function(t,e){var i=t.image;if(i){var r,n,o,a,s=t.drawData,h=s.length,l=0,u=t.matrix,c=t.blendMode,p=t.alpha;if(u&&(n=b.Matrix.create(),o=e.globalMatrix,n.a=o.a,n.b=o.b,n.c=o.c,n.d=o.d,n.tx=o.tx,n.ty=o.ty,r=e.$offsetX,o=e.$offsetY,e.useOffset(),e.transform(u.a,u.b,u.c,u.d,u.tx,u.ty)),c&&e.context.setGlobalCompositeOperation(g[c]),p==p&&(a=e.globalAlpha,e.globalAlpha*=p),t.filter){for(e.context.$filter=t.filter;l<h;)e.context.drawImage(i,s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],t.imageWidth,t.imageHeight,t.rotated,t.smoothing);e.context.$filter=null}else for(;l<h;)e.context.drawImage(i,s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],t.imageWidth,t.imageHeight,t.rotated,t.smoothing);c&&e.context.setGlobalCompositeOperation(y),p==p&&(e.globalAlpha=a),u&&((u=e.globalMatrix).a=n.a,u.b=n.b,u.c=n.c,u.d=n.d,u.tx=n.tx,u.ty=n.ty,e.$offsetX=r,e.$offsetY=o,b.Matrix.release(n))}},e.prototype.renderMesh=function(t,e){var i,r,n,o,a=t.image,s=t.drawData,h=s.length,l=0,u=t.matrix,c=t.blendMode,p=t.alpha;if(u&&(r=b.Matrix.create(),n=e.globalMatrix,r.a=n.a,r.b=n.b,r.c=n.c,r.d=n.d,r.tx=n.tx,r.ty=n.ty,i=e.$offsetX,n=e.$offsetY,e.useOffset(),e.transform(u.a,u.b,u.c,u.d,u.tx,u.ty)),c&&e.context.setGlobalCompositeOperation(g[c]),p==p&&(o=e.globalAlpha,e.globalAlpha*=p),t.filter){for(e.context.$filter=t.filter;l<h;)e.context.drawMesh(a,s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],t.imageWidth,t.imageHeight,t.uvs,t.vertices,t.indices,t.bounds,t.rotated,t.smoothing);e.context.$filter=null}else for(;l<h;)e.context.drawMesh(a,s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],s[l++],t.imageWidth,t.imageHeight,t.uvs,t.vertices,t.indices,t.bounds,t.rotated,t.smoothing);c&&e.context.setGlobalCompositeOperation(y),p==p&&(e.globalAlpha=o),u&&((u=e.globalMatrix).a=r.a,u.b=r.b,u.c=r.c,u.d=r.d,u.tx=r.tx,u.ty=r.ty,e.$offsetX=i,e.$offsetY=n,b.Matrix.release(r))},e.prototype.___renderText____=function(t,e){var i=t.width-t.x,r=t.height-t.y;if(!(i<=0||r<=0)&&i&&r&&0!==t.drawData.length){var n=b.sys.DisplayList.$canvasScaleX,o=b.sys.DisplayList.$canvasScaleY,a=e.context.$maxTextureSize;a<i*n&&(n*=a/(i*n)),a<r*o&&(o*=a/(r*o)),i*=n,r*=o;i=t.x*n,r=t.y*o;t.$canvasScaleX===n&&t.$canvasScaleY===o||(t.$canvasScaleX=n,t.$canvasScaleY=o,t.dirtyRender=!0),(i||r)&&e.transform(1,0,0,1,i/n,r/o),t.dirtyRender&&T.TextAtlasRender.analysisTextNodeAndFlushDrawLabel(t);var s=t[T.property_drawLabel];if(s&&0<s.length){for(var h,l,u,c,p,d,f=e.$offsetX,_=e.$offsetY,g=0,y=s.length;g<y;++g){l=(h=s[g]).anchorX,u=h.anchorY,c=h.textBlocks,e.$offsetX=f+l;for(var m=0,v=c.length;m<v;++m)p=c[m],0<m&&(e.$offsetX-=p.canvasWidthOffset),e.$offsetY=_+u-(p.measureHeight+(p.stroke2?p.canvasHeightOffset:0))/2,d=p.line.page,e.context.drawTexture(d.webGLTexture,p.u,p.v,p.contentWidth,p.contentHeight,0,0,p.contentWidth,p.contentHeight,d.pageWidth,d.pageHeight),e.$offsetX+=p.contentWidth-p.canvasWidthOffset}e.$offsetX=f,e.$offsetY=_}(i||r)&&e.transform(1,0,0,1,-i/n,-r/o),t.dirtyRender=!1}},e.prototype.renderText=function(t,e){var i,r,n,o,a,s,h,l;T.textAtlasRenderEnable?this.___renderText____(t,e):(i=t.width-t.x,r=t.height-t.y,i<=0||r<=0||!i||!r||0==t.drawData.length||(n=b.sys.DisplayList.$canvasScaleX,o=b.sys.DisplayList.$canvasScaleY,(s=e.context.$maxTextureSize)<i*n&&(n*=s/(i*n)),s<r*o&&(o*=s/(r*o)),i*=n,r*=o,a=t.x*n,s=t.y*o,t.$canvasScaleX==n&&t.$canvasScaleY==o||(t.$canvasScaleX=n,t.$canvasScaleY=o,t.dirtyRender=!0),this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new b.CanvasRenderer),t.dirtyRender&&(this.canvasRenderBuffer=new T.CanvasRenderBuffer(i,r))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?t.dirtyRender&&this.canvasRenderBuffer.resize(i,r):(this.canvasRenderer=new b.CanvasRenderer,this.canvasRenderBuffer=new T.CanvasRenderBuffer(i,r)),this.canvasRenderBuffer.context&&(1==n&&1==o||this.canvasRenderBuffer.context.setTransform(n,0,0,o,0,0),a||s?(t.dirtyRender&&this.canvasRenderBuffer.context.setTransform(n,0,0,o,-a,-s),e.transform(1,0,0,1,a/n,s/o)):1==n&&1==o||this.canvasRenderBuffer.context.setTransform(n,0,0,o,0,0),t.dirtyRender&&(l=this.canvasRenderBuffer.surface,this.canvasRenderer.renderText(t,this.canvasRenderBuffer.context),this.wxiOS10?(l.isCanvas=!0,t.$texture=l):(h=t.$texture)?e.context.updateTexture(h,l):(h=e.context.createTexture(l),t.$texture=h),t.$textureWidth=l.width,t.$textureHeight=l.height),h=t.$textureWidth,l=t.$textureHeight,e.context.drawTexture(t.$texture,0,0,h,l,0,0,h/n,l/o,h,l),(a||s)&&(t.dirtyRender&&this.canvasRenderBuffer.context.setTransform(n,0,0,o,0,0),e.transform(1,0,0,1,-a/n,-s/o)),t.dirtyRender=!1)))},e.prototype.renderGraphics=function(t,e,i){var r,n,o,a,s,h=t.width,l=t.height;h<=0||l<=0||!h||!l||0==t.drawData.length||(r=b.sys.DisplayList.$canvasScaleX,n=b.sys.DisplayList.$canvasScaleY,(h*r<1||l*n<1)&&(r=n=1),t.$canvasScaleX==r&&t.$canvasScaleY==n||(t.$canvasScaleX=r,t.$canvasScaleY=n,t.dirtyRender=!0),h*=r,l*=n,r*=(o=Math.ceil(h))/h,n*=(s=Math.ceil(l))/l,h=o,l=s,this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new b.CanvasRenderer),t.dirtyRender&&(this.canvasRenderBuffer=new T.CanvasRenderBuffer(h,l))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?t.dirtyRender&&this.canvasRenderBuffer.resize(h,l):(this.canvasRenderer=new b.CanvasRenderer,this.canvasRenderBuffer=new T.CanvasRenderBuffer(h,l)),this.canvasRenderBuffer.context&&(1==r&&1==n||this.canvasRenderBuffer.context.setTransform(r,0,0,n,0,0),(t.x||t.y)&&((t.dirtyRender||i)&&this.canvasRenderBuffer.context.translate(-t.x,-t.y),e.transform(1,0,0,1,t.x,t.y)),s=this.canvasRenderBuffer.surface,i?(this.canvasRenderer.renderGraphics(t,this.canvasRenderBuffer.context,!0),a=void 0,a=this.wxiOS10?(s.isCanvas=!0,s):(b.WebGLUtils.deleteWebGLTexture(s),e.context.getWebGLTexture(s)),e.context.drawTexture(a,0,0,h,l,0,0,h,l,s.width,s.height)):(t.dirtyRender&&(this.canvasRenderer.renderGraphics(t,this.canvasRenderBuffer.context),this.wxiOS10?(s.isCanvas=!0,t.$texture=s):(a=t.$texture)?e.context.updateTexture(a,s):(a=e.context.createTexture(s),t.$texture=a),t.$textureWidth=s.width,t.$textureHeight=s.height),a=t.$textureWidth,s=t.$textureHeight,e.context.drawTexture(t.$texture,0,0,a,s,0,0,a/r,s/n,a,s)),(t.x||t.y)&&((t.dirtyRender||i)&&this.canvasRenderBuffer.context.translate(t.x,t.y),e.transform(1,0,0,1,-t.x,-t.y)),i||(t.dirtyRender=!1)))},e.prototype.renderGroup=function(t,e){var i,r,n,o=t.matrix;o&&(r=b.Matrix.create(),n=e.globalMatrix,r.a=n.a,r.b=n.b,r.c=n.c,r.d=n.d,r.tx=n.tx,r.ty=n.ty,i=e.$offsetX,n=e.$offsetY,e.useOffset(),e.transform(o.a,o.b,o.c,o.d,o.tx,o.ty));for(var a=t.drawData,s=a.length,h=0;h<s;h++){var l=a[h];this.renderNode(l,e,e.$offsetX,e.$offsetY)}o&&((o=e.globalMatrix).a=r.a,o.b=r.b,o.c=r.c,o.d=r.d,o.tx=r.tx,o.ty=r.ty,e.$offsetX=i,e.$offsetY=n,b.Matrix.release(r))},e.prototype.createRenderBuffer=function(t,e){var i=m.pop();return i?(i.resize(t,e),i.setTransform(1,0,0,1,0,0)):(i=new T.WebGLRenderBuffer(t,e)).$computeDrawCall=!1,i},e.prototype.renderClear=function(){var t=T.WebGLRenderContext.getInstance(),e=t.context;t.$beforeRender();var i=t.surface.width,t=t.surface.height;e.viewport(0,0,i,t)},t=e,T.WebGLRenderer=t,__reflect(t.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(egret=egret||{}),function(d){!function(t){var l,h=(l=d.HashObject,__extends(e,l),Object.defineProperty(e.prototype,"border",{get:function(){return this._border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this.line?this.line.page:null},enumerable:!0,configurable:!0}),e.prototype.updateUV=function(){var t=this.line;return!!t&&(this.u=t.x+this.x+ +this.border,this.v=t.y+this.y+ +this.border,!0)},Object.defineProperty(e.prototype,"subImageOffsetX",{get:function(){var t=this.line;return t?t.x+this.x+this.border:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subImageOffsetY",{get:function(){var t=this.line;return t?t.y+this.y+this.border:0},enumerable:!0,configurable:!0}),e);function e(t,e,i,r,n,o,a,s){var h=l.call(this)||this;return h._width=0,h._height=0,h._border=0,h.line=null,h.x=0,h.y=0,h.u=0,h.v=0,h.tag="",h.measureWidth=0,h.measureHeight=0,h.canvasWidthOffset=0,h.canvasHeightOffset=0,h.stroke2=0,h._width=t,h._height=e,h._border=s,h.measureWidth=i,h.measureHeight=r,h.canvasWidthOffset=n,h.canvasHeightOffset=o,h.stroke2=a,h}t.TextBlock=h,__reflect(h.prototype,"egret.web.TextBlock");var i,u=(i=d.HashObject,__extends(r,i),r.prototype.isCapacityOf=function(t){if(!t)return!1;var e=0,i=this.lastTextBlock();return i&&(e=i.x+i.width,i.y),!(e+t.width>this.maxWidth)&&!(0<this.dynamicMaxHeight&&(t.height>this.dynamicMaxHeight||t.height/this.dynamicMaxHeight<.5))},r.prototype.lastTextBlock=function(){var t=this.textBlocks;return 0<t.length?t[t.length-1]:null},r.prototype.addTextBlock=function(t,e){if(!t)return!1;if(e&&!this.isCapacityOf(t))return!1;var i=0,r=0,e=this.lastTextBlock();return e&&(i=e.x+e.width,r=e.y),t.x=i,t.y=r,(t.line=this).textBlocks.push(t),this.dynamicMaxHeight=Math.max(this.dynamicMaxHeight,t.height),!0},r);function r(t){var e=i.call(this)||this;return e.page=null,e.textBlocks=[],e.dynamicMaxHeight=0,e.maxWidth=0,e.x=0,e.y=0,e.maxWidth=t,e}t.Line=u,__reflect(u.prototype,"egret.web.Line");var n,o=(n=d.HashObject,__extends(a,n),a.prototype.addLine=function(t){if(!t)return!1;var e=0,i=0,r=this.lines;return 0<r.length&&(e=(r=r[r.length-1]).x,i=r.y+r.dynamicMaxHeight),t.maxWidth>this.pageWidth?(console.error("line.maxWidth = "+t.maxWidth+", this.pageWidth = "+this.pageWidth),!1):!(i+t.dynamicMaxHeight>this.pageHeight)&&(t.x=e,t.y=i,(t.page=this).lines.push(t),!0)},a);function a(t,e){var i=n.call(this)||this;return i.lines=[],i.pageWidth=0,i.pageHeight=0,i.webGLTexture=null,i.pageWidth=t,i.pageHeight=e,i}t.Page=o,__reflect(o.prototype,"egret.web.Page");var s,c=(s=d.HashObject,__extends(p,s),p.prototype.addTextBlock=function(t){var e=this._addTextBlock(t);if(!e)return!1;t.updateUV();for(var i=!1,r=e,e=this._sortLines,n=0,o=e;n<o.length;n++)if(o[n]===r[1]){i=!0;break}return i||e.push(r[1]),this.sort(),!0},p.prototype._addTextBlock=function(t){if(!t)return null;if(t.width>this._maxSize||t.height>this._maxSize)return null;for(var e=this._sortLines,i=0,r=e.length;i<r;++i){var n=e[i];if(n.isCapacityOf(t)&&n.addTextBlock(t,!1))return[n.page,n]}var o=new u(this._maxSize);if(!o.addTextBlock(t,!0))return console.error("_addTextBlock !newLine.addTextBlock(textBlock, true)"),null;for(var a=this._pages,i=0,s=a.length;i<s;++i){var h=a[i];if(h.addLine(o))return[h,o]}var l=this.createPage(this._maxSize,this._maxSize);return l.addLine(o)?[l,o]:(console.error("_addText newPage.addLine failed"),null)},p.prototype.createPage=function(t,e){e=new o(t,e);return this._pages.push(e),e},p.prototype.sort=function(){this._sortLines.length<=1||(this._sortLines=this._sortLines.sort(function(t,e){return t.dynamicMaxHeight<e.dynamicMaxHeight?-1:1}))},p.prototype.createTextBlock=function(t,e,i,r,n,o,a,s){s=new h(e,i,r,n,o,a,s,this._border);return this.addTextBlock(s)?(s.tag=t,s):null},p);function p(t,e){var i=s.call(this)||this;return i._pages=[],i._sortLines=[],i._maxSize=1024,i._border=1,i._maxSize=t,i._border=e,i}t.Book=c,__reflect(c.prototype,"egret.web.Book")}(d.web||(d.web={}))}(egret=egret||{}),function(m){!function(f){f.textAtlasRenderEnable=!1,f.__textAtlasRender__=null;f.property_drawLabel="DrawLabel";var e,_=(e=m.HashObject,__extends(r,e),r.prototype.clear=function(){this.anchorX=0,this.anchorY=0,this.textBlocks.length=0},r.create=function(){var t=r.pool;return 0===t.length&&t.push(new r),t.pop()},r.back=function(t,e){var i;t&&(i=r.pool,e&&0<=i.indexOf(t)?console.error("DrawLabel.back repeat"):(t.clear(),i.push(t)))},r.pool=[],r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.anchorX=0,t.anchorY=0,t.textBlocks=[],t}f.DrawLabel=_,__reflect(_.prototype,"egret.web.DrawLabel");var a,g=(a=m.HashObject,__extends(t,a),t);function t(t,e){var i=a.call(this)||this;i.format=null,i.textColor=t.textColor,i.strokeColor=t.strokeColor,i.size=t.size,i.stroke=t.stroke,i.bold=t.bold,i.italic=t.italic,i.fontFamily=t.fontFamily,i.format=e,i.font=m.getFontString(t,i.format);var r=e.textColor||t.textColor,n=e.strokeColor||t.strokeColor,o=e.stroke||t.stroke,t=e.size||t.size;return i.description=i.font+"-"+t,i.description+="-"+m.toColorString(r),i.description+="-"+m.toColorString(n),o&&(i.description+="-"+2*o),i}__reflect(g.prototype,"StyleInfo");var i,n=(i=m.HashObject,__extends(o,i),o.prototype.reset=function(t,e){return this.char=t,this.styleInfo=e,this.hashCodeString=t+":"+e.description,this.charWithStyleHashCode=m.NumberUtils.convertStringToHashCode(this.hashCodeString),this.canvasWidthOffset=0,this.canvasHeightOffset=0,this.stroke2=0,this},o.prototype.measureAndDraw=function(t){var e,i,r,n,o,a,s=t;s&&(e=this.char,i=(a=this.styleInfo.format).textColor||this.styleInfo.textColor,r=a.strokeColor||this.styleInfo.strokeColor,n=a.stroke||this.styleInfo.stroke,o=a.size||this.styleInfo.size,this.measureWidth=this.measure(e,this.styleInfo,o),this.measureHeight=o,t=this.measureWidth,a=this.measureHeight,0<(o=2*n)&&(t+=2*o,a+=2*o),this.stroke2=o,s.width=t=Math.ceil(t)+4,s.height=a=Math.ceil(a)+4,this.canvasWidthOffset=(s.width-this.measureWidth)/2,this.canvasHeightOffset=(s.height-this.measureHeight)/2,a=Math.pow(10,3),this.canvasWidthOffset=Math.floor(this.canvasWidthOffset*a)/a,this.canvasHeightOffset=Math.floor(this.canvasHeightOffset*a)/a,(a=m.sys.getContext2d(s)).save(),a.textAlign="center",a.textBaseline="middle",a.lineJoin="round",a.font=this.styleInfo.font,a.fillStyle=m.toColorString(i),a.strokeStyle=m.toColorString(r),a.clearRect(0,0,s.width,s.height),n&&(a.lineWidth=2*n,a.strokeText(e,s.width/2,s.height/2)),a.fillText(e,s.width/2,s.height/2),a.restore())},o.prototype.measure=function(t,e,i){var r=o.chineseCharactersRegExp.test(t);if(r&&o.chineseCharacterMeasureFastMap[e.font])return o.chineseCharacterMeasureFastMap[e.font];i=m.sys.measureText(t,e.fontFamily,i||e.size,e.bold,e.italic);return r&&(o.chineseCharacterMeasureFastMap[e.font]=i),i},o.chineseCharactersRegExp=new RegExp("^[\u4e00-\u9fa5]$"),o.chineseCharacterMeasureFastMap={},o);function o(){var t=null!==i&&i.apply(this,arguments)||this;return t.char="",t.styleInfo=null,t.hashCodeString="",t.charWithStyleHashCode=0,t.measureWidth=0,t.measureHeight=0,t.canvasWidthOffset=0,t.canvasHeightOffset=0,t.stroke2=0,t}__reflect(n.prototype,"CharImageRender");var s,h=(s=m.HashObject,__extends(y,s),y.analysisTextNodeAndFlushDrawLabel=function(t){if(t){var e;f.__textAtlasRender__||(e=m.web.WebGLRenderContext.getInstance(0,0),f.__textAtlasRender__=new y(e,512,1)),t[f.property_drawLabel]=t[f.property_drawLabel]||[];for(var i=t[f.property_drawLabel],r=0,n=i;r<n.length;r++){var o=n[r];_.back(o,!1)}i.length=0;for(var a=t.drawData,s=[],h=0,l=a.length;h<l;h+=4){var u=a[h+0],c=a[h+1],p=a[h+2],d=a[h+3]||{};s.length=0,f.__textAtlasRender__.convertLabelStringToTextAtlas(p,new g(t,d),s),(o=_.create()).anchorX=u,o.anchorY=c,o.textBlocks=[].concat(s),i.push(o)}}},y.prototype.convertLabelStringToTextAtlas=function(t,e,i){for(var r=this.canvas,n=this.charImageRender,o=this.textBlockMap,a=0,s=t;a<s.length;a++){var h,l,u=s[a];n.reset(u,e),o[n.charWithStyleHashCode]?i.push(o[n.charWithStyleHashCode]):(n.measureAndDraw(r),(h=this.book.createTextBlock(u,r.width,r.height,n.measureWidth,n.measureHeight,n.canvasWidthOffset,n.canvasHeightOffset,n.stroke2))&&(i.push(h),(l=(o[n.charWithStyleHashCode]=h).page).webGLTexture||(l.webGLTexture=this.createTextTextureAtlas(l.pageWidth,l.pageHeight,!1)),u=this.webglRenderContext.context,(l.webGLTexture[m.glContext]=u).bindTexture(u.TEXTURE_2D,l.webGLTexture),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),l.webGLTexture[m.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,u.texSubImage2D(u.TEXTURE_2D,0,h.subImageOffsetX,h.subImageOffsetY,u.RGBA,u.UNSIGNED_BYTE,r),u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)))}},y.prototype.createTextTextureAtlas=function(t,e,i){var r,n=null;return(n=i?(r=m.sys.createCanvas(t,t),(i=m.sys.getContext2d(r)).fillStyle="black",i.fillRect(0,0,t,t),m.sys.createTexture(this.webglRenderContext,r)):m.sys._createTexture(this.webglRenderContext,t,e,null))&&this.textAtlasTextureCache.push(n),n},Object.defineProperty(y.prototype,"canvas",{get:function(){return this._canvas||(this._canvas=m.sys.createCanvas(24,24)),this._canvas},enumerable:!0,configurable:!0}),y);function y(t,e,i){var r=s.call(this)||this;return r.book=null,r.charImageRender=new n,r.textBlockMap={},r._canvas=null,r.textAtlasTextureCache=[],r.webglRenderContext=null,r.webglRenderContext=t,r.book=new f.Book(e,i),r}f.TextAtlasRender=h,__reflect(h.prototype,"egret.web.TextAtlasRender")}(m.web||(m.web={}))}(egret=egret||{}),function(t){var e;function i(t,e,i){this.gl=t,this.name=i.name,this.type=i.type,this.size=i.size,this.location=t.getAttribLocation(e,this.name),this.count=0,this.initCount(t),this.format=t.FLOAT,this.initFormat(t)}e=t.web||(t.web={}),i.prototype.initCount=function(t){switch(this.type){case 5126:case 5120:case 5121:case 5123:this.count=1;break;case 35664:this.count=2;break;case 35665:this.count=3;break;case 35666:this.count=4}},i.prototype.initFormat=function(t){switch(this.type){case 5126:case 35664:case 35665:case 35666:this.format=t.FLOAT;break;case 5121:this.format=t.UNSIGNED_BYTE;break;case 5123:this.format=t.UNSIGNED_SHORT;break;case 5120:this.format=t.BYTE}},t=i,e.EgretWebGLAttribute=t,__reflect(t.prototype,"egret.web.EgretWebGLAttribute")}(egret=egret||{}),function(t){var s;function o(t,e,i){e=t.createShader(e);return t.shaderSource(e,i),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS)||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(e))),e}function n(t,e,i){var r,n;this.vshaderSource=e,this.fshaderSource=i,this.vertexShader=o(t,t.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=o(t,t.FRAGMENT_SHADER,this.fshaderSource),this.id=(r=t,n=this.vertexShader,e=this.fragmentShader,i=r.createProgram(),r.attachShader(i,n),r.attachShader(i,e),r.linkProgram(i),i),this.uniforms=function(t,e){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=0;n<r;n++){var o=t.getActiveUniform(e,n),a=o.name,o=new s.EgretWebGLUniform(t,e,o);i[a]=o}return i}(t,this.id),this.attributes=function(t,e){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),n=0;n<r;n++){var o=t.getActiveAttrib(e,n),a=o.name,o=new s.EgretWebGLAttribute(t,e,o);i[a]=o}return i}(t,this.id)}s=t.web||(t.web={}),n.getProgram=function(t,e,i,r){return this.programCache[r]||(this.programCache[r]=new n(t,e,i)),this.programCache[r]},n.deleteProgram=function(t,e,i,r){},n.programCache={},t=n,s.EgretWebGLProgram=t,__reflect(t.prototype,"egret.web.EgretWebGLProgram")}(egret=egret||{}),function(t){var e;function i(t,e,i){this.gl=t,this.name=i.name,this.type=i.type,this.size=i.size,this.location=t.getUniformLocation(e,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}e=t.web||(t.web={}),i.prototype.setDefaultValue=function(){switch(this.type){case 5126:case 35678:case 35680:case 35670:case 5124:this.value=0;break;case 35664:case 35671:case 35667:this.value=[0,0];break;case 35665:case 35672:case 35668:this.value=[0,0,0];break;case 35666:case 35673:case 35669:this.value=[0,0,0,0];break;case 35674:this.value=new Float32Array([1,0,0,1]);break;case 35675:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case 35676:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},i.prototype.generateSetValue=function(){switch(this.type){case 5126:case 35678:case 35680:case 35670:case 5124:this.setValue=function(t){var e=this.value!==t;this.value=t,e&&this.upload()};break;case 35664:case 35671:case 35667:this.setValue=function(t){var e=this.value[0]!==t.x||this.value[1]!==t.y;this.value[0]=t.x,this.value[1]=t.y,e&&this.upload()};break;case 35665:case 35672:case 35668:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.upload()};break;case 35666:case 35673:case 35669:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.value[3]=t.w,this.upload()};break;case 35674:case 35675:case 35676:this.setValue=function(t){this.value.set(t),this.upload()}}},i.prototype.generateUpload=function(){var e=this.gl,t=this.type,i=this.location;switch(t){case 5126:this.upload=function(){var t=this.value;e.uniform1f(i,t)};break;case 35664:this.upload=function(){var t=this.value;e.uniform2f(i,t[0],t[1])};break;case 35665:this.upload=function(){var t=this.value;e.uniform3f(i,t[0],t[1],t[2])};break;case 35666:this.upload=function(){var t=this.value;e.uniform4f(i,t[0],t[1],t[2],t[3])};break;case 35678:case 35680:case 35670:case 5124:this.upload=function(){var t=this.value;e.uniform1i(i,t)};break;case 35671:case 35667:this.upload=function(){var t=this.value;e.uniform2i(i,t[0],t[1])};break;case 35672:case 35668:this.upload=function(){var t=this.value;e.uniform3i(i,t[0],t[1],t[2])};break;case 35673:case 35669:this.upload=function(){var t=this.value;e.uniform4i(i,t[0],t[1],t[2],t[3])};break;case 35674:this.upload=function(){var t=this.value;e.uniformMatrix2fv(i,!1,t)};break;case 35675:this.upload=function(){var t=this.value;e.uniformMatrix3fv(i,!1,t)};break;case 35676:this.upload=function(){var t=this.value;e.uniformMatrix4fv(i,!1,t)}}},t=i,e.EgretWebGLUniform=t,__reflect(t.prototype,"egret.web.EgretWebGLUniform")}(egret=egret||{}),function(t){var e;function i(){}e=t.web||(t.web={}),i.blur_frag="precision mediump float;\r\nuniform vec2 blur;\r\nuniform sampler2D uSampler;\r\nvarying vec2 vTextureCoord;\r\nuniform vec2 uTextureSize;\r\nvoid main()\r\n{\r\n    const int sampleRadius = 5;\r\n    const int samples = sampleRadius * 2 + 1;\r\n    vec2 blurUv = blur / uTextureSize;\r\n    vec4 color = vec4(0, 0, 0, 0);\r\n    vec2 uv = vec2(0.0, 0.0);\r\n    blurUv /= float(sampleRadius);\r\n\r\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\r\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\r\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\r\n        color += texture2D(uSampler, uv);\r\n    }\r\n\r\n    color /= float(samples);\r\n    gl_FragColor = color;\r\n}",i.colorTransform_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n    if(texColor.a > 0.) {\r\n        // \u62b5\u6d88\u9884\u4e58\u7684alpha\u901a\u9053\r\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n    }\r\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\r\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\r\n}",i.default_vert="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nattribute vec4 aColor;\r\n\r\nuniform vec2 projectionVector;\r\n// uniform vec2 offsetVector;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nconst vec2 center = vec2(-1.0, 1.0);\r\n\r\nvoid main(void) {\r\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\r\n   vTextureCoord = aTextureCoord;\r\n   vColor = aColor;\r\n}",i.glow_frag="precision highp float;\r\nvarying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\n\r\nuniform float dist;\r\nuniform float angle;\r\nuniform vec4 color;\r\nuniform float alpha;\r\nuniform float blurX;\r\nuniform float blurY;\r\n// uniform vec4 quality;\r\nuniform float strength;\r\nuniform float inner;\r\nuniform float knockout;\r\nuniform float hideObject;\r\n\r\nuniform vec2 uTextureSize;\r\n\r\nfloat random(vec2 scale)\r\n{\r\n    return fract(sin(dot(gl_FragCoord.xy, scale)) * 43758.5453);\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\r\n    // TODO \u81ea\u52a8\u8c03\u8282\u91c7\u6837\u6b21\u6570\uff1f\r\n    const float linearSamplingTimes = 7.0;\r\n    const float circleSamplingTimes = 12.0;\r\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\r\n    vec4 curColor;\r\n    float totalAlpha = 0.0;\r\n    float maxTotalAlpha = 0.0;\r\n    float curDistanceX = 0.0;\r\n    float curDistanceY = 0.0;\r\n    float offsetX = dist * cos(angle) * px.x;\r\n    float offsetY = dist * sin(angle) * px.y;\r\n\r\n    const float PI = 3.14159265358979323846264;\r\n    float cosAngle;\r\n    float sinAngle;\r\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec2(12.9898, 78.233));\r\n    float stepX = blurX * px.x / linearSamplingTimes;\r\n    float stepY = blurY * px.y / linearSamplingTimes;\r\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\r\n        cosAngle = cos(a + offset);\r\n        sinAngle = sin(a + offset);\r\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\r\n            curDistanceX = i * stepX * cosAngle;\r\n            curDistanceY = i * stepY * sinAngle;\r\n            if (vTextureCoord.x + curDistanceX - offsetX >= 0.0 && vTextureCoord.y + curDistanceY + offsetY <= 1.0){\r\n                curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\r\n                totalAlpha += (linearSamplingTimes - i) * curColor.a;\r\n            }\r\n            maxTotalAlpha += (linearSamplingTimes - i);\r\n        }\r\n    }\r\n\r\n    ownColor.a = max(ownColor.a, 0.0001);\r\n    ownColor.rgb = ownColor.rgb / ownColor.a;\r\n\r\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\r\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\r\n\r\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\r\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\r\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\r\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\r\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\r\n}",i.primitive_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = vColor;\r\n}",i.texture_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\r\n}",i.texture_etc_alphamask_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\nvoid main(void) {\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 v4Color = texture2D(uSampler, vTextureCoord);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",i.colorTransform_frag_etc_alphamask_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\n\r\nvoid main(void){\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 texColor = texture2D(uSampler, vTextureCoord);\r\nif(texColor.a > 0.0) {\r\n // \u62b5\u6d88\u9884\u4e58\u7684alpha\u901a\u9053\r\ntexColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n}\r\nvec4 v4Color = clamp(texColor * matrix + colorAdd, 0.0, 1.0);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",t=i,e.EgretShaderLib=t,__reflect(t.prototype,"egret.web.EgretShaderLib")}(egret=egret||{}));var RES,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__decorate=this&&this.__decorate||function(t,e,i,r){var n,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var s=t.length-1;0<=s;s--)(n=t[s])&&(a=(o<3?n(a):3<o?n(e,i,a):n(e,i))||a);return 3<o&&a&&Object.defineProperty(e,i,a),a};!function(t){t.checkNull=function(t,i,e){var r=e.value;e.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t[0]?r.apply(this,t):(console.warn("\u65b9\u6cd5"+i+"\u7684\u53c2\u6570\u4e0d\u80fd\u4e3anull"),null)}},t.FEATURE_FLAG={FIX_DUPLICATE_LOAD:1},(t.upgrade||(t.upgrade={})).setUpgradeGuideLevel=function(t){0}}(RES=RES||{}),function(a){function e(t){var e=a.config.config.fileSystem.getFile(t);return e||(t=a.resourceNameSelector(t),e=a.config.config.fileSystem.getFile(t)),e}var r;a.resourceNameSelector=function(t){return t},a.getResourceInfo=e,a.setConfigURL=function(t,e){var i=0<=t.indexOf(".json")?"legacyResourceConfig":"resourceConfig";r={type:i,root:e,url:t,name:t}};var t=(i.prototype.init=function(){return this.config||(this.config={alias:{},groups:{},resourceRoot:r.root,mergeSelector:null,fileSystem:null,loadGroup:[]}),a.queue.pushResItem(r).catch(function(t){return a.isCompatible||t.__resource_manager_error__||(t.error?console.error(t.error.stack):console.error(t.stack),t=new a.ResourceManagerError(1002)),a.host.remove(r),Promise.reject(t)})},i.prototype.getGroupByName=function(t){var t=this.config.groups[t],e=[];if(!t)return e;for(var i=0,r=t;i<r.length;i++){var n=r[i],o=void 0;if(null!=(o=a.config.getResourceWithSubkey(n))){n=o.r,o=o.key;if(null==n)throw new a.ResourceManagerError(2005,o);-1==e.indexOf(n)&&e.push(n)}}return e},i.prototype.__temp__get__type__via__url=function(t){var e=(e=this.config.alias[t])||t;if(a.typeSelector){t=a.typeSelector(e);if(!t)throw new a.ResourceManagerError(2004,e);return t}return console.warn("RES.mapConfig \u5e76\u672a\u8bbe\u7f6e typeSelector"),"unknown"},i.prototype.getResourceWithSubkey=function(t){var e=(t=this.getKeyByAlias(t)).indexOf("#"),i="";0<=e&&(i=t.substr(e+1),t=t.substr(0,e));e=this.getResource(t);return e?{r:e,key:t,subkey:i}:null},i.prototype.getKeyByAlias=function(t){return this.config.alias[t]||t},i.prototype.getResource=function(t){t=e(this.config.alias[t]||t);return t||null},i.prototype.createGroup=function(t,e,i){if(!(i=void 0===i?!1:i)&&this.config.groups[t]||!e||0==e.length)return!1;for(var r=[],n=0,o=e;n<o.length;n++){var a,s=o[n];this.config.groups[s]?(a=this.config.groups[s],r=r.concat(a)):r.push(s)}return this.config.groups[t]=r,!0},i.prototype.addSubkey=function(t,e){this.addAlias(t,e+"#"+t)},i.prototype.addAlias=function(t,e){this.config.alias[e]&&(e=this.config.alias[e]),this.config.alias[t]=e},i.prototype.addResourceData=function(t){a.hasRes(t.name)||(t.type||(t.type=this.__temp__get__type__via__url(t.url)),a.config.config.fileSystem.addFile(t))},i.prototype.removeResourceData=function(t){a.hasRes(t.name)&&(a.config.config.fileSystem.removeFile(t.url),this.config.alias[t.name]&&delete this.config.alias[t.name])},i);function i(){}a.ResourceConfig=t,__reflect(t.prototype,"RES.ResourceConfig")}(RES=RES||{}),function(h){var t=(e.prototype.pushResItem=function(t){if(this.promiseHash[t.root+t.name])return this.promiseHash[t.root+t.name];this.lazyLoadList.push(t),this.itemListPriorityDic[Number.NEGATIVE_INFINITY]=this.lazyLoadList,this.updatelistPriority(this.lazyLoadList,Number.NEGATIVE_INFINITY);var r=new egret.EventDispatcher;this.dispatcherDic[t.root+t.name]=r;var e=new Promise(function(e,i){r.addEventListener("complete",function(t){e(t.data)},null),r.addEventListener("error",function(t){i(t.data)},null)});return this.promiseHash[t.root+t.name]=e,this.loadNextResource(),e},e.prototype.pushResGroup=function(t,e,i,r){if(this.promiseHash[e])return this.promiseHash[e];for(var n=t.length,o=0;o<n;o++){var a=t[o];a.groupNames||(a.groupNames=[]),a.groupNames.push(e)}this.groupTotalDic[e]=t.length,this.numLoadedDic[e]=0,this.updatelistPriority(t,i),this.reporterDic[e]=r;var s=new egret.EventDispatcher;this.dispatcherDic[e]=s;r=new Promise(function(t,e){s.addEventListener("complete",t,null),s.addEventListener("error",function(t){e(t.data)},null)});return this.promiseHash[e]=r,this.loadNextResource(),r},e.prototype.updatelistPriority=function(t,e){null==this.itemListPriorityDic[e]&&(this.itemListPriorityDic[e]=[]);for(var i=0,r=t;i<r.length;i++){var n,o=r[i];1!=this.itemLoadDic[o.root+o.name]&&(null==(n=this.findPriorityInDic(o))?this.itemListPriorityDic[e].push(o):n<e&&(this.itemListPriorityDic[e].push(o),o=this.itemListPriorityDic[n].indexOf(o),this.itemListPriorityDic[n].splice(o,1)))}},e.prototype.findPriorityInDic=function(t){for(var e in this.itemListPriorityDic)if(-1<this.itemListPriorityDic[e].indexOf(t))return parseInt(e)},e.prototype.loadNextResource=function(){for(;this.loadingCount<this.thread;)if(!this.loadSingleResource())break},e.prototype.loadSingleResource=function(){var a=this,s=this.getOneResourceInfoInGroup();return!!s&&(this.itemLoadDic[s.root+s.name]=1,this.loadingCount++,this.loadResource(s).then(function(t){a.loadingCount--,delete a.itemLoadDic[s.root+s.name],h.host.save(s,t),a.promiseHash[s.root+s.name]&&a.deleteDispatcher(s.root+s.name).dispatchEventWith("complete",!1,t);t=s.groupNames;if(t){delete s.groupNames;for(var e=0,i=t;e<i.length;e++){var r=i[e];a.setGroupProgress(r,s)&&a.loadGroupEnd(r)}}a.loadNextResource()}).catch(function(t){if(!t)throw s.name+" load fail";if(!t.__resource_manager_error__)throw t;delete a.itemLoadDic[s.root+s.name],a.loadingCount--,delete h.host.state[s.root+s.name];var e=a.retryTimesDic[s.name]||1;if(e>a.maxRetryTimes){delete a.retryTimesDic[s.name],a.promiseHash[s.root+s.name]&&a.deleteDispatcher(s.root+s.name).dispatchEventWith("error",!1,{r:s,error:t});var i=s.groupNames;if(i){delete s.groupNames;for(var r=0,n=i;r<n.length;r++){var o=n[r];a.loadItemErrorDic[o]||(a.loadItemErrorDic[o]=[]),-1==a.loadItemErrorDic[o].indexOf(s)&&a.loadItemErrorDic[o].push(s),a.groupErrorDic[o]=!0,a.setGroupProgress(o,s)?a.loadGroupEnd(o,t):a.errorDic[o]=t}}a.loadNextResource()}else a.retryTimesDic[s.name]=e+1,a.failedList.push(s),a.loadNextResource()}),!0)},e.prototype.getOneResourceInfoInGroup=function(){if(0<this.failedList.length)return this.failedList.shift();var t,e=Number.NEGATIVE_INFINITY;for(t in this.itemListPriorityDic)e=Math.max(e,t);var i=this.itemListPriorityDic[e];return i?0==i.length?(delete this.itemListPriorityDic[e],this.getOneResourceInfoInGroup()):i.shift():void 0},e.prototype.setGroupProgress=function(t,e){var i=this.reporterDic[t];this.numLoadedDic[t]++;var r=this.numLoadedDic[t],t=this.groupTotalDic[t];return i&&i.onProgress&&i.onProgress(r,t,e),r==t},e.prototype.loadGroupEnd=function(t,e){delete this.groupTotalDic[t],delete this.numLoadedDic[t],delete this.reporterDic[t];var i,r=this.deleteDispatcher(t);e?(delete this.groupErrorDic[t],i=this.loadItemErrorDic[t],delete this.loadItemErrorDic[t],r.dispatchEventWith("error",!1,{itemList:i,error:e})):(e=this.groupErrorDic[t],delete this.groupErrorDic[t],e?(i=this.loadItemErrorDic[t],delete this.loadItemErrorDic[t],e=this.errorDic[t],delete this.errorDic[t],r.dispatchEventWith("error",!1,{itemList:i,error:e})):r.dispatchEventWith("complete"))},e.prototype.deleteDispatcher=function(t){delete this.promiseHash[t];var e=this.dispatcherDic[t];return delete this.dispatcherDic[t],e},e.prototype.loadResource=function(t,e){if(!e){if(1==h.FEATURE_FLAG.FIX_DUPLICATE_LOAD){var i=h.host.state[t.root+t.name];if(2==i)return Promise.resolve(h.host.get(t));if(1==i)return t.promise}e=h.processor.isSupport(t)}if(!e)throw new h.ResourceManagerError(2001,t.name,t.type);h.host.state[t.root+t.name]=1;e=e.onLoadStart(h.host,t);return t.promise=e},e.prototype.unloadResource=function(t){if(!h.host.get(t))return console.warn("\u5c1d\u8bd5\u91ca\u653e\u4e0d\u5b58\u5728\u7684\u8d44\u6e90:",t.name),!1;var e=h.processor.isSupport(t);return e&&(e.onRemoveStart(h.host,t),h.host.remove(t),1==t.extra&&h.config.removeResourceData(t)),!0},e);function e(){this.groupTotalDic={},this.numLoadedDic={},this.groupErrorDic={},this.retryTimesDic={},this.maxRetryTimes=3,this.reporterDic={},this.dispatcherDic={},this.failedList=new Array,this.loadItemErrorDic={},this.errorDic={},this.itemListPriorityDic={},this.itemLoadDic={},this.promiseHash={},this.lazyLoadList=new Array,this.loadingCount=0,this.thread=4}h.ResourceLoader=t,__reflect(t.prototype,"RES.ResourceLoader")}(RES=RES||{}),function(t){(t=t.path||(t.path={})).normalize=function(t){var i=t.split("/");return i.filter(function(t,e){return!!t||e==i.length-1}).join("/")},t.basename=function(t){return t.substr(t.lastIndexOf("/")+1)},t.dirname=function(t){return t.substr(0,t.lastIndexOf("/"))}}(RES=(RES=RES||{})||{}),function(r){var n={};r.profile=function(){r.config.config.fileSystem.profile(),console.log(n);var t,e=0;for(t in n){var i=n[t];i instanceof egret.Texture&&(e+=i.$bitmapWidth*i.$bitmapHeight*4)}console.log("gpu size : "+(e/1024).toFixed(3)+"kb")},r.host={state:{},get resourceConfig(){return r.config},load:function(t,e){e="string"==typeof e?r.processor._map[e]:e;return r.queue.loadResource(t,e)},unload:function(t){return r.queue.unloadResource(t)},save:function(t,e){r.host.state[t.root+t.name]=2,delete t.promise,n[t.root+t.name]=e},get:function(t){return n[t.root+t.name]},remove:function(t){delete r.host.state[t.root+t.name],delete n[t.root+t.name]}},r.config=new r.ResourceConfig,r.queue=new r.ResourceLoader;var o,t=(o=Error,__extends(a,o),a.errorMessage={1001:"\u6587\u4ef6\u52a0\u8f7d\u5931\u8d25:{0}",1002:"ResourceManager \u521d\u59cb\u5316\u5931\u8d25\uff1a\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u5931\u8d25",2001:"{0}\u89e3\u6790\u5931\u8d25,\u4e0d\u652f\u6301\u6307\u5b9a\u89e3\u6790\u7c7b\u578b:'{1}'\uff0c\u8bf7\u7f16\u5199\u81ea\u5b9a\u4e49 Processor \uff0c\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u89c1 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2002:"Analyzer \u76f8\u5173API \u5728 ResourceManager \u4e2d\u4e0d\u518d\u652f\u6301\uff0c\u8bf7\u7f16\u5199\u81ea\u5b9a\u4e49 Processor \uff0c\u66f4\u591a\u5185\u5bb9\u8bf7\u53c2\u89c1 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2003:"{0}\u89e3\u6790\u5931\u8d25,\u9519\u8bef\u539f\u56e0:{1}",2004:"\u65e0\u6cd5\u627e\u5230\u6587\u4ef6\u7c7b\u578b:{0}",2005:'RES\u52a0\u8f7d\u4e86\u4e0d\u5b58\u5728\u6216\u7a7a\u7684\u8d44\u6e90\u7ec4:"{0}"',2006:"\u8d44\u6e90\u914d\u7f6e\u6587\u4ef6\u4e2d\u65e0\u6cd5\u627e\u5230\u7279\u5b9a\u7684\u8d44\u6e90:{0}"},a);function a(t,e,i){var r=o.call(this)||this;return r.__resource_manager_error__=!0,r.name=t.toString(),r.message=a.errorMessage[t].replace("{0}",e).replace("{1}",i),r}r.ResourceManagerError=t,__reflect(t.prototype,"RES.ResourceManagerError")}(RES=RES||{}),function(o){var t=(e.prototype.profile=function(){console.log(this.data)},e.prototype.addFile=function(t,e){e=e||"",t=o.path.normalize(t);var i=o.path.basename(t),r=o.path.dirname(t);this.exists(r)||this.mkdir(r),this.resolve(r)[i]={url:t,type:e}},e.prototype.getFile=function(t){var e=this.resolve(t);return e&&(e.name=t),e},e.prototype.resolve=function(t){if(""==t)return this.data;for(var t=(t=o.path.normalize(t)).split("/"),e=this.data,i=0,r=t;i<r.length;i++){var n=r[i];if(!e)return e;e=e[n]}return e},e.prototype.mkdir=function(t){for(var t=(t=o.path.normalize(t)).split("/"),e=this.data,i=0,r=t;i<r.length;i++){var n=r[i];e[n]||(e[n]={}),e=e[n]}},e.prototype.exists=function(t){if(""==t)return!0;for(var t=(t=o.path.normalize(t)).split("/"),e=this.data,i=0,r=t;i<r.length;i++){var n=r[i];if(!e[n])return!1;e=e[n]}return!0},e);function e(t){this.data=t}o.NewFileSystem=t,__reflect(t.prototype,"RES.NewFileSystem")}(RES=RES||{}),function(_){function n(t){if(!_.isCompatible)return t;t.catch(function(t){}).then()}_.nameSelector=function(t){return _.path.basename(t).split(".").join("_")},_.typeSelector=function(t){var e,i=t.substr(t.lastIndexOf(".")+1);switch(i){case _.ResourceItem.TYPE_XML:case _.ResourceItem.TYPE_JSON:case _.ResourceItem.TYPE_SHEET:e=i;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":e=_.ResourceItem.TYPE_IMAGE;break;case"fnt":e=_.ResourceItem.TYPE_FONT;break;case"txt":e=_.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":e=_.ResourceItem.TYPE_SOUND;break;case"mergeJson":case"zip":case"pvr":e=i;break;case"ttf":e=_.ResourceItem.TYPE_TTF;default:e=_.ResourceItem.TYPE_BIN}return e},_.registerAnalyzer=function(t,e){throw new _.ResourceManagerError(2002)},_.setIsCompatible=function(t){_.isCompatible=t},_.isCompatible=!1,_.loadConfig=function(t,e){var i;return t=(e=0<=e.indexOf("://")?(i=e.split("://"))[0]+"://"+_.path.normalize(i[1]+"/"):_.path.normalize(e+"/"),t.replace(e,"")),_.setConfigURL(t,e),n((o=o||new a).loadConfig())},_.loadGroup=function(t,e,i){return n(o.loadGroup(t,e=void 0===e?0:e,i))},_.isGroupLoaded=function(t){return o.isGroupLoaded(t)},_.getGroupByName=function(t){return o.getGroupByName(t).map(function(t){return _.ResourceItem.convertToResItem(t)})},_.createGroup=function(t,e,i){return o.createGroup(t,e,i=void 0===i?!1:i)},_.hasRes=function(t){return o.hasRes(t)},_.getRes=function(t){return o.getRes(t)},_.getResAsync=function(t,e,i){return n(o.getResAsync.apply(o,arguments))},_.getResByUrl=function(t,e,i,r){return void 0===r&&(r=""),o?n(o.getResByUrl(t,e,i,r)):(r=egret.sys.tr(3200),egret.warn(r),Promise.reject(r))},_.destroyRes=function(t,e){return o.destroyRes(t,e)},_.setMaxLoadingThread=function(t){(o=o||new a).setMaxLoadingThread(t)},_.setMaxRetryTimes=function(t){o.setMaxRetryTimes(t)},_.addEventListener=function(t,e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=0),(o=o||new a).addEventListener(t,e,i,r,n)},_.removeEventListener=function(t,e,i,r){o.removeEventListener(t,e,i,r=void 0===r?!1:r)},_.$addResourceData=function(t){o.addResourceData(t)},_.getVersionController=function(){return(o=o||new a).vcs},_.registerVersionController=function(t){(o=o||new a).registerVersionController(t)},_.getVirtualUrl=function(t){return o.vcs?o.vcs.getVirtualUrl(t):t};var t,o,a=(t=egret.EventDispatcher,__extends(e,t),e.prototype.registerVersionController=function(t){this.vcs=t,this.isVcsInit=!1},e.prototype.loadConfig=function(){var t=this;return!this.isVcsInit&&this.vcs?(this.isVcsInit=!0,this.vcs.init().then(function(){return t.normalLoadConfig()})):this.normalLoadConfig()},e.prototype.isGroupLoaded=function(t){return _.config.getGroupByName(t).every(function(t){return null!=_.host.get(t)})},e.prototype.getGroupByName=function(t){return _.config.getGroupByName(t)},e.prototype.loadGroup=function(o,t,r){var a=this;return this._loadGroup(o,t=void 0===t?0:t,{onProgress:function(t,e,i){r&&r.onProgress&&r.onProgress(t,e,i),_.ResourceEvent.dispatchResourceEvent(a,_.ResourceEvent.GROUP_PROGRESS,o,i,t,e)}}).then(function(t){-1==_.config.config.loadGroup.indexOf(o)&&_.config.config.loadGroup.push(o),_.ResourceEvent.dispatchResourceEvent(a,_.ResourceEvent.GROUP_COMPLETE,o)},function(t){if(-1==_.config.config.loadGroup.indexOf(o)&&_.config.config.loadGroup.push(o),t.itemList)for(var e=t.itemList,i=e.length,r=0;r<i;r++){var n=e[r];delete n.promise,_.ResourceEvent.dispatchResourceEvent(a,_.ResourceEvent.ITEM_LOAD_ERROR,o,n)}return _.isCompatible&&console.warn(t.error.message),_.ResourceEvent.dispatchResourceEvent(a,_.ResourceEvent.GROUP_LOAD_ERROR,o),Promise.reject(t.error)})},e.prototype._loadGroup=function(i,t,e){void 0===t&&(t=0);var r=_.config.getGroupByName(i);return 0==r.length?new Promise(function(t,e){e({error:new _.ResourceManagerError(2005,i)})}):_.queue.pushResGroup(r,i,t,e)},e.prototype.createGroup=function(t,e,i){return _.config.createGroup(t,e,i=void 0===i?!1:i)},e.prototype.hasRes=function(t){return null!=_.config.getResourceWithSubkey(t)},e.prototype.getRes=function(t){var e=_.config.getResourceWithSubkey(t);if(e){var i=e.r,r=e.key,t=e.subkey,e=_.processor.isSupport(i);return e&&e.getData&&t?e.getData(_.host,i,r,t):_.host.get(i)}return null},e.prototype.getResAsync=function(i,r,n){var e=this,o=i,t=_.config.getResourceWithSubkey(i);if(null==t)return r&&r.call(n,null,o),Promise.reject(new _.ResourceManagerError(2006,i));var a=this.getRes(i);if(a)return r&&egret.callLater(function(){r.call(n,a,o)},this),Promise.resolve(a);var s=t.r,h=t.subkey;return _.queue.pushResItem(s).then(function(t){_.host.save(s,t);var e=_.processor.isSupport(s);return e&&e.getData&&h&&(t=e.getData(_.host,s,i,h)),r&&r.call(n,t,o),t},function(t){return _.host.remove(s),_.ResourceEvent.dispatchResourceEvent(e,_.ResourceEvent.ITEM_LOAD_ERROR,"",s),r?(r.call(n,null,o),Promise.reject(null)):Promise.reject(t)})},e.prototype.getResByUrl=function(e,i,r,t){var n=this;void 0===t&&(t="");var o=_.config.getResource(e);if(!(o||(t=t||_.config.__temp__get__type__via__url(e),o={name:e,url:e,type:t,root:"",extra:1},_.config.addResourceData(o),o=_.config.getResource(e))))throw"never";return _.queue.pushResItem(o).then(function(t){return _.host.save(o,t),i&&o&&i.call(r,t,o.url),t},function(t){return _.host.remove(o),_.ResourceEvent.dispatchResourceEvent(n,_.ResourceEvent.ITEM_LOAD_ERROR,"",o),i?(i.call(r,null,e),Promise.reject(null)):Promise.reject(t)})},e.prototype.destroyRes=function(t,e){void 0===e&&(e=!0);var i=_.config.getGroupByName(t);if(i&&0<i.length){var r=_.config.config.loadGroup.indexOf(t);if(-1==r)return!1;if(e||1==_.config.config.loadGroup.length&&_.config.config.loadGroup[0]==t){for(var n=0,o=i;n<o.length;n++){var a=o[n];_.queue.unloadResource(a)}_.config.config.loadGroup.splice(r,1)}else{for(var s={},h=0,l=_.config.config.loadGroup;h<l.length;h++){var u,c=l[h];for(u in _.config.config.groups[c]){var p=_.config.config.groups[c][u];s[p]?s[p]++:s[p]=1}}for(var d=0,f=i;d<f.length;d++)s[(a=f[d]).name]&&1==s[a.name]&&_.queue.unloadResource(a);_.config.config.loadGroup.splice(r,1)}return!0}return(a=_.config.getResource(t))?_.queue.unloadResource(a):(console.warn("\u5728\u5185\u5b58"+t+"\u8d44\u6e90\u4e0d\u5b58\u5728"),!1)},e.prototype.setMaxLoadingThread=function(t){_.queue.thread=t=t<1?1:t},e.prototype.setMaxRetryTimes=function(t){t=Math.max(t,0),_.queue.maxRetryTimes=t},e.prototype.addResourceData=function(t){t.root="",_.config.addResourceData(t)},__decorate([_.checkNull],e.prototype,"hasRes",null),__decorate([_.checkNull],e.prototype,"getRes",null),__decorate([_.checkNull],e.prototype,"getResAsync",null),__decorate([_.checkNull],e.prototype,"getResByUrl",null),e);function e(){var e=t.call(this)||this;return e.isVcsInit=!1,e.normalLoadConfig=function(){return _.config.init().then(function(t){_.ResourceEvent.dispatchResourceEvent(e,_.ResourceEvent.CONFIG_COMPLETE)},function(t){return _.ResourceEvent.dispatchResourceEvent(e,_.ResourceEvent.CONFIG_LOAD_ERROR),Promise.reject(t)})},_.VersionController&&(e.vcs=new _.VersionController),e}_.Resource=a,__reflect(a.prototype,"RES.Resource")}(RES=RES||{}),function(a){var r,t=(r=egret.Event,__extends(s,r),s.dispatchResourceEvent=function(t,e,i,r,n,o){void 0===i&&(i=""),void 0===r&&(r=void 0),void 0===n&&(n=0),void 0===o&&(o=0);e=egret.Event.create(s,e);e.groupName=i,r&&(e.resItem=a.ResourceItem.convertToResItem(r)),e.itemsLoaded=n,e.itemsTotal=o;t=t.dispatchEvent(e);return egret.Event.release(e),t},s.ITEM_LOAD_ERROR="itemLoadError",s.CONFIG_COMPLETE="configComplete",s.CONFIG_LOAD_ERROR="configLoadError",s.GROUP_PROGRESS="groupProgress",s.GROUP_COMPLETE="groupComplete",s.GROUP_LOAD_ERROR="groupLoadError",s);function s(t,e,i){i=r.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this;return i.itemsLoaded=0,i.itemsTotal=0,i.groupName="",i}a.ResourceEvent=t,__reflect(t.prototype,"RES.ResourceEvent")}(RES=RES||{}),function(r){var t;(t=r.ResourceItem||(r.ResourceItem={})).TYPE_XML="xml",t.TYPE_IMAGE="image",t.TYPE_BIN="bin",t.TYPE_TEXT="text",t.TYPE_JSON="json",t.TYPE_SHEET="sheet",t.TYPE_FONT="font",t.TYPE_SOUND="sound",t.TYPE_TTF="ttf",t.convertToResItem=function(t){var e=t.name;if(r.config.config)for(var i in r.config.config.alias)r.config.config.alias[i]==t.url&&(e=i);else e=t.url;return{name:e,url:t.url,type:t.type,data:t,root:t.root}}}(RES=RES||{}),function(t){var e=(i.prototype.init=function(){return this.versionInfo=this.getLocalData("all.manifest"),Promise.resolve()},i.prototype.getVirtualUrl=function(t){return t},i.prototype.getLocalData=function(t){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var e=egret_native.readUpdateFileSync(t);if(null!=e)return JSON.parse(e);if(null!=(e=egret_native.readResourceFileSync(t)))return JSON.parse(e)}return null},i);function i(){}t.NativeVersionController=e,__reflect(e.prototype,"RES.NativeVersionController",["RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(t.VersionController=e)}(RES=RES||{}),function(f){!function(i){function n(r,n){var t=this;return new Promise(function(e,i){r.addEventListener(egret.Event.COMPLETE,function(){var t=r.data||r.response;e(t)},t),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){var t=new f.ResourceManagerError(1001,n.url);i(t)},t)})}function l(t,e){if(-1!=e.indexOf("://"))return e;var i=(t=t.split("\\").join("/")).match(/#.*|\?.*/),r="";i&&(r=i[0]);i=t.lastIndexOf("/");return(t=-1!=i?t.substring(0,i+1)+e:e)+r}function o(t){return{name:t.name+"_alpha",url:t.etc1_alpha_url,type:"ktx",root:t.root}}i.isSupport=function(t){return i._map[t.type]},i.map=function(t,e){i._map[t]=e},i.getRelativePath=l,i.ImageProcessor={onLoadStart:function(i,r){var t=new egret.ImageLoader;return t.load(f.getVirtualUrl(r.root+r.url)),n(t,r).then(function(t){var e=new egret.Texture;e._setBitmapData(t);t=i.resourceConfig.getResource(r.name);return t&&t.scale9grid&&(t=t.scale9grid.split(","),e.scale9Grid=new egret.Rectangle(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),parseInt(t[3]))),e})},onRemoveStart:function(t,e){t.get(e).dispose()}},i.KTXTextureProcessor={onLoadStart:function(i,r){return i.load(r,"bin").then(function(t){if(!t)return console.error("ktx:"+r.root+r.url+" is null"),null;var e=new egret.KTXContainer(t,1);if(e.isInvalid)return console.error("ktx:"+r.root+r.url+" is invalid"),null;t=new egret.BitmapData(t);t.debugCompressedTextureURL=r.root+r.url,t.format="ktx",e.uploadLevels(t,!1);e=new egret.Texture;e._setBitmapData(t);t=i.resourceConfig.getResource(r.name);return t&&t.scale9grid&&(t=t.scale9grid.split(","),e.scale9Grid=new egret.Rectangle(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),parseInt(t[3]))),i.save(r,e),e},function(t){throw i.remove(r),t})},onRemoveStart:function(t,e){e=t.get(e);e&&e.dispose()}},i.makeEtc1SeperatedAlphaResourceInfo=o,i.ETC1KTXProcessor={onLoadStart:function(r,n){return r.load(n,"ktx").then(function(e){if(!e)return null;if(n.etc1_alpha_url){var i=o(n);return r.load(i,"ktx").then(function(t){return e&&e.$bitmapData&&t.$bitmapData?(e.$bitmapData.etcAlphaMask=t.$bitmapData,r.save(i,t)):r.remove(i),e},function(t){throw r.remove(i),t})}return e},function(t){throw r.remove(n),t})},onRemoveStart:function(t,e){var i=t.get(e);i&&i.dispose(),e.etc1_alpha_url&&(i=o(e),(e=t.get(i))&&e.dispose(),t.unload(i))}},i.BinaryProcessor={onLoadStart:function(t,e){var i=new egret.HttpRequest;return i.responseType=egret.HttpResponseType.ARRAY_BUFFER,i.open(f.getVirtualUrl(e.root+e.url),"get"),i.send(),n(i,e)},onRemoveStart:function(t,e){}},i.TextProcessor={onLoadStart:function(t,e){var i=new egret.HttpRequest;return i.responseType=egret.HttpResponseType.TEXT,i.open(f.getVirtualUrl(e.root+e.url),"get"),i.send(),n(i,e)},onRemoveStart:function(t,e){return!0}},i.JsonProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){return JSON.parse(t)})},onRemoveStart:function(t,e){}},i.XMLProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){return egret.XML.parse(t)})},onRemoveStart:function(t,e){return!0}},i.CommonJSProcessor={onLoadStart:function(t,i){return t.load(i,"text").then(function(t){var e=new Function("require","exports",t),t={};try{e(function(){},t)}catch(t){throw new f.ResourceManagerError(2003,i.name,t.message)}return t})},onRemoveStart:function(t,e){}},i.SheetProcessor={onLoadStart:function(h,e){return h.load(e,"json").then(function(a){var t,s=h.resourceConfig.getResource(f.nameSelector(a.file));return s||(t=l(e.url,a.file),s={name:f.nameSelector(a.file),url:t,type:"image",root:e.root},h.resourceConfig.addResourceData(s)),h.load(s).then(function(t){if(!t)return null;var e,i=a.frames,r=new egret.SpriteSheet(t);for(e in r.$resourceInfo=s,i){var n=i[e],o=r.createTexture(e,n.x,n.y,n.w,n.h,n.offX,n.offY,n.sourceW,n.sourceH);n.scale9grid&&(n=n.scale9grid.split(","),o.scale9Grid=new egret.Rectangle(parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])))}return h.save(s,t),r},function(t){throw h.remove(s),t})})},getData:function(t,e,i,r){e=t.get(e);return e?e.getTexture(r):null},onRemoveStart:function(t,e){var i=t.get(e),e=i.$resourceInfo;i.dispose(),t.unload(e)}};i.FontProcessor={onLoadStart:function(a,s){return a.load(s,"text").then(function(e){var i,t,r;try{i=JSON.parse(e)}catch(t){i=e}var n="string"==typeof i?(n=s.url,r="",-1!=(t=(e=(t=i).split("\n")[2]).indexOf('file="'))&&(t=(e=e.substring(t+6)).indexOf('"'),r=e.substring(0,t)),n=-1!=(t=(n=n.split("\\").join("/")).lastIndexOf("/"))?n.substring(0,t+1)+r:r):l(s.url,i.file),o=a.resourceConfig.getResource(f.nameSelector(n));return o||(o={name:f.nameSelector(n),url:n,type:"image",root:s.root},a.resourceConfig.addResourceData(o)),a.load(o).then(function(t){var e=new egret.BitmapFont(t,i);return e.$resourceInfo=o,a.save(o,t),e},function(t){throw a.remove(o),t})})},onRemoveStart:function(t,e){e=t.get(e).$resourceInfo;t.unload(e)}},i.SoundProcessor={onLoadStart:function(t,e){var i=new egret.Sound;return i.load(f.getVirtualUrl(e.root+e.url)),n(i,e).then(function(){return i})},onRemoveStart:function(t,e){t.get(e).close()}},i.MovieClipProcessor={onLoadStart:function(e,i){var r,n;return e.load(i,"json").then(function(t){r=t;t=i.name,t=t.substring(0,t.lastIndexOf("."))+".png";if(!(n=e.resourceConfig.getResource(t)))throw new f.ResourceManagerError(1001,t);return e.load(n)}).then(function(t){return e.save(n,t),new egret.MovieClipDataFactory(r,t)})},onRemoveStart:function(t,e){var i=t.get(e);i.clearCache(),i.$spriteSheet.dispose();e=e.name,e=e.substring(0,e.lastIndexOf("."))+".png",e=t.resourceConfig.getResource(e);e&&t.unload(e)}},i.MergeJSONProcessor={onLoadStart:function(t,i){return t.load(i,"json").then(function(t){for(var e in t)f.config.addSubkey(e,i.name);return t})},getData:function(t,e,i,r){t=t.get(e);return t?t[r]:(console.error("missing resource :"+e.name),null)},onRemoveStart:function(t,e){}},i.TTFProcessor={onLoadStart:function(t,e){return t.load(e,"bin").then(function(t){egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(egret.sys.fontResourceCache||(egret.sys.fontResourceCache={}),egret.sys.fontResourceCache[e.root+e.url]=t)})},onRemoveStart:function(t,e){var i;egret.Capabilities.runtimeType!=egret.RuntimeType.WEB||(i=egret.sys.fontResourceCache)&&i[e.url]&&(i[e.root+e.url]=null)}},i.LegacyResourceConfigProcessor={onLoadStart:function(p,d){return p.load(d,"json").then(function(t){var e=f.config.config,i=d.root,r=e.fileSystem;r||(e.fileSystem=r={fsData:{},getFile:function(t){return l[t]},addFile:function(t){t.type||(t.type=""),null==i&&(t.root=""),l[t.name]=t},profile:function(){console.log(l)},removeFile:function(t){delete l[t]}});for(var n=e.groups,o=0,a=t.groups;o<a.length;o++){var s=a[o];""==s.keys?n[s.name]=[]:n[s.name]=s.keys.split(",")}for(var h=e.alias,l=r.fsData,u=0,c=t.resources;u<c.length;u++)!function(e){l[e.name]=e,l[e.name].root=i,e.subkeys&&e.subkeys.split(",").forEach(function(t){h[t]=e.name+"#"+t,h[e.name+"."+t]=e.name+"#"+t})}(c[u]);return p.save(d,t),t})},onRemoveStart:function(){}},i._map={image:i.ImageProcessor,json:i.JsonProcessor,text:i.TextProcessor,xml:i.XMLProcessor,sheet:i.SheetProcessor,font:i.FontProcessor,bin:i.BinaryProcessor,commonjs:i.CommonJSProcessor,sound:i.SoundProcessor,movieclip:i.MovieClipProcessor,mergeJson:i.MergeJSONProcessor,legacyResourceConfig:i.LegacyResourceConfigProcessor,ktx:i.KTXTextureProcessor,"etc1.ktx":i.ETC1KTXProcessor,"pvrtc.ktx":i.KTXTextureProcessor,ttf:i.TTFProcessor}}(f.processor||(f.processor={}))}(RES=RES||{});__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};!function(t){var e=(i.BINARY="binary",i.TEXT="text",i.VARIABLES="variables",i.TEXTURE="texture",i.SOUND="sound",i);function i(){}t.URLLoaderDataFormat=e,__reflect(e.prototype,"egret.URLLoaderDataFormat")}(egret=egret||{}),function(t){var n,e=(n=t.EventDispatcher,__extends(i,n),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),i.prototype.clone=function(){return new i(this._name,this._frame,this._end)},i);function i(t,e,i){var r=n.call(this)||this;return r._name=t,r._frame=0|e,i&&(r._end=0|i),r}t.FrameLabel=e,__reflect(e.prototype,"egret.FrameLabel")}(egret=egret||{}),function(n){var e,t=(e=n.HashObject,__extends(i,e),i.prototype.$init=function(t,e,i){this.textureData=e,this.spriteSheet=i,this.setMCData(t)},i.prototype.getKeyFrameData=function(t){t=this.frames[t-1];return t=t.frame?this.frames[t.frame-1]:t},i.prototype.getTextureByFrame=function(t){t=this.getKeyFrameData(t);return t.res?this.getTextureByResName(t.res):null},i.prototype.$getOffsetByFrame=function(t,e){t=this.getKeyFrameData(t);t.res&&e.setTo(0|t.x,0|t.y)},i.prototype.getTextureByResName=function(t){if(null==this.spriteSheet)return null;var e,i=this.spriteSheet.getTexture(t);return i||(e=this.textureData[t],i=this.spriteSheet.createTexture(t,e.x,e.y,e.w,e.h)),i},i.prototype.$isDataValid=function(){return 0<this.frames.length},i.prototype.$isTextureValid=function(){return null!=this.textureData&&null!=this.spriteSheet},i.prototype.$fillMCData=function(t){this.frameRate=t.frameRate||24,this.fillFramesData(t.frames),this.fillFrameLabelsData(t.labels),this.fillFrameEventsData(t.events)},i.prototype.fillFramesData=function(t){for(var e=this.frames,i=t?t.length:0,r=0;r<i;r++){var n=t[r];if(e.push(n),n.duration){var o=parseInt(n.duration);if(1<o)for(var a=e.length,s=1;s<o;s++)e.push({frame:a})}}this.numFrames=e.length},i.prototype.fillFrameLabelsData=function(t){if(t){var e=t.length;if(0<e){this.labels=[];for(var i=0;i<e;i++){var r=t[i];this.labels.push(new n.FrameLabel(r.name,r.frame,r.end))}}}},i.prototype.fillFrameEventsData=function(t){if(t){var e=t.length;if(0<e){this.events=[];for(var i=0;i<e;i++){var r=t[i];this.events[r.frame]=r.name}}}},Object.defineProperty(i.prototype,"mcData",{get:function(){return this.$mcData},set:function(t){this.setMCData(t)},enumerable:!0,configurable:!0}),i.prototype.setMCData=function(t){this.$mcData!=t&&(this.$mcData=t)&&this.$fillMCData(t)},i);function i(){var t=e.call(this)||this;return t.$mcData=null,t.numFrames=1,t.frames=[],t.labels=null,t.events=[],t.frameRate=0,t.textureData=null,t.spriteSheet=null,t}n.MovieClipData=t,__reflect(t.prototype,"egret.MovieClipData")}(egret=egret||{}),function(i){var r,t=(r=i.EventDispatcher,__extends(e,r),e.prototype.clearCache=function(){this.$mcDataCache={}},e.prototype.generateMovieClipData=function(t){if(""==(t=void 0===t?"":t)&&this.$mcDataSet)for(t in this.$mcDataSet.mc)break;if(""==t)return null;var e=this.findFromCache(t,this.$mcDataCache);return e||(e=new i.MovieClipData,this.fillData(t,e,this.$mcDataCache)),e},e.prototype.findFromCache=function(t,e){return this.enableCache&&e[t]?e[t]:null},e.prototype.fillData=function(t,e,i){var r;!this.$mcDataSet||(r=this.$mcDataSet.mc[t])&&(e.$init(r,this.$mcDataSet.res,this.$spriteSheet),this.enableCache&&(i[t]=e))},Object.defineProperty(e.prototype,"mcDataSet",{get:function(){return this.$mcDataSet},set:function(t){this.$mcDataSet=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{set:function(t){this.setTexture(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spriteSheet",{get:function(){return this.$spriteSheet},enumerable:!0,configurable:!0}),e.prototype.setTexture=function(t){this.$spriteSheet=t?new i.SpriteSheet(t):null},e);function e(t,e){var i=r.call(this)||this;return i.enableCache=!0,i.$mcDataCache={},i.$mcDataSet=t,i.setTexture(e),i}i.MovieClipDataFactory=t,__reflect(t.prototype,"egret.MovieClipDataFactory")}(egret=egret||{}),function(r){var n,t=(n=r.Event,__extends(o,n),o.dispatchMovieClipEvent=function(t,e,i){void 0===i&&(i=null);e=r.Event.create(o,e);e.frameLabel=i;t=t.dispatchEvent(e);return r.Event.release(e),t},o.FRAME_LABEL="frame_label",o);function o(t,e,i,r){void 0===r&&(r=null);i=n.call(this,t,e=void 0===e?!1:e,i=void 0===i?!1:i)||this;return i.frameLabel=null,i.frameLabel=r,i}r.MovieClipEvent=t,__reflect(t.prototype,"egret.MovieClipEvent")}(egret=egret||{}),function(o){var t=(e.get=function(e){return 1<(e=e<-1?-1:e)&&(e=1),function(t){return 0==e?t:e<0?t*(t*-e+1+e):t*((2-t)*e+(1-e))}},e.quintOut=(e.getPowOut=function(e){return function(t){return 1-Math.pow(1-t,e)}})(5),e.quartOut=e.getPowOut(4),e);function e(){o.$error(1014)}o.ScrollEase=t,__reflect(t.prototype,"egret.ScrollEase");var n,t=(n=o.EventDispatcher,__extends(d,n),d.get=function(t,e,i,r){return void 0===e&&(e=null),void 0===i&&(i=null),(r=void 0===r?!1:r)&&d.removeTweens(t),new d(t,e,i)},d.removeTweens=function(t){if(t.tween_count){for(var e=d._tweens,i=e.length-1;0<=i;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},d.tick=function(t,e){void 0===e&&(e=!1);var i=t-d._lastTime;d._lastTime=t;for(var r=d._tweens.concat(),n=r.length-1;0<=n;n--){var o=r[n];e&&!o.ignoreGlobalPause||o.paused||o.tick(o._useTicks?1:i)}return!1},d._register=function(t,e){var i=t._target,r=d._tweens;if(e)i&&(i.tween_count=0<i.tween_count?i.tween_count+1:1),r.push(t),d._inited||(d._lastTime=o.getTimer(),o.ticker.$startTick(d.tick,null),d._inited=!0);else{i&&i.tween_count--;for(var n=r.length;n--;)if(r[n]==t)return void r.splice(n,1)}},d.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&d.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:d._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},d.prototype.setPosition=function(t,e){void 0===e&&(e=1);var i=t=t<0?0:t,r=!1;if(i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,r=!0)),i==this._prevPos)return r;var n=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target)if(r)this._updateTargetProps(null,1);else if(0<this._steps.length){for(var o=void 0,a=this._steps.length,o=0;o<a&&!(this._steps[o].t>i);o++);t=this._steps[o-1];this._updateTargetProps(t,(this._stepPosition=i-t.t)/t.d)}return r&&this.setPaused(!0),0!=e&&0<this._actions.length&&(this._useTicks?this._runActions(i,i):1==e&&i<n?(n!=this.duration&&this._runActions(n,this.duration),this._runActions(0,i,!0)):this._runActions(n,i)),this.dispatchEventWith("change"),r},d.prototype._runActions=function(t,e,i){void 0===i&&(i=!1);var r=t,n=e,o=-1,a=this._actions.length,s=1;for(e<t&&(r=e,n=t,o=a,a=s=-1);(o+=s)!=a;){var h=this._actions[o],l=h.t;(l==n||r<l&&l<n||i&&l==t)&&h.f.apply(h.o,h.p)}},d.prototype._updateTargetProps=function(t,e){var i,r,n,o,a,s;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,r=t.p1}else this.passive=!1,i=r=this._curQueueProps;for(s in this._initQueueProps){null==(n=i[s])&&(i[s]=n=this._initQueueProps[s]),null==(o=r[s])&&(r[s]=o=n);var h=n==o||0==e||1==e||"number"!=typeof n?1==e?o:n:n+(o-n)*e,l=!1;if(a=d._plugins[s])for(var u=0,c=a.length;u<c;u++){var p=a[u].tween(this,s,h,i,r,e,!!t&&i==r,!t);p==d.IGNORE?l=!0:h=p}l||(this._target[s]=h)}},d.prototype.setPaused=function(t){return this.paused=t,d._register(this,!t),this},d.prototype._cloneProps=function(t){var e,i={};for(e in t)i[e]=t[e];return i},d.prototype._addStep=function(t){return 0<t.d&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},d.prototype._appendQueueProps=function(t){var e,i,r,n,o,a;for(a in t)if(void 0===this._initQueueProps[a]){if(i=this._target[a],e=d._plugins[a])for(r=0,n=e.length;r<n;r++)i=e[r].init(this,a,i);this._initQueueProps[a]=this._curQueueProps[a]=void 0===i?null:i}else i=this._curQueueProps[a];for(a in t){if(i=this._curQueueProps[a],e=d._plugins[a])for(o=o||{},r=0,n=e.length;r<n;r++)e[r].step&&e[r].step(this,a,i,t[a],o);this._curQueueProps[a]=t[a]}return o&&this._appendQueueProps(o),this._curQueueProps},d.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},d.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||e<0)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))})},d.prototype.call=function(t,e,i){return this._addAction({f:t,p:(i=void 0===i?void 0:i)||[],o:(e=void 0===e?void 0:e)||this._target})},d.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},d._tweens=[],d.IGNORE={},d._plugins={},d._inited=!1,d._lastTime=0,d);function d(t,e,i){var r=n.call(this)||this;return r._target=null,r._useTicks=!1,r.ignoreGlobalPause=!1,r.loop=!1,r.pluginData=null,r._steps=null,r._actions=null,r.paused=!1,r.duration=0,r._prevPos=-1,r.position=null,r._prevPosition=0,r._stepPosition=0,r.passive=!1,r.initialize(t,e,i),r}o.ScrollTween=t,__reflect(t.prototype,"egret.ScrollTween")}(egret=egret||{}),function(a){var i,t=(i=a.DisplayObjectContainer,__extends(c,i),Object.defineProperty(c.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),c.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,i.prototype.addChild.call(this,t),this._addEvents()))},c.prototype.removeContent=function(){this._content&&(this._removeEvents(),i.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(c.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())},enumerable:!0,configurable:!0}),c.prototype.setScrollPosition=function(t,e,i){var r,n,o;(i=void 0===i?!1:i)&&0==t&&0==e||!i&&this._ScrV_Props_._scrollTop==t&&this._ScrV_Props_._scrollLeft==e||(n=this._ScrV_Props_._scrollTop,o=this._ScrV_Props_._scrollLeft,i?(r=this.getMaxScrollLeft(),i=this.getMaxScrollTop(),(n<=0||i<=n)&&(t/=2),(o<=0||r<=o)&&(e/=2),n=n+t,o=o+e,this._ScrV_Props_._bounces||((n<=0||i<=n)&&(n=Math.max(0,Math.min(n,i))),(o<=0||r<=o)&&(o=Math.max(0,Math.min(o,r)))),this._ScrV_Props_._scrollTop=n,this._ScrV_Props_._scrollLeft=o):(this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e),this._validatePosition(!0,!0),this._updateContentPosition())},c.prototype._validatePosition=function(t,e){var i;void 0===e&&(e=!1),(t=void 0===t?!1:t)&&(i=this.height,t=this._getContentHeight(),this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-i)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,i<t?t-i/2:i/2)),e&&(i=this.width,e=this._getContentWidth(),this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-i)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,i<e?e-i/2:i/2))},c.prototype.$setWidth=function(t){this.$explicitWidth!=t&&(i.prototype.$setWidth.call(this,t),this._updateContentPosition())},c.prototype.$setHeight=function(t){this.$explicitHeight!=t&&(i.prototype.$setHeight.call(this,t),this._updateContentPosition())},c.prototype._updateContentPosition=function(){var t=this.height,e=this.width;this.scrollRect=new a.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),e,t),this.dispatchEvent(new a.Event(a.Event.CHANGE))},c.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;t=this._ScrV_Props_._verticalScrollPolicy,t=this.__checkScrollPolicy(t,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=t,e||t},c.prototype.__checkScrollPolicy=function(t,e,i){return"on"==t||"off"!=t&&i<e},c.prototype._addEvents=function(){this.addEventListener(a.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(a.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(a.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},c.prototype._removeEvents=function(){this.removeEventListener(a.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(a.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(a.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},c.prototype._onTouchBegin=function(t){t.$isDefaultPrevented||this._checkScrollPolicy()&&(this._ScrV_Props_._touchStartPosition.x=t.stageX,this._ScrV_Props_._touchStartPosition.y=t.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(a.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(a.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(a.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(a.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(t),t.preventDefault())},c.prototype._onTouchBeginCapture=function(t){if(this._checkScrollPolicy()){for(var e=t.target;e!=this;){if("_checkScrollPolicy"in e&&e._checkScrollPolicy())return;e=e.parent}t.stopPropagation();var i=this.cloneTouchEvent(t);this.delayTouchBeginEvent=i,this.touchBeginTimer||(this.touchBeginTimer=new a.Timer(100,1),this.touchBeginTimer.addEventListener(a.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(t)}},c.prototype._onTouchEndCapture=function(t){var e,i=this;this.delayTouchBeginEvent&&(this._onTouchBeginTimer(),t.stopPropagation(),e=this.cloneTouchEvent(t),a.callLater(function(){i.stage&&i.dispatchPropagationEvent(e)},this))},c.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},c.prototype.dispatchPropagationEvent=function(t){for(var e=t.$target,i=this.$getPropagationList(e),r=i.length,e=.5*i.length,n=-1,o=0;o<r;o++)if(i[o]===this._content){n=o;break}i.splice(0,n+1),this.$dispatchPropagationEvent(t,i,e-=n+1),a.Event.release(t)},c.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,i=t.stageY-this._ScrV_Props_._touchStartPosition.y;if(Math.sqrt(e*e+i*i)<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;i=this._getPointChange(t);this.setScrollPosition(i.y,i.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},c.prototype._onTouchEnd=function(t){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(a.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(a.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(a.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(a.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},c.prototype._onEnterFrame=function(t){var e=a.getTimer();100<e-this._ScrV_Props_._lastTouchTime&&e-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},c.prototype._logTouchEvent=function(t){this._ScrV_Props_._lastTouchPosition.x=t.stageX,this._ScrV_Props_._lastTouchPosition.y=t.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(t),this._ScrV_Props_._lastTouchTime=a.getTimer()},c.prototype._getPointChange=function(t){return{x:!1===this._ScrV_Props_._hCanScroll?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:!1===this._ScrV_Props_._vCanScroll?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},c.prototype._calcVelocitys=function(t){var e,i,r=a.getTimer();0!=this._ScrV_Props_._lastTouchTime?(e=this._getPointChange(t),i=r-this._ScrV_Props_._lastTouchTime,e.x/=i,e.y/=i,this._ScrV_Props_._velocitys.push(e),5<this._ScrV_Props_._velocitys.length&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=t.stageX,this._ScrV_Props_._lastTouchPosition.y=t.stageY):this._ScrV_Props_._lastTouchTime=r},c.prototype._getContentWidth=function(){return this._content.$explicitWidth||this._content.width},c.prototype._getContentHeight=function(){return this._content.$explicitHeight||this._content.height},c.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},c.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},c.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,i=0;i<this._ScrV_Props_._velocitys.length;i++){var r=this._ScrV_Props_._velocitys[i],n=c.weight[i];t.x+=r.x*n,t.y+=r.y*n,e+=n}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var o=t.x/e*this.scrollSpeed,a=t.y/e*this.scrollSpeed,s=Math.abs(o),h=Math.abs(a),l=this.getMaxScrollLeft(),u=this.getMaxScrollTop(),l=.02<s?this.getAnimationDatas(o,this._ScrV_Props_._scrollLeft,l):{position:this._ScrV_Props_._scrollLeft,duration:1},u=.02<h?this.getAnimationDatas(a,this._ScrV_Props_._scrollTop,u):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(l.position,l.duration),this.setScrollTop(u.position,u.duration)}},c.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},c.prototype._onScrollStarted=function(){},c.prototype._onScrollFinished=function(){a.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new a.Event(a.Event.COMPLETE))},c.prototype.setScrollTop=function(t,e){void 0===e&&(e=0);var i=Math.min(this.getMaxScrollTop(),Math.max(t,0));0!=e?(0==this._ScrV_Props_._bounces&&(t=i),e=a.ScrollTween.get(this).to({scrollTop:t},e,a.ScrollEase.quartOut),i!=t&&e.to({scrollTop:i},300,a.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,(this._ScrV_Props_._vScrollTween=e).call(this.onTweenFinished,this,[e]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()):this.scrollTop=i},c.prototype.setScrollLeft=function(t,e){void 0===e&&(e=0);var i=Math.min(this.getMaxScrollLeft(),Math.max(t,0));0!=e?(0==this._ScrV_Props_._bounces&&(t=i),e=a.ScrollTween.get(this).to({scrollLeft:t},e,a.ScrollEase.quartOut),i!=t&&e.to({scrollLeft:i},300,a.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,(this._ScrV_Props_._hScrollTween=e).call(this.onTweenFinished,this,[e]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()):this.scrollLeft=i},c.prototype.getAnimationDatas=function(t,e,i){var r=Math.abs(t),n=0,o=e+500*t;if(o<0||i<o)for(o=e;Math.abs(t)!=1/0&&.02<Math.abs(t);)t*=(o+=t)<0||i<o?.998*.95:.998,n++;else n=500*-Math.log(.02/r);return{position:Math.min(i+50,Math.max(o,-50)),duration:n}},c.prototype.cloneTouchEvent=function(t){var e=new a.TouchEvent(t.type,t.bubbles,t.cancelable);return e.touchPointID=t.touchPointID,e.$stageX=t.stageX,e.$stageY=t.stageY,e.touchDown=t.touchDown,e.$isDefaultPrevented=!1,e.$target=t.target,e},c.prototype.throwNotSupportedError=function(){a.$error(1023)},c.prototype.addChild=function(t){return this.throwNotSupportedError(),null},c.prototype.addChildAt=function(t,e){return this.throwNotSupportedError(),null},c.prototype.removeChild=function(t){return this.throwNotSupportedError(),null},c.prototype.removeChildAt=function(t){return this.throwNotSupportedError(),null},c.prototype.setChildIndex=function(t,e){this.throwNotSupportedError()},c.prototype.swapChildren=function(t,e){this.throwNotSupportedError()},c.prototype.swapChildrenAt=function(t,e){this.throwNotSupportedError()},c.weight=[1,1.33,1.66,2,2.33],c);function c(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.scrollBeginThreshold=10,e.scrollSpeed=1,e._content=null,e.delayTouchBeginEvent=null,e.touchBeginTimer=null,e.touchEnabled=!0,e._ScrV_Props_=new a.ScrollViewProperties,t&&e.setContent(t),e}a.ScrollView=t,__reflect(t.prototype,"egret.ScrollView")}(egret=egret||{}),function(t){function e(){this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="auto",this._scrollLeft=0,this._scrollTop=0,this._hCanScroll=!1,this._vCanScroll=!1,this._lastTouchPosition=new t.Point(0,0),this._touchStartPosition=new t.Point(0,0),this._scrollStarted=!1,this._lastTouchTime=0,this._lastTouchEvent=null,this._velocitys=[],this._isHTweenPlaying=!1,this._isVTweenPlaying=!1,this._hScrollTween=null,this._vScrollTween=null,this._bounces=!0}t.ScrollViewProperties=e,__reflect(e.prototype,"egret.ScrollViewProperties")}(egret=egret||{}),function(l){var i,t=(i=l.EventDispatcher,__extends(e,i),e.prototype.load=function(t){this._request=t,this.data=null;var e=this;if(e.dataFormat!=l.URLLoaderDataFormat.TEXTURE)if(e.dataFormat!=l.URLLoaderDataFormat.SOUND){var i,r,n,r=r=-1==(r=(i=t).url).indexOf("?")&&i.method==l.URLRequestMethod.GET&&i.data&&i.data instanceof l.URLVariables?r+"?"+i.data.toString():r,o=new l.HttpRequest;o.open(r,t.method==l.URLRequestMethod.POST?l.HttpMethod.POST:l.HttpMethod.GET),t.method!=l.URLRequestMethod.GET&&t.data&&(n=t.data instanceof l.URLVariables?(o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.data.toString()):(o.setRequestHeader("Content-Type","multipart/form-data"),t.data));for(var a=t.requestHeaders.length,s=0;s<a;s++){var h=t.requestHeaders[s];o.setRequestHeader(h.name,h.value)}o.addEventListener(l.Event.COMPLETE,function(){e.data=o.response,l.Event.dispatchEvent(e,l.Event.COMPLETE)},this),o.addEventListener(l.IOErrorEvent.IO_ERROR,function(){l.IOErrorEvent.dispatchIOErrorEvent(e)},this),o.responseType=e.dataFormat==l.URLLoaderDataFormat.BINARY?l.HttpResponseType.ARRAY_BUFFER:l.HttpResponseType.TEXT,o.send(n)}else this.loadSound(e);else this.loadTexture(e)},e.prototype.getResponseType=function(t){switch(t){case l.URLLoaderDataFormat.TEXT:case l.URLLoaderDataFormat.VARIABLES:return l.URLLoaderDataFormat.TEXT;case l.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return t}},e.prototype.loadSound=function(t){var e=t._request.url,t=new l.Sound;(this.sound=t).addEventListener(l.Event.COMPLETE,this.onSoundoadComplete,this),t.addEventListener(l.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),t.addEventListener(l.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this),t.load(e)},e.prototype.onSoundoadComplete=function(t){var e=this;this.removeSoundLoaderListeners(),this.data=this.sound,window.setTimeout(function(){e.dispatchEventWith(l.Event.COMPLETE)},0)},e.prototype.onSoundLoaderPostProgress=function(t){this.dispatchEvent(t)},e.prototype.onSoundLoaderError=function(t){this.dispatchEvent(t)},e.prototype.removeSoundLoaderListeners=function(){this.sound.removeEventListener(l.Event.COMPLETE,this.onSoundoadComplete,this),this.sound.removeEventListener(l.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),this.sound.removeEventListener(l.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this)},e.prototype.loadTexture=function(t){this.virtualUrl=t._request.url;t=new l.ImageLoader;(this.imageLoader=t).addEventListener(l.Event.COMPLETE,this.onImageLoadComplete,this),t.addEventListener(l.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),t.addEventListener(l.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this),t.load(this.virtualUrl)},e.prototype.onImageLoadComplete=function(t){var e=this;this.removeImageLoaderListeners();var i=new l.Texture,r=this.imageLoader.data;r.source.setAttribute&&r.source.setAttribute("bitmapSrc",this.virtualUrl),i._setBitmapData(r),this.data=i,window.setTimeout(function(){e.dispatchEventWith(l.Event.COMPLETE)},0)},e.prototype.onImageLoaderPostProgress=function(t){this.dispatchEvent(t)},e.prototype.onImageLoaderError=function(t){this.dispatchEvent(t)},e.prototype.removeImageLoaderListeners=function(){this.imageLoader.removeEventListener(l.Event.COMPLETE,this.onImageLoadComplete,this),this.imageLoader.removeEventListener(l.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),this.imageLoader.removeEventListener(l.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this)},e.prototype.__recycle=function(){this._request=null,this.data=null},e);function e(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.dataFormat=l.URLLoaderDataFormat.TEXT,e.data=null,e._request=null,e._status=-1,t&&e.load(t),e}l.URLLoader=t,__reflect(t.prototype,"egret.URLLoader")}(egret=egret||{}),function(c){var i,t=(i=c.DisplayObject,__extends(e,i),e.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(e.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t)},enumerable:!0,configurable:!0}),e.prototype.$init=function(){this.$reset();var t=this.$movieClipData;t&&t.$isDataValid()&&(this.frames=t.frames,this.$totalFrames=t.numFrames,this.frameLabels=t.labels,this.frameEvents=t.events,this.$frameRate=t.frameRate,this.frameIntervalTime=1e3/this.$frameRate,this._initFrame())},e.prototype.$reset=function(){this.frames=null,this.playTimes=0,this.$isPlaying=!1,this.setIsStopped(!0),this.$currentFrameNum=0,this.$nextFrameNum=1,this.displayedKeyFrameNum=0,this.passedTime=0,this.$eventPool=[]},e.prototype._initFrame=function(){this.$movieClipData.$isTextureValid()&&(this.advanceFrame(),this.constructFrame())},e.prototype.$updateRenderNode=function(){var t,e,i,r,n,o,a,s,h,l,u=this.$texture;u&&(t=Math.round(this.offsetPoint.x),e=Math.round(this.offsetPoint.y),i=u.$bitmapWidth,r=u.$bitmapHeight,n=u.$getTextureWidth(),o=u.$getTextureHeight(),a=Math.round(u.$getScaleBitmapWidth()),s=Math.round(u.$getScaleBitmapHeight()),h=u.$sourceWidth,l=u.$sourceHeight,c.sys.BitmapNode.$updateTextureData(this.$renderNode,u.$bitmapData,u.$bitmapX,u.$bitmapY,i,r,t,e,n,o,a,s,h,l,c.BitmapFillMode.SCALE,this.$smoothing))},e.prototype.$measureContentBounds=function(t){var e,i,r,n=this.$texture;n?(e=this.offsetPoint.x,i=this.offsetPoint.y,r=n.$getTextureWidth(),n=n.$getTextureHeight(),t.setTo(e,i,r,n)):t.setEmpty()},e.prototype.$onAddToStage=function(t,e){i.prototype.$onAddToStage.call(this,t,e),this.$isPlaying&&1<this.$totalFrames&&this.setIsStopped(!1)},e.prototype.$onRemoveFromStage=function(){i.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},e.prototype.getFrameLabelByName=function(t,e){(e=void 0===e?!1:e)&&(t=t.toLowerCase());var i=this.frameLabels;if(i)for(var r=null,n=0;n<i.length;n++)if(r=i[n],e?r.name.toLowerCase()==t:r.name==t)return r;return null},e.prototype.getFrameStartEnd=function(t){var e=this.frameLabels;if(e)for(var i,r=0;r<e.length;r++)if(t==(i=e[r]).name){this.$frameLabelStart=i.frame,this.$frameLabelEnd=i.end;break}},e.prototype.getFrameLabelByFrame=function(t){var e=this.frameLabels;if(e)for(var i,r=0;r<e.length;r++)if((i=e[r]).frame==t)return i;return null},e.prototype.getFrameLabelForFrame=function(t){var e,i=null,r=this.frameLabels;if(r)for(var n=0;n<r.length;n++){if((e=r[n]).frame>t)return i;i=e}return i},e.prototype.play=function(t){void 0===t&&(t=0),this.lastTime=c.getTimer(),this.passedTime=0,this.$isPlaying=!0,this.setPlayTimes(t),1<this.$totalFrames&&this.$stage&&this.setIsStopped(!1)},e.prototype.stop=function(){this.$isPlaying=!1,this.setIsStopped(!0)},e.prototype.prevFrame=function(){this.gotoAndStop(this.$currentFrameNum-1)},e.prototype.nextFrame=function(){this.gotoAndStop(this.$currentFrameNum+1)},e.prototype.gotoAndPlay=function(t,e){void 0===e&&(e=0),(0==arguments.length||2<arguments.length)&&c.$error(1022,"MovieClip.gotoAndPlay()"),"string"==typeof t?this.getFrameStartEnd(t):(this.$frameLabelStart=0,this.$frameLabelEnd=0),this.play(e),this.gotoFrame(t)},e.prototype.gotoAndStop=function(t){1!=arguments.length&&c.$error(1022,"MovieClip.gotoAndStop()"),this.stop(),this.gotoFrame(t)},e.prototype.gotoFrame=function(t){var e;"string"==typeof t?e=this.getFrameLabelByName(t).frame:(e=parseInt(t+"",10))!=t&&c.$error(1022,"Frame Label Not Found"),e<1?e=1:e>this.$totalFrames&&(e=this.$totalFrames),this.$nextFrameNum=e,this.advanceFrame(),this.constructFrame(),this.handlePendingEvent()},e.prototype.advanceTime=function(t){var e=this,i=t-e.lastTime;e.lastTime=t;t=e.frameIntervalTime,i=e.passedTime+i;e.passedTime=i%t;var r=i/t;if(r<1)return!1;for(;1<=r;){if(r--,e.$nextFrameNum++,e.$nextFrameNum>e.$totalFrames||0<e.$frameLabelStart&&e.$nextFrameNum>e.$frameLabelEnd)if(-1==e.playTimes)e.$eventPool.push(c.Event.LOOP_COMPLETE),e.$nextFrameNum=1;else{if(e.playTimes--,!(0<e.playTimes)){e.$nextFrameNum=e.$totalFrames,e.$eventPool.push(c.Event.COMPLETE),e.stop();break}e.$eventPool.push(c.Event.LOOP_COMPLETE),e.$nextFrameNum=1}e.$currentFrameNum==e.$frameLabelEnd&&(e.$nextFrameNum=e.$frameLabelStart),e.advanceFrame()}return e.constructFrame(),e.handlePendingEvent(),!1},e.prototype.advanceFrame=function(){this.$currentFrameNum=this.$nextFrameNum;var t=this.frameEvents[this.$nextFrameNum];t&&""!=t&&c.MovieClipEvent.dispatchMovieClipEvent(this,c.MovieClipEvent.FRAME_LABEL,t)},e.prototype.constructFrame=function(){var t,e=this,i=e.$currentFrameNum;e.displayedKeyFrameNum!=i&&(t=e.$movieClipData.getTextureByFrame(i),e.$texture=t,e.$movieClipData.$getOffsetByFrame(i,e.offsetPoint),e.displayedKeyFrameNum=i,e.$renderDirty=!0,c.nativeRender?(e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,t,[t.$bitmapX,t.$bitmapY,t.$bitmapWidth,t.$bitmapHeight,e.offsetPoint.x,e.offsetPoint.y,t.$getScaleBitmapWidth(),t.$getScaleBitmapHeight(),t.$sourceWidth,t.$sourceHeight]),e.$nativeDisplayObject.setWidth(t.$getTextureWidth()),e.$nativeDisplayObject.setHeight(t.$getTextureHeight())):((t=e.$parent)&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp()),(e=e.$maskedObject)&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp())))},e.prototype.$renderFrame=function(){this.$texture=this.$movieClipData.getTextureByFrame(this.$currentFrameNum),this.$renderDirty=!0;var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp());t=this.$maskedObject;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},e.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();for(var t=this.$eventPool,e=t.length,i=!1,r=!1,n=0;n<e;n++){var o=t.pop();o==c.Event.LOOP_COMPLETE?r=!0:o==c.Event.COMPLETE?i=!0:this.dispatchEventWith(o)}r&&this.dispatchEventWith(c.Event.LOOP_COMPLETE),i&&this.dispatchEventWith(c.Event.COMPLETE)}},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this.$totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this.$currentFrameNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrameLabel",{get:function(){var t=this.getFrameLabelByFrame(this.$currentFrameNum);return t&&t.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentLabel",{get:function(){var t=this.getFrameLabelForFrame(this.$currentFrameNum);return t?t.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return this.$frameRate},set:function(t){t!=this.$frameRate&&(this.$frameRate=t,this.frameIntervalTime=1e3/this.$frameRate)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"movieClipData",{get:function(){return this.$movieClipData},set:function(t){this.setMovieClipData(t)},enumerable:!0,configurable:!0}),e.prototype.setMovieClipData=function(t){this.$movieClipData!=t&&(this.$movieClipData=t,this.$init())},e.prototype.setPlayTimes=function(t){(t<0||1<=t)&&(this.playTimes=t<0?-1:Math.floor(t))},e.prototype.setIsStopped=function(t){this.isStopped!=t&&((this.isStopped=t)?c.ticker.$stopTick(this.advanceTime,this):(this.playTimes=0==this.playTimes?1:this.playTimes,this.lastTime=c.getTimer(),c.ticker.$startTick(this.advanceTime,this)))},e);function e(t){var e=i.call(this)||this;return e.$texture=null,e.offsetPoint=c.Point.create(0,0),e.$movieClipData=null,e.frames=null,e.$totalFrames=0,e.frameLabels=null,e.$frameLabelStart=0,e.$frameLabelEnd=0,e.frameEvents=null,e.frameIntervalTime=0,e.$eventPool=null,e.$isPlaying=!1,e.isStopped=!0,e.playTimes=0,e.$currentFrameNum=0,e.$nextFrameNum=1,e.displayedKeyFrameNum=0,e.passedTime=0,e.$frameRate=NaN,e.lastTime=0,e.$smoothing=c.Bitmap.defaultSmoothing,e.setMovieClipData(t),c.nativeRender||(e.$renderNode=new c.sys.NormalBitmapNode),e}c.MovieClip=t,__reflect(t.prototype,"egret.MovieClip")}(egret=egret||{}),function(i){var r,t=(r=i.HashObject,__extends(e,r),e);function e(t){void 0===t&&(t=null);var e=r.call(this)||this;return e.data=null,e.method=i.URLRequestMethod.GET,e.url="",e.requestHeaders=[],e.url=t,e}i.URLRequest=t,__reflect(t.prototype,"egret.URLRequest")}(egret=egret||{}),function(){function t(t,e){this.name="",this.value="",this.name=t,this.value=e}(egret||(egret={})).URLRequestHeader=t,__reflect(t.prototype,"egret.URLRequestHeader")}(),function(t){var e=(i.GET="get",i.POST="post",i);function i(){}t.URLRequestMethod=e,__reflect(e.prototype,"egret.URLRequestMethod")}(egret=egret||{}),function(t){var i,e=(i=t.HashObject,__extends(r,i),r.prototype.decode=function(t){this.variables||(this.variables={}),t=t.split("+").join(" ");for(var e=/[?&]?([^=]+)=([^&]*)/g;i=e.exec(t);){var i,r=decodeURIComponent(i[1]),n=decodeURIComponent(i[2]);r in this.variables!=0?(i=this.variables[r])instanceof Array?i.push(n):this.variables[r]=[i,n]:this.variables[r]=n}},r.prototype.toString=function(){if(!this.variables)return"";var t,e=this.variables,i=[];for(t in e)i.push(this.encodeValue(t,e[t]));return i.join("&")},r.prototype.encodeValue=function(t,e){return e instanceof Array?this.encodeArray(t,e):encodeURIComponent(t)+"="+encodeURIComponent(e)},r.prototype.encodeArray=function(e,t){return e?0==t.length?encodeURIComponent(e)+"=":t.map(function(t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}).join("&"):""},r);function r(t){void 0===t&&(t=null);var e=i.call(this)||this;return(e.variables=null)!==t&&e.decode(t),e}t.URLVariables=e,__reflect(e.prototype,"egret.URLVariables")}(egret=egret||{}),function(e){var i,t=(i=e.EventDispatcher,__extends(r,i),r.prototype.update=function(t){var e=t-this._lastTime;if(this._lastTime=t,this._paused)return!1;var i=e*this._timeScale;for(this._callList=this.callBackList.concat(),this._callIndex=0;this._callIndex<this._callList.length;this._callIndex++){var r=this._callList[this._callIndex];r.listener.call(r.thisObject,i)}return this._callIndex=-1,this._callList=null,!1},r.prototype.register=function(t,e,i){this.$insertEventBin(this.callBackList,"",t,e,!1,i=void 0===i?0:i,!1)},r.prototype.unregister=function(t,e){this.$removeEventBin(this.callBackList,t,e)},r.prototype.setTimeScale=function(t){this._timeScale=t},r.prototype.getTimeScale=function(){return this._timeScale},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){this._paused=!1},r.getInstance=function(){return r.instance=null==r.instance?new r:r.instance},r);function r(){var t=i.call(this)||this;return t._timeScale=1,t._paused=!1,t._callIndex=-1,t._lastTime=0,t.callBackList=[],null!=r.instance&&e.$error(1033),e.ticker.$startTick(t.update,t),t._lastTime=e.getTimer(),t}e.Ticker=t,__reflect(t.prototype,"egret.Ticker")}(egret=egret||{}),function(t){var e,i=(e=t.EventDispatcher,__extends(r,e),Object.defineProperty(r.prototype,"stage",{get:function(){return t.sys.$TempStage},enumerable:!0,configurable:!0}),Object.defineProperty(r,"instance",{get:function(){return r._instance=null==r._instance?new r:r._instance},enumerable:!0,configurable:!0}),r.deviceType=null,r.DEVICE_PC="web",r.DEVICE_MOBILE="native",r);function r(){return e.call(this)||this}t.MainContext=i,__reflect(i.prototype,"egret.MainContext")}(egret=egret||{}),egret.testDeviceType1=function(){if(!window.navigator||!navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},egret.MainContext.deviceType=egret.testDeviceType1()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC,delete egret.testDeviceType1,function(t){var i,e=(i=t.HashObject,__extends(r,i),r.$init=function(){t.ticker.$startTick(r.onUpdate,r)},r.onUpdate=function(t){for(var e=r._callBackList,i=e.length-1;0<=i;i--)e[i].$checkFrame();return!1},r.prototype.$checkFrame=function(){this.frameCount--,this.frameCount<=0&&this.dispose()},Object.defineProperty(r.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),r.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),t.__recycle&&t.__recycle(),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,r._callBackList.push(this)))},r.prototype.pop=function(){return 0==this._length?null:(this._length--,this.objectPool.pop())},r.prototype.dispose=function(){0<this._length&&(this.objectPool=[],this._length=0),this.frameCount=0;var t=r._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)},r._callBackList=[],r);function r(t){void 0===t&&(t=300);var e=i.call(this)||this;return e.objectPool=[],e._length=0,e.autoDisposeTime=t=t<1?1:t,e.frameCount=0,e}t.Recycler=e,__reflect(e.prototype,"egret.Recycler"),e.$init()}(egret=egret||{}),function(a){var s={},h=0,l=0,u=0;function c(t){var e,i=t-u;for(e in u=t,s){var r=s[e];r.delay-=i,r.delay<=0&&(r.delay=r.originDelay,r.listener.apply(r.thisObject,r.params))}return!1}a.setInterval=function(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var o={listener:t,thisObject:e,delay:i,originDelay:i,params:r};return 1==++l&&(u=a.getTimer(),a.ticker.$startTick(c,null)),s[++h]=o,h},a.clearInterval=function(t){s[t]&&(l--,delete s[t],0==l&&a.ticker.$stopTick(c,null))}}(egret=egret||{}),function(a){var s={},h=0,l=0,u=0;function o(t){s[t]&&(l--,delete s[t],0==l&&a.ticker&&a.ticker.$stopTick(c,null))}function c(t){var e,i=t-u;for(e in u=t,s){var r=e,n=s[r];n.delay-=i,n.delay<=0&&(o(r),n.listener.apply(n.thisObject,n.params))}return!1}a.setTimeout=function(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var o={listener:t,thisObject:e,delay:i,params:r};return 1==++l&&a.ticker&&(u=a.getTimer(),a.ticker.$startTick(c,null)),s[++h]=o,h},a.clearTimeout=o}(egret=egret||{});__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};!function(t){var e=(i.get=function(e){return 1<(e=e<-1?-1:e)&&(e=1),function(t){return 0==e?t:e<0?t*(t*-e+1+e):t*((2-t)*e+(1-e))}},i.getPowIn=function(e){return function(t){return Math.pow(t,e)}},i.getPowOut=function(e){return function(t){return 1-Math.pow(1-t,e)}},i.getPowInOut=function(e){return function(t){return(t*=2)<1?.5*Math.pow(t,e):1-.5*Math.abs(Math.pow(2-t,e))}},i.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},i.sineOut=function(t){return Math.sin(t*Math.PI/2)},i.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},i.getBackIn=function(e){return function(t){return t*t*((e+1)*t-e)}},i.getBackOut=function(e){return function(t){return--t*t*((e+1)*t+e)+1}},i.getBackInOut=function(e){return e*=1.525,function(t){return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},i.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},i.circOut=function(t){return Math.sqrt(1- --t*t)},i.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},i.bounceIn=function(t){return 1-i.bounceOut(1-t)},i.bounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},i.bounceInOut=function(t){return t<.5?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5},i.getElasticIn=function(i,r){var n=2*Math.PI;return function(t){if(0==t||1==t)return t;var e=r/n*Math.asin(1/i);return-(i*Math.pow(2,10*--t)*Math.sin((t-e)*n/r))}},i.getElasticOut=function(i,r){var n=2*Math.PI;return function(t){if(0==t||1==t)return t;var e=r/n*Math.asin(1/i);return i*Math.pow(2,-10*t)*Math.sin((t-e)*n/r)+1}},i.getElasticInOut=function(i,r){var n=2*Math.PI;return function(t){var e=r/n*Math.asin(1/i);return(t*=2)<1?i*Math.pow(2,10*--t)*Math.sin((t-e)*n/r)*-.5:i*Math.pow(2,-10*--t)*Math.sin((t-e)*n/r)*.5+1}},i.quadIn=i.getPowIn(2),i.quadOut=i.getPowOut(2),i.quadInOut=i.getPowInOut(2),i.cubicIn=i.getPowIn(3),i.cubicOut=i.getPowOut(3),i.cubicInOut=i.getPowInOut(3),i.quartIn=i.getPowIn(4),i.quartOut=i.getPowOut(4),i.quartInOut=i.getPowInOut(4),i.quintIn=i.getPowIn(5),i.quintOut=i.getPowOut(5),i.quintInOut=i.getPowInOut(5),i.backIn=i.getBackIn(1.7),i.backOut=i.getBackOut(1.7),i.backInOut=i.getBackInOut(1.7),i.elasticIn=i.getElasticIn(1,.3),i.elasticOut=i.getElasticOut(1,.3),i.elasticInOut=i.getElasticInOut(1,.3*1.5),i);function i(){t.$error(1014)}t.Ease=e,__reflect(e.prototype,"egret.Ease")}(egret=egret||{}),function(o){var n,t=(n=o.EventDispatcher,__extends(d,n),d.get=function(t,e,i,r){return void 0===i&&(i=null),(r=void 0===r?!1:r)&&d.removeTweens(t),new d(t,e,i)},d.removeTweens=function(t){if(t.tween_count){for(var e=d._tweens,i=e.length-1;0<=i;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},d.pauseTweens=function(t){if(t.tween_count)for(var e=o.Tween._tweens,i=e.length-1;0<=i;i--)e[i]._target==t&&(e[i].paused=!0)},d.resumeTweens=function(t){if(t.tween_count)for(var e=o.Tween._tweens,i=e.length-1;0<=i;i--)e[i]._target==t&&(e[i].paused=!1)},d.tick=function(t,e){void 0===e&&(e=!1);var i=t-d._lastTime;d._lastTime=t;for(var r=d._tweens.concat(),n=r.length-1;0<=n;n--){var o=r[n];e&&!o.ignoreGlobalPause||o.paused||o.$tick(o._useTicks?1:i)}return!1},d._register=function(t,e){var i=t._target,r=d._tweens;if(e)i&&(i.tween_count=0<i.tween_count?i.tween_count+1:1),r.push(t),d._inited||(d._lastTime=o.getTimer(),o.ticker.$startTick(d.tick,null),d._inited=!0);else{i&&i.tween_count--;for(var n=r.length;n--;)if(r[n]==t)return void r.splice(n,1)}},d.removeAllTweens=function(){for(var t=d._tweens,e=0,i=t.length;e<i;e++){var r=t[e];r.paused=!0,r._target.tween_count=0}t.length=0},d.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&d.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],e&&e.paused?this.paused=!0:d._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,d.NONE)},d.prototype.setPosition=function(t,e){void 0===e&&(e=1);var i,r=t=t<0?0:t,n=!1;if(r>=this.duration&&(this.loop?(i=r%this.duration,r=0<r&&0==i?this.duration:i):(r=this.duration,n=!0)),r==this._prevPos)return n;n&&this.setPaused(!0);var o=this._prevPos;if(this.position=this._prevPos=r,this._prevPosition=t,this._target&&0<this._steps.length){for(var a=this._steps.length,s=-1,h=0;h<a&&!("step"==this._steps[h].type&&(s=h,this._steps[h].t<=r&&this._steps[h].t+this._steps[h].d>=r));h++);for(var l,h=0;h<a;h++)"action"==this._steps[h].type?0!=e&&(this._useTicks?this._runAction(this._steps[h],r,r):1==e&&r<o?(o!=this.duration&&this._runAction(this._steps[h],o,this.duration),this._runAction(this._steps[h],0,r,!0)):this._runAction(this._steps[h],o,r)):"step"==this._steps[h].type&&s==h&&(l=this._steps[s],this._updateTargetProps(l,Math.min((this._stepPosition=r-l.t)/l.d,1)))}return this.dispatchEventWith("change"),n},d.prototype._runAction=function(t,e,i,r){void 0===r&&(r=!1);var n=e,o=i;i<e&&(n=i,o=e);i=t.t;(i==o||n<i&&i<o||r&&i==e)&&t.f.apply(t.o,t.p)},d.prototype._updateTargetProps=function(t,e){var i,r,n,o,a,s;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,r=t.p1}else this.passive=!1,i=r=this._curQueueProps;for(s in this._initQueueProps){null==(n=i[s])&&(i[s]=n=this._initQueueProps[s]),null==(o=r[s])&&(r[s]=o=n);var h=n==o||0==e||1==e||"number"!=typeof n?1==e?o:n:n+(o-n)*e,l=!1;if(a=d._plugins[s])for(var u=0,c=a.length;u<c;u++){var p=a[u].tween(this,s,h,i,r,e,!!t&&i==r,!t);p==d.IGNORE?l=!0:h=p}l||(this._target[s]=h)}},d.prototype.setPaused=function(t){return this.paused==t||(this.paused=t,d._register(this,!t)),this},d.prototype._cloneProps=function(t){var e,i={};for(e in t)i[e]=t[e];return i},d.prototype._addStep=function(t){return 0<t.d&&(t.type="step",this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},d.prototype._appendQueueProps=function(t){var e,i,r,n,o,a;for(a in t)if(void 0===this._initQueueProps[a]){if(i=this._target[a],e=d._plugins[a])for(r=0,n=e.length;r<n;r++)i=e[r].init(this,a,i);this._initQueueProps[a]=this._curQueueProps[a]=void 0===i?null:i}else i=this._curQueueProps[a];for(a in t){if(i=this._curQueueProps[a],e=d._plugins[a])for(o=o||{},r=0,n=e.length;r<n;r++)e[r].step&&e[r].step(this,a,i,t[a],o);this._curQueueProps[a]=t[a]}return o&&this._appendQueueProps(o),this._curQueueProps},d.prototype._addAction=function(t){return t.t=this.duration,t.type="action",this._steps.push(t),this},d.prototype._set=function(t,e){for(var i in t)e[i]=t[i]},d.prototype.wait=function(t,e){if(null==t||t<=0)return this;var i=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:i,p1:i,v:e})},d.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||e<0)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))}),this.set(t)},d.prototype.call=function(t,e,i){return this._addAction({f:t,p:(i=void 0===i?void 0:i)||[],o:(e=void 0===e?void 0:e)||this._target})},d.prototype.set=function(t,e){return void 0===e&&(e=null),this._appendQueueProps(t),this._addAction({f:this._set,o:this,p:[t,e||this._target]})},d.prototype.play=function(t){return this.call((t=t||this).setPaused,t,[!1])},d.prototype.pause=function(t){return this.call((t=t||this).setPaused,t,[!0])},d.prototype.$tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},d.NONE=0,d.LOOP=1,d.REVERSE=2,d._tweens=[],d.IGNORE={},d._plugins={},d._inited=!1,d._lastTime=0,d);function d(t,e,i){var r=n.call(this)||this;return r._target=null,r._useTicks=!1,r.ignoreGlobalPause=!1,r.loop=!1,r.pluginData=null,r._steps=null,r.paused=!1,r.duration=0,r._prevPos=-1,r.position=null,r._prevPosition=0,r._stepPosition=0,r.passive=!1,r.initialize(t,e,i),r}o.Tween=t,__reflect(t.prototype,"egret.Tween")}(egret=egret||{}),function(T){!function(t){var e,i=(e=T.EventDispatcher,__extends(r,e),r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="",t}t.BasePath=i,__reflect(i.prototype,"egret.tween.BasePath");var n,o=(__extends(a,n=i),a);function a(){var t=null!==n&&n.apply(this,arguments)||this;return t.props=void 0,t.duration=500,t.ease=void 0,t}t.To=o,__reflect(o.prototype,"egret.tween.To");var s,h=(__extends(l,s=i),l);function l(){var t=null!==s&&s.apply(this,arguments)||this;return t.duration=500,t.passive=void 0,t}t.Wait=h,__reflect(h.prototype,"egret.tween.Wait");var u,c=(__extends(p,u=i),p);function p(){var t=null!==u&&u.apply(this,arguments)||this;return t.props=void 0,t}t.Set=c,__reflect(c.prototype,"egret.tween.Set");var d,f=(__extends(_,d=i),_);function _(){var t=null!==d&&d.apply(this,arguments)||this;return t.delta=0,t}t.Tick=f,__reflect(f.prototype,"egret.tween.Tick");var g,i=(g=T.EventDispatcher,__extends(y,g),Object.defineProperty(y.prototype,"props",{get:function(){return this._props},set:function(t){this._props=t},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"paths",{get:function(){return this._paths},set:function(t){this._paths=t||[]},enumerable:!0,configurable:!0}),y.prototype.play=function(t){this.tween?(this.tween.setPaused(!1),this.isStop&&null==t&&(t=0,this.isStop=!1),null!=t&&this.tween.setPosition(t)):this.createTween(t)},y.prototype.pause=function(){this.tween&&this.tween.setPaused(!0)},y.prototype.stop=function(){this.pause(),this.isStop=!0},y.prototype.createTween=function(t){this.tween=T.Tween.get(this._target,this._props),this._paths&&this.applyPaths(),null!=t&&this.tween.setPosition(t)},y.prototype.applyPaths=function(){for(var t=0;t<this._paths.length;t++){var e=this._paths[t];this.applyPath(e)}},y.prototype.applyPath=function(t){var e,i=this;t instanceof o?this.tween.to(t.props,t.duration,"function"==typeof(e=t.ease)||"function"==typeof(e=T.Ease[e])?e:null):t instanceof h?this.tween.wait(t.duration,t.passive):t instanceof c?this.tween.set(t.props):t instanceof f&&this.tween.$tick(t.delta),this.tween.call(function(){return i.pathComplete(t)})},y.prototype.pathComplete=function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",!1,t);t=this._paths.indexOf(t);0<=t&&t===this._paths.length-1&&this.dispatchEventWith("complete")},y);function y(){var t=g.call(this)||this;return t.isStop=!1,t}t.TweenItem=i,__reflect(i.prototype,"egret.tween.TweenItem"),b(i,"paths","Array",!0);var m,i=(m=T.EventDispatcher,__extends(v,m),Object.defineProperty(v.prototype,"items",{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)},enumerable:!0,configurable:!0}),v.prototype.registerEvent=function(e){var i=this;this._items&&this._items.forEach(function(t){e?t.addEventListener("complete",i.itemComplete,i):t.removeEventListener("complete",i.itemComplete,i)})},v.prototype.play=function(t){if(this._items)for(var e=0;e<this._items.length;e++)this._items[e].play(t)},v.prototype.pause=function(){if(this._items)for(var t=0;t<this._items.length;t++)this._items[t].pause()},v.prototype.stop=function(){if(this._items)for(var t=0;t<this._items.length;t++)this._items[t].stop()},v.prototype.itemComplete=function(t){t=t.currentTarget;this.completeCount++,this.dispatchEventWith("itemComplete",!1,t),this.completeCount===this.items.length&&(this.dispatchEventWith("complete"),this.completeCount=0)},v);function v(){var t=m.call(this)||this;return t.completeCount=0,t}function b(t,e,i,r){t=t.prototype;t.__meta__=t.__meta__||{},t.__meta__[e]=i,r&&(t.__defaultProperty__=e)}t.TweenGroup=i,__reflect(i.prototype,"egret.tween.TweenGroup"),b(i,"items","Array",!0)}(T.tween||(T.tween={}))}(egret=egret||{});var egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};(function(r){var i,t=(i=r.EventDispatcher,__extends(n,i),n.prototype.connect=function(t,e){this._connecting||this._connected||(this._connecting=!0,this.socket.connect(t,e))},n.prototype.connectByUrl=function(t){this._connecting||this._connected||(this._connecting=!0,this.socket.connectByUrl(t))},n.prototype.close=function(){this._connected&&this.socket.close()},n.prototype.onConnect=function(){this._connected=!0,this._connecting=!1,this.dispatchEventWith(r.Event.CONNECT)},n.prototype.onClose=function(){this._connected=!1,this.dispatchEventWith(r.Event.CLOSE)},n.prototype.onError=function(){this._connecting&&(this._connecting=!1),this.dispatchEventWith(r.IOErrorEvent.IO_ERROR)},n.prototype.onSocketData=function(t){"string"==typeof t?this._readMessage+=t:this._readByte._writeUint8Array(new Uint8Array(t)),r.ProgressEvent.dispatchProgressEvent(this,r.ProgressEvent.SOCKET_DATA)},n.prototype.flush=function(){this._connected?(this._writeMessage&&(this.socket.send(this._writeMessage),this._writeMessage=""),this._bytesWrite&&(this.socket.send(this._writeByte.buffer),this._bytesWrite=!1,this._writeByte.clear()),this._isReadySend=!1):r.$warn(3101)},n.prototype.writeUTF=function(t){this._connected?(this._type==n.TYPE_BINARY?(this._bytesWrite=!0,this._writeByte.writeUTF(t)):this._writeMessage+=t,this.flush()):r.$warn(3101)},n.prototype.readUTF=function(){var t;return this._type==n.TYPE_BINARY?(this._readByte.position=0,t=this._readByte.readUTF(),this._readByte.clear()):(t=this._readMessage,this._readMessage=""),t},n.prototype.writeBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._connected?this._writeByte?(this._bytesWrite=!0,this._writeByte.writeBytes(t,e,i),this.flush()):r.$warn(3102):r.$warn(3101)},n.prototype.readBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),this._readByte?(this._readByte.position=0,this._readByte.readBytes(t,e,i),this._readByte.clear()):r.$warn(3102)},Object.defineProperty(n.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(t){(this._type=t)!=n.TYPE_BINARY||this._writeByte||(this._readByte=new r.ByteArray,this._writeByte=new r.ByteArray)},enumerable:!0,configurable:!0}),n.TYPE_STRING="webSocketTypeString",n.TYPE_BINARY="webSocketTypeBinary",n.URI="ws://",n);function n(t,e){void 0===t&&(t=""),void 0===e&&(e=0);e=i.call(this)||this;return e._writeMessage="",e._readMessage="",e._connected=!1,e._connecting=!1,e._isReadySend=!1,e._bytesWrite=!1,e._type=n.TYPE_STRING,e._connected=!1,e._writeMessage="",e._readMessage="",e.socket=new r.ISocket,e.socket.addCallBacks(e.onConnect,e.onClose,e.onSocketData,e.onError,e),e}r.WebSocket=t,__reflect(t.prototype,"egret.WebSocket")})(egret=(egret=egret||{})||{}),function(i){var t,e;function r(){this.host="",this.port=0,window.WebSocket||i.$error(3100)}t=i.web||(i.web={}),r.prototype.addCallBacks=function(t,e,i,r,n){this.onConnect=t,this.onClose=e,this.onSocketData=i,this.onError=r,this.thisObject=n},r.prototype.connect=function(t,e){this.host=t,this.port=e;e=i.WebSocket.URI+this.host+(null!=this.port?":"+this.port:"");this.socket=new window.WebSocket(e),this.socket.binaryType="arraybuffer",this._bindEvent()},r.prototype.connectByUrl=function(t){this.socket=new window.WebSocket(t),this.socket.binaryType="arraybuffer",this._bindEvent()},r.prototype._bindEvent=function(){var e=this,t=this.socket;t.onopen=function(){e.onConnect&&e.onConnect.call(e.thisObject)},t.onclose=function(t){e.onClose&&e.onClose.call(e.thisObject)},t.onerror=function(t){e.onError&&e.onError.call(e.thisObject)},t.onmessage=function(t){e.onSocketData&&(t.data?e.onSocketData.call(e.thisObject,t.data):e.onSocketData.call(e.thisObject,t))}},r.prototype.send=function(t){this.socket.send(t)},r.prototype.close=function(){this.socket.close()},r.prototype.disconnect=function(){this.socket.disconnect&&this.socket.disconnect()},e=r,t.HTML5WebSocket=e,__reflect(e.prototype,"egret.web.HTML5WebSocket",["egret.ISocket"]),i.ISocket=e}(egret=egret||{}),window.__isqq__||(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function l(t){return"function"==typeof t}var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,e=void 0,n=void 0,s=function(t,e){c[r]=t,c[r+1]=e,2===(r+=2)&&(n?n(p):m())};var t="undefined"!=typeof window?window:void 0,o=t||{},a=o.MutationObserver||o.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),o="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function u(){var t=setTimeout;return function(){return t(p,1)}}var c=new Array(1e3);function p(){for(var t=0;t<r;t+=2)(0,c[t])(c[t+1]),c[t]=void 0,c[t+1]=void 0;r=0}function d(){try{var t=require("vertx");return void 0!==(e=t.runOnLoop||t.runOnContext)?function(){e(p)}:u()}catch(t){return u()}}var f,_,g,y,m=void 0;function v(t,e){var i=arguments,r=this,n=new this.constructor(x);void 0===n[T]&&N(n);var o,a=r._state;return a?(o=i[a-1],s(function(){return k(a,n,o,r._result)})):B(r,n,t,e),n}function b(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(x);return I(e,t),e}var m=h?function(){return process.nextTick(p)}:a?(_=0,g=new a(p),y=document.createTextNode(""),g.observe(y,{characterData:!0}),function(){y.data=_=++_%2}):o?((f=new MessageChannel).port1.onmessage=p,function(){return f.port2.postMessage(0)}):(void 0===t&&"function"==typeof require?d:u)(),T=Math.random().toString(36).substring(16);function x(){}var w=void 0,S=1,C=2,E=new L;function P(t){try{return t.then}catch(t){return E.error=t,E}}function D(t,r,n){s(function(e){var i=!1,t=function(t,e,i,r){try{t.call(e,i,r)}catch(t){return t}}(n,r,function(t){i||(i=!0,(r!==t?I:A)(e,t))},function(t){i||(i=!0,R(e,t))},e._label);!i&&t&&(i=!0,R(e,t))},t)}function O(t,e,i){var r,n;e.constructor===t.constructor&&i===v&&e.constructor.resolve===b?(r=t,(n=e)._state===S?A(r,n._result):n._state===C?R(r,n._result):B(n,void 0,function(t){return I(r,t)},function(t){return R(r,t)})):i===E?R(t,E.error):void 0!==i&&l(i)?D(t,e,i):A(t,e)}function I(t,e){var i;t===e?R(t,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(i=e)||"object"==typeof i&&null!==i?O(t,e,P(e)):A(t,e)}function $(t){t._onerror&&t._onerror(t._result),M(t)}function A(t,e){t._state===w&&(t._result=e,t._state=S,0!==t._subscribers.length&&s(M,t))}function R(t,e){t._state===w&&(t._state=C,t._result=e,s($,t))}function B(t,e,i,r){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=e,n[o+S]=i,n[o+C]=r,0===o&&t._state&&s(M,t)}function M(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var r,n=void 0,o=t._result,a=0;a<e.length;a+=3)r=e[a],n=e[a+i],r?k(i,r,n,o):n(o);t._subscribers.length=0}}function L(){this.error=null}var F=new L;function k(t,e,i,r){var n=l(i),o=void 0,a=void 0,s=void 0,h=void 0;if(n){if((o=function(t,e){try{return t(e)}catch(t){return F.error=t,F}}(i,r))===F?(h=!0,a=o.error,o=null):s=!0,e===o)return void R(e,new TypeError("A promises callback cannot return that same promise."))}else o=r,s=!0;e._state!==w||(n&&s?I(e,o):h?R(e,a):t===S?A(e,o):t===C&&R(e,o))}var j=0;function N(t){t[T]=j++,t._state=void 0,t._result=void 0,t._subscribers=[]}function G(t,e){this._instanceConstructor=t,this.promise=new t(x),this.promise[T]||N(this.promise),i(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&A(this.promise,this._result))):R(this.promise,new Error("Array Methods must be provided an Array"))}function U(t){this[T]=j++,this._result=this._state=void 0,this._subscribers=[],x!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof U?function(e,t){try{t(function(t){I(e,t)},function(t){R(e,t)})}catch(t){R(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return G.prototype._enumerate=function(){for(var t=this.length,e=this._input,i=0;this._state===w&&i<t;i++)this._eachEntry(e[i],i)},G.prototype._eachEntry=function(e,t){var i,r,n=this._instanceConstructor,o=n.resolve;o===b?(i=P(e))===v&&e._state!==w?this._settledAt(e._state,t,e._result):"function"!=typeof i?(this._remaining--,this._result[t]=e):n===U?(O(r=new n(x),e,i),this._willSettleAt(r,t)):this._willSettleAt(new n(function(t){return t(e)}),t):this._willSettleAt(o(e),t)},G.prototype._settledAt=function(t,e,i){var r=this.promise;r._state===w&&(this._remaining--,t===C?R(r,i):this._result[e]=i),0===this._remaining&&A(r,this._result)},G.prototype._willSettleAt=function(t,e){var i=this;B(t,void 0,function(t){return i._settledAt(S,e,t)},function(t){return i._settledAt(C,e,t)})},U.all=function(t){return new G(this,t).promise},U.race=function(n){var o=this;return i(n)?new o(function(t,e){for(var i=n.length,r=0;r<i;r++)o.resolve(n[r]).then(t,e)}):new o(function(t,e){return e(new TypeError("You must pass an array to race."))})},U.resolve=b,U.reject=function(t){var e=new this(x);return R(e,t),e},U._setScheduler=function(t){n=t},U._setAsap=function(t){s=t},U._asap=s,U.prototype={constructor:U,then:v,catch:function(t){return this.then(null,t)}},U.polyfill=function(){var t=void 0;if(void 0!==global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e="undefined"!=typeof egret_native&&egret_native.capability&&!egret_native.capability("Promise")?void 0:e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=U},U.Promise=U}),ES6Promise.polyfill());__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(a){var t=(e.prototype.advanceTime=function(t){if(0<this._objects.length){for(var e=0,i=this._objects;e<i.length;e++)i[e].returnToPool();this._objects.length=0}if(this._clock.advanceTime(t),0<this._events.length){for(var r=0;r<this._events.length;++r){var n=this._events[r],o=n.armature;null!==o._armatureData&&(o.eventDispatcher.dispatchDBEvent(n.type,n),n.type===a.EventObject.SOUND_EVENT&&this._eventManager.dispatchDBEvent(n.type,n)),this.bufferObject(n)}this._events.length=0}},e.prototype.bufferEvent=function(t){this._events.indexOf(t)<0&&this._events.push(t)},e.prototype.bufferObject=function(t){this._objects.indexOf(t)<0&&this._objects.push(t)},Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),e.VERSION="5.7.000",e.yDown=!0,e.debug=!1,e.debugDraw=!1,e);function e(t){this._clock=new a.WorldClock,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=t,console.info("DragonBones: "+e.VERSION+"\nWebsite: http://dragonbones.com/\nSource and Demo: https://github.com/DragonBones/")}a.DragonBones=t}(dragonBones=dragonBones||{}),console.warn||(console.warn=function(){}),console.assert||(console.assert=function(){}),Date.now||(Date.now=function(){return(new Date).getTime()});var global,dragonBones,__extends=function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};void 0===global&&"undefined"!=typeof window&&(global=window),"object"==typeof exports&&"object"==typeof module?module.exports=dragonBones:"function"==typeof define&&define.amd?define(["dragonBones"],function(){return dragonBones}):"object"==typeof exports?exports=dragonBones:void 0!==global&&(global.dragonBones=dragonBones),function(t){var e=(n._returnObject=function(t){var e=String(t.constructor),i=e in n._maxCountMap?n._maxCountMap[e]:n._defaultMaxCount,e=n._poolsMap[e]=n._poolsMap[e]||[];e.length<i&&(t._isInPool?console.warn("The object is already in the pool."):(t._isInPool=!0,e.push(t)))},n.toString=function(){throw new Error},n.setMaxCount=function(t,e){var i;if((e<0||e!=e)&&(e=0),null!==t)null!==(i=(r=String(t))in n._poolsMap?n._poolsMap[r]:null)&&i.length>e&&(i.length=e),n._maxCountMap[r]=e;else for(var r in n._defaultMaxCount=e,n._poolsMap)(i=n._poolsMap[r]).length>e&&(i.length=e),r in n._maxCountMap&&(n._maxCountMap[r]=e)},n.clearPool=function(t){if(null!==(t=void 0===t?null:t)){t=String(t);null!==(i=t in n._poolsMap?n._poolsMap[t]:null)&&0<i.length&&(i.length=0)}else for(var e in n._poolsMap){var i;(i=n._poolsMap[e]).length=0}},n.borrowObject=function(t){var e=String(t),e=e in n._poolsMap?n._poolsMap[e]:null;if(null!==e&&0<e.length){e=e.pop();return e._isInPool=!1,e}t=new t;return t._onClear(),t},n.prototype.returnToPool=function(){this._onClear(),n._returnObject(this)},n._hashCode=0,n._defaultMaxCount=3e3,n._maxCountMap={},n._poolsMap={},n);function n(){this.hashCode=n._hashCode++,this._isInPool=!1}t.BaseObject=e}(dragonBones=dragonBones||{}),function(t){var e=(i.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},i.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},i.prototype.copyFromArray=function(t,e){return this.a=t[e=void 0===e?0:e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this},i.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},i.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,o=this.tx*t.a+t.tx,a=this.ty*t.d+t.ty;return 0===this.b&&0===this.c||(e+=this.b*t.c,i+=this.b*t.d,r+=this.c*t.a,n+=this.c*t.b),0===t.b&&0===t.c||(i+=this.a*t.b,r+=this.d*t.c,o+=this.ty*t.c,a+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=o,this.ty=a,this},i.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=this.ty;if(0===e&&0===i)return(this.b=this.c=0)===t||0===r?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,r=this.d=1/r,this.tx=-t*n,this.ty=-r*o),this;var a=t*r-e*i;if(0==a)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;var s=this.a=r*(a=1/a),e=this.b=-e*a,i=this.c=-i*a,r=this.d=t*a;return this.tx=-(s*n+i*o),this.ty=-(e*n+r*o),this},i.prototype.transformPoint=function(t,e,i,r){void 0===r&&(r=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,r||(i.x+=this.tx,i.y+=this.ty)},i.prototype.transformRectangle=function(t,e){var i=this.a,r=this.b,n=this.c,o=this.d,a=(e=void 0===e?!1:e)?0:this.tx,s=e?0:this.ty,h=t.x,l=t.y,u=h+t.width,c=l+t.height,p=i*h+n*l+a,d=r*h+o*l+s,f=i*u+n*l+a,e=r*u+o*l+s,l=i*u+n*c+a,u=r*u+o*c+s,a=i*h+n*c+a,c=r*h+o*c+s,s=0;f<p&&(s=p,p=f,f=s),a<l&&(s=l,l=a,a=s),t.x=Math.floor(p<l?p:l),t.width=Math.ceil((a<f?f:a)-t.x),e<d&&(s=d,d=e,e=s),c<u&&(s=u,u=c,c=s),t.y=Math.floor(d<u?d:u),t.height=Math.ceil((c<e?e:c)-t.y)},i);function i(t,e,i,r,n,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0),this.a=t=void 0===t?1:t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}t.Matrix=e}(dragonBones=dragonBones||{}),function(t){var e=(o.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=0<t?-Math.PI:Math.PI},o.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skew/Math.PI+" skewY:"+180*this.rotation/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},o.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skew=t.skew,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},o.prototype.identity=function(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this},o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skew+=t.skew,this.rotation+=t.rotation,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},o.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this.skew-=t.skew,this.rotation-=t.rotation,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this},o.prototype.fromMatrix=function(t){var e=this.scaleX,i=this.scaleY,r=o.PI_Q;this.x=t.tx,this.y=t.ty,this.rotation=Math.atan(t.b/t.a);var n=Math.atan(-t.c/t.d);return this.scaleX=this.rotation>-r&&this.rotation<r?t.a/Math.cos(this.rotation):t.b/Math.sin(this.rotation),this.scaleY=-r<n&&n<r?t.d/Math.cos(n):-t.c/Math.sin(n),0<=e&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),0<=i&&this.scaleY<0&&(this.scaleY=-this.scaleY,n-=Math.PI),this.skew=n-this.rotation,this},o.prototype.toMatrix=function(t){return 0===this.rotation?(t.a=1,t.b=0):(t.a=Math.cos(this.rotation),t.b=Math.sin(this.rotation)),0===this.skew?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skew+this.rotation),t.d=Math.cos(this.skew+this.rotation)),1!==this.scaleX&&(t.a*=this.scaleX,t.b*=this.scaleX),1!==this.scaleY&&(t.c*=this.scaleY,t.d*=this.scaleY),t.tx=this.x,t.ty=this.y,this},o.PI=Math.PI,o.PI_D=2*Math.PI,o.PI_H=Math.PI/2,o.PI_Q=Math.PI/4,o.RAD_DEG=180/Math.PI,o.DEG_RAD=Math.PI/180,o);function o(t,e,i,r,n,o){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=1),this.x=t=void 0===t?0:t,this.y=e,this.skew=i,this.rotation=r,this.scaleX=n,this.scaleY=o}t.Transform=e}(dragonBones=dragonBones||{}),function(t){var e=(i.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.greenOffset=t.greenOffset,this.blueOffset=t.blueOffset},i.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},i);function i(t,e,i,r,n,o,a,s){void 0===e&&(e=1),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),this.alphaMultiplier=t=void 0===t?1:t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=r,this.alphaOffset=n,this.redOffset=o,this.greenOffset=a,this.blueOffset=s}t.ColorTransform=e}(dragonBones=dragonBones||{}),function(t){var e=(i.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},i.prototype.clear=function(){this.x=this.y=0},i);function i(t,e){void 0===e&&(e=0),this.x=t=void 0===t?0:t,this.y=e}t.Point=e}(dragonBones=dragonBones||{}),function(t){var e=(i.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},i.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},i);function i(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t=void 0===t?0:t,this.y=e,this.width=i,this.height=r}t.Rectangle=e}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.toString=function(){return"[class dragonBones.UserData]"},r.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},r.prototype.addInt=function(t){this.ints.push(t)},r.prototype.addFloat=function(t){this.floats.push(t)},r.prototype.addString=function(t){this.strings.push(t)},r.prototype.getInt=function(t){return 0<=(t=void 0===t?0:t)&&t<this.ints.length?this.ints[t]:0},r.prototype.getFloat=function(t){return 0<=(t=void 0===t?0:t)&&t<this.floats.length?this.floats[t]:0},r.prototype.getString=function(t){return 0<=(t=void 0===t?0:t)&&t<this.strings.length?this.strings[t]:""},r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.ints=[],t.floats=[],t.strings=[],t}t.UserData=i;var n,i=(n=t.BaseObject,__extends(o,n),o.toString=function(){return"[class dragonBones.ActionData]"},o.prototype._onClear=function(){null!==this.data&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null},o);function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.data=null,t}t.ActionData=i}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.toString=function(){return"[class dragonBones.DragonBonesData]"},r.prototype._onClear=function(){for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];null!==this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.colorArray=null,this.userData=null},r.prototype.addArmature=function(t){t.name in this.armatures?console.warn("Same armature: "+t.name):((t.parent=this).armatures[t.name]=t,this.armatureNames.push(t.name))},r.prototype.getArmature=function(t){return t in this.armatures?this.armatures[t]:null},r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameIndices=[],t.cachedFrames=[],t.armatureNames=[],t.armatures={},t.userData=null,t}t.DragonBonesData=i}(dragonBones=dragonBones||{}),function(e){var i,t=(i=e.BaseObject,__extends(r,i),r.toString=function(){return"[class dragonBones.ArmatureData]"},r.prototype._onClear=function(){for(var t=0,e=this.defaultActions;t<e.length;t++)e[t].returnToPool();for(var i,r=0,n=this.actions;r<n.length;r++)n[r].returnToPool();for(i in this.bones)this.bones[i].returnToPool(),delete this.bones[i];for(i in this.slots)this.slots[i].returnToPool(),delete this.slots[i];for(i in this.constraints)this.constraints[i].returnToPool(),delete this.constraints[i];for(i in this.skins)this.skins[i].returnToPool(),delete this.skins[i];for(i in this.animations)this.animations[i].returnToPool(),delete this.animations[i];null!==this.canvas&&this.canvas.returnToPool(),null!==this.userData&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null},r.prototype.sortBones=function(){var t=this.sortedBones.length;if(!(t<=0)){var e=this.sortedBones.concat(),i=0,r=0;for(this.sortedBones.length=0;r<t;){var n=e[i++];if(t<=i&&(i=0),!(0<=this.sortedBones.indexOf(n))){var o,a=!1;for(o in this.constraints){var s=this.constraints[o];if(s.root===n&&this.sortedBones.indexOf(s.target)<0){a=!0;break}}a||null!==n.parent&&this.sortedBones.indexOf(n.parent)<0||(this.sortedBones.push(n),r++)}}}},r.prototype.cacheFrames=function(t){if(!(0<this.cacheFrameRate))for(var e in this.cacheFrameRate=t,this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)},r.prototype.setCacheFrame=function(t,e){var i=this.parent.cachedFrames,r=i.length;return i.length+=10,i[r]=t.a,i[r+1]=t.b,i[r+2]=t.c,i[r+3]=t.d,i[r+4]=t.tx,i[r+5]=t.ty,i[r+6]=e.rotation,i[r+7]=e.skew,i[r+8]=e.scaleX,i[r+9]=e.scaleY,r},r.prototype.getCacheFrame=function(t,e,i){var r=this.parent.cachedFrames;t.a=r[i],t.b=r[i+1],t.c=r[i+2],t.d=r[i+3],t.tx=r[i+4],t.ty=r[i+5],e.rotation=r[i+6],e.skew=r[i+7],e.scaleX=r[i+8],e.scaleY=r[i+9],e.x=t.tx,e.y=t.ty},r.prototype.addBone=function(t){t.name in this.bones?console.warn("Same bone: "+t.name):(this.bones[t.name]=t,this.sortedBones.push(t))},r.prototype.addSlot=function(t){t.name in this.slots?console.warn("Same slot: "+t.name):(this.slots[t.name]=t,this.sortedSlots.push(t))},r.prototype.addConstraint=function(t){t.name in this.constraints?console.warn("Same constraint: "+t.name):this.constraints[t.name]=t},r.prototype.addSkin=function(t){t.name in this.skins?console.warn("Same skin: "+t.name):((t.parent=this).skins[t.name]=t,null===this.defaultSkin&&(this.defaultSkin=t),"default"===t.name&&(this.defaultSkin=t))},r.prototype.addAnimation=function(t){t.name in this.animations?console.warn("Same animation: "+t.name):((t.parent=this).animations[t.name]=t,this.animationNames.push(t.name),null===this.defaultAnimation&&(this.defaultAnimation=t))},r.prototype.addAction=function(t,e){(e?this.defaultActions:this.actions).push(t)},r.prototype.getBone=function(t){return t in this.bones?this.bones[t]:null},r.prototype.getSlot=function(t){return t in this.slots?this.slots[t]:null},r.prototype.getConstraint=function(t){return t in this.constraints?this.constraints[t]:null},r.prototype.getSkin=function(t){return t in this.skins?this.skins[t]:null},r.prototype.getMesh=function(t,e,i){t=this.getSkin(t);return null===t?null:t.getDisplay(e,i)},r.prototype.getAnimation=function(t){return t in this.animations?this.animations[t]:null},r);function r(){var t=null!==i&&i.apply(this,arguments)||this;return t.aabb=new e.Rectangle,t.animationNames=[],t.sortedBones=[],t.sortedSlots=[],t.defaultActions=[],t.actions=[],t.bones={},t.slots={},t.constraints={},t.skins={},t.animations={},t.canvas=null,t.userData=null,t}e.ArmatureData=t;var n,t=(n=e.BaseObject,__extends(o,n),o.toString=function(){return"[class dragonBones.BoneData]"},o.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=0,this.length=0,this.alpha=1,this.name="",this.transform.identity(),this.userData=null,this.parent=null},o);function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.transform=new e.Transform,t.userData=null,t}e.BoneData=t;var a,t=(__extends(s,a=t),s.toString=function(){return"[class dragonBones.SurfaceData]"},s.prototype._onClear=function(){a.prototype._onClear.call(this),this.type=1,this.segmentX=0,this.segmentY=0,this.geometry.clear()},s);function s(){var t=null!==a&&a.apply(this,arguments)||this;return t.geometry=new e.GeometryData,t}e.SurfaceData=t;var h,t=(h=e.BaseObject,__extends(l,h),l.createColor=function(){return new e.ColorTransform},l.toString=function(){return"[class dragonBones.SlotData]"},l.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.zIndex=0,this.alpha=1,this.name="",this.color=null,this.userData=null,this.parent=null},l.DEFAULT_COLOR=new e.ColorTransform,l);function l(){var t=null!==h&&h.apply(this,arguments)||this;return t.color=null,t.userData=null,t}e.SlotData=t}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.toString=function(){return"[class dragonBones.CanvasData]"},r.prototype._onClear=function(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0},r);function r(){return null!==e&&e.apply(this,arguments)||this}t.CanvasData=i}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.toString=function(){return"[class dragonBones.SkinData]"},r.prototype._onClear=function(){for(var t in this.displays){for(var e=0,i=this.displays[t];e<i.length;e++){var r=i[e];null!==r&&r.returnToPool()}delete this.displays[t]}this.name="",this.parent=null},r.prototype.addDisplay=function(t,e){t in this.displays||(this.displays[t]=[]),null!==e&&(e.parent=this),this.displays[t].push(e)},r.prototype.getDisplay=function(t,e){t=this.getDisplays(t);if(null!==t)for(var i=0,r=t;i<r.length;i++){var n=r[i];if(null!==n&&n.name===e)return n}return null},r.prototype.getDisplays=function(t){return t in this.displays?this.displays[t]:null},r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.displays={},t}t.SkinData=i}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.prototype._onClear=function(){this.order=0,this.name="",this.type=0,this.target=null,this.root=null,this.bone=null},r);function r(){return null!==e&&e.apply(this,arguments)||this}t.ConstraintData=i;var n,o=(__extends(a,n=i),a.toString=function(){return"[class dragonBones.IKConstraintData]"},a.prototype._onClear=function(){n.prototype._onClear.call(this),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1},a);function a(){return null!==n&&n.apply(this,arguments)||this}t.IKConstraintData=o;var s,i=(__extends(h,s=i),h.toString=function(){return"[class dragonBones.PathConstraintData]"},h.prototype._onClear=function(){s.prototype._onClear.call(this),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=0,this.spacingMode=1,this.rotateMode=1,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0},h.prototype.AddBone=function(t){this.bones.push(t)},h);function h(){var t=null!==s&&s.apply(this,arguments)||this;return t.bones=[],t}t.PathConstraintData=i}(dragonBones=dragonBones||{}),function(e){var i=(t.prototype.clear=function(){this.isShared||null===this.weight||this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null},t.prototype.shareFrom=function(t){this.isShared=!0,this.offset=t.offset,this.weight=t.weight},Object.defineProperty(t.prototype,"vertexCount",{get:function(){return this.data.intArray[this.offset+0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"triangleCount",{get:function(){return this.data.intArray[this.offset+1]},enumerable:!0,configurable:!0}),t);function t(){this.weight=null}e.GeometryData=i;var r,n=(r=e.BaseObject,__extends(o,r),o.prototype._onClear=function(){this.name="",this.path="",this.transform.identity(),this.parent=null},o);function o(){var t=null!==r&&r.apply(this,arguments)||this;return t.transform=new e.Transform,t}e.DisplayData=n;var a,s=(__extends(h,a=n),h.toString=function(){return"[class dragonBones.ImageDisplayData]"},h.prototype._onClear=function(){a.prototype._onClear.call(this),this.type=0,this.pivot.clear(),this.texture=null},h);function h(){var t=null!==a&&a.apply(this,arguments)||this;return t.pivot=new e.Point,t}e.ImageDisplayData=s;var l,s=(__extends(u,l=n),u.toString=function(){return"[class dragonBones.ArmatureDisplayData]"},u.prototype._onClear=function(){l.prototype._onClear.call(this);for(var t=0,e=this.actions;t<e.length;t++)e[t].returnToPool();this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null},u.prototype.addAction=function(t){this.actions.push(t)},u);function u(){var t=null!==l&&l.apply(this,arguments)||this;return t.actions=[],t}e.ArmatureDisplayData=s;var c,s=(__extends(p,c=n),p.toString=function(){return"[class dragonBones.MeshDisplayData]"},p.prototype._onClear=function(){c.prototype._onClear.call(this),this.type=2,this.geometry.clear(),this.texture=null},p);function p(){var t=null!==c&&c.apply(this,arguments)||this;return t.geometry=new i,t}e.MeshDisplayData=s;var d,s=(__extends(f,d=n),f.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"},f.prototype._onClear=function(){d.prototype._onClear.call(this),null!==this.boundingBox&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null},f);function f(){var t=null!==d&&d.apply(this,arguments)||this;return t.boundingBox=null,t}e.BoundingBoxDisplayData=s;var _,n=(__extends(g,_=n),g.toString=function(){return"[class dragonBones.PathDisplayData]"},g.prototype._onClear=function(){_.prototype._onClear.call(this),this.type=4,this.closed=!1,this.constantSpeed=!1,this.geometry.clear(),this.curveLengths.length=0},g);function g(){var t=null!==_&&_.apply(this,arguments)||this;return t.geometry=new i,t.curveLengths=[],t}e.PathDisplayData=n;var y,n=(y=e.BaseObject,__extends(m,y),m.toString=function(){return"[class dragonBones.WeightData]"},m.prototype._onClear=function(){this.count=0,this.offset=0,this.bones.length=0},m.prototype.addBone=function(t){this.bones.push(t)},m);function m(){var t=null!==y&&y.apply(this,arguments)||this;return t.bones=[],t}e.WeightData=n}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.prototype._onClear=function(){this.color=0,this.width=0,this.height=0},r);function r(){return null!==e&&e.apply(this,arguments)||this}t.BoundingBoxData=i;var n,h=(__extends(b,n=i),b.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"},b._computeOutCode=function(t,e,i,r,n,o){var a=0;return t<i?a|=1:n<t&&(a|=2),e<r?a|=4:o<e&&(a|=8),a},b.rectangleIntersectsSegment=function(t,e,i,r,n,o,a,s,h,l,u){void 0===h&&(h=null),void 0===l&&(l=null),void 0===u&&(u=null);var c=n<t&&t<a&&o<e&&e<s,p=n<i&&i<a&&o<r&&r<s;if(c&&p)return-1;for(var d=0,f=b._computeOutCode(t,e,n,o,a,s),_=b._computeOutCode(i,r,n,o,a,s);;){if(0==(f|_)){d=2;break}if(0!=(f&_))break;var g=0,y=0,m=0,v=0!==f?f:_;0!=(4&v)?(g=t+(i-t)*(o-e)/(r-e),y=o,null!==u&&(m=.5*-Math.PI)):0!=(8&v)?(g=t+(i-t)*(s-e)/(r-e),y=s,null!==u&&(m=.5*Math.PI)):0!=(2&v)?(y=e+(r-e)*(a-t)/(i-t),g=a,null!==u&&(m=0)):0!=(1&v)&&(y=e+(r-e)*(n-t)/(i-t),g=n,null!==u&&(m=Math.PI)),v===f?(t=g,e=y,f=b._computeOutCode(t,e,n,o,a,s),null!==u&&(u.x=m)):(i=g,r=y,_=b._computeOutCode(i,r,n,o,a,s),null!==u&&(u.y=m))}return d&&(c?(d=2,null!==h&&(h.x=i,h.y=r),null!==l&&(l.x=i,l.y=i),null!==u&&(u.x=u.y+Math.PI)):p?(d=1,null!==h&&(h.x=t,h.y=e),null!==l&&(l.x=t,l.y=e),null!==u&&(u.y=u.x+Math.PI)):(d=3,null!==h&&(h.x=t,h.y=e),null!==l&&(l.x=i,l.y=r))),d},b.prototype._onClear=function(){n.prototype._onClear.call(this),this.type=0},b.prototype.containsPoint=function(t,e){var i=.5*this.width;if(-i<=t&&t<=i){i=.5*this.height;if(-i<=e&&e<=i)return!0}return!1},b.prototype.intersectsSegment=function(t,e,i,r,n,o,a){var s=.5*this.width,h=.5*this.height;return b.rectangleIntersectsSegment(t,e,i,r,-s,-h,s,h,n=void 0===n?null:n,o=void 0===o?null:o,a=void 0===a?null:a)},b);function b(){return null!==n&&n.apply(this,arguments)||this}t.RectangleBoundingBoxData=h;var o,a=(__extends(s,o=i),s.toString=function(){return"[class dragonBones.EllipseData]"},s.ellipseIntersectsSegment=function(t,e,i,r,n,o,a,s,h,l,u){void 0===h&&(h=null),void 0===l&&(l=null),void 0===u&&(u=null);var c=a/s,p=c*c,d=i-t,f=(r*=c)-(e*=c),_=Math.sqrt(d*d+f*f),g=d/_,y=f/_,s=(n-t)*g+(o-e)*y,d=a*a,f=d-(t*t+e*e)+s*s,n=0;if(0<=f){o=Math.sqrt(f),a=s-o,f=s+o,s=a<0?-1:a<=_?0:1,o=f<0?-1:f<=_?0:1,_=s*o;if(_<0)return-1;0==_&&(-1==s?(n=2,i=t+f*g,r=(e+f*y)/c,null!==h&&(h.x=i,h.y=r),null!==l&&(l.x=i,l.y=r),null!==u&&(u.x=Math.atan2(r/d*p,i/d),u.y=u.x+Math.PI)):1==o?(n=1,t+=a*g,e=(e+a*y)/c,null!==h&&(h.x=t,h.y=e),null!==l&&(l.x=t,l.y=e),null!==u&&(u.x=Math.atan2(e/d*p,t/d),u.y=u.x+Math.PI)):(n=3,null!==h&&(h.x=t+a*g,h.y=(e+a*y)/c,null!==u&&(u.x=Math.atan2(h.y/d*p,h.x/d))),null!==l&&(l.x=t+f*g,l.y=(e+f*y)/c,null!==u&&(u.y=Math.atan2(l.y/d*p,l.x/d)))))}return n},s.prototype._onClear=function(){o.prototype._onClear.call(this),this.type=1},s.prototype.containsPoint=function(t,e){var i=.5*this.width;if(-i<=t&&t<=i){var r=.5*this.height;if(-r<=e&&e<=r)return e*=i/r,Math.sqrt(t*t+e*e)<=i}return!1},s.prototype.intersectsSegment=function(t,e,i,r,n,o,a){return s.ellipseIntersectsSegment(t,e,i,r,0,0,.5*this.width,.5*this.height,n=void 0===n?null:n,o=void 0===o?null:o,a=void 0===a?null:a)},s);function s(){return null!==o&&o.apply(this,arguments)||this}t.EllipseBoundingBoxData=a;var l,i=(__extends(u,l=i),u.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"},u.polygonIntersectsSegment=function(t,e,i,r,n,o,a,s){void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null);for(var h=n.length,l=(t=t===i?i+1e-6:t)-i,u=(e=e===r?r+1e-6:e)-r,c=t*r-e*i,p=0,d=n[h-2],f=n[h-1],_=0,g=0,y=0,m=0,v=0,b=0,T=0;T<h;T+=2){var x=n[T],w=n[T+1],S=(d=d===x?x+1e-4:d)-x,C=(f=f===w?w+1e-4:f)-w,E=d*w-f*x,P=l*C-u*S,S=(c*S-l*E)/P;if((d<=S&&S<=x||x<=S&&S<=d)&&(0==l||t<=S&&S<=i||i<=S&&S<=t)){E=(c*C-u*E)/P;if((f<=E&&E<=w||w<=E&&E<=f)&&(0==u||e<=E&&E<=r||r<=E&&E<=e)){if(null===a){v=y=S,b=m=E,p++,null!==s&&(s.x=Math.atan2(w-f,x-d)-.5*Math.PI,s.y=s.x);break}P=S-t;P<0&&(P=-P),0===p?(g=_=P,v=y=S,b=m=E,null!==s&&(s.x=Math.atan2(w-f,x-d)-.5*Math.PI,s.y=s.x)):(P<_&&(_=P,y=S,m=E,null!==s&&(s.x=Math.atan2(w-f,x-d)-.5*Math.PI)),g<P&&(g=P,v=S,b=E,null!==s&&(s.y=Math.atan2(w-f,x-d)-.5*Math.PI))),p++}}d=x,f=w}return 1===p?(null!==o&&(o.x=y,o.y=m),null!==a&&(a.x=y,a.y=m),null!==s&&(s.y=s.x+Math.PI)):1<p&&(p++,null!==o&&(o.x=y,o.y=m),null!==a&&(a.x=v,a.y=b)),p},u.prototype._onClear=function(){l.prototype._onClear.call(this),this.type=2,this.x=0,this.y=0,this.vertices.length=0},u.prototype.containsPoint=function(t,e){var i=!1;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var r=0,n=this.vertices.length,o=n-2;r<n;r+=2){var a,s=this.vertices[o+1],h=this.vertices[r+1];!(h<e&&e<=s||s<e&&e<=h)||(e-h)*(this.vertices[o]-(a=this.vertices[r]))/(s-h)+a<t&&(i=!i),o=r}return i},u.prototype.intersectsSegment=function(t,e,i,r,n,o,a){void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=null);var s=0;return s=0!==h.rectangleIntersectsSegment(t,e,i,r,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)?u.polygonIntersectsSegment(t,e,i,r,this.vertices,n,o,a):s},u);function u(){var t=null!==l&&l.apply(this,arguments)||this;return t.vertices=[],t}t.PolygonBoundingBoxData=i}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.toString=function(){return"[class dragonBones.AnimationData]"},r.prototype._onClear=function(){for(var t in this.boneTimelines){for(var e=0,i=this.boneTimelines[t];e<i.length;e++)i[e].returnToPool();delete this.boneTimelines[t]}for(var t in this.slotTimelines){for(var r=0,n=this.slotTimelines[t];r<n.length;r++)n[r].returnToPool();delete this.slotTimelines[t]}for(var t in this.constraintTimelines){for(var o=0,a=this.constraintTimelines[t];o<a.length;o++)a[o].returnToPool();delete this.constraintTimelines[t]}for(var t in this.animationTimelines){for(var s=0,h=this.animationTimelines[t];s<h.length;s++)h[s].returnToPool();delete this.animationTimelines[t]}for(var t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(var t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];null!==this.actionTimeline&&this.actionTimeline.returnToPool(),null!==this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.blendType=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null},r.prototype.cacheFrames=function(t){if(!(0<this.cacheFrameRate)){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(var i=0,r=this.cacheFrames.length;i<r;++i)this.cachedFrames[i]=!1;for(var n=0,o=this.parent.sortedBones;n<o.length;n++){for(var a=o[n],i=0,r=(l=new Array(e)).length;i<r;++i)l[i]=-1;this.boneCachedFrameIndices[a.name]=l}for(var s=0,h=this.parent.sortedSlots;s<h.length;s++){for(var l,u=h[s],i=0,r=(l=new Array(e)).length;i<r;++i)l[i]=-1;this.slotCachedFrameIndices[u.name]=l}}},r.prototype.addBoneTimeline=function(t,e){t=t in this.boneTimelines?this.boneTimelines[t]:this.boneTimelines[t]=[];t.indexOf(e)<0&&t.push(e)},r.prototype.addSlotTimeline=function(t,e){t=t in this.slotTimelines?this.slotTimelines[t]:this.slotTimelines[t]=[];t.indexOf(e)<0&&t.push(e)},r.prototype.addConstraintTimeline=function(t,e){t=t in this.constraintTimelines?this.constraintTimelines[t]:this.constraintTimelines[t]=[];t.indexOf(e)<0&&t.push(e)},r.prototype.addAnimationTimeline=function(t,e){t=t in this.animationTimelines?this.animationTimelines[t]:this.animationTimelines[t]=[];t.indexOf(e)<0&&t.push(e)},r.prototype.getBoneTimelines=function(t){return t in this.boneTimelines?this.boneTimelines[t]:null},r.prototype.getSlotTimelines=function(t){return t in this.slotTimelines?this.slotTimelines[t]:null},r.prototype.getConstraintTimelines=function(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null},r.prototype.getAnimationTimelines=function(t){return t in this.animationTimelines?this.animationTimelines[t]:null},r.prototype.getBoneCachedFrameIndices=function(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null},r.prototype.getSlotCachedFrameIndices=function(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null},r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.cachedFrames=[],t.boneTimelines={},t.slotTimelines={},t.constraintTimelines={},t.animationTimelines={},t.boneCachedFrameIndices={},t.slotCachedFrameIndices={},t.actionTimeline=null,t.zOrderTimeline=null,t}t.AnimationData=i;var n,i=(n=t.BaseObject,__extends(o,n),o.toString=function(){return"[class dragonBones.TimelineData]"},o.prototype._onClear=function(){this.type=10,this.offset=0,this.frameIndicesOffset=-1},o);function o(){return null!==n&&n.apply(this,arguments)||this}t.TimelineData=i;var a,i=(__extends(s,a=i),s.toString=function(){return"[class dragonBones.AnimationTimelineData]"},s.prototype._onClear=function(){a.prototype._onClear.call(this),this.x=0,this.y=0},s);function s(){return null!==a&&a.apply(this,arguments)||this}t.AnimationTimelineData=i}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.toString=function(){return"[class dragonBones.AnimationConfig]"},r.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additive=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0},r.prototype.clear=function(){this._onClear()},r.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutTweenType=t.fadeOutTweenType,this.actionEnabled=t.actionEnabled,this.additive=t.additive,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.resetToPose=t.resetToPose,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInTweenType=t.fadeInTweenType,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;e<i;++e)this.boneMask[e]=t.boneMask[e]},r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.boneMask=[],t}t.AnimationConfig=i}(dragonBones=dragonBones||{}),function(e){var i,t=(i=e.BaseObject,__extends(r,i),r.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""},r.prototype.copyFrom=function(t){for(var e in this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath,this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(var e in t.textures){var i=this.createTexture();i.copyFrom(t.textures[e]),this.textures[e]=i}},r.prototype.addTexture=function(t){t.name in this.textures?console.warn("Same texture: "+t.name):(t.parent=this).textures[t.name]=t},r.prototype.getTexture=function(t){return t in this.textures?this.textures[t]:null},r);function r(){var t=null!==i&&i.apply(this,arguments)||this;return t.textures={},t}e.TextureAtlasData=t;var n,t=(n=e.BaseObject,__extends(o,n),o.createRectangle=function(){return new e.Rectangle},o.prototype._onClear=function(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null},o.prototype.copyFrom=function(t){this.rotated=t.rotated,this.name=t.name,this.region.copyFrom(t.region),this.parent=t.parent,null===this.frame&&null!==t.frame?this.frame=o.createRectangle():null!==this.frame&&null===t.frame&&(this.frame=null),null!==this.frame&&null!==t.frame&&this.frame.copyFrom(t.frame)},o);function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.region=new e.Rectangle,t.frame=null,t}e.TextureData=t}(dragonBones=dragonBones||{}),function(n){var e,t=(e=n.BaseObject,__extends(g,e),g.toString=function(){return"[class dragonBones.Armature]"},g._onSortSlots=function(t,e){return 1e3*t._zIndex+t._zOrder>1e3*e._zIndex+e._zOrder?1:-1},g.prototype._onClear=function(){null!==this._clock&&this._clock.remove(this);for(var t=0,e=this._bones;t<e.length;t++)e[t].returnToPool();for(var i=0,r=this._slots;i<r.length;i++)r[i].returnToPool();for(var n=0,o=this._constraints;n<o.length;n++)o[n].returnToPool();for(var a=0,s=this._actions;a<s.length;a++)s[a].returnToPool();null!==this._animation&&this._animation.returnToPool(),null!==this._proxy&&this._proxy.dbClear(),null!==this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._zIndexDirty=!1,this._alphaDirty=!0,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._alpha=1,this._globalAlpha=1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null},g.prototype._sortZOrder=function(t,e){var i=this._armatureData.sortedSlots,r=null===t;if(this._zOrderDirty||!r){for(var n=0,o=i.length;n<o;++n){var a=r?n:t[e+n];a<0||o<=a||(a=i[a],null!==(a=this.getSlot(a.name))&&a._setZOrder(n))}this._slotsDirty=!0,this._zOrderDirty=!r}},g.prototype._addBone=function(t){this._bones.indexOf(t)<0&&this._bones.push(t)},g.prototype._addSlot=function(t){this._slots.indexOf(t)<0&&this._slots.push(t)},g.prototype._addConstraint=function(t){this._constraints.indexOf(t)<0&&this._constraints.push(t)},g.prototype._bufferAction=function(t,e){this._actions.indexOf(t)<0&&(e?this._actions.push(t):this._actions.unshift(t))},g.prototype.dispose=function(){null!==this._armatureData&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))},g.prototype.init=function(t,e,i,r){null===this._armatureData&&(this._armatureData=t,this._animation=n.BaseObject.borrowObject(n.Animation),this._proxy=e,this._display=i,this._dragonBones=r,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)},g.prototype.advanceTime=function(t){if(!this._lockUpdate)if(this._lockUpdate=!0,null!==this._armatureData)if(null!==this._armatureData.parent){var e=this._cacheFrameIndex;if(this._animation.advanceTime(t),this._slotsDirty||this._zIndexDirty){if(this._slots.sort(g._onSortSlots),this._zIndexDirty)for(var i=0,r=this._slots.length;i<r;++i)this._slots[i]._setZOrder(i);this._slotsDirty=!1,this._zIndexDirty=!1}if(this._alphaDirty){this._alphaDirty=!1,this._globalAlpha=this._alpha*(null!==this._parent?this._parent._globalAlpha:1);for(var n=0,o=this._bones;n<o.length;n++)o[n]._updateAlpha();for(var a=0,s=this._slots;a<s.length;a++)(p=s[a])._updateAlpha()}if(this._cacheFrameIndex<0||this._cacheFrameIndex!==e){i=0,r=0;for(i=0,r=this._bones.length;i<r;++i)this._bones[i].update(this._cacheFrameIndex);for(i=0,r=this._slots.length;i<r;++i)this._slots[i].update(this._cacheFrameIndex)}if(0<this._actions.length){for(var h=0,l=this._actions;h<l.length;h++){var u=l[h],c=u.actionData;if(null!==c)if(0===c.type)if(null!==u.slot)null!==(d=u.slot.childArmature)&&d.animation.fadeIn(c.name);else if(null!==u.bone)for(var p,d,f=0,_=this.getSlots();f<_.length;f++)(p=_[f]).parent===u.bone&&null!==(d=p.childArmature)&&d.animation.fadeIn(c.name);else this._animation.fadeIn(c.name);u.returnToPool()}this._actions.length=0}this._lockUpdate=!1,this._proxy.dbUpdate()}else console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");else console.warn("The armature has been disposed.")},g.prototype.invalidUpdate=function(t,e){if(void 0===e&&(e=!1),null!==(t=void 0===t?null:t)&&0<t.length){var i=this.getBone(t);if(null!==i&&(i.invalidUpdate(),e))for(var r=0,n=this._slots;r<n.length;r++)(s=n[r]).parent===i&&s.invalidUpdate()}else{for(var o=0,a=this._bones;o<a.length;o++)(i=a[o]).invalidUpdate();if(e)for(var s,h=0,l=this._slots;h<l.length;h++)(s=l[h]).invalidUpdate()}},g.prototype.containsPoint=function(t,e){for(var i=0,r=this._slots;i<r.length;i++){var n=r[i];if(n.containsPoint(t,e))return n}return null},g.prototype.intersectsSegment=function(t,e,i,r,n,o,a){void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=null);for(var s=t===i,h=0,l=0,u=0,c=0,p=0,d=0,f=0,_=0,g=null,y=null,m=0,v=this._slots;m<v.length;m++){var b,T=v[m];if(0<T.intersectsSegment(t,e,i,r,n,o,a)){if(null===n&&null===o){g=T;break}null!==n&&((b=s?n.y-e:n.x-t)<0&&(b=-b),(null===g||b<h)&&(h=b,u=n.x,c=n.y,g=T,a&&(f=a.x))),null!==o&&((b=o.x-t)<0&&(b=-b),(null===y||l<b)&&(l=b,p=o.x,d=o.y,y=T,null!==a&&(_=a.y)))}}return null!==g&&null!==n&&(n.x=u,n.y=c,null!==a&&(a.x=f)),null!==y&&null!==o&&(o.x=p,o.y=d,null!==a&&(a.y=_)),g},g.prototype.getBone=function(t){for(var e=0,i=this._bones;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},g.prototype.getBoneByDisplay=function(t){t=this.getSlotByDisplay(t);return null!==t?t.parent:null},g.prototype.getSlot=function(t){for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},g.prototype.getSlotByDisplay=function(t){if(null!==t)for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];if(r.display===t)return r}return null},g.prototype.getBones=function(){return this._bones},g.prototype.getSlots=function(){return this._slots},Object.defineProperty(g.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots;e<i.length;e++){var r=i[e].childArmature;null!==r&&(r.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"name",{get:function(){return this._armatureData.name},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture!==t){null!==this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];r.invalidUpdate(),r.update(-1)}}},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){null!==this._clock&&this._clock.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(var e=0,i=this._slots;e<i.length;e++){var r=i[e].childArmature;null!==r&&(r.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),g.prototype.getDisplay=function(){return this._display},g);function g(){var t=null!==e&&e.apply(this,arguments)||this;return t._bones=[],t._slots=[],t._constraints=[],t._actions=[],t._animation=null,t._proxy=null,t._replaceTextureAtlasData=null,t._clock=null,t}n.Armature=t}(dragonBones=dragonBones||{}),function(e){var i,t=(i=e.BaseObject,__extends(r,i),r.prototype._onClear=function(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._alpha=1,this._globalAlpha=1,this._armature=null},r.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(r.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),r._helpMatrix=new e.Matrix,r._helpTransform=new e.Transform,r._helpPoint=new e.Point,r);function r(){var t=null!==i&&i.apply(this,arguments)||this;return t.globalTransformMatrix=new e.Matrix,t.global=new e.Transform,t.offset=new e.Transform,t}e.TransformObject=t}(dragonBones=dragonBones||{}),function(d){var e,t=(e=d.TransformObject,__extends(i,e),i.toString=function(){return"[class dragonBones.Bone]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._boneData=null,this._parent=null,this._cachedFrameIndices=null},i.prototype._updateGlobalTransformMatrix=function(t){var e,i=this._boneData,r=this.global,n=this.globalTransformMatrix,o=this.origin,a=this.offset,s=this.animationPose,h=this._parent,l=this._armature.flipX,u=this._armature.flipY===d.DragonBones.yDown,c=null!==h,p=0;1===this.offsetMode?null!==o?(r.x=o.x+a.x+s.x,r.scaleX=o.scaleX*a.scaleX*s.scaleX,r.scaleY=o.scaleY*a.scaleY*s.scaleY,d.DragonBones.yDown?(r.y=o.y+a.y+s.y,r.skew=o.skew+a.skew+s.skew,r.rotation=o.rotation+a.rotation+s.rotation):(r.y=o.y-a.y+s.y,r.skew=o.skew-a.skew+s.skew,r.rotation=o.rotation-a.rotation+s.rotation)):(r.copyFrom(a),d.DragonBones.yDown||(r.y=-r.y,r.skew=-r.skew,r.rotation=-r.rotation),r.add(s)):0===this.offsetMode?null!==o?r.copyFrom(o).add(s):r.copyFrom(s):(c=!1,r.copyFrom(a),d.DragonBones.yDown||(r.y=-r.y,r.skew=-r.skew,r.rotation=-r.rotation)),c?(o=(e=1===h._boneData.type)?h._bone:null,s=e?h._getGlobalTransformMatrix(r.x,r.y):h.globalTransformMatrix,!i.inheritScale||e&&null===o?(i.inheritTranslation?(a=r.x,c=r.y,r.x=s.a*a+s.c*c+s.tx,r.y=s.b*a+s.d*c+s.ty):(l&&(r.x=-r.x),u&&(r.y=-r.y)),i.inheritRotation?(h.updateGlobalTransform(),p=h.global.scaleX<0?r.rotation+h.global.rotation+Math.PI:r.rotation+h.global.rotation,s.a*s.d-s.b*s.c<0&&(p-=2*r.rotation,l===u&&!i.inheritReflection||(r.skew+=Math.PI),d.DragonBones.yDown||(r.skew=-r.skew)),r.rotation=p):(l||u)&&(l&&u?p=r.rotation+Math.PI:(p=l?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=p),r.toMatrix(n)):e?(i.inheritRotation&&(r.rotation+=h.global.rotation),o.updateGlobalTransform(),r.scaleX*=o.global.scaleX,r.scaleY*=o.global.scaleY,s.transformPoint(r.x,r.y,r),r.toMatrix(n),i.inheritTranslation?(r.x=n.tx,r.y=n.ty):(n.tx=r.x,n.ty=r.y)):(i.inheritRotation||(h.updateGlobalTransform(),p=l&&u?r.rotation-(h.global.rotation+Math.PI):l?r.rotation+h.global.rotation+Math.PI:u?r.rotation+h.global.rotation:r.rotation-h.global.rotation,r.rotation=p),r.toMatrix(n),n.concat(s),i.inheritTranslation?(r.x=n.tx,r.y=n.ty):(n.tx=r.x,n.ty=r.y),t?r.fromMatrix(n):this._globalDirty=!0)):((l||u)&&(l&&(r.x=-r.x),u&&(r.y=-r.y),l&&u?p=r.rotation+Math.PI:(p=l?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=p),r.toMatrix(n))},i.prototype._updateAlpha=function(){null!==this._parent?this._globalAlpha=this._alpha*this._parent._globalAlpha:this._globalAlpha=this._alpha*this._armature._globalAlpha},i.prototype.init=function(t,e){null===this._boneData&&(this._boneData=t,this._armature=e,this._alpha=this._boneData.alpha,null!==this._boneData.parent&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)},i.prototype.update=function(t){if(0<=t&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];if(0<=e&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(0<=e)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(var i=0,r=this._armature._constraints;i<r.length;i++)(n=r[i])._root===this&&n.update();!(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&0<=this._cachedFrameIndex?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var n,o=0,a=this._armature._constraints;o<a.length;o++)(n=a[o])._root===this&&n.update();(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}this._transformDirty?(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0?(e=0<=t,this._localDirty&&this._updateGlobalTransformMatrix(e),e&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))):this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)):this._childrenTransformDirty&&(this._childrenTransformDirty=!1),this._localDirty=!0},i.prototype.updateByConstraint=function(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)},i.prototype.invalidUpdate=function(){this._transformDirty=!0},i.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.parent;return e===this},Object.defineProperty(i.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!==t){this._visible=t;for(var e=0,i=this._armature.getSlots();e<i.length;e++){var r=i[e];r.parent===this&&r._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._boneData.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationPose=new d.Transform,t}d.Bone=t}(dragonBones=dragonBones||{}),function(t){var o,e=(o=t.Bone,__extends(T,o),T.toString=function(){return"[class dragonBones.Surface]"},T.prototype._onClear=function(){o.prototype._onClear.call(this),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0,this._bone=null},T.prototype._getAffineTransform=function(t,e,i,r,n,o,a,s,h,l,u,c,p){a-=n,s-=o,h-=n,l-=o;u.rotation=Math.atan2(s,a),u.skew=Math.atan2(l,h)-.5*Math.PI-u.rotation,p&&(u.rotation+=Math.PI),u.scaleX=Math.sqrt(a*a+s*s)/i,u.scaleY=Math.sqrt(h*h+l*l)/r,u.toMatrix(c),u.x=c.tx=n-(c.a*t+c.c*e),u.y=c.ty=o-(c.b*t+c.d*e)},T.prototype._updateVertices=function(){var t=this._armature.armatureData.parent,e=this._boneData.geometry,i=t.intArray,r=t.floatArray,t=i[e.offset+0],n=i[e.offset+2],o=this._vertices,a=this._deformVertices;if(null!==this._parent)if(1===this._parent._boneData.type)for(var s=0,h=t;s<h;++s){var l=r[n+(d=2*s)]+a[d],u=r[n+d+1]+a[d+1],c=this._parent._getGlobalTransformMatrix(l,u);o[d]=c.a*l+c.c*u+c.tx,o[d+1]=c.b*l+c.d*u+c.ty}else for(var p=this._parent.globalTransformMatrix,s=0,h=t;s<h;++s){l=r[n+(d=2*s)]+a[d],u=r[n+d+1]+a[d+1];o[d]=p.a*l+p.c*u+p.tx,o[d+1]=p.b*l+p.d*u+p.ty}else for(var d,s=0,h=t;s<h;++s)o[d=2*s]=r[n+d]+a[d],o[d+1]=r[n+d+1]+a[d+1]},T.prototype._updateGlobalTransformMatrix=function(t){var e=2*this._boneData.segmentX,i=this._vertices.length-2,r=this._vertices[0],n=this._vertices[1],o=this._vertices[e],a=this._vertices[1+e],s=this._vertices[i],h=this._vertices[1+i],l=this._vertices[i-e],e=this._vertices[i-e+1],r=r+.5*(s-r),n=n+.5*(h-n);this._getAffineTransform(0,0,200,200,r+.5*(o+.5*(l-o)-r),n+.5*(a+.5*(e-a)-n),o+.5*(s-o),a+.5*(h-a),l+.5*(s-l),e+.5*(h-e),this.global,this.globalTransformMatrix,!1),this._globalDirty=!1},T.prototype._getGlobalTransformMatrix=function(t,e){if(t<-1e3||1e3<t||e<-1e3||1e3<e)return this.globalTransformMatrix;var i,r,n,o,a,s,h=!1,l=this._boneData,u=l.segmentX,c=l.segmentY,p=2*l.segmentX,d=this._dX,f=this._dY,_=Math.floor((t+200)/d),g=Math.floor((e+200)/f),y=0,m=_*d-200,v=g*f-200,b=this._matrixCahce,l=T._helpMatrix;if(t<-200){if(e<-200||200<=e)return this.globalTransformMatrix;0<b[y=7*(2*(u*c+u+c+c+g)+((h=e>this._kX*(t+200)+v)?1:0))]?l.copyFromArray(b,y+1):(a=g*(2+p),i=this._hullCache[4],r=this._hullCache[5],n=this._hullCache[2]-(c-g)*i,o=this._hullCache[3]-(c-g)*r,s=this._vertices,h?this._getAffineTransform(-200,v+f,800,f,s[a+p+2],s[a+p+3],n+i,o+r,s[a],s[a+1],T._helpTransform,l,!0):this._getAffineTransform(-1e3,v,800,f,n,o,s[a],s[a+1],n+i,o+r,T._helpTransform,l,!1),b[y]=1,b[y+1]=l.a,b[y+2]=l.b,b[y+3]=l.c,b[y+4]=l.d,b[y+5]=l.tx,b[y+6]=l.ty)}else if(200<=t){if(e<-200||200<=e)return this.globalTransformMatrix;0<b[y=7*(2*(u*c+u+g)+((h=e>this._kX*(t-1e3)+v)?1:0))]?l.copyFromArray(b,y+1):(a=(g+1)*(2+p)-2,i=this._hullCache[4],r=this._hullCache[5],n=this._hullCache[0]+g*i,o=this._hullCache[1]+g*r,s=this._vertices,h?this._getAffineTransform(1e3,v+f,800,f,n+i,o+r,s[a+p+2],s[a+p+3],n,o,T._helpTransform,l,!0):this._getAffineTransform(200,v,800,f,s[a],s[a+1],n,o,s[a+p+2],s[a+p+3],T._helpTransform,l,!1),b[y]=1,b[y+1]=l.a,b[y+2]=l.b,b[y+3]=l.c,b[y+4]=l.d,b[y+5]=l.tx,b[y+6]=l.ty)}else if(e<-200){if(t<-200||200<=t)return this.globalTransformMatrix;0<b[y=7*(2*(u*c+_)+((h=e>this._kY*(t-m-d)-1e3)?1:0))]?l.copyFromArray(b,y+1):(a=2*_,i=this._hullCache[10],r=this._hullCache[11],n=this._hullCache[8]+_*i,o=this._hullCache[9]+_*r,s=this._vertices,h?this._getAffineTransform(m+d,-200,d,800,s[a+2],s[a+3],s[a],s[a+1],n+i,o+r,T._helpTransform,l,!0):this._getAffineTransform(m,-1e3,d,800,n,o,n+i,o+r,s[a],s[a+1],T._helpTransform,l,!1),b[y]=1,b[y+1]=l.a,b[y+2]=l.b,b[y+3]=l.c,b[y+4]=l.d,b[y+5]=l.tx,b[y+6]=l.ty)}else if(200<=e){if(t<-200||200<=t)return this.globalTransformMatrix;0<b[y=7*(2*(u*c+u+c+_)+((h=e>this._kY*(t-m-d)+200)?1:0))]?l.copyFromArray(b,y+1):(a=c*(2+p)+2*_,i=this._hullCache[10],r=this._hullCache[11],n=this._hullCache[6]-(u-_)*i,o=this._hullCache[7]-(u-_)*r,s=this._vertices,h?this._getAffineTransform(m+d,1e3,d,800,n+i,o+r,n,o,s[a+2],s[a+3],T._helpTransform,l,!0):this._getAffineTransform(m,200,d,800,s[a],s[a+1],s[a+2],s[a+3],n,o,T._helpTransform,l,!1),b[y]=1,b[y+1]=l.a,b[y+2]=l.b,b[y+3]=l.c,b[y+4]=l.d,b[y+5]=l.tx,b[y+6]=l.ty)}else 0<b[y=7*(2*(u*g+_)+((h=e>this._k*(t-m-d)+v)?1:0))]?l.copyFromArray(b,y+1):(a=2*_+g*(2+p),s=this._vertices,h?this._getAffineTransform(m+d,v+f,d,f,s[a+p+4],s[a+p+5],s[a+p+2],s[a+p+3],s[a+2],s[a+3],T._helpTransform,l,!0):this._getAffineTransform(m,v,d,f,s[a],s[a+1],s[a+2],s[a+3],s[a+p+2],s[a+p+3],T._helpTransform,l,!1),b[y]=1,b[y+1]=l.a,b[y+2]=l.b,b[y+3]=l.c,b[y+4]=l.d,b[y+5]=l.tx,b[y+6]=l.ty);return l},T.prototype.init=function(t,e){if(null===this._boneData){o.prototype.init.call(this,t,e);var i=t.segmentX,e=t.segmentY,r=this._armature.armatureData.parent.intArray[t.geometry.offset+0];this._dX=400/i,this._dY=400/e,this._k=-this._dY/this._dX,this._kX=-this._dY/800,this._kY=-800/this._dX,this._vertices.length=2*r,this._deformVertices.length=2*r,this._matrixCahce.length=2*(i*e+2*i+2*e)*7,this._hullCache.length=10;for(var n=0;n<2*r;++n)this._deformVertices[n]=0;null!==this._parent&&(0===this._parent.boneData.type?this._bone=this._parent:this._bone=this._parent._bone)}},T.prototype.update=function(t){if(0<=t&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];if(0<=e&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(0<=e)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(var i=0,r=this._armature._constraints;i<r.length;i++)(n=r[i])._root===this&&n.update();!(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&0<=this._cachedFrameIndex?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var n,o=0,a=this._armature._constraints;o<a.length;o++)(n=a[o])._root===this&&n.update();(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(var s=0,h=this._matrixCahce.length;s<h;s+=7)this._matrixCahce[s]=-1;this._updateVertices(),this._cachedFrameIndex<0?(l=0<=t,this._localDirty&&this._updateGlobalTransformMatrix(l),l&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))):this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);var e=2*this.global.x,l=2*this.global.y,t=T._helpPoint;this.globalTransformMatrix.transformPoint(1e3,-200,t),this._hullCache[0]=t.x,this._hullCache[1]=t.y,this._hullCache[2]=e-t.x,this._hullCache[3]=l-t.y,this.globalTransformMatrix.transformPoint(0,this._dY,t,!0),this._hullCache[4]=t.x,this._hullCache[5]=t.y,this.globalTransformMatrix.transformPoint(200,1e3,t),this._hullCache[6]=t.x,this._hullCache[7]=t.y,this._hullCache[8]=e-t.x,this._hullCache[9]=l-t.y,this.globalTransformMatrix.transformPoint(this._dX,0,t,!0),this._hullCache[10]=t.x,this._hullCache[11]=t.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},T);function T(){var t=null!==o&&o.apply(this,arguments)||this;return t._vertices=[],t._deformVertices=[],t._hullCache=[],t._matrixCahce=[],t}t.Surface=e}(dragonBones=dragonBones||{}),function(d){var e,r=(e=d.BaseObject,__extends(t,e),t.toString=function(){return"[class dragonBones.DisplayFrame]"},t.prototype._onClear=function(){this.rawDisplayData=null,this.displayData=null,this.textureData=null,this.display=null,this.deformVertices.length=0},t.prototype.updateDeformVertices=function(){if(null!==this.rawDisplayData&&0===this.deformVertices.length){var t;if(2===this.rawDisplayData.type)t=this.rawDisplayData.geometry;else{if(4!==this.rawDisplayData.type)return;t=this.rawDisplayData.geometry}var e=0,e=null!==t.weight?2*t.weight.count:2*t.data.intArray[t.offset+0];this.deformVertices.length=e}},t.prototype.getGeometryData=function(){if(null!==this.displayData){if(2===this.displayData.type)return this.displayData.geometry;if(4===this.displayData.type)return this.displayData.geometry}if(null!==this.rawDisplayData){if(2===this.rawDisplayData.type)return this.rawDisplayData.geometry;if(4===this.rawDisplayData.type)return this.rawDisplayData.geometry}return null},t.prototype.getBoundingBox=function(){return null!==this.displayData&&3===this.displayData.type?this.displayData.boundingBox:null!==this.rawDisplayData&&3===this.rawDisplayData.type?this.rawDisplayData.boundingBox:null},t.prototype.getTextureData=function(){if(null!==this.displayData){if(0===this.displayData.type)return this.displayData.texture;if(2===this.displayData.type)return this.displayData.texture}if(null!==this.textureData)return this.textureData;if(null!==this.rawDisplayData){if(0===this.rawDisplayData.type)return this.rawDisplayData.texture;if(2===this.rawDisplayData.type)return this.rawDisplayData.texture}return null},t);function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.deformVertices=[],t}d.DisplayFrame=r;var h,i=(h=d.TransformObject,__extends(f,h),f.prototype._onClear=function(){h.prototype._onClear.call(this);for(var t=[],e=0,i=this._displayFrames;e<i.length;e++){var r=i[e],n=r.display;n!==this._rawDisplay&&n!==this._meshDisplay&&t.indexOf(n)<0&&t.push(n),r.returnToPool()}for(var o=0,a=t;o<a.length;o++){var s=a[o];s instanceof d.Armature?s.dispose():this._disposeDisplay(s,!0)}null!==this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),null!==this._rawDisplay&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDataDirty=!1,this._displayDirty=!1,this._geometryDirty=!1,this._textureDirty=!1,this._visibleDirty=!1,this._blendModeDirty=!1,this._zOrderDirty=!1,this._colorDirty=!1,this._verticesDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._zIndex=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayFrames.length=0,this._geometryBones.length=0,this._slotData=null,this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null},f.prototype._hasDisplay=function(t){for(var e=0,i=this._displayFrames;e<i.length;e++)if(i[e].display===t)return!0;return!1},f.prototype._isBonesUpdate=function(){for(var t=0,e=this._geometryBones;t<e.length;t++){var i=e[t];if(null!==i&&i._childrenTransformDirty)return!0}return!1},f.prototype._updateAlpha=function(){var t=this._alpha*this._parent._globalAlpha;this._globalAlpha!==t&&(this._globalAlpha=t,this._colorDirty=!0)},f.prototype._updateDisplayData=function(){var t,e,i,r,n,o=this._displayFrame,a=this._geometryData,s=this._textureData,h=null,l=null;if(this._displayFrame=null,this._geometryData=null,this._boundingBoxData=null,this._textureData=null,0<=this._displayIndex&&this._displayIndex<this._displayFrames.length&&(this._displayFrame=this._displayFrames[this._displayIndex],h=this._displayFrame.rawDisplayData,l=this._displayFrame.displayData,this._geometryData=this._displayFrame.getGeometryData(),this._boundingBoxData=this._displayFrame.getBoundingBox(),this._textureData=this._displayFrame.getTextureData()),this._displayFrame!==o||this._geometryData!==a||this._textureData!==s){if(null===this._geometryData&&null!==this._textureData?(t=null!==l&&0===l.type?l:h,e=this._textureData.parent.scale*this._armature._armatureData.scale,i=this._textureData.frame,this._pivotX=t.pivot.x,this._pivotY=t.pivot.y,n=(r=null!==i?i:this._textureData.region).width,o=r.height,this._textureData.rotated&&null===i&&(n=r.height,o=r.width),this._pivotX*=n*e,this._pivotY*=o*e,null!==i&&(this._pivotX+=i.x*e,this._pivotY+=i.y*e),null!==h&&t!==h&&(h.transform.toMatrix(f._helpMatrix),f._helpMatrix.invert(),f._helpMatrix.transformPoint(0,0,f._helpPoint),this._pivotX-=f._helpPoint.x,this._pivotY-=f._helpPoint.y,t.transform.toMatrix(f._helpMatrix),f._helpMatrix.invert(),f._helpMatrix.transformPoint(0,0,f._helpPoint),this._pivotX+=f._helpPoint.x,this._pivotY+=f._helpPoint.y),d.DragonBones.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*e-this._pivotY)):(this._pivotX=0,this._pivotY=0),this.origin=null!==h?h.transform:null!==l?l.transform:null,(null!==this.origin?this.global.copyFrom(this.origin).add(this.offset):this.global.copyFrom(this.offset)).toMatrix(this._localMatrix),this._geometryData!==a)if(this._geometryDirty=!0,this._verticesDirty=!0,null!==this._geometryData){if(this._geometryBones.length=0,null!==this._geometryData.weight)for(var u=0,c=this._geometryData.weight.bones.length;u<c;++u){var p=this._armature.getBone(this._geometryData.weight.bones[u].name);this._geometryBones.push(p)}}else this._geometryBones.length=0,this._geometryData=null;this._textureDirty=this._textureData!==s,this._transformDirty=!0}},f.prototype._updateDisplay=function(){var t=null!==this._display?this._display:this._rawDisplay,e=this._childArmature;null!==this._displayFrame?(this._display=this._displayFrame.display,null!==this._display&&this._display instanceof d.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null);var i=null!==this._display?this._display:this._rawDisplay;if((i!==t&&(this._textureDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._transformDirty=!0,this._onUpdateDisplay(),this._replaceDisplay(t)),this._childArmature!==e)&&(null!==e&&(e._parent=null,e.clock=null,e.inheritAnimation&&e.animation.reset()),null!==this._childArmature&&((this._childArmature._parent=this)._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation&&(0!==this._childArmature.cacheFrameRate||0!==(r=this._armature.cacheFrameRate)&&(this._childArmature.cacheFrameRate=r),null!==this._displayFrame)))){var e=null,r=null!==this._displayFrame.displayData?this._displayFrame.displayData:this._displayFrame.rawDisplayData;if(null!==(e=null!==r&&1===r.type?r.actions:e)&&0<e.length)for(var n=0,o=e;n<o.length;n++){var a=o[n],s=d.BaseObject.borrowObject(d.EventObject);d.EventObject.actionDataToInstance(a,s,this._armature),(s.slot=this)._armature._bufferAction(s,!1)}else this._childArmature.animation.play()}},f.prototype._updateGlobalTransformMatrix=function(t){var e=0===this._parent._boneData.type?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(e),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},f.prototype._setDisplayIndex=function(t,e){if(e=void 0===e?!1:e){if(this._animationDisplayIndex===t)return;this._animationDisplayIndex=t}this._displayIndex!==t&&(this._displayIndex=t<this._displayFrames.length?t:this._displayFrames.length-1,this._displayDataDirty=!0,this._displayDirty=this._displayIndex<0||this._display!==this._displayFrames[this._displayIndex].display)},f.prototype._setZOrder=function(t){return this._zOrder,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},f.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0},f.prototype.init=function(t,e,i,r){null===this._slotData&&(this._slotData=t,this._colorDirty=!0,this._blendModeDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._zIndex=this._slotData.zIndex,this._alpha=this._slotData.alpha,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=i,this._meshDisplay=r,this._armature=e,null!==(e=this._armature.getBone(this._slotData.parent.name))&&(this._parent=e),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay())},f.prototype.update=function(t){if(this._displayDataDirty&&(this._updateDisplayData(),this._displayDataDirty=!1),this._displayDirty&&(this._updateDisplay(),this._displayDirty=!1),this._zOrderDirty&&(this._updateZOrder(),this._zOrderDirty=!1),(this._geometryDirty||this._textureDirty)&&(null!==this._display&&this._display!==this._rawDisplay&&this._display!==this._meshDisplay||this._updateFrame(),this._geometryDirty=!1,this._textureDirty=!1),null!==this._display){if(this._visibleDirty&&(this._updateVisible(),this._visibleDirty=!1),this._blendModeDirty&&(this._updateBlendMode(),this._blendModeDirty=!1),this._colorDirty&&(this._updateColor(),this._colorDirty=!1),null!==this._geometryData&&this._display===this._meshDisplay){var e=null!==this._geometryData.weight,i=0!==this._parent._boneData.type;if((this._verticesDirty||e&&this._isBonesUpdate()||i&&this._parent._childrenTransformDirty)&&(this._verticesDirty=!1,this._updateMesh()),e||i)return}var r;0<=t&&null!==this._cachedFrameIndices?0<=(r=this._cachedFrameIndices[t])&&this._cachedFrameIndex===r?this._transformDirty=!1:0<=r?(this._transformDirty=!0,this._cachedFrameIndex=r):!this._transformDirty&&!this._parent._childrenTransformDirty&&0<=this._cachedFrameIndex?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1):(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1),this._transformDirty&&(this._cachedFrameIndex<0?(this._updateGlobalTransformMatrix(r=0<=t),r&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))):this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex),this._updateTransform(),this._transformDirty=!1)}},f.prototype.invalidUpdate=function(){this._displayDataDirty=!0,this._displayDirty=!0,this._transformDirty=!0,this.update(-1)},f.prototype.updateTransformAndMatrix=function(){this._transformDirty&&(this._updateGlobalTransformMatrix(!1),this._transformDirty=!1)},f.prototype.replaceRawDisplayData=function(t,e){if((e=void 0===e?-1:e)<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;var i=this._displayFrames[e];i.rawDisplayData!==t&&(i.deformVertices.length=0,i.rawDisplayData=t,null===i.rawDisplayData&&(null===(t=this._armature._armatureData.defaultSkin)||null!==(t=t.getDisplays(this._slotData.name))&&e<t.length&&(i.rawDisplayData=t[e])),e===this._displayIndex&&(this._displayDataDirty=!0))},f.prototype.replaceDisplayData=function(t,e){if((e=void 0===e?-1:e)<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;var i=this._displayFrames[e];i.displayData!==t&&i.rawDisplayData!==t&&(i.displayData=t,e===this._displayIndex&&(this._displayDataDirty=!0))},f.prototype.replaceTextureData=function(t,e){if((e=void 0===e?-1:e)<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;var i=this._displayFrames[e];i.textureData!==t&&(i.textureData=t,e===this._displayIndex&&(this._displayDataDirty=!0))},f.prototype.replaceDisplay=function(t,e){if((e=void 0===e?-1:e)<0)e=this._displayIndex<0?0:this._displayIndex;else if(e>=this._displayFrames.length)return;var i,r=this._displayFrames[e];r.display!==t&&(i=r.display,r.display=t,null===i||i===this._rawDisplay||i===this._meshDisplay||this._hasDisplay(i)||i instanceof d.Armature||this._disposeDisplay(i,!0),null===t||t===this._rawDisplay||t===this._meshDisplay||this._hasDisplay(i)||t instanceof d.Armature||this._initDisplay(t,!0),e===this._displayIndex&&(this._displayDirty=!0))},f.prototype.containsPoint=function(t,e){return null!==this._boundingBoxData&&(this.updateTransformAndMatrix(),f._helpMatrix.copyFrom(this.globalTransformMatrix),f._helpMatrix.invert(),f._helpMatrix.transformPoint(t,e,f._helpPoint),this._boundingBoxData.containsPoint(f._helpPoint.x,f._helpPoint.y))},f.prototype.intersectsSegment=function(t,e,i,r,n,o,a){if(void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=null),null===this._boundingBoxData)return 0;this.updateTransformAndMatrix(),f._helpMatrix.copyFrom(this.globalTransformMatrix),f._helpMatrix.invert(),f._helpMatrix.transformPoint(t,e,f._helpPoint),t=f._helpPoint.x,e=f._helpPoint.y,f._helpMatrix.transformPoint(i,r,f._helpPoint),i=f._helpPoint.x,r=f._helpPoint.y;r=this._boundingBoxData.intersectsSegment(t,e,i,r,n,o,a);return 0<r&&(1===r||2===r?null!==n?(this.globalTransformMatrix.transformPoint(n.x,n.y,n),null!==o&&(o.x=n.x,o.y=n.y)):null!==o&&this.globalTransformMatrix.transformPoint(o.x,o.y,o):(null!==n&&this.globalTransformMatrix.transformPoint(n.x,n.y,n),null!==o&&this.globalTransformMatrix.transformPoint(o.x,o.y,o)),null!==a&&(this.globalTransformMatrix.transformPoint(Math.cos(a.x),Math.sin(a.x),f._helpPoint,!0),a.x=Math.atan2(f._helpPoint.y,f._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(a.y),Math.sin(a.y),f._helpPoint,!0),a.y=Math.atan2(f._helpPoint.y,f._helpPoint.x))),r},f.prototype.getDisplayFrameAt=function(t){return this._displayFrames[t]},Object.defineProperty(f.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!==t&&(this._visible=t,this._updateVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"displayFrameCount",{get:function(){return this._displayFrames.length},set:function(t){var e=this._displayFrames.length;if(e<t){this._displayFrames.length=t;for(var i=e;i<t;++i)this._displayFrames[i]=d.BaseObject.borrowObject(r)}else if(t<e){for(i=e-1;i<t;--i)this.replaceDisplay(null,i),this._displayFrames[i].returnToPool();this._displayFrames.length=t}},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t),this.update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"name",{get:function(){return this._slotData.name},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"displayList",{get:function(){for(var t=new Array,e=0,i=this._displayFrames;e<i.length;e++){var r=i[e];t.push(r.display)}return t},set:function(t){this.displayFrameCount=t.length;for(var e=0,i=0,r=t;i<r.length;i++){var n=r[i];this.replaceDisplay(n,e++)}},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"slotData",{get:function(){return this._slotData},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"display",{get:function(){return this._display},set:function(t){this._display!==t&&(0===this._displayFrames.length&&(this.displayFrameCount=1,this._displayIndex=0),this.replaceDisplay(t,this._displayIndex))},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!==t&&(this.display=t)},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),f.prototype.getDisplay=function(){return this._display},f.prototype.setDisplay=function(t){this.display=t},f);function f(){var t=null!==h&&h.apply(this,arguments)||this;return t._localMatrix=new d.Matrix,t._colorTransform=new d.ColorTransform,t._displayFrames=[],t._geometryBones=[],t._rawDisplay=null,t._meshDisplay=null,t._display=null,t}d.Slot=i}(dragonBones=dragonBones||{}),function(k){var t,e=(t=k.BaseObject,__extends(i,t),i.prototype._onClear=function(){this._armature=null,this._target=null,this._root=null,this._bone=null},Object.defineProperty(i.prototype,"name",{get:function(){return this._constraintData.name},enumerable:!0,configurable:!0}),i._helpMatrix=new k.Matrix,i._helpTransform=new k.Transform,i._helpPoint=new k.Point,i);function i(){return null!==t&&t.apply(this,arguments)||this}k.Constraint=e;var r,n=(__extends(o,r=e),o.toString=function(){return"[class dragonBones.IKConstraint]"},o.prototype._onClear=function(){r.prototype._onClear.call(this),this._bendPositive=!1,this._weight=1,this._constraintData=null},o.prototype._computeA=function(){var t=this._target.global,e=this._root.global,i=this._root.globalTransformMatrix,t=Math.atan2(t.y-e.y,t.x-e.x);e.scaleX<0&&(t+=Math.PI),e.rotation+=k.Transform.normalizeRadian(t-e.rotation)*this._weight,e.toMatrix(i)},o.prototype._computeB=function(){var t=this._bone._boneData.length,e=this._root,i=this._target.global,r=e.global,n=this._bone.global,o=this._bone.globalTransformMatrix,a=o.a*t,s=o.b*t,h=a*a+s*s,l=Math.sqrt(h),u=n.x-r.x,c=n.y-r.y,p=u*u+c*c,d=Math.sqrt(p),f=n.rotation,_=r.rotation,g=Math.atan2(c,u),t=(u=i.x-r.x)*u+(c=i.y-r.y)*c,a=Math.sqrt(t),s=0;l+d<=a||a+l<=d||a+d<=l?(s=Math.atan2(i.y-r.y,i.x-r.x),l+d<=a||d<l&&(s+=Math.PI)):(h=(p-h+t)/(2*t),p=Math.sqrt(p-h*h*t)/a,t=r.x+u*h,a=r.y+c*h,h=-c*p,c=u*p,u=!1,(u=null!==(p=e.parent)?(p=p.globalTransformMatrix).a*p.d-p.b*p.c<0:u)!==this._bendPositive?(n.x=t-h,n.y=a-c):(n.x=t+h,n.y=a+c),s=Math.atan2(n.y-r.y,n.x-r.x));s=k.Transform.normalizeRadian(s-g);r.rotation=_+s*this._weight,r.toMatrix(e.globalTransformMatrix);g+=s*this._weight;n.x=r.x+Math.cos(g)*d,n.y=r.y+Math.sin(g)*d;i=Math.atan2(i.y-n.y,i.x-n.x);n.scaleX<0&&(i+=Math.PI),n.rotation=r.rotation+f-_+k.Transform.normalizeRadian(i-s-f)*this._weight,n.toMatrix(o)},o.prototype.init=function(t,e){null===this._constraintData&&(this._constraintData=t,this._armature=e,this._target=this._armature.getBone(this._constraintData.target.name),this._root=this._armature.getBone(this._constraintData.root.name),this._bone=null!==this._constraintData.bone?this._armature.getBone(this._constraintData.bone.name):null,e=this._constraintData,this._bendPositive=e.bendPositive,this._weight=e.weight,this._root._hasConstraint=!0)},o.prototype.update=function(){this._root.updateByConstraint(),null!==this._bone?(this._bone.updateByConstraint(),this._computeB()):this._computeA()},o.prototype.invalidUpdate=function(){this._root.invalidUpdate(),null!==this._bone&&this._bone.invalidUpdate()},o);function o(){return null!==r&&r.apply(this,arguments)||this}k.IKConstraint=n;var a,e=(__extends(s,a=e),s.toString=function(){return"[class dragonBones.PathConstraint]"},s.prototype._onClear=function(){a.prototype._onClear.call(this),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0},s.prototype._updatePathVertices=function(t){var e=this._armature,i=e.armatureData.parent,r=e.armatureData.scale,n=i.intArray,o=i.floatArray,i=t.offset,a=n[i+0],i=n[i+2];this._pathGlobalVertices.length=2*a;t=t.weight;if(null!==t)for(var s=this._pathSlot._geometryBones,h=t.bones.length,t=t.offset,l=n[t+1],u=t+2+h,c=0,p=0;c<a;c++){for(var d=0,f=0,_=0,g=n[u++];_<g;_++){var y=s[n[u++]];null!==y&&(y.updateByConstraint(),m=y.globalTransformMatrix,y=o[l++],b=o[l++]*r,T=o[l++]*r,d+=(m.a*b+m.c*T+m.tx)*y,f+=(m.b*b+m.d*T+m.ty)*y)}this._pathGlobalVertices[p++]=d,this._pathGlobalVertices[p++]=f}else{h=this._pathSlot.parent;h.updateByConstraint();for(var m=h.globalTransformMatrix,c=0,v=i;c<a;c+=2){var b=o[v++]*r,T=o[v++]*r,x=m.a*b+m.c*T+m.tx,w=m.b*b+m.d*T+m.ty;this._pathGlobalVertices[c]=x,this._pathGlobalVertices[c+1]=w}}},s.prototype._computeVertices=function(t,e,i,r){for(var n=i,o=t;n<e;n+=2)r[n]=this._pathGlobalVertices[o++],r[n+1]=this._pathGlobalVertices[o++]},s.prototype._computeBezierCurve=function(t,e,i,r,n){var o=this._armature.armatureData.parent.intArray[t.geometry.offset+0],a=this._positions,s=this._spaces,h=t.closed,l=Array(),u=2*o,c=u/6,p=-1,d=this.position;a.length=3*e+2;var f=0;if(t.constantSpeed){h?(u+=2,l.length=o,this._computeVertices(2,u-4,0,l),this._computeVertices(0,2,u-4,l),l[u-2]=l[0],l[u-1]=l[1]):(c--,l.length=u-=4,this._computeVertices(2,u,0,l));for(var _=new Array(c),g=l[f=0],y=l[1],m=0,v=0,b=0,T=0,x=0,w=0,S=0,C=2;S<c;S++,C+=6)m=l[C],v=l[C+1],b=l[C+2],T=l[C+3],k=2*(R=.1875*(g-2*m+b))+(M=.09375*(3*(m-b)-g+(x=l[C+4]))),j=2*(B=.1875*(y-2*v+T))+(L=.09375*(3*(v-T)-y+(w=l[C+5]))),N=.75*(m-g)+R+.16666667*M,G=.75*(v-y)+B+.16666667*L,f+=Math.sqrt(N*N+G*G),N+=k,G+=j,k+=M,j+=L,f+=Math.sqrt(N*N+G*G),N+=k,G+=j,f+=Math.sqrt(N*N+G*G),N+=k+M,G+=j+L,f+=Math.sqrt(N*N+G*G),_[S]=f,g=x,y=w;if(r&&(d*=f),n)for(S=0;S<e;S++)s[S]*=f;for(var E=this._segments,P=0,S=0,D=0,O=0,I=0;S<e;S++,D+=3){var $=d+=s[S];if(h)($%=f)<0&&($+=f),O=0;else{if($<0)continue;if(f<$)continue}for(;;O++){var A=_[O];if(!(A<$)){0===O?$/=A:$=($-(U=_[O-1]))/(A-U);break}}if(O!==p){var R,B,M,L,p=O,F=6*O,g=l[F],y=l[F+1],m=l[F+2],v=l[F+3],b=l[F+4],T=l[F+5],k=2*(R=.03*(g-2*m+b))+(M=.006*(3*(m-b)-g+(x=l[F+6]))),j=2*(B=.03*(y-2*v+T))+(L=.006*(3*(v-T)-y+(w=l[F+7]))),N=.3*(m-g)+R+.16666667*M,G=.3*(v-y)+B+.16666667*L,P=Math.sqrt(N*N+G*G);for(E[0]=P,F=1;F<8;F++)N+=k,G+=j,k+=M,j+=L,P+=Math.sqrt(N*N+G*G),E[F]=P;N+=k,G+=j,P+=Math.sqrt(N*N+G*G),E[8]=P,N+=k+M,G+=j+L,P+=Math.sqrt(N*N+G*G),E[9]=P,I=0}for($*=P;;I++){var U,H=E[I];if(!(H<$)){0===I?$/=H:$=I+($-(U=E[I-1]))/(H-U);break}}this.addCurvePosition(.1*$,g,y,m,v,b,T,x,w,a,D,i)}}else{var z=t.curveLengths,f=z[c-=h?1:2];if(r&&(d*=f),n)for(var S=0;S<e;S++)s[S]*=f;l.length=8;for(var S=0,D=0,O=0;S<e;S++,D+=3){if(d+=s[S],h)(d%=f)<0&&(d+=f),O=0;else{if(d<0)continue;if(f<d)continue}for(var W=0;;O++){var V,Y=z[O];if(!(Y<d)){W=0===O?d/Y:(d-(V=z[O-1]))/(Y-V);break}}O!==p&&(p=O,h&&O===c?(this._computeVertices(u-4,4,0,l),this._computeVertices(0,4,4,l)):this._computeVertices(6*O+2,8,0,l)),this.addCurvePosition(W,l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],a,D,i)}}},s.prototype.addCurvePosition=function(t,e,i,r,n,o,a,s,h,l,u,c){if(0===t)return l[u]=e,l[u+1]=i,void(l[u+2]=0);if(1===t)return l[u]=s,l[u+1]=h,void(l[u+2]=0);var p=1-t,d=p*p,f=t*t,_=d*p,d=d*t*3,p=p*f*3,f=t*f,s=_*e+d*r+p*o+f*s,h=_*i+d*n+p*a+f*h;l[u]=s,l[u+1]=h,l[u+2]=c?Math.atan2(h-(_*i+d*n+p*a),s-(_*e+d*r+p*o)):0},s.prototype.init=function(t,e){this._constraintData=t,this._armature=e;var i=t;this.pathOffset=i.pathDisplayData.geometry.offset,this.position=i.position,this.spacing=i.spacing,this.rotateOffset=i.rotateOffset,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix,this._root=this._armature.getBone(i.root.name),this._target=this._armature.getBone(i.target.name),this._pathSlot=this._armature.getSlot(i.pathSlot.name);for(var r=0,n=i.bones.length;r<n;r++){var o=this._armature.getBone(i.bones[r].name);null!==o&&this._bones.push(o)}2===i.rotateMode&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0},s.prototype.update=function(){var t=this._pathSlot;if(null!==t._geometryData&&t._geometryData.offset===this.pathOffset){var e=this._constraintData,i=!1;if(this._root._childrenTransformDirty?(this._updatePathVertices(t._geometryData),i=!0):(t._verticesDirty||t._isBonesUpdate())&&(this._updatePathVertices(t._geometryData),i=!(t._verticesDirty=!1)),i||this.dirty){var r=e.positionMode,n=e.spacingMode,i=e.rotateMode,o=this._bones,e=0===n,a=2===i,s=0===i,h=o.length,l=s?h:h+1,u=this.spacing,c=this._spaces;if(c.length=l,a||e)for(var p=c[0]=0,d=l-1;p<d;p++){(w=o[p]).updateByConstraint();var f=w._boneData.length,_=f*(S=w.globalTransformMatrix).a,g=f*S.b,y=Math.sqrt(_*_+g*g);a&&(this._boneLengths[p]=y),c[p+1]=(f+u)*y/f}else for(p=0;p<l;p++)c[p]=u;this._computeBezierCurve(t._displayFrame.rawDisplayData,l,s,1===r,2===n);var m,v=this._positions,b=this.rotateOffset,T=v[0],x=v[1];0===b?m=1===i:(m=!1,null!==(w=t.parent)&&(b*=0<(S=w.globalTransformMatrix).a*S.d-S.b*S.c?k.Transform.DEG_RAD:-k.Transform.DEG_RAD));for(var w,S,C=this.rotateMix,E=this.translateMix,p=0,P=3;p<h;p++,P+=3){(w=o[p]).updateByConstraint(),(S=w.globalTransformMatrix).tx+=(T-S.tx)*E,S.ty+=(x-S.ty)*E;var D,O,I,$,A,R,B,M,L=(_=v[P])-T,F=(g=v[P+1])-x;a&&(R=this._boneLengths[p],B=(Math.sqrt(L*L+F*F)/R-1)*C+1,S.a*=B,S.b*=B),T=_,x=g,0<C&&(D=S.a,O=S.b,I=S.c,$=S.d,R=A=M=void 0,M=s?v[P-1]:Math.atan2(F,L),M-=Math.atan2(O,D),m?(A=Math.cos(M),R=Math.sin(M),T+=((B=w._boneData.length)*(A*D-R*O)-L)*C,x+=(B*(R*D+A*O)-F)*C):M+=b,M>k.Transform.PI?M-=k.Transform.PI_D:M<-k.Transform.PI&&(M+=k.Transform.PI_D),M*=C,A=Math.cos(M),R=Math.sin(M),S.a=A*D-R*O,S.b=R*D+A*O,S.c=A*I-R*$,S.d=R*I+A*$),w.global.fromMatrix(S)}this.dirty=!1}}},s.prototype.invalidUpdate=function(){},s);function s(){var t=null!==a&&a.apply(this,arguments)||this;return t._bones=[],t._spaces=[],t._positions=[],t._curves=[],t._boneLengths=[],t._pathGlobalVertices=[],t._segments=[10],t}k.PathConstraint=e}(dragonBones=dragonBones||{}),function(t){var e=(i.prototype.advanceTime=function(t){t!=t&&(t=0);var e=.001*Date.now();if(t<0&&(t=e-this._systemTime),this._systemTime=e,1!==this.timeScale&&(t*=this.timeScale),0!==t){t<0?this.time-=t:this.time+=t;for(var i=0,r=0,n=this._animatebles.length;i<n;++i){var o=this._animatebles[i];null!==o?(0<r&&(this._animatebles[i-r]=o,this._animatebles[i]=null),o.advanceTime(t)):r++}if(0<r){for(n=this._animatebles.length;i<n;++i){var a=this._animatebles[i];null!==a?this._animatebles[i-r]=a:r++}this._animatebles.length-=r}}},i.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.clock;return e===this},i.prototype.add=function(t){this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},i.prototype.remove=function(t){var e=this._animatebles.indexOf(t);0<=e&&(this._animatebles[e]=null,t.clock=null)},i.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock!==t&&(null!==this._clock&&this._clock.remove(this),this._clock=t,null!==this._clock&&this._clock.add(this))},enumerable:!0,configurable:!0}),i);function i(t){void 0===t&&(t=0),this.time=0,this.timeScale=1,this._systemTime=0,this._animatebles=[],this._clock=null,this.time=t,this._systemTime=.001*(new Date).getTime()}t.WorldClock=e}(dragonBones=dragonBones||{}),function(g){var e,t=(e=g.BaseObject,__extends(i,e),i.toString=function(){return"[class dragonBones.Animation]"},i.prototype._onClear=function(){for(var t,e=0,i=this._animationStates;e<i.length;e++)i[e].returnToPool();for(t in this._animations)delete this._animations[t];for(t in this._blendStates){var r,n=this._blendStates[t];for(r in n)n[r].returnToPool();delete this._blendStates[t]}null!==this._animationConfig&&this._animationConfig.returnToPool(),this.timeScale=1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null},i.prototype._fadeOut=function(t){switch(t.fadeOutMode){case 1:for(var e=0,i=this._animationStates;e<i.length;e++)null===(s=i[e])._parent&&s.layer===t.layer&&s.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 2:for(var r=0,n=this._animationStates;r<n.length;r++)null===(s=n[r])._parent&&s.group===t.group&&s.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 3:for(var o=0,a=this._animationStates;o<a.length;o++)null===(s=a[o])._parent&&s.layer===t.layer&&s.group===t.group&&s.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 4:for(var s,h=0,l=this._animationStates;h<l.length;h++)null===(s=l[h])._parent&&s.fadeOut(t.fadeOutTime,t.pauseFadeOut)}},i.prototype.init=function(t){null===this._armature&&(this._armature=t,this._animationConfig=g.BaseObject.borrowObject(g.AnimationConfig))},i.prototype.advanceTime=function(t){for(var e in t<0&&(t=-t),this._armature.inheritAnimation&&null!==this._armature._parent?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,1!==this._inheritTimeScale&&(t*=this._inheritTimeScale),this._blendStates){var i,r=this._blendStates[e];for(i in r)r[i].reset()}var n=this._animationStates.length;if(1===n)if(0<(f=this._animationStates[0])._fadeState&&0<f._subFadeState)this._armature._dragonBones.bufferObject(f),this._animationStates.length=0,this._lastAnimationState=null;else{var o=f.animationData,a=o.cacheFrameRate;if(this._animationDirty&&0<a){this._animationDirty=!1;for(var s=0,h=this._armature.getBones();s<h.length;s++){var l=h[s];l._cachedFrameIndices=o.getBoneCachedFrameIndices(l.name)}for(var u=0,c=this._armature.getSlots();u<c.length;u++){var p=c[u];if(0<p.displayFrameCount){var d=p.getDisplayFrameAt(0).rawDisplayData;if(null!==d&&d.parent===this._armature.armatureData.defaultSkin){p._cachedFrameIndices=o.getSlotCachedFrameIndices(p.name);continue}}p._cachedFrameIndices=null}}f.advanceTime(t,a)}else if(1<n){for(var f,_=0,g=0;_<n;++_)0<(f=this._animationStates[_])._fadeState&&0<f._subFadeState?(g++,this._armature._dragonBones.bufferObject(f),this._animationDirty=!0,this._lastAnimationState===f&&(this._lastAnimationState=null)):(0<g&&(this._animationStates[_-g]=f),f.advanceTime(t,0)),_===n-1&&0<g&&(this._animationStates.length-=g,null===this._lastAnimationState&&0<this._animationStates.length&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]));this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1},i.prototype.reset=function(){for(var t=0,e=this._animationStates;t<e.length;t++)e[t].returnToPool();this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},i.prototype.stop=function(t){if(null!==(t=void 0===t?null:t))null!==(e=this.getState(t))&&e.stop();else for(var e,i=0,r=this._animationStates;i<r.length;i++)(e=r[i]).stop()},i.prototype.playConfig=function(t){var e=t.animation;if(!(e in this._animations))return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+e),null;var i=this._animations[e];if(5===t.fadeOutMode)for(var r=0,n=this._animationStates;r<n.length;r++){var o=n[r];if(o._fadeState<1&&o.layer===t.layer&&o.animationData===i)return o}0===this._animationStates.length?t.fadeInTime=0:t.fadeInTime<0&&(t.fadeInTime=i.fadeInTime),t.fadeOutTime<0&&(t.fadeOutTime=t.fadeInTime),t.timeScale<=-100&&(t.timeScale=1/i.scale),0<i.frameCount?(t.position<0?(t.position%=i.duration,t.position=i.duration-t.position):t.position===i.duration?t.position-=1e-6:t.position>i.duration&&(t.position%=i.duration),0<t.duration&&t.position+t.duration>i.duration&&(t.duration=i.duration-t.position),t.playTimes<0&&(t.playTimes=i.playTimes)):(t.playTimes=1,(t.position=0)<t.duration&&(t.duration=0)),0===t.duration&&(t.duration=-1),this._fadeOut(t);var a=g.BaseObject.borrowObject(g.AnimationState);if(a.init(this._armature,i,t),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,0<this._animationStates.length){for(var s=!1,h=0,l=this._animationStates.length;h<l;++h){if(a.layer>this._animationStates[h].layer){s=!0,this._animationStates.splice(h,0,a);break}if(h!==l-1&&a.layer>this._animationStates[h+1].layer){s=!0,this._animationStates.splice(h+1,0,a);break}}s||this._animationStates.push(a)}else this._animationStates.push(a);for(var u,c=0,p=this._armature.getSlots();c<p.length;c++){var d=p[c].childArmature;null!==d&&d.inheritAnimation&&d.animation.hasAnimation(e)&&null===d.animation.getState(e)&&d.animation.fadeIn(e)}for(u in i.animationTimelines){var f,_=this.fadeIn(u,0,1,a.layer,"",5);null!==_&&(f=i.animationTimelines[u],_.actionEnabled=!1,_.resetToPose=!1,_.stop(),a.addState(_,f),f=this._animationStates.indexOf(a),(_=this._animationStates.indexOf(_))<f&&(this._animationStates.splice(f,1),this._animationStates.splice(_,0,a)))}return this._lastAnimationState=a},i.prototype.play=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=null!==t?t:"",null!==t&&0<t.length?this.playConfig(this._animationConfig):null===this._lastAnimationState?null!==(t=this._armature.armatureData.defaultAnimation)&&(this._animationConfig.animation=t.name,this.playConfig(this._animationConfig)):this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):this._lastAnimationState.play(),this._lastAnimationState},i.prototype.fadeIn=function(t,e,i,r,n,o){return void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===r&&(r=0),void 0===n&&(n=null),void 0===o&&(o=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=o,this._animationConfig.playTimes=i,this._animationConfig.layer=r,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==n?n:"",this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0;t=(this._animationConfig.animation=t)in this._animations?this._animations[t]:null;return null!==t&&(this._animationConfig.position=0<t.frameCount?t.duration*e/t.frameCount:0),this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0;t=(this._animationConfig.animation=t)in this._animations?this._animations[t]:null;return null!==t&&(this._animationConfig.position=t.duration*(0<e?e:0)),this.playConfig(this._animationConfig)},i.prototype.gotoAndStopByTime=function(t,e){e=this.gotoAndPlayByTime(t,e=void 0===e?0:e,1);return null!==e&&e.stop(),e},i.prototype.gotoAndStopByFrame=function(t,e){e=this.gotoAndPlayByFrame(t,e=void 0===e?0:e,1);return null!==e&&e.stop(),e},i.prototype.gotoAndStopByProgress=function(t,e){e=this.gotoAndPlayByProgress(t,e=void 0===e?0:e,1);return null!==e&&e.stop(),e},i.prototype.getBlendState=function(t,e,i){t in this._blendStates||(this._blendStates[t]={});t=this._blendStates[t];return e in t||((t[e]=g.BaseObject.borrowObject(g.BlendState)).target=i),t[e]},i.prototype.getState=function(t,e){void 0===e&&(e=-1);for(var i=this._animationStates.length;i--;){var r=this._animationStates[i];if(r.name===t&&(e<0||r.layer===e))return r}return null},i.prototype.hasAnimation=function(t){return t in this._animations},i.prototype.getStates=function(){return this._animationStates},Object.defineProperty(i.prototype,"isPlaying",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++)if(e[t].isPlaying)return!0;return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++)if(!e[t].isCompleted)return!1;return 0<this._animationStates.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return null!==this._lastAnimationState?this._lastAnimationState.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!==t){for(var e in this._animationNames.length=0,this._animations)delete this._animations[e];for(var e in t)this._animationNames.push(e),this._animations[e]=t[e]}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationNames=[],t._animationStates=[],t._animations={},t._blendStates={},t._animationConfig=null,t}g.Animation=t}(dragonBones=dragonBones||{}),function(j){var e,t=(e=j.BaseObject,__extends(i,e),i.toString=function(){return"[class dragonBones.AnimationState]"},i.prototype._onClear=function(){for(var t=0,e=this._boneTimelines;t<e.length;t++)(p=e[t]).returnToPool();for(var i=0,r=this._boneBlendTimelines;i<r.length;i++)(p=r[i]).returnToPool();for(var n=0,o=this._slotTimelines;n<o.length;n++)(p=o[n]).returnToPool();for(var a=0,s=this._slotBlendTimelines;a<s.length;a++)(p=s[a]).returnToPool();for(var h=0,l=this._constraintTimelines;h<l.length;h++)(p=l[h]).returnToPool();for(var u=0,c=this._animationTimelines;u<c.length;u++){var p,d=(p=c[u]).target;d._parent===this&&(d._fadeState=1,d._subFadeState=1,d._parent=null),p.returnToPool()}null!==this._actionTimeline&&this._actionTimeline.returnToPool(),null!==this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additive=!1,this.displayControl=!1,this.resetToPose=!1,this.blendType=0,this.playTimes=1,this.layer=0,this.timeScale=1,this._weight=1,this.parameterX=0,this.parameterY=0,this.positionX=0,this.positionY=0,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._boneMask.length=0,this._boneTimelines.length=0,this._boneBlendTimelines.length=0,this._slotTimelines.length=0,this._slotBlendTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._activeChildA=null,this._activeChildB=null,this._parent=null},i.prototype._updateTimelines=function(){for(var t=0,e=this._armature._constraints;t<e.length;t++){var i=e[t],r=this._animationData.getConstraintTimelines(i.name);if(null!==r)for(var n=0,o=r;n<o.length;n++){var a,s=o[n];30===s.type&&((a=j.BaseObject.borrowObject(j.IKConstraintTimelineState)).target=i,a.init(this._armature,this,s),this._constraintTimelines.push(a))}else this.resetToPose&&((a=j.BaseObject.borrowObject(j.IKConstraintTimelineState)).target=i,a.init(this._armature,this,null),this._constraintTimelines.push(a),this._poseTimelines.push(a))}},i.prototype._updateBoneAndSlotTimelines=function(){for(var t={},e=0,i=this._boneTimelines;e<i.length;e++)(h=(_=i[e]).target.target.name)in t||(t[h]=[]),t[h].push(_);for(var r=0,n=this._boneBlendTimelines;r<n.length;r++)(h=(_=n[r]).target.target.name)in t||(t[h]=[]),t[h].push(_);for(var o=0,a=this._armature.getBones();o<a.length;o++){var s=a[o],h=s.name;if(this.containsBoneMask(h))if(h in t)delete t[h];else{var l=this._animationData.getBoneTimelines(h),u=this._armature.animation.getBlendState(N.BONE_TRANSFORM,s.name,s);if(null!==l)for(var c=0,p=l;c<p.length;c++)switch((O=p[c]).type){case 10:(_=j.BaseObject.borrowObject(j.BoneAllTimelineState)).target=u,_.init(this._armature,this,O),this._boneTimelines.push(_);break;case 11:(_=j.BaseObject.borrowObject(j.BoneTranslateTimelineState)).target=u,_.init(this._armature,this,O),this._boneTimelines.push(_);break;case 12:(_=j.BaseObject.borrowObject(j.BoneRotateTimelineState)).target=u,_.init(this._armature,this,O),this._boneTimelines.push(_);break;case 13:(_=j.BaseObject.borrowObject(j.BoneScaleTimelineState)).target=u,_.init(this._armature,this,O),this._boneTimelines.push(_);break;case 60:(_=j.BaseObject.borrowObject(j.AlphaTimelineState)).target=this._armature.animation.getBlendState(N.BONE_ALPHA,s.name,s),_.init(this._armature,this,O),this._boneBlendTimelines.push(_);break;case 50:(_=j.BaseObject.borrowObject(j.SurfaceTimelineState)).target=this._armature.animation.getBlendState(N.SURFACE,s.name,s),_.init(this._armature,this,O),this._boneBlendTimelines.push(_)}else this.resetToPose&&(0===s._boneData.type?((_=j.BaseObject.borrowObject(j.BoneAllTimelineState)).target=u,_.init(this._armature,this,null),this._boneTimelines.push(_)):((_=j.BaseObject.borrowObject(j.SurfaceTimelineState)).target=this._armature.animation.getBlendState(N.SURFACE,s.name,s),_.init(this._armature,this,null),this._boneBlendTimelines.push(_)),this._poseTimelines.push(_))}}for(x in t)for(var d=0,f=t[x];d<f.length;d++){var _=f[d];0<=(k=this._boneTimelines.indexOf(_))&&(this._boneTimelines.splice(k,1),_.returnToPool()),0<=(k=this._boneBlendTimelines.indexOf(_))&&(this._boneBlendTimelines.splice(k,1),_.returnToPool())}for(var g={},y=[],m=0,v=this._slotTimelines;m<v.length;m++)(h=(_=v[m]).target.name)in g||(g[h]=[]),g[h].push(_);for(var b=0,T=this._slotBlendTimelines;b<T.length;b++)(h=(_=T[b]).target.target.name)in g||(g[h]=[]),g[h].push(_);for(var x,w=0,S=this._armature.getSlots();w<S.length;w++){var C=S[w],E=C.parent.name;if(this.containsBoneMask(E))if((h=C.name)in g)delete g[h];else{var P=!1,D=!1;if(y.length=0,null!==(l=this._animationData.getSlotTimelines(h)))for(var O,I=0,$=l;I<$.length;I++)switch((O=$[I]).type){case 20:(_=j.BaseObject.borrowObject(j.SlotDisplayTimelineState)).target=C,_.init(this._armature,this,O),this._slotTimelines.push(_),P=!0;break;case 23:(_=j.BaseObject.borrowObject(j.SlotZIndexTimelineState)).target=this._armature.animation.getBlendState(N.SLOT_Z_INDEX,C.name,C),_.init(this._armature,this,O),this._slotBlendTimelines.push(_);break;case 21:(_=j.BaseObject.borrowObject(j.SlotColorTimelineState)).target=C,_.init(this._armature,this,O),this._slotTimelines.push(_),D=!0;break;case 22:(_=j.BaseObject.borrowObject(j.DeformTimelineState)).target=this._armature.animation.getBlendState(N.SLOT_DEFORM,C.name,C),_.init(this._armature,this,O),null!==_.target?(this._slotBlendTimelines.push(_),y.push(_.geometryOffset)):_.returnToPool();break;case 24:(_=j.BaseObject.borrowObject(j.AlphaTimelineState)).target=this._armature.animation.getBlendState(N.SLOT_ALPHA,C.name,C),_.init(this._armature,this,O),this._slotBlendTimelines.push(_)}if(this.resetToPose){P||((_=j.BaseObject.borrowObject(j.SlotDisplayTimelineState)).target=C,_.init(this._armature,this,null),this._slotTimelines.push(_),this._poseTimelines.push(_)),D||((_=j.BaseObject.borrowObject(j.SlotColorTimelineState)).target=C,_.init(this._armature,this,null),this._slotTimelines.push(_),this._poseTimelines.push(_));for(var A=0,R=C.displayFrameCount;A<R;++A){var B,M=C.getDisplayFrameAt(A);0!==M.deformVertices.length&&(null!==(B=M.getGeometryData())&&y.indexOf(B.offset)<0&&((_=j.BaseObject.borrowObject(j.DeformTimelineState)).geometryOffset=B.offset,_.displayFrame=M,_.target=this._armature.animation.getBlendState(N.SLOT_DEFORM,C.name,C),_.init(this._armature,this,null),this._slotBlendTimelines.push(_),this._poseTimelines.push(_)))}}}}for(x in g)for(var L=0,F=g[x];L<F.length;L++){var k,_=F[L];0<=(k=this._slotTimelines.indexOf(_))&&(this._slotTimelines.splice(k,1),_.returnToPool()),0<=(k=this._slotBlendTimelines.indexOf(_))&&(this._slotBlendTimelines.splice(k,1),_.returnToPool())}},i.prototype._advanceFadeTime=function(t){var e,i,r=0<this._fadeState;this._subFadeState<0&&(this._subFadeState=0,null===this._parent&&this.actionEnabled&&(e=r?j.EventObject.FADE_OUT:j.EventObject.FADE_IN,this._armature.eventDispatcher.hasDBEventListener(e)&&((i=j.BaseObject.borrowObject(j.EventObject)).type=e,i.armature=this._armature,(i.animationState=this)._armature._dragonBones.bufferEvent(i)))),this._fadeTime+=t=t<0?-t:t,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=r?0:1):0<this._fadeTime?this._fadeProgress=r?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=r?1:0,0<this._subFadeState&&(r||(this._playheadState|=1,this._fadeState=0),null===this._parent&&this.actionEnabled&&(e=r?j.EventObject.FADE_OUT_COMPLETE:j.EventObject.FADE_IN_COMPLETE,this._armature.eventDispatcher.hasDBEventListener(e)&&((i=j.BaseObject.borrowObject(j.EventObject)).type=e,i.armature=this._armature,(i.animationState=this)._armature._dragonBones.bufferEvent(i))))},i.prototype.init=function(t,e,i){if(null===this._armature){if(this._armature=t,this._animationData=e,this.resetToPose=i.resetToPose,this.additive=i.additive,this.displayControl=i.displayControl,this.actionEnabled=i.actionEnabled,this.blendType=e.blendType,this.layer=i.layer,this.playTimes=i.playTimes,this.timeScale=i.timeScale,this.fadeTotalTime=i.fadeInTime,this.autoFadeOutTime=i.autoFadeOutTime,this.name=0<i.name.length?i.name:i.animation,this.group=i.group,this._weight=i.weight,i.pauseFadeIn?this._playheadState=2:this._playheadState=3,i.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==i.position?0<=this.timeScale?this._time=i.position:this._time=i.position-this._duration:this._time=0):(this._position=i.position,this._duration=i.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),0<i.boneMask.length){this._boneMask.length=i.boneMask.length;for(var r=0,n=this._boneMask.length;r<n;++r)this._boneMask[r]=i.boneMask[r]}this._actionTimeline=j.BaseObject.borrowObject(j.ActionTimelineState),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),null!==this._animationData.zOrderTimeline&&(this._zOrderTimeline=j.BaseObject.borrowObject(j.ZOrderTimelineState),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}},i.prototype.advanceTime=function(t,e){0===this._fadeState&&0===this._subFadeState||this._advanceFadeTime(t),3===this._playheadState&&(1!==this.timeScale&&(t*=this.timeScale),this._time+=t),0!==this._timelineDirty&&(2===this._timelineDirty&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines());var i=0!==this._fadeState||0===this._subFadeState,r=0===this._fadeState&&0<e,n=!0,o=!0,a=this._time;if(this._weightResult=this._weight*this._fadeProgress,null!==this._parent&&(this._weightResult*=this._parent._weightResult),this._actionTimeline.playState<=0&&this._actionTimeline.update(a),0!==this._weight){if(r&&(t=2*e,this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*t)/t),null!==this._zOrderTimeline&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(a),r&&(e=Math.floor(this._actionTimeline.currentTime*e),this._armature._cacheFrameIndex===e?o=n=!1:(this._armature._cacheFrameIndex=e,this._animationData.cachedFrames[e]?o=!1:this._animationData.cachedFrames[e]=!0)),n){var s=!1,h=null;if(o)for(var l,u=0,c=this._boneTimelines.length;u<c;++u)(x=this._boneTimelines[u]).playState<=0&&x.update(a),x.target!==h&&(s=(d=x.target).update(this),1===(h=d).dirty&&((l=d.target.animationPose).x=0,l.y=0,l.rotation=0,l.skew=0,l.scaleX=1,l.scaleY=1)),s&&x.blend(i);for(u=0,c=this._boneBlendTimelines.length;u<c;++u)(x=this._boneBlendTimelines[u]).playState<=0&&x.update(a),x.target.update(this)&&x.blend(i);if(this.displayControl)for(var p,u=0,c=this._slotTimelines.length;u<c;++u)(x=this._slotTimelines[u]).playState<=0&&(null!==(p=x.target.displayController)&&p!==this.name&&p!==this.group||x.update(a));for(var d,u=0,c=this._slotBlendTimelines.length;u<c;++u)(x=this._slotBlendTimelines[u]).playState<=0&&(d=x.target,x.update(a),d.update(this)&&x.blend(i));for(u=0,c=this._constraintTimelines.length;u<c;++u)(x=this._constraintTimelines[u]).playState<=0&&x.update(a);if(0<this._animationTimelines.length){for(var f,_,g=100,y=100,m=null,v=null,u=0,c=this._animationTimelines.length;u<c;++u)(x=this._animationTimelines[u]).playState<=0&&x.update(a),1===this.blendType&&(f=x.target,0<=(_=this.parameterX-f.positionX)?_<g&&(g=_,m=f):-_<y&&(y=-_,v=f));null!==m&&(this._activeChildA!==m&&(null!==this._activeChildA&&(this._activeChildA.weight=0),this._activeChildA=m,this._activeChildA.activeTimeline()),this._activeChildB!==v&&(null!==this._activeChildB&&(this._activeChildB.weight=0),this._activeChildB=v),m.weight=y/(g+y),v&&(v.weight=1-m.weight))}}if(0===this._fadeState){if(0<this._subFadeState&&(this._subFadeState=0)<this._poseTimelines.length){for(var b=0,T=this._poseTimelines;b<T.length;b++){var x=T[b],w=this._boneTimelines.indexOf(x);0<=w?(this._boneTimelines.splice(w,1),x.returnToPool()):0<=(w=this._boneBlendTimelines.indexOf(x))?(this._boneBlendTimelines.splice(w,1),x.returnToPool()):0<=(w=this._slotTimelines.indexOf(x))?(this._slotTimelines.splice(w,1),x.returnToPool()):0<=(w=this._slotBlendTimelines.indexOf(x))?(this._slotBlendTimelines.splice(w,1),x.returnToPool()):0<=(w=this._constraintTimelines.indexOf(x))&&(this._constraintTimelines.splice(w,1),x.returnToPool())}this._poseTimelines.length=0}0<this._actionTimeline.playState&&0<=this.autoFadeOutTime&&this.fadeOut(this.autoFadeOutTime)}}},i.prototype.play=function(){this._playheadState=3},i.prototype.stop=function(){this._playheadState&=1},i.prototype.fadeOut=function(t,e){if(t<0&&(t=0),(e=void 0===e?!0:e)&&(this._playheadState&=2),0<this._fadeState){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,r=this._boneTimelines;i<r.length;i++)(p=r[i]).fadeOut();for(var n=0,o=this._boneBlendTimelines;n<o.length;n++)(p=o[n]).fadeOut();for(var a=0,s=this._slotTimelines;a<s.length;a++)(p=s[a]).fadeOut();for(var h=0,l=this._slotBlendTimelines;h<l.length;h++)(p=l[h]).fadeOut();for(var u=0,c=this._constraintTimelines;u<c.length;u++)(p=c[u]).fadeOut();for(var p,d=0,f=this._animationTimelines;d<f.length;d++)(p=f[d]).fadeOut(),p.target.fadeOut(999999,!0)}this.displayControl=!1,this.fadeTotalTime=1e-6<this._fadeProgress?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},i.prototype.containsBoneMask=function(t){return 0===this._boneMask.length||0<=this._boneMask.indexOf(t)},i.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(null!==i){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(var r=0,n=this._armature.getBones();r<n.length;r++){var o=n[r];this._boneMask.indexOf(o.name)<0&&i.contains(o)&&this._boneMask.push(o.name)}this._timelineDirty=1}},i.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(0<=i&&this._boneMask.splice(i,1),e){var r=this._armature.getBone(t);if(null!==r){t=this._armature.getBones();if(0<this._boneMask.length)for(var n=0,o=t;n<o.length;n++){var a=o[n],s=this._boneMask.indexOf(a.name);0<=s&&r.contains(a)&&this._boneMask.splice(s,1)}else for(var h=0,l=t;h<l.length;h++)(a=l[h])!==r&&(r.contains(a)||this._boneMask.push(a.name))}}this._timelineDirty=1},i.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._timelineDirty=1},i.prototype.addState=function(t,e){if(null!==(e=void 0===e?null:e))for(var i=0,r=e;i<r.length;i++){var n,o,a=r[i];switch(a.type){case 40:(o=j.BaseObject.borrowObject(j.AnimationProgressTimelineState)).target=t,o.init(this._armature,this,a),this._animationTimelines.push(o),0!==this.blendType&&(t.positionX=(n=a).x,t.positionY=n.y,t.weight=0),(t._parent=this).resetToPose=!1;break;case 41:(o=j.BaseObject.borrowObject(j.AnimationWeightTimelineState)).target=t,o.init(this._armature,this,a),this._animationTimelines.push(o);break;case 42:(o=j.BaseObject.borrowObject(j.AnimationParametersTimelineState)).target=t,o.init(this._armature,this,a),this._animationTimelines.push(o)}}null===t._parent&&(t._parent=this)},i.prototype.activeTimeline=function(){for(var t=0,e=this._slotTimelines;t<e.length;t++){var i=e[t];i.dirty=!0,i.currentTime=-1}},Object.defineProperty(i.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isFadeOut",{get:function(){return 0<this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isFadeComplete",{get:function(){return 0===this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return 0!=(2&this._playheadState)&&this._actionTimeline.playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){return 0<this._actionTimeline.playState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(t){var e=this._actionTimeline.currentPlayTimes-(0<this._actionTimeline.playState?1:0);if((t<0||this._duration<t)&&(t=t%this._duration+e*this._duration)<0&&(t+=this._duration),0<this.playTimes&&e==this.playTimes-1&&t===this._duration&&null===this._parent&&(t=this._duration-1e-6),this._time!==t){this._time=t,this._actionTimeline.setCurrentTime(this._time),null!==this._zOrderTimeline&&(this._zOrderTimeline.playState=-1);for(var i=0,r=this._boneTimelines;i<r.length;i++)r[i].playState=-1;for(var n=0,o=this._slotTimelines;n<o.length;n++)o[n].playState=-1}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"weight",{get:function(){return this._weight},set:function(t){if(this._weight!==t){this._weight=t;for(var e=0,i=this._boneTimelines;e<i.length;e++)i[e].dirty=!0;for(var r=0,n=this._boneBlendTimelines;r<n.length;r++)n[r].dirty=!0;for(var o=0,a=this._slotBlendTimelines;o<a.length;o++)a[o].dirty=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._boneMask=[],t._boneTimelines=[],t._boneBlendTimelines=[],t._slotTimelines=[],t._slotBlendTimelines=[],t._constraintTimelines=[],t._animationTimelines=[],t._poseTimelines=[],t._actionTimeline=null,t._zOrderTimeline=null,t}j.AnimationState=t;var r,N=(r=j.BaseObject,__extends(n,r),n.toString=function(){return"[class dragonBones.BlendState]"},n.prototype._onClear=function(){this.reset(),this.target=null},n.prototype.update=function(t){var e=t.layer,t=t._weightResult;if(0<this.dirty){if(0<this.leftWeight){if(this.layer!==e){if(this.layerWeight>=this.leftWeight)return this.dirty++,this.layer=e,this.leftWeight=0,this.blendWeight=0,!1;this.layer=e,this.leftWeight-=this.layerWeight,this.layerWeight=0}return t*=this.leftWeight,this.dirty++,this.blendWeight=t,this.layerWeight+=this.blendWeight,!0}return!1}return this.dirty++,this.layer=e,this.leftWeight=1,this.blendWeight=t,this.layerWeight=t,!0},n.prototype.reset=function(){this.dirty=0,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0},n.BONE_TRANSFORM="boneTransform",n.BONE_ALPHA="boneAlpha",n.SURFACE="surface",n.SLOT_DEFORM="slotDeform",n.SLOT_ALPHA="slotAlpha",n.SLOT_Z_INDEX="slotZIndex",n);function n(){return null!==r&&r.apply(this,arguments)||this}j.BlendState=N}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.prototype._onClear=function(){this.dirty=!1,this.playState=-1,this.currentPlayTimes=0,this.currentTime=-1,this.target=null,this._isTween=!1,this._valueOffset=0,this._frameValueOffset=0,this._frameOffset=0,this._frameRate=0,this._frameCount=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._valueArray=null,this._timelineArray=null,this._frameIndices=null},r.prototype._setCurrentTime=function(t){var e,i,r=this.playState,n=this.currentPlayTimes,o=this.currentTime;return null!==this._actionTimeline&&this._frameCount<=1?(this.playState=0<=this._actionTimeline.playState?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime):null===this._actionTimeline||1!==this._timeScale||0!==this._timeOffset?(i=(e=this._animationState.playTimes)*this._duration,t*=this._timeScale,0!==this._timeOffset&&(t+=this._timeOffset*this._animationData.duration),0<e&&(i<=t||t<=-i)?(this.playState<=0&&3===this._animationState._playheadState&&(this.playState=1),this.currentPlayTimes=e,this.currentTime=t<0?0:1===this.playState?this._duration+1e-6:this._duration):(0!==this.playState&&3===this._animationState._playheadState&&(this.playState=0),t<0?(t=-t,this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=this._duration-t%this._duration):(this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=t%this._duration)),this.currentTime+=this._position):(this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime),(this.currentPlayTimes!==n||this.currentTime!==o)&&((r<0&&this.playState!==r||this.playState<=0&&this.currentPlayTimes!==n)&&(this._frameIndex=-1),!0)},r.prototype.init=function(t,e,i){this._armature=t,this._animationState=e,this._timelineData=i,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState.animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,null!==this._timelineData&&(i=this._animationData.parent.parent,this._frameArray=i.frameArray,this._timelineArray=i.timelineArray,this._frameIndices=i.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=.01*this._timelineArray[this._timelineData.offset+1])},r.prototype.fadeOut=function(){this.dirty=!1},r.prototype.update=function(t){this._setCurrentTime(t)&&(1<this._frameCount?(t=Math.floor(this.currentTime*this._frameRate),t=this._frameIndices[this._timelineData.frameIndicesOffset+t],this._frameIndex!==t&&(this._frameIndex=t,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())):this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame()),(this._isTween||this.dirty)&&this._onUpdateFrame())},r.prototype.blend=function(t){},r);function r(){return null!==e&&e.apply(this,arguments)||this}t.TimelineState=i;var n,o=(__extends(a,n=i),a._getEasingValue=function(t,e,i){var r=e;switch(t){case 3:r=Math.pow(e,2);break;case 4:r=1-Math.pow(1-e,2);break;case 5:r=.5*(1-Math.cos(e*Math.PI))}return(r-e)*i+e},a._getEasingCurveValue=function(t,e,i,r){if(t<=0)return 0;if(1<=t)return 1;var n=0<i,o=i+1,a=Math.floor(t*o),s=0,i=0,i=n?(s=0===a?0:e[r+a-1],a===o-1?1e4:e[r+a]):(s=e[r+a-1],e[r+a]);return 1e-4*(s+(i-s)*(t*o-a))},a.prototype._onClear=function(){n.prototype._onClear.call(this),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenEasing=0,this._tweenProgress=0,this._valueScale=1},a.prototype._onArriveAtFrame=function(){var t;1<this._frameCount&&(this._frameIndex!==this._frameCount-1||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1)?(this._tweenType=this._frameArray[this._frameOffset+1],this._isTween=0!==this._tweenType,this._isTween?2===this._tweenType?this._curveCount=this._frameArray[this._frameOffset+2]:0!==this._tweenType&&1!==this._tweenType&&(this._tweenEasing=.01*this._frameArray[this._frameOffset+2]):this.dirty=!0,this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1?this._frameDurationR=1/(this._animationData.duration-this._framePosition):(t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],t=this._frameArray[t]*this._frameRateR-this._framePosition,this._frameDurationR=0<t?1/t:0)):(this.dirty=!0,this._isTween=!1)},a.prototype._onUpdateFrame=function(){this._isTween&&(this.dirty=!0,this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,2===this._tweenType?this._tweenProgress=a._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):1!==this._tweenType&&(this._tweenProgress=a._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing)))},a);function a(){return null!==n&&n.apply(this,arguments)||this}t.TweenTimelineState=o;var s,i=(__extends(h,s=o),h.prototype._onClear=function(){s.prototype._onClear.call(this),this._current=0,this._difference=0,this._result=0},h.prototype._onArriveAtFrame=function(){var t,e,i,r;s.prototype._onArriveAtFrame.call(this),null!==this._timelineData?(t=this._valueScale,e=this._valueArray,i=this._valueOffset+this._frameValueOffset+this._frameIndex,this._isTween?(r=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:i+1,1===t?(this._current=e[i],this._difference=e[r]-this._current):(this._current=e[i]*t,this._difference=e[r]*t-this._current)):this._result=e[i]*t):this._result=0},h.prototype._onUpdateFrame=function(){s.prototype._onUpdateFrame.call(this),this._isTween&&(this._result=this._current+this._difference*this._tweenProgress)},h);function h(){return null!==s&&s.apply(this,arguments)||this}t.SingleValueTimelineState=i;var l,i=(__extends(u,l=o),u.prototype._onClear=function(){l.prototype._onClear.call(this),this._currentA=0,this._currentB=0,this._differenceA=0,this._differenceB=0,this._resultA=0,this._resultB=0},u.prototype._onArriveAtFrame=function(){var t,e,i,r;l.prototype._onArriveAtFrame.call(this),null!==this._timelineData?(t=this._valueScale,e=this._valueArray,i=this._valueOffset+this._frameValueOffset+2*this._frameIndex,this._isTween?(r=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:i+2,1===t?(this._currentA=e[i],this._currentB=e[i+1],this._differenceA=e[r]-this._currentA,this._differenceB=e[r+1]-this._currentB):(this._currentA=e[i]*t,this._currentB=e[i+1]*t,this._differenceA=e[r]*t-this._currentA,this._differenceB=e[r+1]*t-this._currentB)):(this._resultA=e[i]*t,this._resultB=e[i+1]*t)):(this._resultA=0,this._resultB=0)},u.prototype._onUpdateFrame=function(){l.prototype._onUpdateFrame.call(this),this._isTween&&(this._resultA=this._currentA+this._differenceA*this._tweenProgress,this._resultB=this._currentB+this._differenceB*this._tweenProgress)},u);function u(){return null!==l&&l.apply(this,arguments)||this}t.DoubleValueTimelineState=i;var c,o=(__extends(p,c=o),p.prototype._onClear=function(){c.prototype._onClear.call(this),this._valueCount=0,this._rd.length=0},p.prototype._onArriveAtFrame=function(){c.prototype._onArriveAtFrame.call(this);var t=this._valueCount,e=this._rd;if(null!==this._timelineData){var i=this._valueScale,r=this._valueArray,n=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(this._isTween){var o=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:n+t;if(1===i)for(var a=0;a<t;++a)e[t+a]=r[o+a]-r[n+a];else for(a=0;a<t;++a)e[t+a]=(r[o+a]-r[n+a])*i}else if(1===i)for(a=0;a<t;++a)e[a]=r[n+a];else for(a=0;a<t;++a)e[a]=r[n+a]*i}else for(a=0;a<t;++a)e[a]=0},p.prototype._onUpdateFrame=function(){if(c.prototype._onUpdateFrame.call(this),this._isTween){var t=this._valueCount,e=this._valueScale,i=this._tweenProgress,r=this._valueArray,n=this._rd,o=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(1===e)for(var a=0;a<t;++a)n[a]=r[o+a]+n[t+a]*i;else for(a=0;a<t;++a)n[a]=r[o+a]*e+n[t+a]*i}},p);function p(){var t=null!==c&&c.apply(this,arguments)||this;return t._rd=[],t}t.MutilpleValueTimelineState=o}(dragonBones=dragonBones||{}),function(d){var t,e=(t=d.TimelineState,__extends(i,t),i.toString=function(){return"[class dragonBones.ActionTimelineState]"},i.prototype._onCrossFrame=function(t){var e=this._armature.eventDispatcher;if(this._animationState.actionEnabled)for(var i=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+t],r=this._frameArray[i+1],n=this._animationData.parent.actions,o=0;o<r;++o){var a,s,h=n[this._frameArray[i+2+o]];0===h.type?((s=d.BaseObject.borrowObject(d.EventObject)).time=this._frameArray[i]/this._frameRate,s.animationState=this._animationState,d.EventObject.actionDataToInstance(h,s,this._armature),this._armature._bufferAction(s,!0)):(a=10===h.type?d.EventObject.FRAME_EVENT:d.EventObject.SOUND_EVENT,11!==h.type&&!e.hasDBEventListener(a)||((s=d.BaseObject.borrowObject(d.EventObject)).time=this._frameArray[i]/this._frameRate,s.animationState=this._animationState,d.EventObject.actionDataToInstance(h,s,this._armature),this._armature._dragonBones.bufferEvent(s)))}},i.prototype._onArriveAtFrame=function(){},i.prototype._onUpdateFrame=function(){},i.prototype.update=function(t){var e=this.playState,i=this.currentPlayTimes,r=this.currentTime;if(this._setCurrentTime(t)){var n=null===this._animationState._parent&&this._animationState.actionEnabled,t=this._armature.eventDispatcher;if(e<0){if(this.playState===e)return;this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),n&&t.hasDBEventListener(d.EventObject.START)&&((a=d.BaseObject.borrowObject(d.EventObject)).type=d.EventObject.START,a.armature=this._armature,a.animationState=this._animationState,this._armature._dragonBones.bufferEvent(a))}var e=this._animationState.timeScale<0,o=null,a=null;if(n&&this.currentPlayTimes!==i&&(t.hasDBEventListener(d.EventObject.LOOP_COMPLETE)&&((o=d.BaseObject.borrowObject(d.EventObject)).type=d.EventObject.LOOP_COMPLETE,o.armature=this._armature,o.animationState=this._animationState),0<this.playState&&t.hasDBEventListener(d.EventObject.COMPLETE)&&((a=d.BaseObject.borrowObject(d.EventObject)).type=d.EventObject.COMPLETE,a.armature=this._armature,a.animationState=this._animationState)),1<this._frameCount){var s=this._timelineData,t=Math.floor(this.currentTime*this._frameRate),h=this._frameIndices[s.frameIndicesOffset+t];if(this._frameIndex!==h){var l,u=this._frameIndex;if(this._frameIndex=h,null!==this._timelineArray)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[s.offset+5+this._frameIndex],e)for(u<0&&(l=Math.floor(r*this._frameRate),u=this._frameIndices[s.frameIndicesOffset+l],this.currentPlayTimes===i&&u===h&&(u=-1));0<=u;){var c=this._animationData.frameOffset+this._timelineArray[s.offset+5+u],p=this._frameArray[c]/this._frameRate;if(this._position<=p&&p<=this._position+this._duration&&this._onCrossFrame(u),null!==o&&0===u&&(this._armature._dragonBones.bufferEvent(o),o=null),0<u?u--:u=this._frameCount-1,u===h)break}else for(u<0&&(l=Math.floor(r*this._frameRate),u=this._frameIndices[s.frameIndicesOffset+l],c=this._animationData.frameOffset+this._timelineArray[s.offset+5+u],p=this._frameArray[c]/this._frameRate,this.currentPlayTimes===i&&(r<=p?0<u?u--:u=this._frameCount-1:u===h&&(u=-1)));0<=u;){u<this._frameCount-1?u++:u=0;var c=this._animationData.frameOffset+this._timelineArray[s.offset+5+u],p=this._frameArray[c]/this._frameRate;if(this._position<=p&&p<=this._position+this._duration&&this._onCrossFrame(u),null!==o&&0===u&&(this._armature._dragonBones.bufferEvent(o),o=null),u===h)break}}}else this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5],p=this._frameArray[this._frameOffset]/this._frameRate,this.currentPlayTimes===i?r<=p&&this._onCrossFrame(this._frameIndex):this._position<=p&&(e||null===o||(this._armature._dragonBones.bufferEvent(o),o=null),this._onCrossFrame(this._frameIndex))));null!==o&&this._armature._dragonBones.bufferEvent(o),null!==a&&this._armature._dragonBones.bufferEvent(a)}},i.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._frameIndex=-1},i);function i(){return null!==t&&t.apply(this,arguments)||this}d.ActionTimelineState=e;var r,e=(r=d.TimelineState,__extends(n,r),n.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},n.prototype._onArriveAtFrame=function(){0<=this.playState&&(0<this._frameArray[this._frameOffset+1]?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))},n.prototype._onUpdateFrame=function(){},n);function n(){return null!==r&&r.apply(this,arguments)||this}d.ZOrderTimelineState=e;var o,e=(o=d.MutilpleValueTimelineState,__extends(a,o),a.toString=function(){return"[class dragonBones.BoneAllTimelineState]"},a.prototype._onArriveAtFrame=function(){o.prototype._onArriveAtFrame.call(this),this._isTween&&this._frameIndex===this._frameCount-1&&(this._rd[2]=d.Transform.normalizeRadian(this._rd[2]),this._rd[3]=d.Transform.normalizeRadian(this._rd[3])),null===this._timelineData&&(this._rd[4]=1,this._rd[5]=1)},a.prototype.init=function(t,e,i){o.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=6,this._valueArray=this._animationData.parent.parent.frameFloatArray},a.prototype.fadeOut=function(){this.dirty=!1,this._rd[2]=d.Transform.normalizeRadian(this._rd[2]),this._rd[3]=d.Transform.normalizeRadian(this._rd[3])},a.prototype.blend=function(t){var e=this._armature.armatureData.scale,i=this._rd,r=this.target,n=r.target,o=r.blendWeight,a=n.animationPose;1<r.dirty?(a.x+=i[0]*o*e,a.y+=i[1]*o*e,a.rotation+=i[2]*o,a.skew+=i[3]*o,a.scaleX+=(i[4]-1)*o,a.scaleY+=(i[5]-1)*o):(a.x=i[0]*o*e,a.y=i[1]*o*e,a.rotation=i[2]*o,a.skew=i[3]*o,a.scaleX=(i[4]-1)*o+1,a.scaleY=(i[5]-1)*o+1),(t||this.dirty)&&(this.dirty=!1,n._transformDirty=!0)},a);function a(){return null!==o&&o.apply(this,arguments)||this}d.BoneAllTimelineState=e;var s,e=(s=d.DoubleValueTimelineState,__extends(h,s),h.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"},h.prototype.init=function(t,e,i){s.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=this._animationData.parent.parent.frameFloatArray},h.prototype.blend=function(t){var e=this.target,i=e.target,r=e.blendWeight,n=i.animationPose;1<e.dirty?(n.x+=this._resultA*r,n.y+=this._resultB*r):1!==r?(n.x=this._resultA*r,n.y=this._resultB*r):(n.x=this._resultA,n.y=this._resultB),(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},h);function h(){return null!==s&&s.apply(this,arguments)||this}d.BoneTranslateTimelineState=e;var l,e=(l=d.DoubleValueTimelineState,__extends(u,l),u.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"},u.prototype._onArriveAtFrame=function(){l.prototype._onArriveAtFrame.call(this),this._isTween&&this._frameIndex===this._frameCount-1&&(this._differenceA=d.Transform.normalizeRadian(this._differenceA),this._differenceB=d.Transform.normalizeRadian(this._differenceB))},u.prototype.init=function(t,e,i){l.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray},u.prototype.fadeOut=function(){this.dirty=!1,this._resultA=d.Transform.normalizeRadian(this._resultA),this._resultB=d.Transform.normalizeRadian(this._resultB)},u.prototype.blend=function(t){var e=this.target,i=e.target,r=e.blendWeight,n=i.animationPose;1<e.dirty?(n.rotation+=this._resultA*r,n.skew+=this._resultB*r):1!==r?(n.rotation=this._resultA*r,n.skew=this._resultB*r):(n.rotation=this._resultA,n.skew=this._resultB),(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},u);function u(){return null!==l&&l.apply(this,arguments)||this}d.BoneRotateTimelineState=e;var c,e=(c=d.DoubleValueTimelineState,__extends(p,c),p.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"},p.prototype._onArriveAtFrame=function(){c.prototype._onArriveAtFrame.call(this),null===this._timelineData&&(this._resultA=1,this._resultB=1)},p.prototype.init=function(t,e,i){c.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameFloatOffset,this._valueArray=this._animationData.parent.parent.frameFloatArray},p.prototype.blend=function(t){var e=this.target,i=e.target,r=e.blendWeight,n=i.animationPose;1<e.dirty?(n.scaleX+=(this._resultA-1)*r,n.scaleY+=(this._resultB-1)*r):1!==r?(n.scaleX=(this._resultA-1)*r+1,n.scaleY=(this._resultB-1)*r+1):(n.scaleX=this._resultA,n.scaleY=this._resultB),(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},p);function p(){return null!==c&&c.apply(this,arguments)||this}d.BoneScaleTimelineState=e;var f,e=(f=d.MutilpleValueTimelineState,__extends(_,f),_.toString=function(){return"[class dragonBones.SurfaceTimelineState]"},_.prototype._onClear=function(){f.prototype._onClear.call(this),this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0},_.prototype.init=function(t,e,i){f.prototype.init.call(this,t,e,i),null!==this._timelineData?(e=(t=this._animationData.parent.parent).frameIntArray,i=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3],this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=e[i+2],this._deformCount=e[i+1],this._deformOffset=e[i+3],this._sameValueOffset=e[i+4]+this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=t.frameFloatArray,this._rd.length=2*this._valueCount):this._deformCount=this.target.target._deformVertices.length},_.prototype.blend=function(t){var e=this.target,i=e.target,r=e.blendWeight,n=i._deformVertices,o=this._valueArray;if(null!==o)for(var a=this._valueCount,s=this._deformOffset,h=this._sameValueOffset,l=this._rd,u=0;u<this._deformCount;++u){var c=0,c=u<s?o[h+u]:u<s+a?l[u-s]:o[h+u-a];1<e.dirty?n[u]+=c*r:n[u]=c*r}else if(1===e.dirty)for(u=0;u<this._deformCount;++u)n[u]=0;(t||this.dirty)&&(this.dirty=!1,i._transformDirty=!0)},_);function _(){return null!==f&&f.apply(this,arguments)||this}d.SurfaceTimelineState=e;var g,e=(g=d.SingleValueTimelineState,__extends(y,g),y.toString=function(){return"[class dragonBones.AlphaTimelineState]"},y.prototype._onArriveAtFrame=function(){g.prototype._onArriveAtFrame.call(this),null===this._timelineData&&(this._result=1)},y.prototype.init=function(t,e,i){g.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray},y.prototype.blend=function(t){var e=this.target,i=e.target,r=e.blendWeight;1<e.dirty?(i._alpha+=this._result*r,1<i._alpha&&(i._alpha=1)):i._alpha=this._result*r,(t||this.dirty)&&(this.dirty=!1,this._armature._alphaDirty=!0)},y);function y(){return null!==g&&g.apply(this,arguments)||this}d.AlphaTimelineState=e;var m,e=(m=d.TimelineState,__extends(v,m),v.toString=function(){return"[class dragonBones.SlotDisplayTimelineState]"},v.prototype._onArriveAtFrame=function(){var t,e;0<=this.playState&&(t=this.target,e=null!==this._timelineData?this._frameArray[this._frameOffset+1]:t._slotData.displayIndex,t.displayIndex!==e&&t._setDisplayIndex(e,!0))},v.prototype._onUpdateFrame=function(){},v);function v(){return null!==m&&m.apply(this,arguments)||this}d.SlotDisplayTimelineState=e;var b,e=(b=d.TweenTimelineState,__extends(T,b),T.toString=function(){return"[class dragonBones.SlotColorTimelineState]"},T.prototype._onArriveAtFrame=function(){var t,e,i,r;b.prototype._onArriveAtFrame.call(this),null!==this._timelineData?(t=(r=this._animationData.parent.parent).colorArray,(r=(e=r.frameIntArray)[i=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex])<0&&(r+=65536),this._isTween?(this._current[0]=t[r++],this._current[1]=t[r++],this._current[2]=t[r++],this._current[3]=t[r++],this._current[4]=t[r++],this._current[5]=t[r++],this._current[6]=t[r++],this._current[7]=t[r++],(r=this._frameIndex===this._frameCount-1?e[this._animationData.frameIntOffset+this._frameValueOffset]:e[i+1])<0&&(r+=65536),this._difference[0]=t[r++]-this._current[0],this._difference[1]=t[r++]-this._current[1],this._difference[2]=t[r++]-this._current[2],this._difference[3]=t[r++]-this._current[3],this._difference[4]=t[r++]-this._current[4],this._difference[5]=t[r++]-this._current[5],this._difference[6]=t[r++]-this._current[6],this._difference[7]=t[r++]-this._current[7]):(this._result[0]=.01*t[r++],this._result[1]=.01*t[r++],this._result[2]=.01*t[r++],this._result[3]=.01*t[r++],this._result[4]=t[r++],this._result[5]=t[r++],this._result[6]=t[r++],this._result[7]=t[r++])):(r=this.target.slotData.color,this._result[0]=r.alphaMultiplier,this._result[1]=r.redMultiplier,this._result[2]=r.greenMultiplier,this._result[3]=r.blueMultiplier,this._result[4]=r.alphaOffset,this._result[5]=r.redOffset,this._result[6]=r.greenOffset,this._result[7]=r.blueOffset)},T.prototype._onUpdateFrame=function(){b.prototype._onUpdateFrame.call(this),this._isTween&&(this._result[0]=.01*(this._current[0]+this._difference[0]*this._tweenProgress),this._result[1]=.01*(this._current[1]+this._difference[1]*this._tweenProgress),this._result[2]=.01*(this._current[2]+this._difference[2]*this._tweenProgress),this._result[3]=.01*(this._current[3]+this._difference[3]*this._tweenProgress),this._result[4]=this._current[4]+this._difference[4]*this._tweenProgress,this._result[5]=this._current[5]+this._difference[5]*this._tweenProgress,this._result[6]=this._current[6]+this._difference[6]*this._tweenProgress,this._result[7]=this._current[7]+this._difference[7]*this._tweenProgress)},T.prototype.fadeOut=function(){this._isTween=!1},T.prototype.update=function(t){var e,i;b.prototype.update.call(this,t),(this._isTween||this.dirty)&&(i=(e=this.target)._colorTransform,0!==this._animationState._fadeState||0!==this._animationState._subFadeState?i.alphaMultiplier===this._result[0]&&i.redMultiplier===this._result[1]&&i.greenMultiplier===this._result[2]&&i.blueMultiplier===this._result[3]&&i.alphaOffset===this._result[4]&&i.redOffset===this._result[5]&&i.greenOffset===this._result[6]&&i.blueOffset===this._result[7]||(t=Math.pow(this._animationState._fadeProgress,4),i.alphaMultiplier+=(this._result[0]-i.alphaMultiplier)*t,i.redMultiplier+=(this._result[1]-i.redMultiplier)*t,i.greenMultiplier+=(this._result[2]-i.greenMultiplier)*t,i.blueMultiplier+=(this._result[3]-i.blueMultiplier)*t,i.alphaOffset+=(this._result[4]-i.alphaOffset)*t,i.redOffset+=(this._result[5]-i.redOffset)*t,i.greenOffset+=(this._result[6]-i.greenOffset)*t,i.blueOffset+=(this._result[7]-i.blueOffset)*t,e._colorDirty=!0):this.dirty&&(this.dirty=!1,i.alphaMultiplier===this._result[0]&&i.redMultiplier===this._result[1]&&i.greenMultiplier===this._result[2]&&i.blueMultiplier===this._result[3]&&i.alphaOffset===this._result[4]&&i.redOffset===this._result[5]&&i.greenOffset===this._result[6]&&i.blueOffset===this._result[7]||(i.alphaMultiplier=this._result[0],i.redMultiplier=this._result[1],i.greenMultiplier=this._result[2],i.blueMultiplier=this._result[3],i.alphaOffset=this._result[4],i.redOffset=this._result[5],i.greenOffset=this._result[6],i.blueOffset=this._result[7],e._colorDirty=!0)))},T);function T(){var t=null!==b&&b.apply(this,arguments)||this;return t._current=[0,0,0,0,0,0,0,0],t._difference=[0,0,0,0,0,0,0,0],t._result=[0,0,0,0,0,0,0,0],t}d.SlotColorTimelineState=e;var x,e=(x=d.SingleValueTimelineState,__extends(w,x),w.toString=function(){return"[class dragonBones.SlotZIndexTimelineState]"},w.prototype._onArriveAtFrame=function(){var t;x.prototype._onArriveAtFrame.call(this),null===this._timelineData&&(t=this.target.target,this._result=t.slotData.zIndex)},w.prototype.init=function(t,e,i){x.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameIntOffset,this._valueArray=this._animationData.parent.parent.frameIntArray},w.prototype.blend=function(t){var e=this.target,i=e.target,r=e.blendWeight;1<e.dirty?i._zIndex+=this._result*r:i._zIndex=this._result*r,(t||this.dirty)&&(this.dirty=!1,this._armature._zIndexDirty=!0)},w);function w(){return null!==x&&x.apply(this,arguments)||this}d.SlotZIndexTimelineState=e;var S,e=(S=d.MutilpleValueTimelineState,__extends(C,S),C.toString=function(){return"[class dragonBones.DeformTimelineState]"},C.prototype._onClear=function(){S.prototype._onClear.call(this),this.displayFrame=null,this.geometryOffset=0,this._deformCount=0,this._deformOffset=0,this._sameValueOffset=0},C.prototype.init=function(t,e,i){if(S.prototype.init.call(this,t,e,i),null!==this._timelineData){var t=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3],e=this._animationData.parent.parent,i=e.frameIntArray,r=this.target.target;this.geometryOffset=i[t+0],this.geometryOffset<0&&(this.geometryOffset+=65536);for(var n=0,o=r.displayFrameCount;n<o;++n){var a=r.getDisplayFrameAt(n),s=a.getGeometryData();if(null!==s&&s.offset===this.geometryOffset){this.displayFrame=a,this.displayFrame.updateDeformVertices();break}}null!==this.displayFrame?(this._valueOffset=this._animationData.frameFloatOffset,this._valueCount=i[t+2],this._deformCount=i[t+1],this._deformOffset=i[t+3],this._sameValueOffset=i[t+4]+this._animationData.frameFloatOffset,this._valueScale=this._armature.armatureData.scale,this._valueArray=e.frameFloatArray,this._rd.length=2*this._valueCount):this.returnToPool()}else this._deformCount=this.displayFrame.deformVertices.length},C.prototype.blend=function(t){var e=this.target,i=e.target,r=e.blendWeight,n=this.displayFrame.deformVertices,o=this._valueArray;if(null!==o)for(var a=this._valueCount,s=this._deformOffset,h=this._sameValueOffset,l=this._rd,u=0;u<this._deformCount;++u){var c=0,c=u<s?o[h+u]:u<s+a?l[u-s]:o[h+u-a];1<e.dirty?n[u]+=c*r:n[u]=c*r}else if(1===e.dirty)for(u=0;u<this._deformCount;++u)n[u]=0;(t||this.dirty)&&(this.dirty=!1,i._geometryData===this.displayFrame.getGeometryData()&&(i._verticesDirty=!0))},C);function C(){return null!==S&&S.apply(this,arguments)||this}d.DeformTimelineState=e;var E,e=(E=d.DoubleValueTimelineState,__extends(P,E),P.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"},P.prototype._onUpdateFrame=function(){E.prototype._onUpdateFrame.call(this);var t,e=this.target;null!==this._timelineData?(e._bendPositive=0<this._currentA,e._weight=this._currentB):(t=e._constraintData,e._bendPositive=t.bendPositive,e._weight=t.weight),e.invalidUpdate(),this.dirty=!1},P.prototype.init=function(t,e,i){E.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=.01,this._valueArray=this._animationData.parent.parent.frameIntArray},P);function P(){return null!==E&&E.apply(this,arguments)||this}d.IKConstraintTimelineState=e;var D,e=(D=d.SingleValueTimelineState,__extends(O,D),O.toString=function(){return"[class dragonBones.AnimationProgressTimelineState]"},O.prototype._onUpdateFrame=function(){D.prototype._onUpdateFrame.call(this);var t=this.target;null!==t._parent&&(t.currentTime=this._result*t.totalTime),this.dirty=!1},O.prototype.init=function(t,e,i){D.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},O);function O(){return null!==D&&D.apply(this,arguments)||this}d.AnimationProgressTimelineState=e;var I,e=(I=d.SingleValueTimelineState,__extends($,I),$.toString=function(){return"[class dragonBones.AnimationWeightTimelineState]"},$.prototype._onUpdateFrame=function(){I.prototype._onUpdateFrame.call(this);var t=this.target;null!==t._parent&&(t.weight=this._result),this.dirty=!1},$.prototype.init=function(t,e,i){I.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},$);function $(){return null!==I&&I.apply(this,arguments)||this}d.AnimationWeightTimelineState=e;var A,e=(A=d.DoubleValueTimelineState,__extends(R,A),R.toString=function(){return"[class dragonBones.AnimationParametersTimelineState]"},R.prototype._onUpdateFrame=function(){A.prototype._onUpdateFrame.call(this);var t=this.target;null!==t._parent&&(t.parameterX=this._resultA,t.parameterY=this._resultB),this.dirty=!1},R.prototype.init=function(t,e,i){A.prototype.init.call(this,t,e,i),this._valueOffset=this._animationData.frameIntOffset,this._valueScale=1e-4,this._valueArray=this._animationData.parent.parent.frameIntArray},R);function R(){return null!==A&&A.apply(this,arguments)||this}d.AnimationParametersTimelineState=e}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.BaseObject,__extends(r,e),r.actionDataToInstance=function(t,e,i){0===t.type?e.type=r.FRAME_EVENT:e.type=10===t.type?r.FRAME_EVENT:r.SOUND_EVENT,e.name=t.name,e.armature=i,e.actionData=t,e.data=t.data,null!==t.bone&&(e.bone=i.getBone(t.bone.name)),null!==t.slot&&(e.slot=i.getSlot(t.slot.name))},r.toString=function(){return"[class dragonBones.EventObject]"},r.prototype._onClear=function(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null},r.START="start",r.LOOP_COMPLETE="loopComplete",r.COMPLETE="complete",r.FADE_IN="fadeIn",r.FADE_IN_COMPLETE="fadeInComplete",r.FADE_OUT="fadeOut",r.FADE_OUT_COMPLETE="fadeOutComplete",r.FRAME_EVENT="frameEvent",r.SOUND_EVENT="soundEvent",r);function r(){return null!==e&&e.apply(this,arguments)||this}t.EventObject=i}(dragonBones=dragonBones||{}),function(t){var e=(i._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},i._getBoneType=function(t){switch(t.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}},i._getPositionMode=function(t){switch(t.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}},i._getSpacingMode=function(t){switch(t.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}},i._getRotateMode=function(t){switch(t.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}},i._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}},i._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}},i._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},i._getAnimationBlendType=function(t){switch(t.toLowerCase()){case"none":return 0;case"1d":return 1;default:return 0}},i._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}},i.DATA_VERSION_2_3="2.3",i.DATA_VERSION_3_0="3.0",i.DATA_VERSION_4_0="4.0",i.DATA_VERSION_4_5="4.5",i.DATA_VERSION_5_0="5.0",i.DATA_VERSION_5_5="5.5",i.DATA_VERSION=i.DATA_VERSION_5_6="5.6",i.DATA_VERSIONS=[i.DATA_VERSION_4_0,i.DATA_VERSION_4_5,i.DATA_VERSION_5_0,i.DATA_VERSION_5_5,i.DATA_VERSION_5_6],i.TEXTURE_ATLAS="textureAtlas",i.SUB_TEXTURE="SubTexture",i.FORMAT="format",i.IMAGE_PATH="imagePath",i.WIDTH="width",i.HEIGHT="height",i.ROTATED="rotated",i.FRAME_X="frameX",i.FRAME_Y="frameY",i.FRAME_WIDTH="frameWidth",i.FRAME_HEIGHT="frameHeight",i.DRADON_BONES="dragonBones",i.USER_DATA="userData",i.ARMATURE="armature",i.CANVAS="canvas",i.BONE="bone",i.SURFACE="surface",i.SLOT="slot",i.CONSTRAINT="constraint",i.SKIN="skin",i.DISPLAY="display",i.FRAME="frame",i.IK="ik",i.PATH_CONSTRAINT="path",i.ANIMATION="animation",i.TIMELINE="timeline",i.FFD="ffd",i.TRANSLATE_FRAME="translateFrame",i.ROTATE_FRAME="rotateFrame",i.SCALE_FRAME="scaleFrame",i.DISPLAY_FRAME="displayFrame",i.COLOR_FRAME="colorFrame",i.DEFAULT_ACTIONS="defaultActions",i.ACTIONS="actions",i.EVENTS="events",i.INTS="ints",i.FLOATS="floats",i.STRINGS="strings",i.TRANSFORM="transform",i.PIVOT="pivot",i.AABB="aabb",i.COLOR="color",i.VERSION="version",i.COMPATIBLE_VERSION="compatibleVersion",i.FRAME_RATE="frameRate",i.TYPE="type",i.SUB_TYPE="subType",i.NAME="name",i.PARENT="parent",i.TARGET="target",i.STAGE="stage",i.SHARE="share",i.PATH="path",i.LENGTH="length",i.DISPLAY_INDEX="displayIndex",i.Z_ORDER="zOrder",i.Z_INDEX="zIndex",i.BLEND_MODE="blendMode",i.INHERIT_TRANSLATION="inheritTranslation",i.INHERIT_ROTATION="inheritRotation",i.INHERIT_SCALE="inheritScale",i.INHERIT_REFLECTION="inheritReflection",i.INHERIT_ANIMATION="inheritAnimation",i.INHERIT_DEFORM="inheritDeform",i.SEGMENT_X="segmentX",i.SEGMENT_Y="segmentY",i.BEND_POSITIVE="bendPositive",i.CHAIN="chain",i.WEIGHT="weight",i.BLEND_TYPE="blendType",i.FADE_IN_TIME="fadeInTime",i.PLAY_TIMES="playTimes",i.SCALE="scale",i.OFFSET="offset",i.POSITION="position",i.DURATION="duration",i.TWEEN_EASING="tweenEasing",i.TWEEN_ROTATE="tweenRotate",i.TWEEN_SCALE="tweenScale",i.CLOCK_WISE="clockwise",i.CURVE="curve",i.SOUND="sound",i.EVENT="event",i.ACTION="action",i.X="x",i.Y="y",i.SKEW_X="skX",i.SKEW_Y="skY",i.SCALE_X="scX",i.SCALE_Y="scY",i.VALUE="value",i.ROTATE="rotate",i.SKEW="skew",i.ALPHA="alpha",i.ALPHA_OFFSET="aO",i.RED_OFFSET="rO",i.GREEN_OFFSET="gO",i.BLUE_OFFSET="bO",i.ALPHA_MULTIPLIER="aM",i.RED_MULTIPLIER="rM",i.GREEN_MULTIPLIER="gM",i.BLUE_MULTIPLIER="bM",i.UVS="uvs",i.VERTICES="vertices",i.TRIANGLES="triangles",i.WEIGHTS="weights",i.SLOT_POSE="slotPose",i.BONE_POSE="bonePose",i.BONES="bones",i.POSITION_MODE="positionMode",i.SPACING_MODE="spacingMode",i.ROTATE_MODE="rotateMode",i.SPACING="spacing",i.ROTATE_OFFSET="rotateOffset",i.ROTATE_MIX="rotateMix",i.TRANSLATE_MIX="translateMix",i.TARGET_DISPLAY="targetDisplay",i.CLOSED="closed",i.CONSTANT_SPEED="constantSpeed",i.VERTEX_COUNT="vertexCount",i.LENGTHS="lengths",i.GOTO_AND_PLAY="gotoAndPlay",i.DEFAULT_NAME="default",i);function i(){}t.DataParser=e}(dragonBones=dragonBones||{}),function(j){var e,t=(e=j.DataParser,__extends(N,e),N._getBoolean=function(t,e,i){if(e in t){t=t[e],e=typeof t;if("boolean"==e)return t;if("string"!=e)return!!t;switch(t){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},N._getNumber=function(t,e,i){if(e in t){e=t[e];return null===e||"NaN"===e?i:+e||0}return i},N._getString=function(t,e,i){if(e in t){e=t[e];return"string"==typeof e?e:String(e)}return i},N.prototype._getCurvePoint=function(t,e,i,r,n,o,a,s,h,l){var u=1-h,c=u*u,p=h*h,d=u*c,c=3*h*c,u=3*u*p,p=h*p;l.x=d*t+c*i+u*n+p*a,l.y=d*e+c*r+u*o+p*s},N.prototype._samplingEasingCurve=function(t,e){var i=t.length;if(i%3==1){for(var r=-2,n=0,o=e.length;n<o;++n){for(var a=(n+1)/(o+1);(r+6<i?t[r+6]:1)<a;)r+=6;for(var s=0<=r&&r+6<i,h=s?t[r]:0,l=s?t[r+1]:0,u=t[r+2],c=t[r+3],p=t[r+4],d=t[r+5],f=s?t[r+6]:1,_=s?t[r+7]:1,g=0,y=1;1e-4<y-g;){var m=.5*(y+g);this._getCurvePoint(h,l,u,c,p,d,f,_,m,this._helpPoint),0<a-this._helpPoint.x?g=m:y=m}e[n]=this._helpPoint.y}return!0}for(r=0,n=0,o=e.length;n<o;++n){for(a=(n+1)/(o+1);t[r+6]<a;)r+=6;for(h=t[r],l=t[r+1],u=t[r+2],c=t[r+3],p=t[r+4],d=t[r+5],f=t[r+6],_=t[r+7],g=0,y=1;1e-4<y-g;){m=.5*(y+g);this._getCurvePoint(h,l,u,c,p,d,f,_,m,this._helpPoint),0<a-this._helpPoint.x?g=m:y=m}e[n]=this._helpPoint.y}return!1},N.prototype._parseActionDataInFrame=function(t,e,i,r){j.DataParser.EVENT in t&&this._mergeActionFrame(t[j.DataParser.EVENT],e,10,i,r),j.DataParser.SOUND in t&&this._mergeActionFrame(t[j.DataParser.SOUND],e,11,i,r),j.DataParser.ACTION in t&&this._mergeActionFrame(t[j.DataParser.ACTION],e,0,i,r),j.DataParser.EVENTS in t&&this._mergeActionFrame(t[j.DataParser.EVENTS],e,10,i,r),j.DataParser.ACTIONS in t&&this._mergeActionFrame(t[j.DataParser.ACTIONS],e,0,i,r)},N.prototype._mergeActionFrame=function(t,e,i,r,n){for(var o=this._armature.actions.length,a=this._parseActionData(t,i,r,n),s=0,h=null,l=0,u=a;l<u.length;l++){var c=u[l];this._armature.addAction(c,!1)}0===this._actionFrames.length&&((h=new b).frameStart=0,this._actionFrames.push(h),h=null);for(var p=0,d=this._actionFrames;p<d.length;p++){var f=d[p];if(f.frameStart===e){h=f;break}if(f.frameStart>e)break;s++}null===h&&((h=new b).frameStart=e,this._actionFrames.splice(s,0,h));for(var _=0;_<a.length;++_)h.actions.push(o+_)},N.prototype._parseArmature=function(t,e){var i,r=j.BaseObject.borrowObject(j.ArmatureData);if(r.name=N._getString(t,j.DataParser.NAME,""),r.frameRate=N._getNumber(t,j.DataParser.FRAME_RATE,this._data.frameRate),r.scale=e,j.DataParser.TYPE in t&&"string"==typeof t[j.DataParser.TYPE]?r.type=j.DataParser._getArmatureType(t[j.DataParser.TYPE]):r.type=N._getNumber(t,j.DataParser.TYPE,0),0===r.frameRate&&(r.frameRate=24),this._armature=r,j.DataParser.CANVAS in t&&(e=t[j.DataParser.CANVAS],i=j.BaseObject.borrowObject(j.CanvasData),j.DataParser.COLOR in e?i.hasBackground=!0:i.hasBackground=!1,i.color=N._getNumber(e,j.DataParser.COLOR,0),i.x=N._getNumber(e,j.DataParser.X,0)*r.scale,i.y=N._getNumber(e,j.DataParser.Y,0)*r.scale,i.width=N._getNumber(e,j.DataParser.WIDTH,0)*r.scale,i.height=N._getNumber(e,j.DataParser.HEIGHT,0)*r.scale,r.canvas=i),j.DataParser.AABB in t&&(i=t[j.DataParser.AABB],r.aabb.x=N._getNumber(i,j.DataParser.X,0)*r.scale,r.aabb.y=N._getNumber(i,j.DataParser.Y,0)*r.scale,r.aabb.width=N._getNumber(i,j.DataParser.WIDTH,0)*r.scale,r.aabb.height=N._getNumber(i,j.DataParser.HEIGHT,0)*r.scale),j.DataParser.BONE in t)for(var n=0,o=t[j.DataParser.BONE];n<o.length;n++){var a=o[n],s=N._getString(a,j.DataParser.PARENT,""),h=this._parseBone(a);if(0<s.length&&(null!==(a=r.getBone(s))?h.parent=a:(s in this._cacheBones||(this._cacheBones[s]=[]),this._cacheBones[s].push(h))),h.name in this._cacheBones){for(var l=0,u=this._cacheBones[h.name];l<u.length;l++)u[l].parent=h;delete this._cacheBones[h.name]}r.addBone(h),this._rawBones.push(h)}if(j.DataParser.IK in t)for(var c=0,p=t[j.DataParser.IK];c<p.length;c++){var d=p[c];(w=this._parseIKConstraint(d))&&r.addConstraint(w)}if(r.sortBones(),j.DataParser.SLOT in t)for(var f=0,_=0,g=t[j.DataParser.SLOT];_<g.length;_++){var y=g[_];r.addSlot(this._parseSlot(y,f++))}if(j.DataParser.SKIN in t)for(var m=0,v=t[j.DataParser.SKIN];m<v.length;m++){var b=v[m];r.addSkin(this._parseSkin(b))}if(j.DataParser.PATH_CONSTRAINT in t)for(var T=0,x=t[j.DataParser.PATH_CONSTRAINT];T<x.length;T++){var w,S=x[T];(w=this._parsePathConstraint(S))&&r.addConstraint(w)}for(var C,E=0,P=this._cacheRawMeshes.length;E<P;++E){var D=this._cacheRawMeshes[E],O=N._getString(D,j.DataParser.SHARE,"");0!==O.length&&(0===(D=N._getString(D,j.DataParser.SKIN,j.DataParser.DEFAULT_NAME)).length&&(D=j.DataParser.DEFAULT_NAME),null!==(O=r.getMesh(D,"",O))&&this._cacheMeshes[E].geometry.shareFrom(O.geometry))}if(j.DataParser.ANIMATION in t)for(var I=0,$=t[j.DataParser.ANIMATION];I<$.length;I++){var A=$[I],R=this._parseAnimation(A);r.addAnimation(R)}if(j.DataParser.DEFAULT_ACTIONS in t)for(var B=0,M=this._parseActionData(t[j.DataParser.DEFAULT_ACTIONS],0,null,null);B<M.length;B++){var L=M[B];r.addAction(L,!0),0===L.type&&null!==(R=r.getAnimation(L.name))&&(r.defaultAnimation=R)}if(j.DataParser.ACTIONS in t)for(var F=0,k=this._parseActionData(t[j.DataParser.ACTIONS],0,null,null);F<k.length;F++){L=k[F];r.addAction(L,!1)}for(C in this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null,this._weightSlotPose)delete this._weightSlotPose[C];for(C in this._weightBonePoses)delete this._weightBonePoses[C];for(C in this._cacheBones)delete this._cacheBones[C];for(C in this._slotChildActions)delete this._slotChildActions[C];return r},N.prototype._parseBone=function(t){if(0===(j.DataParser.TYPE in t&&"string"==typeof t[j.DataParser.TYPE]?j.DataParser._getBoneType(t[j.DataParser.TYPE]):N._getNumber(t,j.DataParser.TYPE,0))){var e=this._armature.scale,i=j.BaseObject.borrowObject(j.BoneData);return i.inheritTranslation=N._getBoolean(t,j.DataParser.INHERIT_TRANSLATION,!0),i.inheritRotation=N._getBoolean(t,j.DataParser.INHERIT_ROTATION,!0),i.inheritScale=N._getBoolean(t,j.DataParser.INHERIT_SCALE,!0),i.inheritReflection=N._getBoolean(t,j.DataParser.INHERIT_REFLECTION,!0),i.length=N._getNumber(t,j.DataParser.LENGTH,0)*e,i.alpha=N._getNumber(t,j.DataParser.ALPHA,1),i.name=N._getString(t,j.DataParser.NAME,""),j.DataParser.TRANSFORM in t&&this._parseTransform(t[j.DataParser.TRANSFORM],i.transform,e),i}i=j.BaseObject.borrowObject(j.SurfaceData);return i.alpha=N._getNumber(t,j.DataParser.ALPHA,1),i.name=N._getString(t,j.DataParser.NAME,""),i.segmentX=N._getNumber(t,j.DataParser.SEGMENT_X,0),i.segmentY=N._getNumber(t,j.DataParser.SEGMENT_Y,0),this._parseGeometry(t,i.geometry),i},N.prototype._parseIKConstraint=function(t){var e=this._armature.getBone(N._getString(t,j.DataParser.BONE,""));if(null===e)return null;var i=this._armature.getBone(N._getString(t,j.DataParser.TARGET,""));if(null===i)return null;var r=N._getNumber(t,j.DataParser.CHAIN,0),n=j.BaseObject.borrowObject(j.IKConstraintData);return n.scaleEnabled=N._getBoolean(t,j.DataParser.SCALE,!1),n.bendPositive=N._getBoolean(t,j.DataParser.BEND_POSITIVE,!0),n.weight=N._getNumber(t,j.DataParser.WEIGHT,1),n.name=N._getString(t,j.DataParser.NAME,""),n.type=0,n.target=i,0<r&&null!==e.parent?(n.root=e.parent,n.bone=e):(n.root=e,n.bone=null),n},N.prototype._parsePathConstraint=function(t){var e=this._armature.getSlot(N._getString(t,j.DataParser.TARGET,""));if(null===e)return null;var i=this._armature.defaultSkin;if(null===i)return null;var r=i.getDisplay(e.name,N._getString(t,j.DataParser.TARGET_DISPLAY,e.name));if(null===r||!(r instanceof j.PathDisplayData))return null;i=t[j.DataParser.BONES];if(null===i||0===i.length)return null;var n=j.BaseObject.borrowObject(j.PathConstraintData);n.name=N._getString(t,j.DataParser.NAME,""),n.type=1,n.pathSlot=e,n.pathDisplayData=r,n.target=e.parent,n.positionMode=j.DataParser._getPositionMode(N._getString(t,j.DataParser.POSITION_MODE,"")),n.spacingMode=j.DataParser._getSpacingMode(N._getString(t,j.DataParser.SPACING_MODE,"")),n.rotateMode=j.DataParser._getRotateMode(N._getString(t,j.DataParser.ROTATE_MODE,"")),n.position=N._getNumber(t,j.DataParser.POSITION,0),n.spacing=N._getNumber(t,j.DataParser.SPACING,0),n.rotateOffset=N._getNumber(t,j.DataParser.ROTATE_OFFSET,0),n.rotateMix=N._getNumber(t,j.DataParser.ROTATE_MIX,1),n.translateMix=N._getNumber(t,j.DataParser.TRANSLATE_MIX,1);for(var o=0,a=i;o<a.length;o++){var s=a[o],s=this._armature.getBone(s);null!==s&&(n.AddBone(s),null===n.root&&(n.root=s))}return n},N.prototype._parseSlot=function(t,e){var i=j.BaseObject.borrowObject(j.SlotData);return i.displayIndex=N._getNumber(t,j.DataParser.DISPLAY_INDEX,0),i.zOrder=e,i.zIndex=N._getNumber(t,j.DataParser.Z_INDEX,0),i.alpha=N._getNumber(t,j.DataParser.ALPHA,1),i.name=N._getString(t,j.DataParser.NAME,""),i.parent=this._armature.getBone(N._getString(t,j.DataParser.PARENT,"")),j.DataParser.BLEND_MODE in t&&"string"==typeof t[j.DataParser.BLEND_MODE]?i.blendMode=j.DataParser._getBlendMode(t[j.DataParser.BLEND_MODE]):i.blendMode=N._getNumber(t,j.DataParser.BLEND_MODE,0),j.DataParser.COLOR in t?(i.color=j.SlotData.createColor(),this._parseColorTransform(t[j.DataParser.COLOR],i.color)):i.color=j.SlotData.DEFAULT_COLOR,j.DataParser.ACTIONS in t&&(this._slotChildActions[i.name]=this._parseActionData(t[j.DataParser.ACTIONS],0,null,null)),i},N.prototype._parseSkin=function(t){var e=j.BaseObject.borrowObject(j.SkinData);if(e.name=N._getString(t,j.DataParser.NAME,j.DataParser.DEFAULT_NAME),0===e.name.length&&(e.name=j.DataParser.DEFAULT_NAME),j.DataParser.SLOT in t){t=t[j.DataParser.SLOT];this._skin=e;for(var i=0,r=t;i<r.length;i++){var n=r[i],o=N._getString(n,j.DataParser.NAME,""),a=this._armature.getSlot(o);if(null!==a){if(this._slot=a,j.DataParser.DISPLAY in n)for(var s=0,h=n[j.DataParser.DISPLAY];s<h.length;s++){var l=h[s];l?e.addDisplay(o,this._parseDisplay(l)):e.addDisplay(o,null)}this._slot=null}}this._skin=null}return e},N.prototype._parseDisplay=function(t){var e=N._getString(t,j.DataParser.NAME,""),i=N._getString(t,j.DataParser.PATH,""),r=0,n=null;switch(r=j.DataParser.TYPE in t&&"string"==typeof t[j.DataParser.TYPE]?j.DataParser._getDisplayType(t[j.DataParser.TYPE]):N._getNumber(t,j.DataParser.TYPE,r)){case 0:var o=n=j.BaseObject.borrowObject(j.ImageDisplayData);o.name=e,o.path=0<i.length?i:e,this._parsePivot(t,o);break;case 1:var a=n=j.BaseObject.borrowObject(j.ArmatureDisplayData);if(a.name=e,a.path=0<i.length?i:e,a.inheritAnimation=!0,j.DataParser.ACTIONS in t)for(var s=0,h=this._parseActionData(t[j.DataParser.ACTIONS],0,null,null);s<h.length;s++){var l=h[s];a.addAction(l)}else if(this._slot.name in this._slotChildActions){var u=this._skin.getDisplays(this._slot.name);if(null===u?0===this._slot.displayIndex:this._slot.displayIndex===u.length){for(var c=0,p=this._slotChildActions[this._slot.name];c<p.length;c++){l=p[c];a.addAction(l)}delete this._slotChildActions[this._slot.name]}}break;case 2:var d=n=j.BaseObject.borrowObject(j.MeshDisplayData);d.geometry.inheritDeform=N._getBoolean(t,j.DataParser.INHERIT_DEFORM,!0),d.name=e,d.path=0<i.length?i:e,j.DataParser.SHARE in t?(d.geometry.data=this._data,this._cacheRawMeshes.push(t),this._cacheMeshes.push(d)):this._parseMesh(t,d);break;case 3:u=this._parseBoundingBox(t);null!==u&&((d=n=j.BaseObject.borrowObject(j.BoundingBoxDisplayData)).name=e,d.path=0<i.length?i:e,d.boundingBox=u);break;case 4:var f=t[j.DataParser.LENGTHS],_=n=j.BaseObject.borrowObject(j.PathDisplayData);_.closed=N._getBoolean(t,j.DataParser.CLOSED,!1),_.constantSpeed=N._getBoolean(t,j.DataParser.CONSTANT_SPEED,!1),_.name=e,_.path=0<i.length?i:e,_.curveLengths.length=f.length;for(var g=0,y=f.length;g<y;++g)_.curveLengths[g]=f[g];this._parsePath(t,_)}return null!==n&&j.DataParser.TRANSFORM in t&&this._parseTransform(t[j.DataParser.TRANSFORM],n.transform,this._armature.scale),n},N.prototype._parsePath=function(t,e){this._parseGeometry(t,e.geometry)},N.prototype._parsePivot=function(t,e){j.DataParser.PIVOT in t?(t=t[j.DataParser.PIVOT],e.pivot.x=N._getNumber(t,j.DataParser.X,0),e.pivot.y=N._getNumber(t,j.DataParser.Y,0)):(e.pivot.x=.5,e.pivot.y=.5)},N.prototype._parseMesh=function(t,e){var i;this._parseGeometry(t,e.geometry),j.DataParser.WEIGHTS in t&&(i=t[j.DataParser.SLOT_POSE],t=t[j.DataParser.BONE_POSE],e=this._skin.name+"_"+this._slot.name+"_"+e.name,this._weightSlotPose[e]=i,this._weightBonePoses[e]=t)},N.prototype._parseBoundingBox=function(t){var e=null,i=0;switch(i=j.DataParser.SUB_TYPE in t&&"string"==typeof t[j.DataParser.SUB_TYPE]?j.DataParser._getBoundingBoxType(t[j.DataParser.SUB_TYPE]):N._getNumber(t,j.DataParser.SUB_TYPE,i)){case 0:e=j.BaseObject.borrowObject(j.RectangleBoundingBoxData);break;case 1:e=j.BaseObject.borrowObject(j.EllipseBoundingBoxData);break;case 2:e=this._parsePolygonBoundingBox(t)}return null!==e&&(e.color=N._getNumber(t,j.DataParser.COLOR,0),0!==e.type&&1!==e.type||(e.width=N._getNumber(t,j.DataParser.WIDTH,0),e.height=N._getNumber(t,j.DataParser.HEIGHT,0))),e},N.prototype._parsePolygonBoundingBox=function(t){var e=j.BaseObject.borrowObject(j.PolygonBoundingBoxData);if(j.DataParser.VERTICES in t){var i=this._armature.scale,r=t[j.DataParser.VERTICES],n=e.vertices;n.length=r.length;for(var o=0,a=r.length;o<a;o+=2){var s=r[o]*i,h=r[o+1]*i;n[o]=s,n[o+1]=h,0===o?(e.x=s,e.y=h,e.width=s,e.height=h):(s<e.x?e.x=s:s>e.width&&(e.width=s),h<e.y?e.y=h:h>e.height&&(e.height=h))}e.width-=e.x,e.height-=e.y}else console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.");return e},N.prototype._parseAnimation=function(t){var e=j.BaseObject.borrowObject(j.AnimationData);if(e.blendType=j.DataParser._getAnimationBlendType(N._getString(t,j.DataParser.BLEND_TYPE,"")),e.frameCount=N._getNumber(t,j.DataParser.DURATION,0),e.playTimes=N._getNumber(t,j.DataParser.PLAY_TIMES,1),e.duration=e.frameCount/this._armature.frameRate,e.fadeInTime=N._getNumber(t,j.DataParser.FADE_IN_TIME,0),e.scale=N._getNumber(t,j.DataParser.SCALE,1),e.name=N._getString(t,j.DataParser.NAME,j.DataParser.DEFAULT_NAME),0===e.name.length&&(e.name=j.DataParser.DEFAULT_NAME),e.frameIntOffset=this._frameIntArray.length,e.frameFloatOffset=this._frameFloatArray.length,e.frameOffset=this._frameArray.length,this._animation=e,j.DataParser.FRAME in t){var i=t[j.DataParser.FRAME],r=i.length;if(0<r)for(var n=0,o=0;n<r;++n){var a=i[n];this._parseActionDataInFrame(a,o,null,null),o+=N._getNumber(a,j.DataParser.DURATION,1)}}if(j.DataParser.Z_ORDER in t&&(this._animation.zOrderTimeline=this._parseTimeline(t[j.DataParser.Z_ORDER],null,j.DataParser.FRAME,1,0,0,this._parseZOrderFrame)),j.DataParser.BONE in t)for(var s=0,h=t[j.DataParser.BONE];s<h.length;s++){var l=h[s];this._parseBoneTimeline(l)}if(j.DataParser.SLOT in t)for(var u=0,c=t[j.DataParser.SLOT];u<c.length;u++){l=c[u];this._parseSlotTimeline(l)}if(j.DataParser.FFD in t)for(var p=0,d=t[j.DataParser.FFD];p<d.length;p++){var l=d[p],f=N._getString(l,j.DataParser.SKIN,j.DataParser.DEFAULT_NAME),_=N._getString(l,j.DataParser.SLOT,""),g=N._getString(l,j.DataParser.NAME,"");0===f.length&&(f=j.DataParser.DEFAULT_NAME),this._slot=this._armature.getSlot(_),this._mesh=this._armature.getMesh(f,_,g),null!==this._slot&&null!==this._mesh&&(null!==(S=this._parseTimeline(l,null,j.DataParser.FRAME,22,2,0,this._parseSlotDeformFrame))&&this._animation.addSlotTimeline(_,S),this._slot=null,this._mesh=null)}if(j.DataParser.IK in t)for(var y=0,m=t[j.DataParser.IK];y<m.length;y++){var l=m[y],v=N._getString(l,j.DataParser.NAME,"");null!==this._armature.getConstraint(v)&&null!==(S=this._parseTimeline(l,null,j.DataParser.FRAME,30,1,2,this._parseIKConstraintFrame))&&this._animation.addConstraintTimeline(v,S)}if(0<this._actionFrames.length&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,0,0,this._parseActionFrame),this._actionFrames.length=0),j.DataParser.TIMELINE in t)for(var b=0,T=t[j.DataParser.TIMELINE];b<T.length;b++){var l=T[b],x=N._getNumber(l,j.DataParser.TYPE,0),w=N._getString(l,j.DataParser.NAME,""),S=null;switch(x){case 0:break;case 20:case 23:case 60:case 24:case 40:case 41:20===x?(this._frameValueType=0,this._frameValueScale=1):(this._frameValueType=1,this._frameValueScale=23===x?1:40===x||41===x?1e4:100),this._frameDefaultValue=60===x||24===x||41===x?1:0,40===x&&0!==e.blendType&&((C=S=j.BaseObject.borrowObject(j.AnimationTimelineData)).x=N._getNumber(l,j.DataParser.X,0),C.y=N._getNumber(l,j.DataParser.Y,0)),S=this._parseTimeline(l,null,j.DataParser.FRAME,x,this._frameValueType,1,this._parseSingleValueFrame,S);break;case 11:case 12:case 13:case 30:case 42:30===x||42===x?(this._frameValueType=1,this._frameValueScale=42===x?1e4:100):(this._frameValueScale=12===x?j.Transform.DEG_RAD:1,this._frameValueType=2),this._frameDefaultValue=13===x||30===x?1:0,S=this._parseTimeline(l,null,j.DataParser.FRAME,x,this._frameValueType,2,this._parseDoubleValueFrame);break;case 1:break;case 50:var C=this._armature.getBone(w);if(null===C)continue;this._geometry=C.geometry,S=this._parseTimeline(l,null,j.DataParser.FRAME,x,2,0,this._parseDeformFrame),this._geometry=null;break;case 22:for(var f in this._geometry=null,this._armature.skins){var E,P=this._armature.skins[f];for(E in P.displays)for(var D=0,O=P.displays[E];D<O.length;D++){var I=O[D];if(null!==I&&I.name===w){this._geometry=I.geometry;break}}}if(null===this._geometry)continue;S=this._parseTimeline(l,null,j.DataParser.FRAME,x,2,0,this._parseDeformFrame),this._geometry=null;break;case 21:S=this._parseTimeline(l,null,j.DataParser.FRAME,x,1,1,this._parseSlotColorFrame)}if(null!==S)switch(x){case 0:case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(w,S);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(w,S);break;case 30:this._animation.addConstraintTimeline(w,S);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(w,S)}}return this._animation=null,e},N.prototype._parseTimeline=function(t,e,i,r,n,o,a,s){if(void 0===s&&(s=null),null===(e=null!==t&&0<i.length&&i in t?t[i]:e))return null;var h=e.length;if(0===h)return null;var l=this._frameIntArray.length,u=this._frameFloatArray.length,c=this._timelineArray.length;switch((s=null===s?j.BaseObject.borrowObject(j.TimelineData):s).type=r,s.offset=c,this._frameValueType=n,this._timeline=s,this._timelineArray.length+=5+h,null!==t?(this._timelineArray[c+0]=Math.round(100*N._getNumber(t,j.DataParser.SCALE,1)),this._timelineArray[c+1]=Math.round(100*N._getNumber(t,j.DataParser.OFFSET,0))):(this._timelineArray[c+0]=100,this._timelineArray[c+1]=0),this._timelineArray[c+2]=h,this._timelineArray[c+3]=o,this._frameValueType){case 0:this._timelineArray[c+4]=0;break;case 1:this._timelineArray[c+4]=l-this._animation.frameIntOffset;break;case 2:this._timelineArray[c+4]=u-this._animation.frameFloatOffset}if(1===h)s.frameIndicesOffset=-1,this._timelineArray[c+5+0]=a.call(this,e[0],0,0)-this._animation.frameOffset;else{var p=this._animation.frameCount+1,d=this._data.frameIndices,f=d.length;d.length+=p,s.frameIndicesOffset=f;for(var _,g=0,y=0,m=0,v=0;g<p;++g)m+v<=g&&y<h&&(_=e[y],m=g,v=y===h-1?this._animation.frameCount-m:_ instanceof b?this._actionFrames[y+1].frameStart-m:N._getNumber(_,j.DataParser.DURATION,1),this._timelineArray[c+5+y]=a.call(this,_,m,v)-this._animation.frameOffset,y++),d[f+g]=y-1}return this._timeline=null,s},N.prototype._parseBoneTimeline=function(t){var e,i=this._armature.getBone(N._getString(t,j.DataParser.NAME,""));null!==i&&(this._bone=i,this._slot=this._armature.getSlot(this._bone.name),j.DataParser.TRANSLATE_FRAME in t&&(this._frameDefaultValue=0,this._frameValueScale=1,null!==(e=this._parseTimeline(t,null,j.DataParser.TRANSLATE_FRAME,11,2,2,this._parseDoubleValueFrame))&&this._animation.addBoneTimeline(i.name,e)),j.DataParser.ROTATE_FRAME in t&&(this._frameDefaultValue=0,this._frameValueScale=1,null!==(e=this._parseTimeline(t,null,j.DataParser.ROTATE_FRAME,12,2,2,this._parseBoneRotateFrame))&&this._animation.addBoneTimeline(i.name,e)),j.DataParser.SCALE_FRAME in t&&(this._frameDefaultValue=1,this._frameValueScale=1,null!==(e=this._parseTimeline(t,null,j.DataParser.SCALE_FRAME,13,2,2,this._parseBoneScaleFrame))&&this._animation.addBoneTimeline(i.name,e)),j.DataParser.FRAME in t&&null!==(e=this._parseTimeline(t,null,j.DataParser.FRAME,10,2,6,this._parseBoneAllFrame))&&this._animation.addBoneTimeline(i.name,e),this._bone=null,this._slot=null)},N.prototype._parseSlotTimeline=function(t){var e,i,r=this._armature.getSlot(N._getString(t,j.DataParser.NAME,""));null!==r&&(i=e=null,this._slot=r,e=j.DataParser.DISPLAY_FRAME in t?this._parseTimeline(t,null,j.DataParser.DISPLAY_FRAME,20,0,0,this._parseSlotDisplayFrame):this._parseTimeline(t,null,j.DataParser.FRAME,20,0,0,this._parseSlotDisplayFrame),i=j.DataParser.COLOR_FRAME in t?this._parseTimeline(t,null,j.DataParser.COLOR_FRAME,21,1,1,this._parseSlotColorFrame):this._parseTimeline(t,null,j.DataParser.FRAME,21,1,1,this._parseSlotColorFrame),null!==e&&this._animation.addSlotTimeline(r.name,e),null!==i&&this._animation.addSlotTimeline(r.name,i),this._slot=null)},N.prototype._parseFrame=function(t,e,i){var r=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[r+0]=e,r},N.prototype._parseTweenFrame=function(t,e,i){var r=this._parseFrame(t,e,i);if(0<i)if(j.DataParser.CURVE in t){var n=i+1;this._helpArray.length=n;var o=this._samplingEasingCurve(t[j.DataParser.CURVE],this._helpArray);this._frameArray.length+=2+this._helpArray.length,this._frameArray[r+1]=2,this._frameArray[r+2]=o?n:-n;for(var a=0;a<n;++a)this._frameArray[r+3+a]=Math.round(1e4*this._helpArray[a])}else{o=-2;-2===(o=j.DataParser.TWEEN_EASING in t?N._getNumber(t,j.DataParser.TWEEN_EASING,-2):o)?(this._frameArray.length+=1,this._frameArray[r+1]=0):0===o?(this._frameArray.length+=1,this._frameArray[r+1]=1):o<0?(this._frameArray.length+=2,this._frameArray[r+1]=3,this._frameArray[r+2]=Math.round(100*-o)):o<=1?(this._frameArray.length+=2,this._frameArray[r+1]=4,this._frameArray[r+2]=Math.round(100*o)):(this._frameArray.length+=2,this._frameArray[r+1]=5,this._frameArray[r+2]=Math.round(100*o-100))}else this._frameArray.length+=1,this._frameArray[r+1]=0;return r},N.prototype._parseSingleValueFrame=function(t,e,i){var r=0;switch(this._frameValueType){case 0:r=this._parseFrame(t,e,i),this._frameArray.length+=1,this._frameArray[r+1]=N._getNumber(t,j.DataParser.VALUE,this._frameDefaultValue);break;case 1:var r=this._parseTweenFrame(t,e,i),n=this._frameIntArray.length;this._frameIntArray.length+=1,this._frameIntArray[n]=Math.round(N._getNumber(t,j.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale);break;case 2:r=this._parseTweenFrame(t,e,i);n=this._frameFloatArray.length;this._frameFloatArray.length+=1,this._frameFloatArray[n]=N._getNumber(t,j.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale}return r},N.prototype._parseDoubleValueFrame=function(t,e,i){var r=0;switch(this._frameValueType){case 0:r=this._parseFrame(t,e,i),this._frameArray.length+=2,this._frameArray[r+1]=N._getNumber(t,j.DataParser.X,this._frameDefaultValue),this._frameArray[r+2]=N._getNumber(t,j.DataParser.Y,this._frameDefaultValue);break;case 1:var r=this._parseTweenFrame(t,e,i),n=this._frameIntArray.length;this._frameIntArray.length+=2,this._frameIntArray[n]=Math.round(N._getNumber(t,j.DataParser.X,this._frameDefaultValue)*this._frameValueScale),this._frameIntArray[n+1]=Math.round(N._getNumber(t,j.DataParser.Y,this._frameDefaultValue)*this._frameValueScale);break;case 2:r=this._parseTweenFrame(t,e,i);n=this._frameFloatArray.length;this._frameFloatArray.length+=2,this._frameFloatArray[n]=N._getNumber(t,j.DataParser.X,this._frameDefaultValue)*this._frameValueScale,this._frameFloatArray[n+1]=N._getNumber(t,j.DataParser.Y,this._frameDefaultValue)*this._frameValueScale}return r},N.prototype._parseActionFrame=function(t,e,i){var r=this._frameArray.length,n=t.actions.length;this._frameArray.length+=2+n,this._frameArray[r+0]=e,this._frameArray[r+0+1]=n;for(var o=0;o<n;++o)this._frameArray[r+0+2+o]=t.actions[o];return r},N.prototype._parseZOrderFrame=function(t,e,i){var r=this._parseFrame(t,e,i);if(j.DataParser.Z_ORDER in t){var n=t[j.DataParser.Z_ORDER];if(0<n.length){for(var o=this._armature.sortedSlots.length,a=new Array(o-n.length/2),s=new Array(o),h=0;h<a.length;++h)a[h]=0;for(var l=0;l<o;++l)s[l]=-1;for(var u=0,c=0,p=0,d=n.length;p<d;p+=2){for(var f=n[p],_=n[p+1];u!==f;)a[c++]=u++;s[u+_]=u++}for(;u<o;)a[c++]=u++;this._frameArray.length+=1+o;for(var g=this._frameArray[r+1]=o;g--;)-1===s[g]?this._frameArray[r+2+g]=a[--c]||0:this._frameArray[r+2+g]=s[g]||0;return r}}return this._frameArray.length+=1,this._frameArray[r+1]=0,r},N.prototype._parseBoneAllFrame=function(t,e,i){this._helpTransform.identity(),j.DataParser.TRANSFORM in t&&this._parseTransform(t[j.DataParser.TRANSFORM],this._helpTransform,1);var r=this._helpTransform.rotation;0!==e&&(r=0===this._prevClockwise?this._prevRotation+j.Transform.normalizeRadian(r-this._prevRotation):((0<this._prevClockwise?r>=this._prevRotation:r<=this._prevRotation)&&(this._prevClockwise=0<this._prevClockwise?this._prevClockwise-1:this._prevClockwise+1),this._prevRotation+r-this._prevRotation+j.Transform.PI_D*this._prevClockwise)),this._prevClockwise=N._getNumber(t,j.DataParser.TWEEN_ROTATE,0),this._prevRotation=r;var n=this._parseTweenFrame(t,e,i),i=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[i++]=this._helpTransform.x,this._frameFloatArray[i++]=this._helpTransform.y,this._frameFloatArray[i++]=r,this._frameFloatArray[i++]=this._helpTransform.skew,this._frameFloatArray[i++]=this._helpTransform.scaleX,this._frameFloatArray[i++]=this._helpTransform.scaleY,this._parseActionDataInFrame(t,e,this._bone,this._slot),n},N.prototype._parseBoneTranslateFrame=function(t,e,i){e=this._parseTweenFrame(t,e,i),i=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[i++]=N._getNumber(t,j.DataParser.X,0),this._frameFloatArray[i++]=N._getNumber(t,j.DataParser.Y,0),e},N.prototype._parseBoneRotateFrame=function(t,e,i){var r=N._getNumber(t,j.DataParser.ROTATE,0)*j.Transform.DEG_RAD;0!==e&&(r=0===this._prevClockwise?this._prevRotation+j.Transform.normalizeRadian(r-this._prevRotation):((0<this._prevClockwise?r>=this._prevRotation:r<=this._prevRotation)&&(this._prevClockwise=0<this._prevClockwise?this._prevClockwise-1:this._prevClockwise+1),this._prevRotation+r-this._prevRotation+j.Transform.PI_D*this._prevClockwise)),this._prevClockwise=N._getNumber(t,j.DataParser.CLOCK_WISE,0),this._prevRotation=r;e=this._parseTweenFrame(t,e,i),i=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[i++]=r,this._frameFloatArray[i++]=N._getNumber(t,j.DataParser.SKEW,0)*j.Transform.DEG_RAD,e},N.prototype._parseBoneScaleFrame=function(t,e,i){e=this._parseTweenFrame(t,e,i),i=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[i++]=N._getNumber(t,j.DataParser.X,1),this._frameFloatArray[i++]=N._getNumber(t,j.DataParser.Y,1),e},N.prototype._parseSlotDisplayFrame=function(t,e,i){i=this._parseFrame(t,e,i);return this._frameArray.length+=1,j.DataParser.VALUE in t?this._frameArray[i+1]=N._getNumber(t,j.DataParser.VALUE,0):this._frameArray[i+1]=N._getNumber(t,j.DataParser.DISPLAY_INDEX,0),this._parseActionDataInFrame(t,e,this._slot.parent,this._slot),i},N.prototype._parseSlotColorFrame=function(t,e,i){var i=this._parseTweenFrame(t,e,i),r=-1;if(j.DataParser.VALUE in t||j.DataParser.COLOR in t){var n,o=j.DataParser.VALUE in t?t[j.DataParser.VALUE]:t[j.DataParser.COLOR];for(n in o){this._parseColorTransform(o,this._helpColorTransform),r=this._colorArray.length,this._colorArray.length+=8,this._colorArray[r++]=Math.round(100*this._helpColorTransform.alphaMultiplier),this._colorArray[r++]=Math.round(100*this._helpColorTransform.redMultiplier),this._colorArray[r++]=Math.round(100*this._helpColorTransform.greenMultiplier),this._colorArray[r++]=Math.round(100*this._helpColorTransform.blueMultiplier),this._colorArray[r++]=Math.round(this._helpColorTransform.alphaOffset),this._colorArray[r++]=Math.round(this._helpColorTransform.redOffset),this._colorArray[r++]=Math.round(this._helpColorTransform.greenOffset),this._colorArray[r++]=Math.round(this._helpColorTransform.blueOffset),r-=8;break}}r<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=r=this._colorArray.length,this._colorArray.length+=8,this._colorArray[r++]=100,this._colorArray[r++]=100,this._colorArray[r++]=100,this._colorArray[r++]=100,this._colorArray[r++]=0,this._colorArray[r++]=0,this._colorArray[r++]=0,this._colorArray[r++]=0),r=this._defaultColorOffset);t=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[t]=r,i},N.prototype._parseSlotDeformFrame=function(t,e,i){var r=this._frameFloatArray.length,i=this._parseTweenFrame(t,e,i),n=j.DataParser.VERTICES in t?t[j.DataParser.VERTICES]:null,o=N._getNumber(t,j.DataParser.OFFSET,0),a=this._intArray[this._mesh.geometry.offset+0],s=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,h=this._mesh.geometry.weight,l=0,u=0,c=0,p=0;null!==h?(t=this._weightSlotPose[s],this._helpMatrixA.copyFromArray(t,0),this._frameFloatArray.length+=2*h.count,c=h.offset+2+h.bones.length):this._frameFloatArray.length+=2*a;for(var d=0;d<2*a;d+=2)if(u=null===n?l=0:(l=d<o||d-o>=n.length?0:n[d-o],d+1<o||d+1-o>=n.length?0:n[d+1-o]),null!==h){var f=this._weightBonePoses[s],_=this._intArray[c++];this._helpMatrixA.transformPoint(l,u,this._helpPoint,!0);for(var l=this._helpPoint.x,u=this._helpPoint.y,g=0;g<_;++g){var y=this._intArray[c++];this._helpMatrixB.copyFromArray(f,7*y+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(l,u,this._helpPoint,!0),this._frameFloatArray[r+p++]=this._helpPoint.x,this._frameFloatArray[r+p++]=this._helpPoint.y}}else this._frameFloatArray[r+d]=l,this._frameFloatArray[r+d+1]=u;return 0===e&&(e=this._frameIntArray.length,this._frameIntArray.length+=5,this._frameIntArray[e+0]=this._mesh.geometry.offset,this._frameIntArray[e+1]=this._frameFloatArray.length-r,this._frameIntArray[e+2]=this._frameFloatArray.length-r,this._frameIntArray[e+3]=0,this._frameIntArray[e+4]=r-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=e-this._animation.frameIntOffset),i},N.prototype._parseIKConstraintFrame=function(t,e,i){e=this._parseTweenFrame(t,e,i),i=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[i++]=N._getBoolean(t,j.DataParser.BEND_POSITIVE,!0)?1:0,this._frameIntArray[i++]=Math.round(100*N._getNumber(t,j.DataParser.WEIGHT,1)),e},N.prototype._parseActionData=function(t,e,i,r){var n=new Array;if("string"==typeof t)(l=j.BaseObject.borrowObject(j.ActionData)).type=e,l.name=t,l.bone=i,l.slot=r,n.push(l);else if(t instanceof Array)for(var o=0,a=t;o<a.length;o++){var s,h=a[o],l=j.BaseObject.borrowObject(j.ActionData);j.DataParser.GOTO_AND_PLAY in h?(l.type=0,l.name=N._getString(h,j.DataParser.GOTO_AND_PLAY,"")):(j.DataParser.TYPE in h&&"string"==typeof h[j.DataParser.TYPE]?l.type=j.DataParser._getActionType(h[j.DataParser.TYPE]):l.type=N._getNumber(h,j.DataParser.TYPE,e),l.name=N._getString(h,j.DataParser.NAME,"")),j.DataParser.BONE in h?(s=N._getString(h,j.DataParser.BONE,""),l.bone=this._armature.getBone(s)):l.bone=i,j.DataParser.SLOT in h?(s=N._getString(h,j.DataParser.SLOT,""),l.slot=this._armature.getSlot(s)):l.slot=r;var u=null;if(j.DataParser.INTS in h){null===u&&(u=j.BaseObject.borrowObject(j.UserData));for(var c=0,p=h[j.DataParser.INTS];c<p.length;c++){var d=p[c];u.addInt(d)}}if(j.DataParser.FLOATS in h){null===u&&(u=j.BaseObject.borrowObject(j.UserData));for(var f=0,_=h[j.DataParser.FLOATS];f<_.length;f++){d=_[f];u.addFloat(d)}}if(j.DataParser.STRINGS in h){null===u&&(u=j.BaseObject.borrowObject(j.UserData));for(var g=0,y=h[j.DataParser.STRINGS];g<y.length;g++){d=y[g];u.addString(d)}}l.data=u,n.push(l)}return n},N.prototype._parseDeformFrame=function(t,e,i){var r=this._frameFloatArray.length,i=this._parseTweenFrame(t,e,i),n=j.DataParser.VERTICES in t?t[j.DataParser.VERTICES]:j.DataParser.VALUE in t?t[j.DataParser.VALUE]:null,o=N._getNumber(t,j.DataParser.OFFSET,0),a=this._intArray[this._geometry.offset+0],t=this._geometry.weight,s=0,h=0;if(null===t){this._frameFloatArray.length+=2*a;for(var l=0;l<2*a;l+=2)h=null!==n?(s=l<o||l-o>=n.length?0:n[l-o],l+1<o||l+1-o>=n.length?0:n[l+1-o]):s=0,this._frameFloatArray[r+l]=s,this._frameFloatArray[r+l+1]=h}return 0===e&&(e=this._frameIntArray.length,this._frameIntArray.length+=5,this._frameIntArray[e+0]=this._geometry.offset,this._frameIntArray[e+1]=this._frameFloatArray.length-r,this._frameIntArray[e+2]=this._frameFloatArray.length-r,this._frameIntArray[e+3]=0,this._frameIntArray[e+4]=r-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=e-this._animation.frameIntOffset),i},N.prototype._parseTransform=function(t,e,i){e.x=N._getNumber(t,j.DataParser.X,0)*i,e.y=N._getNumber(t,j.DataParser.Y,0)*i,j.DataParser.ROTATE in t||j.DataParser.SKEW in t?(e.rotation=j.Transform.normalizeRadian(N._getNumber(t,j.DataParser.ROTATE,0)*j.Transform.DEG_RAD),e.skew=j.Transform.normalizeRadian(N._getNumber(t,j.DataParser.SKEW,0)*j.Transform.DEG_RAD)):(j.DataParser.SKEW_X in t||j.DataParser.SKEW_Y in t)&&(e.rotation=j.Transform.normalizeRadian(N._getNumber(t,j.DataParser.SKEW_Y,0)*j.Transform.DEG_RAD),e.skew=j.Transform.normalizeRadian(N._getNumber(t,j.DataParser.SKEW_X,0)*j.Transform.DEG_RAD)-e.rotation),e.scaleX=N._getNumber(t,j.DataParser.SCALE_X,1),e.scaleY=N._getNumber(t,j.DataParser.SCALE_Y,1)},N.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=.01*N._getNumber(t,j.DataParser.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*N._getNumber(t,j.DataParser.RED_MULTIPLIER,100),e.greenMultiplier=.01*N._getNumber(t,j.DataParser.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*N._getNumber(t,j.DataParser.BLUE_MULTIPLIER,100),e.alphaOffset=N._getNumber(t,j.DataParser.ALPHA_OFFSET,0),e.redOffset=N._getNumber(t,j.DataParser.RED_OFFSET,0),e.greenOffset=N._getNumber(t,j.DataParser.GREEN_OFFSET,0),e.blueOffset=N._getNumber(t,j.DataParser.BLUE_OFFSET,0)},N.prototype._parseGeometry=function(t,e){var i=t[j.DataParser.VERTICES],r=Math.floor(i.length/2),n=0,o=this._intArray.length,a=this._floatArray.length;e.offset=o,e.data=this._data,this._intArray.length+=4,this._intArray[o+0]=r,this._intArray[o+2]=a,this._intArray[o+3]=-1,this._floatArray.length+=2*r;for(var s=0,h=2*r;s<h;++s)this._floatArray[a+s]=i[s];if(j.DataParser.TRIANGLES in t){var l=t[j.DataParser.TRIANGLES],n=Math.floor(l.length/3);this._intArray.length+=3*n;for(s=0,h=3*n;s<h;++s)this._intArray[o+4+s]=l[s]}if(this._intArray[o+1]=n,j.DataParser.UVS in t){var u=t[j.DataParser.UVS],c=a+2*r;this._floatArray.length+=2*r;for(s=0,h=2*r;s<h;++s)this._floatArray[c+s]=u[s]}if(j.DataParser.WEIGHTS in t){var p=t[j.DataParser.WEIGHTS],d=Math.floor(p.length-r)/2,f=this._intArray.length,_=this._floatArray.length,g=0,y=this._armature.sortedBones,m=j.BaseObject.borrowObject(j.WeightData);if(m.count=d,m.offset=f,this._intArray.length+=2+g+r+d,this._intArray[f+1]=_,j.DataParser.BONE_POSE in t){var n=t[j.DataParser.SLOT_POSE],v=t[j.DataParser.BONE_POSE],b=new Array,g=Math.floor(v.length/7);b.length=g;for(s=0;s<g;++s){var T=v[7*s],x=this._rawBones[T];m.addBone(x),b[s]=T,this._intArray[f+2+s]=y.indexOf(x)}this._floatArray.length+=3*d,this._helpMatrixA.copyFromArray(n,0);for(var s=0,w=0,S=f+2+g,C=_;s<r;++s){var E=2*s,P=this._intArray[S++]=p[w++],D=this._floatArray[a+E],O=this._floatArray[a+E+1];this._helpMatrixA.transformPoint(D,O,this._helpPoint),D=this._helpPoint.x,O=this._helpPoint.y;for(var I=0;I<P;++I){var T=p[w++],$=b.indexOf(T);this._helpMatrixB.copyFromArray(v,7*$+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(D,O,this._helpPoint),this._intArray[S++]=$,this._floatArray[C++]=p[w++],this._floatArray[C++]=this._helpPoint.x,this._floatArray[C++]=this._helpPoint.y}}}else{var A=t[j.DataParser.BONES];g=A.length;for(s=0;s<g;s++){T=A[s],x=this._rawBones[T];m.addBone(x),this._intArray[f+2+s]=y.indexOf(x)}this._floatArray.length+=3*d;for(var s=0,w=0,C=0,S=f+2+g,R=_;s<d;s++){P=p[w++];this._intArray[S++]=P;for(I=0;I<P;I++){var $=p[w++],B=p[w++],D=i[C++],O=i[C++];this._intArray[S++]=A.indexOf($),this._floatArray[R++]=B,this._floatArray[R++]=D,this._floatArray[R++]=O}}}e.weight=m}},N.prototype._parseArray=function(t){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0,this._colorArray.length=0},N.prototype._modifyArray=function(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!=0&&this._timelineArray.push(0),this._timelineArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._colorArray.push(0);for(var t=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,e=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,i=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,r=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,n=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,o=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,a=this._colorArray.length*Int16Array.BYTES_PER_ELEMENT,a=new ArrayBuffer(t+e+i+r+n+o+a),s=new Int16Array(a,0,this._intArray.length),h=new Float32Array(a,t,this._floatArray.length),l=new Int16Array(a,t+e,this._frameIntArray.length),u=new Float32Array(a,t+e+i,this._frameFloatArray.length),c=new Int16Array(a,t+e+i+r,this._frameArray.length),p=new Uint16Array(a,t+e+i+r+n,this._timelineArray.length),d=new Int16Array(a,t+e+i+r+n+o,this._colorArray.length),f=0,_=this._intArray.length;f<_;++f)s[f]=this._intArray[f];for(f=0,_=this._floatArray.length;f<_;++f)h[f]=this._floatArray[f];for(f=0,_=this._frameIntArray.length;f<_;++f)l[f]=this._frameIntArray[f];for(f=0,_=this._frameFloatArray.length;f<_;++f)u[f]=this._frameFloatArray[f];for(f=0,_=this._frameArray.length;f<_;++f)c[f]=this._frameArray[f];for(f=0,_=this._timelineArray.length;f<_;++f)p[f]=this._timelineArray[f];for(f=0,_=this._colorArray.length;f<_;++f)d[f]=this._colorArray[f];this._data.binary=a,this._data.intArray=s,this._data.floatArray=h,this._data.frameIntArray=l,this._data.frameFloatArray=u,this._data.frameArray=c,this._data.timelineArray=p,this._data.colorArray=d,this._defaultColorOffset=-1},N.prototype.parseDragonBonesData=function(t,e){void 0===e&&(e=1),console.assert(null!=t,"Data error.");var i=N._getString(t,j.DataParser.VERSION,""),r=N._getString(t,j.DataParser.COMPATIBLE_VERSION,"");if(0<=j.DataParser.DATA_VERSIONS.indexOf(i)||0<=j.DataParser.DATA_VERSIONS.indexOf(r)){var n=j.BaseObject.borrowObject(j.DragonBonesData);if(n.version=i,n.name=N._getString(t,j.DataParser.NAME,""),n.frameRate=N._getNumber(t,j.DataParser.FRAME_RATE,24),0===n.frameRate&&(n.frameRate=24),j.DataParser.ARMATURE in t){this._data=n,this._parseArray(t);for(var o=0,a=t[j.DataParser.ARMATURE];o<a.length;o++){var s=a[o];n.addArmature(this._parseArmature(s,e))}this._data.binary||this._modifyArray(),j.DataParser.STAGE in t?n.stage=n.getArmature(N._getString(t,j.DataParser.STAGE,"")):0<n.armatureNames.length&&(n.stage=n.getArmature(n.armatureNames[0])),this._data=null}return j.DataParser.TEXTURE_ATLAS in t&&(this._rawTextureAtlases=t[j.DataParser.TEXTURE_ATLAS]),n}return console.assert(!1,"Nonsupport data version: "+i+"\nPlease convert DragonBones data to support version.\nRead more: https://github.com/DragonBones/Tools/"),null},N.prototype.parseTextureAtlasData=function(t,e,i){if(void 0===i&&(i=1),console.assert(void 0!==t),null===t){if(null===this._rawTextureAtlases||0===this._rawTextureAtlases.length)return!1;var r=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(r,e,i),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(e.width=N._getNumber(t,j.DataParser.WIDTH,0),e.height=N._getNumber(t,j.DataParser.HEIGHT,0),e.scale=1===i?1/N._getNumber(t,j.DataParser.SCALE,1):i,e.name=N._getString(t,j.DataParser.NAME,""),e.imagePath=N._getString(t,j.DataParser.IMAGE_PATH,""),j.DataParser.SUB_TEXTURE in t)for(var n=t[j.DataParser.SUB_TEXTURE],o=0,a=n.length;o<a;++o){var s=n[o],h=N._getNumber(s,j.DataParser.FRAME_WIDTH,-1),l=N._getNumber(s,j.DataParser.FRAME_HEIGHT,-1),u=e.createTexture();u.rotated=N._getBoolean(s,j.DataParser.ROTATED,!1),u.name=N._getString(s,j.DataParser.NAME,""),u.region.x=N._getNumber(s,j.DataParser.X,0),u.region.y=N._getNumber(s,j.DataParser.Y,0),u.region.width=N._getNumber(s,j.DataParser.WIDTH,0),u.region.height=N._getNumber(s,j.DataParser.HEIGHT,0),0<h&&0<l&&(u.frame=j.TextureData.createRectangle(),u.frame.x=N._getNumber(s,j.DataParser.FRAME_X,0),u.frame.y=N._getNumber(s,j.DataParser.FRAME_Y,0),u.frame.width=h,u.frame.height=l),e.addTexture(u)}return!0},N.getInstance=function(){return N._objectDataParserInstance=null===N._objectDataParserInstance?new N:N._objectDataParserInstance},N._objectDataParserInstance=null,N);function N(){var t=null!==e&&e.apply(this,arguments)||this;return t._rawTextureAtlasIndex=0,t._rawBones=[],t._data=null,t._armature=null,t._bone=null,t._geometry=null,t._slot=null,t._skin=null,t._mesh=null,t._animation=null,t._timeline=null,t._rawTextureAtlases=null,t._frameValueType=0,t._defaultColorOffset=-1,t._prevClockwise=0,t._prevRotation=0,t._frameDefaultValue=0,t._frameValueScale=1,t._helpMatrixA=new j.Matrix,t._helpMatrixB=new j.Matrix,t._helpTransform=new j.Transform,t._helpColorTransform=new j.ColorTransform,t._helpPoint=new j.Point,t._helpArray=[],t._intArray=[],t._floatArray=[],t._frameIntArray=[],t._frameFloatArray=[],t._frameArray=[],t._timelineArray=[],t._colorArray=[],t._cacheRawMeshes=[],t._cacheMeshes=[],t._actionFrames=[],t._weightSlotPose={},t._weightBonePoses={},t._cacheBones={},t._slotChildActions={},t}j.ObjectDataParser=t;var b=function(){this.frameStart=0,this.actions=[]};j.ActionFrame=b}(dragonBones=dragonBones||{}),function(v){var n,t=(n=v.ObjectDataParser,__extends(e,n),e.prototype._inRange=function(t,e,i){return e<=t&&t<=i},e.prototype._decodeUTF8=function(t){for(var e=0,i="",r=0,n=0,o=0,a=0;t.length>e;){var s,h,l=t[e++];null!==(l=-1===l?0!==n?65533:-1:0===n?this._inRange(l,0,127)?l:(this._inRange(l,194,223)?(n=1,a=128,r=l-192):this._inRange(l,224,239)?(n=2,a=2048,r=l-224):this._inRange(l,240,244)&&(n=3,a=65536,r=l-240),r*=Math.pow(64,n),null):this._inRange(l,128,191)?(o+=1,r+=(l-128)*Math.pow(64,n-o),o!==n?null:(s=r,h=a,a=o=n=r=0,this._inRange(s,h,1114111)&&!this._inRange(s,55296,57343)?s:l)):(a=o=n=r=0,e--,l))&&-1!==l&&(l<=65535?0<l&&(i+=String.fromCharCode(l)):(l-=65536,i+=String.fromCharCode(55296+(l>>10&1023)),i+=String.fromCharCode(56320+(1023&l))))}return i},e.prototype._parseBinaryTimeline=function(t,e,i){var r=null!==(i=void 0===i?null:i)?i:v.BaseObject.borrowObject(v.TimelineData);r.type=t,r.offset=e,this._timeline=r;var n=this._timelineArrayBuffer[r.offset+2];if(1===n)r.frameIndicesOffset=-1;else{var o=this._animation.frameCount+1,a=this._data.frameIndices,s=a.length;a.length+=o,r.frameIndicesOffset=s;for(var h=0,l=0,u=0,c=0;h<o;++h)u+c<=h&&l<n&&(u=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[r.offset+5+l]],c=l===n-1?this._animation.frameCount-u:this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[r.offset+5+l+1]]-u,l++),a[s+h]=l-1}return this._timeline=null,r},e.prototype._parseAnimation=function(t){var e=v.BaseObject.borrowObject(v.AnimationData);e.blendType=v.DataParser._getAnimationBlendType(v.ObjectDataParser._getString(t,v.DataParser.BLEND_TYPE,"")),e.frameCount=v.ObjectDataParser._getNumber(t,v.DataParser.DURATION,0),e.playTimes=v.ObjectDataParser._getNumber(t,v.DataParser.PLAY_TIMES,1),e.duration=e.frameCount/this._armature.frameRate,e.fadeInTime=v.ObjectDataParser._getNumber(t,v.DataParser.FADE_IN_TIME,0),e.scale=v.ObjectDataParser._getNumber(t,v.DataParser.SCALE,1),e.name=v.ObjectDataParser._getString(t,v.DataParser.NAME,v.DataParser.DEFAULT_NAME),0===e.name.length&&(e.name=v.DataParser.DEFAULT_NAME);var i,r,n=t[v.DataParser.OFFSET];if(e.frameIntOffset=n[0],e.frameFloatOffset=n[1],e.frameOffset=n[2],this._animation=e,v.DataParser.ACTION in t&&(e.actionTimeline=this._parseBinaryTimeline(0,t[v.DataParser.ACTION])),v.DataParser.Z_ORDER in t&&(e.zOrderTimeline=this._parseBinaryTimeline(1,t[v.DataParser.Z_ORDER])),v.DataParser.BONE in t)for(r in i=t[v.DataParser.BONE]){var o=i[r],a=this._armature.getBone(r);if(null!==a)for(var s=0,h=o.length;s<h;s+=2){var l=o[s],u=o[s+1],c=this._parseBinaryTimeline(l,u);this._animation.addBoneTimeline(a.name,c)}}if(v.DataParser.SLOT in t)for(r in i=t[v.DataParser.SLOT]){var o=i[r],p=this._armature.getSlot(r);if(null!==p)for(s=0,h=o.length;s<h;s+=2){l=o[s],u=o[s+1],c=this._parseBinaryTimeline(l,u);this._animation.addSlotTimeline(p.name,c)}}if(v.DataParser.CONSTRAINT in t)for(r in i=t[v.DataParser.CONSTRAINT]){var o=i[r],d=this._armature.getConstraint(r);if(null!==d)for(s=0,h=o.length;s<h;s+=2){l=o[s],u=o[s+1],c=this._parseBinaryTimeline(l,u);this._animation.addConstraintTimeline(d.name,c)}}if(v.DataParser.TIMELINE in t)for(var f=0,_=o=t[v.DataParser.TIMELINE];f<_.length;f++){var g=_[f];if(0<=(u=v.ObjectDataParser._getNumber(g,v.DataParser.OFFSET,0))){var y,l=v.ObjectDataParser._getNumber(g,v.DataParser.TYPE,0),m=v.ObjectDataParser._getString(g,v.DataParser.NAME,""),c=null;switch(40===l&&0!==e.blendType&&((y=c=v.BaseObject.borrowObject(v.AnimationTimelineData)).x=v.ObjectDataParser._getNumber(g,v.DataParser.X,0),y.y=v.ObjectDataParser._getNumber(g,v.DataParser.Y,0)),c=this._parseBinaryTimeline(l,u,c),l){case 0:case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(m,c);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(m,c);break;case 30:this._animation.addConstraintTimeline(m,c);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(m,c)}}}return this._animation=null,e},e.prototype._parseGeometry=function(t,e){e.offset=t[v.DataParser.OFFSET],e.data=this._data;var i=this._intArrayBuffer[e.offset+3];if(i<-1&&(i+=65536),0<=i){var r=v.BaseObject.borrowObject(v.WeightData),t=this._intArrayBuffer[e.offset+0],n=this._intArrayBuffer[i+0];r.offset=i;for(var o=0;o<n;++o){var a=this._intArrayBuffer[i+2+o];r.addBone(this._rawBones[a])}for(var s=i+2+n,h=0,o=0,l=t;o<l;++o){var u=this._intArrayBuffer[s++];h+=u,s+=u}r.count=h,e.weight=r}},e.prototype._parseArray=function(t){var e=t[v.DataParser.OFFSET],i=e[1],r=e[3],n=e[5],o=e[7],a=e[9],s=e[11],t=12<e.length?e[13]:0,i=new Int16Array(this._binary,this._binaryOffset+e[0],i/Int16Array.BYTES_PER_ELEMENT),r=new Float32Array(this._binary,this._binaryOffset+e[2],r/Float32Array.BYTES_PER_ELEMENT),n=new Int16Array(this._binary,this._binaryOffset+e[4],n/Int16Array.BYTES_PER_ELEMENT),o=new Float32Array(this._binary,this._binaryOffset+e[6],o/Float32Array.BYTES_PER_ELEMENT),a=new Int16Array(this._binary,this._binaryOffset+e[8],a/Int16Array.BYTES_PER_ELEMENT),s=new Uint16Array(this._binary,this._binaryOffset+e[10],s/Uint16Array.BYTES_PER_ELEMENT),t=0<t?new Int16Array(this._binary,this._binaryOffset+e[12],t/Uint16Array.BYTES_PER_ELEMENT):i;this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=i,this._data.floatArray=r,this._data.frameIntArray=n,this._data.frameFloatArray=o,this._data.frameArray=this._frameArrayBuffer=a,this._data.timelineArray=this._timelineArrayBuffer=s,this._data.colorArray=t},e.prototype.parseDragonBonesData=function(t,e){void 0===e&&(e=1),console.assert(null!=t&&t instanceof ArrayBuffer,"Data error.");var i=new Uint8Array(t,0,8);if(i[0]!=="D".charCodeAt(0)||i[1]!=="B".charCodeAt(0)||i[2]!=="D".charCodeAt(0)||i[3]!=="T".charCodeAt(0))return console.assert(!1,"Nonsupport data."),null;var r=new Uint32Array(t,8,1)[0],i=new Uint8Array(t,12,r),i=this._decodeUTF8(i),i=JSON.parse(i);return this._binaryOffset=12+r,this._binary=t,n.prototype.parseDragonBonesData.call(this,i,e)},e.getInstance=function(){return e._binaryDataParserInstance=null===e._binaryDataParserInstance?new e:e._binaryDataParserInstance},e._binaryDataParserInstance=null,e);function e(){return null!==n&&n.apply(this,arguments)||this}v.BinaryDataParser=t}(dragonBones=dragonBones||{}),function(_){var t=(o.prototype._isSupportMesh=function(){return!0},o.prototype._getTextureData=function(t,e){if(t in this._textureAtlasDataMap)for(var i=0,r=this._textureAtlasDataMap[t];i<r.length;i++)if(null!==(s=(h=r[i]).getTexture(e)))return s;if(this.autoSearch)for(var n in this._textureAtlasDataMap)for(var o=0,a=this._textureAtlasDataMap[n];o<a.length;o++){var s,h=a[o];if(h.autoSearch)if(null!==(s=h.getTexture(e)))return s}return null},o.prototype._fillBuildArmaturePackage=function(t,e,i,r,n){var o=null,a=null;if(null===(a=0<e.length&&e in this._dragonBonesDataMap?(o=this._dragonBonesDataMap[e]).getArmature(i):a)&&(0===e.length||this.autoSearch))for(var s in this._dragonBonesDataMap)if(o=this._dragonBonesDataMap[s],(0===e.length||o.autoSearch)&&null!==(a=o.getArmature(i))){e=s;break}if(null===a)return!1;if(t.dataName=e,t.textureAtlasName=n,t.data=o,t.armature=a,t.skin=null,0<r.length&&(t.skin=a.getSkin(r),null===t.skin&&this.autoSearch))for(var s in this._dragonBonesDataMap){var h=this._dragonBonesDataMap[s].getArmature(r);if(null!==h){t.skin=h.defaultSkin;break}}return null===t.skin&&(t.skin=a.defaultSkin),!0},o.prototype._buildBones=function(t,e){for(var i=0,r=t.armature.sortedBones;i<r.length;i++){var n=r[i];_.BaseObject.borrowObject(0===n.type?_.Bone:_.Surface).init(n,e)}},o.prototype._buildSlots=function(t,e){var i=t.skin,r=t.armature.defaultSkin;if(null!==i&&null!==r){var n={};for(a in r.displays){var o=r.getDisplays(a);n[a]=o}if(i!==r)for(var a in i.displays){o=i.getDisplays(a);n[a]=o}for(var s=0,h=t.armature.sortedSlots;s<h.length;s++){var l=h[s],u=l.name in n?n[l.name]:null,c=this._buildSlot(t,l,e);if(null!==u){c.displayFrameCount=u.length;for(var p=0,d=c.displayFrameCount;p<d;++p){var f,_=u[p];c.replaceRawDisplayData(_,p),null!==_?(0<t.textureAtlasName.length&&(f=this._getTextureData(t.textureAtlasName,_.path),c.replaceTextureData(f,p)),_=this._getSlotDisplay(t,_,c),c.replaceDisplay(_,p)):c.replaceDisplay(null)}}c._setDisplayIndex(l.displayIndex,!0)}}},o.prototype._buildConstraints=function(t,e){var i,r=t.armature.constraints;for(i in r){var n=r[i];switch(n.type){case 0:var o=_.BaseObject.borrowObject(_.IKConstraint);o.init(n,e),e._addConstraint(o);break;case 1:var a=_.BaseObject.borrowObject(_.PathConstraint);a.init(n,e),e._addConstraint(a);break;default:a=_.BaseObject.borrowObject(_.IKConstraint);a.init(n,e),e._addConstraint(a)}}},o.prototype._buildChildArmature=function(t,e,i){return this.buildArmature(i.path,null!==t?t.dataName:"","",null!==t?t.textureAtlasName:"")},o.prototype._getSlotDisplay=function(t,e,i){var r=null!==t?t.dataName:e.parent.parent.parent.name,n=null;switch(e.type){case 0:var o=e;null===o.texture&&(o.texture=this._getTextureData(r,e.path)),n=i.rawDisplay;break;case 2:var a=e;null===a.texture&&(a.texture=this._getTextureData(r,a.path)),n=this._isSupportMesh()?i.meshDisplay:i.rawDisplay;break;case 1:var s=e,o=this._buildChildArmature(t,i,s);if(null!==o){if(o.inheritAnimation=s.inheritAnimation,!o.inheritAnimation){a=0<s.actions.length?s.actions:o.armatureData.defaultActions;if(0<a.length)for(var h=0,l=a;h<l.length;h++){var u=l[h],c=_.BaseObject.borrowObject(_.EventObject);_.EventObject.actionDataToInstance(u,c,i.armature),(c.slot=i).armature._bufferAction(c,!1)}else o.animation.play()}s.armature=o.armatureData}n=o}return n},o.prototype.parseDragonBonesData=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=1);for(var r=t instanceof ArrayBuffer?o._binaryParser:this._dataParser,t=r.parseDragonBonesData(t,i);;){var n=this._buildTextureAtlasData(null,null);if(!r.parseTextureAtlasData(null,n,i)){n.returnToPool();break}this.addTextureAtlasData(n,e)}return null!==t&&this.addDragonBonesData(t,e),t},o.prototype.parseTextureAtlasData=function(t,e,i,r){void 0===i&&(i=null),void 0===r&&(r=1);var n=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,r),this._buildTextureAtlasData(n,e||null),this.addTextureAtlasData(n,i),n},o.prototype.updateTextureAtlases=function(t,e){var i=this.getTextureAtlasData(e);if(null!==i)for(var r=0,n=i.length;r<n;++r)r<t.length&&this._buildTextureAtlasData(i[r],t[r])},o.prototype.getDragonBonesData=function(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null},o.prototype.addDragonBonesData=function(t,e){if((e=null!==(e=void 0===e?null:e)?e:t.name)in this._dragonBonesDataMap)return this._dragonBonesDataMap[e]===t?void 0:void console.warn("Can not add same name data: "+e);this._dragonBonesDataMap[e]=t},o.prototype.removeDragonBonesData=function(t,e){void 0===e&&(e=!0),t in this._dragonBonesDataMap&&(e&&this._dragonBones.bufferObject(this._dragonBonesDataMap[t]),delete this._dragonBonesDataMap[t])},o.prototype.getTextureAtlasData=function(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null},o.prototype.addTextureAtlasData=function(t,e){e=(e=null!==(e=void 0===e?null:e)?e:t.name)in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];e.indexOf(t)<0&&e.push(t)},o.prototype.removeTextureAtlasData=function(t,e){if(void 0===e&&(e=!0),t in this._textureAtlasDataMap){var i=this._textureAtlasDataMap[t];if(e)for(var r=0,n=i;r<n.length;r++){var o=n[r];this._dragonBones.bufferObject(o)}delete this._textureAtlasDataMap[t]}},o.prototype.getArmatureData=function(t,e){void 0===e&&(e="");var i=new a;return this._fillBuildArmaturePackage(i,e,t,"","")?i.armature:null},o.prototype.clear=function(t){for(var e in void 0===t&&(t=!0),this._dragonBonesDataMap)t&&this._dragonBones.bufferObject(this._dragonBonesDataMap[e]),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=0,r=this._textureAtlasDataMap[e];i<r.length;i++){var n=r[i];this._dragonBones.bufferObject(n)}delete this._textureAtlasDataMap[e]}},o.prototype.buildArmature=function(t,e,i,r){void 0===e&&(e=""),void 0===i&&(i=""),void 0===r&&(r="");var n=new a;if(!this._fillBuildArmaturePackage(n,e||"",t,i||"",r||""))return console.warn("No armature data: "+t+", "+(null!==e?e:"")),null;e=this._buildArmature(n);return this._buildBones(n,e),this._buildSlots(n,e),this._buildConstraints(n,e),e.invalidUpdate(null,!0),e.advanceTime(0),e},o.prototype.replaceDisplay=function(t,e,i){var r;(i=void 0===i?-1:i)<0&&(i=t.displayIndex),t.replaceDisplayData(e,i=i<0?0:i),null!==e?(r=this._getSlotDisplay(null,e,t),0!==e.type||null!==(e=t.getDisplayFrameAt(i).rawDisplayData)&&2===e.type&&(r=t.meshDisplay),t.replaceDisplay(r,i)):t.replaceDisplay(null,i)},o.prototype.replaceSlotDisplay=function(t,e,i,r,n,o){void 0===o&&(o=-1);t=this.getArmatureData(e,t||"");if(null===t||null===t.defaultSkin)return!1;r=t.defaultSkin.getDisplay(i,r);return this.replaceDisplay(n,r,o),!0},o.prototype.replaceSlotDisplayList=function(t,e,i,r){t=this.getArmatureData(e,t||"");if(!t||!t.defaultSkin)return!1;var n=t.defaultSkin.getDisplays(i);if(!n)return!1;r.displayFrameCount=n.length;for(var o=0,a=r.displayFrameCount;o<a;++o){var s=n[o];this.replaceDisplay(r,s,o)}return!0},o.prototype.replaceSkin=function(t,e,i,r){void 0===i&&(i=!1),void 0===r&&(r=null);for(var n=!1,o=e.parent.defaultSkin,a=0,s=t.getSlots();a<s.length;a++){var h=s[a];if(!(null!==r&&0<=r.indexOf(h.name))){var l=e.getDisplays(h.name);if(null!==l||null!==(l=null!==o&&e!==o?o.getDisplays(h.name):l)){h.displayFrameCount=l.length;for(var u=0,c=h.displayFrameCount;u<c;++u){var p=l[u];h.replaceRawDisplayData(p,u),null!==p?h.replaceDisplay(this._getSlotDisplay(null,p,h),u):h.replaceDisplay(null,u)}n=!0}else i&&(h.displayFrameCount=0)}}return n},o.prototype.replaceAnimation=function(t,e,i){var r=e.defaultSkin;if(null===r)return!1;if(i=void 0===i?!0:i)t.animation.animations=e.animations;else{var n,o=t.animation.animations,a={};for(n in o)a[n]=o[n];for(n in e.animations)a[n]=e.animations[n];t.animation.animations=a}for(var s=0,h=t.getSlots();s<h.length;s++)for(var l=h[s],u=0,c=0,p=l.displayList;c<p.length;c++){var d,f=p[c];f instanceof _.Armature&&(null!==(d=r.getDisplays(l.name))&&u<d.length&&(null===(d=d[u])||1!==d.type||(d=this.getArmatureData(d.path,d.parent.parent.parent.name))&&this.replaceAnimation(f,d,i))),u++}return!0},o.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},o.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},Object.defineProperty(o.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:!0,configurable:!0}),o._objectParser=null,o._binaryParser=null,o);function o(t){void 0===t&&(t=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,(this._dataParser=null)===o._objectParser&&(o._objectParser=new _.ObjectDataParser),null===o._binaryParser&&(o._binaryParser=new _.BinaryDataParser),this._dataParser=null!==t?t:o._objectParser}_.BaseFactory=t;var a=function(){this.dataName="",this.textureAtlasName="",this.skin=null};_.BuildArmaturePackage=a}(dragonBones=dragonBones||{}),function(t){var e,i=(e=t.TextureAtlasData,__extends(r,e),r.toString=function(){return"[class dragonBones.EgretTextureAtlasData]"},r.prototype._onClear=function(){e.prototype._onClear.call(this),this.disposeEnabled&&null!==this._renderTexture&&this._renderTexture.dispose(),this.disposeEnabled=!1,this._renderTexture=null},r.prototype.createTexture=function(){return t.BaseObject.borrowObject(o)},Object.defineProperty(r.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(t){if(this._renderTexture!==t)if(this._renderTexture=t,null!==this._renderTexture){var e=this._renderTexture.bitmapData,i=(0<this.width?this:e).width,r=(0<this.height?this:e).height;for(s in this.textures){var n=egret.$TextureScaleFactor,o=(h=this.textures[s]).region.width,a=h.region.height;null===h.renderTexture&&(h.renderTexture=new egret.Texture),h.renderTexture.bitmapData=e,h.rotated?h.renderTexture.$initData(h.region.x*n,h.region.y*n,a*n,o*n,0,0,a*n,o*n,i,r,h.rotated):h.renderTexture.$initData(h.region.x*n,h.region.y*n,o*n,a*n,0,0,o*n,a*n,i,r)}}else for(var s in this.textures){var h;(h=this.textures[s]).renderTexture=null}},enumerable:!0,configurable:!0}),r);function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTexture=null,t}t.EgretTextureAtlasData=i;var n,o=(n=t.TextureData,__extends(a,n),a.toString=function(){return"[class dragonBones.EgretTextureData]"},a.prototype._onClear=function(){n.prototype._onClear.call(this),this.renderTexture,this.renderTexture=null},a);function a(){var t=null!==n&&n.apply(this,arguments)||this;return t.renderTexture=null,t}t.EgretTextureData=o}(dragonBones=dragonBones||{}),function(D){var t,i=(t=egret.Event,__extends(e,t),Object.defineProperty(e.prototype,"eventObject",{get:function(){return this.data},enumerable:!0,configurable:!0}),e);function e(){return null!==t&&t.apply(this,arguments)||this}D.EgretEvent=i;var _,r=(_=egret.DisplayObjectContainer,__extends(n,_),n._cleanBeforeRender=function(){},n.prototype.dbInit=function(t){this._armature=t,this._batchEnabled&&(this.$renderNode=new egret.sys.GroupNode,this.$renderNode.cleanBeforeRender=n._cleanBeforeRender)},n.prototype.dbClear=function(){this._armature=null,this._bounds=null,this._debugDrawer=null},n.prototype.dbUpdate=function(){var t=D.DragonBones.debugDraw||this.debugDraw;if(t||this._debugDraw)if(this._debugDraw=t,this._debugDraw){null===this._debugDrawer&&(this._debugDrawer=new egret.Sprite),this._debugDrawer.parent!==this&&this.addChild(this._debugDrawer);var e=this._debugDrawer.graphics;e.clear();for(var i=0,r=this._armature.getBones();i<r.length;i++){var n=r[i];if(0===n.boneData.type){var o=Math.max(n.boneData.length,2),a=n.globalTransformMatrix.tx,s=n.globalTransformMatrix.ty,h=a-2*n.globalTransformMatrix.a,l=s-2*n.globalTransformMatrix.b,u=a+n.globalTransformMatrix.a*o,c=s+n.globalTransformMatrix.b*o,p=a+l-s,d=s+h-a,o=a-l+s,a=s-h+a;e.lineStyle(2,65535,.7),e.moveTo(h,l),e.lineTo(u,c),e.moveTo(p,d),e.lineTo(o,a)}else{var a=n._boneData,f=a.segmentX,_=a.segmentY,g=n._vertices;e.lineStyle(2,16776960,.3);for(var y=0;y<_;++y)for(var m=0;m<f;++m){var v=2*(m+y*(f+1)),b=g[v],T=g[1+v];e.moveTo(b,T),e.lineTo(g[2+v],g[3+v]),e.moveTo(b,T),e.lineTo(g[v+2*(f+1)],g[v+2*(f+1)+1]),m===f-1&&(e.moveTo(g[2+v],g[3+v]),e.lineTo(g[v+2*(f+2)],g[v+2*(f+2)+1])),y===_-1&&(e.moveTo(g[v+2*(f+1)],g[v+2*(f+1)+1]),e.lineTo(g[v+2*(f+2)],g[v+2*(f+2)+1]))}}}for(var x=0,w=this._armature.getSlots();x<w.length;x++){var S,C=w[x],E=C.boundingBoxData;if(null!==E){switch(null===(S=this._debugDrawer.getChildByName(C.name))&&((S=new egret.Shape).name=C.name,this._debugDrawer.addChild(S)),S.graphics.clear(),S.graphics.lineStyle(2,16711935,.7),E.type){case 0:S.graphics.drawRect(.5*-E.width,.5*-E.height,E.width,E.height);break;case 1:S.graphics.drawEllipse(.5*-E.width,.5*-E.height,E.width,E.height);break;case 2:for(var g=E.vertices,P=0;P<g.length;P+=2){b=g[P],T=g[P+1];0===P?S.graphics.moveTo(b,T):S.graphics.lineTo(b,T)}S.graphics.lineTo(g[0],g[1])}C.updateTransformAndMatrix(),C.updateGlobalTransform(),S.$setMatrix(C.globalTransformMatrix,!1)}else null!==(S=this._debugDrawer.getChildByName(C.name))&&this._debugDrawer.removeChild(S)}}else null!==this._debugDrawer&&this._debugDrawer.parent===this&&this.removeChild(this._debugDrawer);!D.isV5&&this._batchEnabled&&this._childDirty&&this.$invalidateContentBounds()},n.prototype.dispose=function(t){void 0===t&&(t=!0),null!==this._armature&&(this._armature.dispose(),this._armature=null)},n.prototype.dispatchDBEvent=function(t,e){t=egret.Event.create(i,t);t.data=e,_.prototype.dispatchEvent.call(this,t),egret.Event.release(t)},n.prototype.hasDBEventListener=function(t){return this.hasEventListener(t)},n.prototype.addDBEventListener=function(t,e,i){this.addEventListener(t,e,i)},n.prototype.removeDBEventListener=function(t,e,i){this.removeEventListener(t,e,i)},n.prototype.disableBatch=function(){if(this._batchEnabled&&this._armature){for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t],r=i._geometryData?i.meshDisplay:i.rawDisplay,n=(r=!i.display&&r===i.meshDisplay?i.rawDisplay:r).$renderNode;n.matrix&&r.$setMatrix(i.globalTransformMatrix,!1),n.alpha=1,n.filter=null,this.addChild(r)}this._batchEnabled=!1,this.$renderNode.cleanBeforeRender=null,this.$renderNode=null,this.armature.invalidUpdate(null,!0)}},Object.defineProperty(n.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),n.prototype.$measureContentBounds=function(t){if(this._batchEnabled&&this._armature){if(this._childDirty){for(var e=!(this._childDirty=!1),i=new egret.Rectangle,r=0,n=this._armature.getSlots();r<n.length;r++){var o=n[r],a=o.display;if(a&&a.$renderNode&&a.$renderNode.image){var s=a.$renderNode.matrix;if(a===o.meshDisplay){var h=a.$renderNode.vertices;if(!(h&&0<h.length))continue;i.setTo(999999,999999,-999999,-999999);for(var l=0,u=h.length;l<u;l+=2){var c=h[l],p=h[l+1];i.x>c&&(i.x=c),i.width<c&&(i.width=c),i.y>p&&(i.y=p),i.height<p&&(i.height=p)}i.width-=i.x,i.height-=i.y}else if(o._displayFrame){var d=o._displayFrame.getTextureData();if(!d)continue;var f=d.parent.scale;i.x=0,i.y=0,i.width=d.region.width*f,i.height=d.region.height*f}s.$transformBounds(i);o=i.x,d=i.y,f=i.x+i.width,s=i.y+i.height;e?(e=!1,t.x=o,t.y=d,t.width=f,t.height=s):(o<t.x&&(t.x=o),d<t.y&&(t.y=d),f>t.width&&(t.width=f),s>t.height&&(t.height=s))}}t.width-=t.x,t.height-=t.y,D.isV5&&(null===this._bounds&&(this._bounds=new egret.Rectangle),this._bounds.copyFrom(t))}else D.isV5&&(null===this._bounds&&(this._bounds=new egret.Rectangle),t.copyFrom(this._bounds));return t}return _.prototype.$measureContentBounds.call(this,t)},n.prototype.createNativeDisplayObject=function(){egret_native.nrCreateArmatureDisplay?this.$nativeDisplayObject=egret_native.nrCreateArmatureDisplay():_.prototype.createNativeDisplayObject.call(this)},n);function n(){var t=null!==_&&_.apply(this,arguments)||this;return t.debugDraw=!1,t._batchEnabled=!(global.nativeRender||global.bricks),t._childDirty=!0,t._debugDraw=!1,t._armature=null,t._bounds=null,t._debugDrawer=null,t}D.EgretArmatureDisplay=r}(dragonBones=dragonBones||{}),function($){var n,t=(n=$.Slot,__extends(e,n),e.toString=function(){return"[class dragonBones.EgretSlot]"},e.prototype.init=function(t,e,i,r){n.prototype.init.call(this,t,e,i,r),$.isV5?this._updateTransform=this._updateTransformV5:this._updateTransform=this._updateTransformV4},e.prototype._onClear=function(){n.prototype._onClear.call(this),this._armatureDisplay=null,this._renderDisplay=null,this._colorFilter=null},e.prototype._initDisplay=function(t,e){},e.prototype._disposeDisplay=function(t,e){},e.prototype._onUpdateDisplay=function(){var t;this._armatureDisplay=this._armature.display,this._renderDisplay=null!==this._display?this._display:this._rawDisplay,$.isV5&&this._armatureDisplay._batchEnabled&&(this._renderDisplay!==this._rawDisplay||this._renderDisplay.$renderNode instanceof egret.sys.BitmapNode||(this._renderDisplay.$renderNode=new egret.sys.BitmapNode)),this._armatureDisplay._batchEnabled&&(this._renderDisplay!==this._rawDisplay&&this._renderDisplay!==this._meshDisplay?(this._armatureDisplay.disableBatch(),this._renderDisplay!==this._meshDisplay&&(this._meshDisplay=this._renderDisplay)):(t=this._renderDisplay.$renderNode).matrix||(t.matrix=new egret.Matrix))},e.prototype._addDisplay=function(){this._armatureDisplay._batchEnabled?this._armatureDisplay.$renderNode.addNode(this._renderDisplay.$renderNode):this._armatureDisplay.addChild(this._renderDisplay)},e.prototype._replaceDisplay=function(t){var e,i=t;this._armatureDisplay._batchEnabled?(t=(e=this._armatureDisplay.$renderNode.drawData).indexOf(i.$renderNode),e[t]=this._renderDisplay.$renderNode):(this._armatureDisplay.addChild(this._renderDisplay),this._armatureDisplay.swapChildren(this._renderDisplay,i),this._armatureDisplay.removeChild(i))},e.prototype._removeDisplay=function(){var t;this._armatureDisplay._batchEnabled?(t=this._armatureDisplay.$renderNode.drawData).splice(t.indexOf(this._renderDisplay.$renderNode),1):this._renderDisplay.parent.removeChild(this._renderDisplay)},e.prototype._updateZOrder=function(){var t;this._armatureDisplay._batchEnabled?(t=this._armatureDisplay.$renderNode.drawData).indexOf(this._renderDisplay.$renderNode)!==this._zOrder&&(t[this._zOrder]=this._renderDisplay.$renderNode):this._armatureDisplay.getChildIndex(this._renderDisplay)!==this._zOrder&&this._armatureDisplay.addChildAt(this._renderDisplay,this._zOrder)},e.prototype._updateVisible=function(){var t=this._parent.visible&&this._visible;this._armatureDisplay._batchEnabled?this._renderDisplay.$renderNode.alpha=t?1:0:this._renderDisplay.visible=t},e.prototype._updateBlendMode=function(){switch(this._blendMode){case 0:this._renderDisplay.blendMode=egret.BlendMode.NORMAL;break;case 1:this._renderDisplay.blendMode=egret.BlendMode.ADD;break;case 5:this._renderDisplay.blendMode=egret.BlendMode.ERASE}this._armatureDisplay._batchEnabled&&(this._renderDisplay.$renderNode.blendMode=egret.sys.blendModeToNumber(this._renderDisplay.blendMode))},e.prototype._updateColor=function(){var t,e,i=this._colorTransform.alphaMultiplier*this._globalAlpha;1!==this._colorTransform.redMultiplier||1!==this._colorTransform.greenMultiplier||1!==this._colorTransform.blueMultiplier||0!==this._colorTransform.redOffset||0!==this._colorTransform.greenOffset||0!==this._colorTransform.blueOffset||0!==this._colorTransform.alphaOffset?(null===this._colorFilter&&(this._colorFilter=new egret.ColorMatrixFilter),(t=this._colorFilter.matrix)[0]=this._colorTransform.redMultiplier,t[6]=this._colorTransform.greenMultiplier,t[12]=this._colorTransform.blueMultiplier,t[18]=i,t[4]=this._colorTransform.redOffset,t[9]=this._colorTransform.greenOffset,t[14]=this._colorTransform.blueOffset,t[19]=this._colorTransform.alphaOffset,this._colorFilter.matrix=t,this._armatureDisplay._batchEnabled&&((e=this._renderDisplay.$renderNode).filter=this._colorFilter,e.alpha=1),(t=(t=this._renderDisplay.filters)||[]).indexOf(this._colorFilter)<0&&t.push(this._colorFilter),this._renderDisplay.filters=t,this._renderDisplay.alpha=1):(this._armatureDisplay._batchEnabled&&((e=this._renderDisplay.$renderNode).filter=null,e.alpha=i),this._renderDisplay.filters=null,this._renderDisplay.alpha=i)},e.prototype._updateFrame=function(){var t=this._textureData;if(null!==this._displayFrame&&null!==this._display&&null!==t){var e=t.parent;if(null!==this._armature.replacedTexture&&(null===this._armature._replaceTextureAtlasData?((e=$.BaseObject.borrowObject($.EgretTextureAtlasData)).copyFrom(t.parent),e.renderTexture=this._armature.replacedTexture,this._armature._replaceTextureAtlasData=e):e=this._armature._replaceTextureAtlasData,t=e.getTexture(t.name)),null!==t.renderTexture){if(null!==this._geometryData){var i=this._geometryData.data,r=i.intArray,n=i.floatArray,o=r[this._geometryData.offset+0],a=r[this._geometryData.offset+1],s=r[this._geometryData.offset+2];s<0&&(s+=65536);var h=s+2*o,l=this._armature._armatureData.scale,i=this._renderDisplay,u=i.$renderNode;u.uvs.length=2*o,u.vertices.length=2*o,u.indices.length=3*a;for(var c=0,p=2*o;c<p;++c)u.vertices[c]=n[s+c]*l,u.uvs[c]=n[h+c];for(c=0;c<3*a;++c)u.indices[c]=r[this._geometryData.offset+4+c];this._armatureDisplay._batchEnabled&&(g=t.renderTexture,d=this._renderDisplay.$renderNode,egret.sys.RenderNode.prototype.cleanBeforeRender.call(d),d.image=g.bitmapData,$.isV5?(d.drawMesh(g.$bitmapX,g.$bitmapY,g.$bitmapWidth,g.$bitmapHeight,g.$offsetX,g.$offsetY,g.textureWidth,g.textureHeight),d.imageWidth=g.$sourceWidth,d.imageHeight=g.$sourceHeight):(d.drawMesh((f=g)._bitmapX,f._bitmapY,f._bitmapWidth,f._bitmapHeight,f._offsetX,f._offsetY,f.textureWidth,f.textureHeight),d.imageWidth=f._sourceWidth,d.imageHeight=f._sourceHeight),this._blendModeDirty=!0,this._colorDirty=!0),i.texture=t.renderTexture,i.anchorOffsetX=this._pivotX,i.anchorOffsetY=this._pivotY,i.$updateVertices(),$.isV5||i.$invalidateTransform();o=null!==this._geometryData.weight,i=0!==this._parent._boneData.type;(o||i)&&this._identityTransform()}else{var d,f,l=t.parent.scale*this._armature._armatureData.scale,o=(t.rotated?t.region.height:t.region.width)*l,i=(t.rotated?t.region.width:t.region.height)*l,_=this._renderDisplay,g=t.renderTexture;_.texture=g,this._armatureDisplay._batchEnabled?(d=this._renderDisplay.$renderNode,egret.sys.RenderNode.prototype.cleanBeforeRender.call(d),d.image=g.bitmapData,$.isV5?(d.drawImage(g.$bitmapX,g.$bitmapY,g.$bitmapWidth,g.$bitmapHeight,g.$offsetX,g.$offsetY,o,i),d.imageWidth=g.$sourceWidth,d.imageHeight=g.$sourceHeight):(d.drawImage((f=g)._bitmapX,f._bitmapY,f._bitmapWidth,f._bitmapHeight,f._offsetX,f._offsetY,o,i),d.imageWidth=f._sourceWidth,d.imageHeight=f._sourceHeight),this._blendModeDirty=!0,this._colorDirty=!0):(_.width=o,_.height=i),_.anchorOffsetX=this._pivotX,_.anchorOffsetY=this._pivotY}return void(this._visibleDirty=!0)}}this._armatureDisplay._batchEnabled&&(this._renderDisplay.$renderNode.image=null);_=this._renderDisplay;_.texture=null,_.x=0,_.y=0,_.visible=!1},e.prototype._updateMesh=function(){var t=this._armature._armatureData.scale,e=this._displayFrame.deformVertices,i=this._geometryBones,r=this._geometryData,n=r.weight,o=0<e.length&&r.inheritDeform,a=this._renderDisplay,s=a.$renderNode;if(null!==n){var h=(S=r.data).intArray,l=S.floatArray,u=h[r.offset+0],c=h[n.offset+1];c<0&&(c+=65536);for(var p=0,d=0,f=n.offset+2+i.length,_=c,g=0;p<u;++p){for(var y=h[f++],m=0,v=0,b=0;b<y;++b){var T,x,w=i[h[f++]];null!==w&&(D=w.globalTransformMatrix,T=l[_++],x=l[_++]*t,w=l[_++]*t,o&&(x+=e[g++],w+=e[g++]),m+=(D.a*x+D.c*w+D.tx)*T,v+=(D.b*x+D.d*w+D.ty)*T)}s.vertices[d++]=m,s.vertices[d++]=v}a.$updateVertices(),$.isV5||a.$invalidateTransform()}else{var S,C=0!==this._parent._boneData.type,h=(S=r.data).intArray,l=S.floatArray,u=h[r.offset+0],E=h[r.offset+2];E<0&&(E+=65536);for(var p=0,P=2*u;p<P;p+=2){var D,O=l[E+p]*t,I=l[E+p+1]*t;o&&(O+=e[p],I+=e[p+1]),C?(D=this._parent._getGlobalTransformMatrix(O,I),s.vertices[p]=D.a*O+D.c*I+D.tx,s.vertices[p+1]=D.b*O+D.d*I+D.ty):(s.vertices[p]=O,s.vertices[p+1]=I)}a.$updateVertices(),$.isV5||a.$invalidateTransform()}this._armatureDisplay._batchEnabled&&(this._armatureDisplay._childDirty=!0)},e.prototype._updateTransform=function(){throw new Error},e.prototype._identityTransform=function(){var t;this._armatureDisplay._batchEnabled?(this._armatureDisplay._childDirty=!0,(t=this._renderDisplay.$renderNode.matrix).a=1,t.b=0,t.c=0,t.d=1,t.tx=0,t.ty=0):(egret.$TempMatrix.identity(),this._renderDisplay.$setMatrix(egret.$TempMatrix,this.transformUpdateEnabled))},e.prototype._updateTransformV4=function(){var t,e=this.globalTransformMatrix;this._armatureDisplay._batchEnabled?(this._armatureDisplay._childDirty=!0,(t=this._renderDisplay.$renderNode.matrix).a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),t.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)):this.transformUpdateEnabled?this._renderDisplay.$setMatrix(e,!0):((t=this._renderDisplay.$DisplayObject[6]).a=this.globalTransformMatrix.a,t.b=this.globalTransformMatrix.b,t.c=this.globalTransformMatrix.c,t.d=this.globalTransformMatrix.d,t.tx=this.globalTransformMatrix.tx,t.ty=this.globalTransformMatrix.ty,this._renderDisplay.$removeFlags(8),this._renderDisplay.$invalidatePosition())},e.prototype._updateTransformV5=function(){var t,e=this.globalTransformMatrix;this._armatureDisplay._batchEnabled?(this._armatureDisplay._childDirty=!0,(t=this._renderDisplay.$renderNode.matrix).a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),t.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)):this._renderDisplay.$setMatrix(e,this.transformUpdateEnabled)},e);function e(){var t=null!==n&&n.apply(this,arguments)||this;return t.transformUpdateEnabled=!1,t._armatureDisplay=null,t._renderDisplay=null,t._colorFilter=null,t}$.EgretSlot=t}(dragonBones=dragonBones||{}),function(n){n.isV5=5.1<=Number(egret.Capabilities.engineVersion.substr(0,3));var i,t=(i=n.BaseFactory,__extends(r,i),r._clockHandler=function(t){var e=(t*=.001)-this._time;return this._dragonBonesInstance.advanceTime(e),this._time=t,!1},Object.defineProperty(r,"factory",{get:function(){return null===this._factory&&(this._factory=new r),this._factory},enumerable:!0,configurable:!0}),r.prototype._isSupportMesh=function(){return!0},r.prototype._buildTextureAtlasData=function(t,e){var i;return null!==t?e instanceof egret.Texture?t.renderTexture=e:e&&((i=new egret.Texture).bitmapData=new egret.BitmapData(e),t.disposeEnabled=!0,t.renderTexture=i):t=n.BaseObject.borrowObject(n.EgretTextureAtlasData),t},r.prototype._buildArmature=function(t){var e=n.BaseObject.borrowObject(n.Armature),i=new n.EgretArmatureDisplay;return e.init(t.armature,i,i,this._dragonBones),e},r.prototype._buildSlot=function(t,e,i){var r=n.BaseObject.borrowObject(n.EgretSlot);return r.init(e,i,new egret.Bitmap,new egret.Mesh),r},r.prototype.buildArmatureDisplay=function(t,e,i,r){r=this.buildArmature(t,(e=void 0===e?"":e)||"",(i=void 0===i?"":i)||"",(r=void 0===r?"":r)||"");return null!==r?(this._dragonBones.clock.add(r),r.display):null},r.prototype.getTextureDisplay=function(t,e){var i=this._getTextureData(null!==(e=void 0===e?null:e)?e:"",t);if(null===i||null===i.renderTexture)return null;e=i.renderTexture,t=new egret.Bitmap(e);return t.width=e.textureWidth*i.parent.scale,t.height=e.textureHeight*i.parent.scale,t},Object.defineProperty(r.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:!0,configurable:!0}),r._time=0,r._dragonBonesInstance=null,r._factory=null,r);function r(t){var e=i.call(this,t=void 0===t?null:t)||this;return null===r._dragonBonesInstance&&(t=new n.EgretArmatureDisplay,r._dragonBonesInstance=new n.DragonBones(t),r._time=.001*egret.getTimer(),egret.startTick(r._clockHandler,r)),e._dragonBones=r._dragonBonesInstance,e}n.EgretFactory=t}(dragonBones=dragonBones||{});var mouse,fgui,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i};!function(t){var e=(i.MOUSE_MOVE="mouseMove",i.MOUSE_OVER="mouseOver",i.MOUSE_OUT="mouseOut",i.ROLL_OVER="rollOver",i.ROLL_OUT="rollOut",i.MOUSE_WHEEL="mouseWheel",i);function i(){}t.MouseEvent=e,__reflect(e.prototype,"mouse.MouseEvent")}(mouse=mouse||{}),egret.DisplayObject.prototype.$getConcatenatedVisible=function(){return(!this.$parent||this.$parent.$getConcatenatedVisible())&&this.$visible},function(i){var r,e;i.enable=function(t){e="Windows PC"==egret.Capabilities.os||"Mac OS"==egret.Capabilities.os,r=t,e&&n()};i.setButtonMode=function(t,e){t.buttonModeForMouse=e};i.setMouseMoveEnabled=function(t){0};var n=function(){function e(t){var e=t.type;"DOMMouseScroll"!=e&&"mousewheel"!=e||(t.delta=t.wheelDelta||-(t.detail||0),r.dispatchEventWith(i.MouseEvent.MOUSE_WHEEL,!1,t.delta))}var t="mousewheel";window.addEventListener?("mousewheel"===t&&void 0!==document.mozFullScreen&&(t="DOMMouseScroll"),window.addEventListener(t,function(t){e(t)},!1)):window.attachEvent&&window.attachEvent("on"+t,function(t){t=t||window.event,e(t)})}}(mouse=mouse||{}),function(u){var t=(e.prototype.createObject=function(t,e){var i=u.UIPackage.getByName(t);if(!i)throw new Error("package not found: "+t);i=i.getItemByName(e);if(!i)throw new Error("resource not found: "+e);this.internalCreateObject(i)},e.prototype.createObjectFromURL=function(t){var e=u.UIPackage.getItemByURL(t);if(!e)throw new Error("resource not found: "+t);this.internalCreateObject(e)},e.prototype.cancel=function(){u.GTimers.inst.remove(this.run,this),this._itemList.length=0;var t=this._objectPool.length;if(0<t){for(var e=0;e<t;e++)this._objectPool[e].dispose();this._objectPool.length=0}},e.prototype.internalCreateObject=function(t){this._itemList.length=0,this._objectPool.length=0;var e={pi:t,type:t.objectType};e.childCount=this.collectComponentChildren(t),this._itemList.push(e),this._index=0,u.GTimers.inst.add(1,0,this.run,this)},e.prototype.collectComponentChildren=function(t){var e,i,r,n=t.rawData;n.seek(0,2);for(var o=n.readShort(),a=0;a<o;a++){e=n.readShort(),i=n.position,n.seek(i,0);var s=n.readByte(),h=n.readS(),l=n.readS();n.position=i,null!=h?(r={pi:h=null!=(r=null!=l?u.UIPackage.getById(l):t.owner)?r.getItemById(h):null,type:s},null!=h&&h.type==u.PackageItemType.Component&&(r.childCount=this.collectComponentChildren(h))):(r={type:s},s==u.ObjectType.List&&(r.listItemCount=this.collectListChildren(n))),this._itemList.push(r),n.position=i+e}return o},e.prototype.collectListChildren=function(t){t.seek(t.position,8);for(var e,i,r,n=0,o=t.readS(),a=t.readShort(),s=0;s<a;s++)e=t.readShort(),e+=t.position,(r=null==(r=t.readS())?o:r)&&(i=u.UIPackage.getItemByURL(r))&&(r={pi:i,type:i.objectType},i.type==u.PackageItemType.Component&&(r.childCount=this.collectComponentChildren(i)),this._itemList.push(r),n++),t.position=e;return n},e.prototype.run=function(){for(var t,e,i,r,n=egret.getTimer(),o=u.UIConfig.frameTimeForAsyncUIConstruction,a=this._itemList.length;this._index<a;){if((e=this._itemList[this._index]).pi)t=u.UIObjectFactory.newObject(e.pi),this._objectPool.push(t),u.UIPackage._constructing++,e.pi.type==u.PackageItemType.Component?(i=this._objectPool.length-e.childCount-1,t.constructFromResource2(this._objectPool,i),this._objectPool.splice(i,e.childCount)):t.constructFromResource(),u.UIPackage._constructing--;else if(t=u.UIObjectFactory.newObject(e.type),this._objectPool.push(t),e.type==u.ObjectType.List&&0<e.listItemCount){for(i=this._objectPool.length-e.listItemCount-1,r=0;r<e.listItemCount;r++)t.itemPool.returnObject(this._objectPool[r+i]);this._objectPool.splice(i,e.listItemCount)}if(this._index++,this._index%5==0&&egret.getTimer()-n>=o)return}u.GTimers.inst.remove(this.run,this);var s=this._objectPool[0];this._itemList.length=0,this._objectPool.length=0,null!=this.callback&&this.callback.call(this.callbackObj,s)},e);function e(){this._itemList=new Array,this._objectPool=new Array}u.AsyncOperation=t}(fgui=fgui||{}),function(s){var e,r=0,t=(e=egret.EventDispatcher,__extends(i,e),i.prototype.dispose=function(){},Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.parent.applyController(this),this.dispatchEvent(new s.StateChangeEvent(s.StateChangeEvent.CHANGED)),this.changing=!1}},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndex=function(t){if(this._selectedIndex!=t){if(t>this._pageIds.length-1)throw"index out of bounds: "+t;this.changing=!0,this._previousIndex=this._selectedIndex,this._selectedIndex=t,this.parent.applyController(this),this.changing=!1}},Object.defineProperty(i.prototype,"previsousIndex",{get:function(){return this._previousIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedPage",{get:function(){return-1==this._selectedIndex?null:this._pageNames[this._selectedIndex]},set:function(t){t=this._pageNames.indexOf(t);this.selectedIndex=t=-1==t?0:t},enumerable:!0,configurable:!0}),i.prototype.setSelectedPage=function(t){t=this._pageNames.indexOf(t);this.setSelectedIndex(t=-1==t?0:t)},Object.defineProperty(i.prototype,"previousPage",{get:function(){return-1==this._previousIndex?null:this._pageNames[this._previousIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageCount",{get:function(){return this._pageIds.length},enumerable:!0,configurable:!0}),i.prototype.getPageName=function(t){return this._pageNames[t]},i.prototype.addPage=function(t){this.addPageAt(t||"",this._pageIds.length)},i.prototype.addPageAt=function(t,e){var i=""+r++;e==this._pageIds.length?(this._pageIds.push(i),this._pageNames.push(t)):(this._pageIds.splice(e,0,i),this._pageNames.splice(e,0,t))},i.prototype.removePage=function(t){t=this._pageNames.indexOf(t);-1!=t&&(this._pageIds.splice(t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this))},i.prototype.removePageAt=function(t){this._pageIds.splice(t=void 0===t?0:t,1),this._pageNames.splice(t,1),this._selectedIndex>=this._pageIds.length?this.selectedIndex=this._selectedIndex-1:this.parent.applyController(this)},i.prototype.clearPages=function(){this._pageIds.length=0,this._pageNames.length=0,-1!=this._selectedIndex?this.selectedIndex=-1:this.parent.applyController(this)},i.prototype.hasPage=function(t){return-1!=this._pageNames.indexOf(t)},i.prototype.getPageIndexById=function(t){return this._pageIds.indexOf(t)},i.prototype.getPageIdByName=function(t){t=this._pageNames.indexOf(t);return-1!=t?this._pageIds[t]:null},i.prototype.getPageNameById=function(t){t=this._pageIds.indexOf(t);return-1!=t?this._pageNames[t]:null},i.prototype.getPageId=function(t){return this._pageIds[t=void 0===t?0:t]},Object.defineProperty(i.prototype,"selectedPageId",{get:function(){return-1==this._selectedIndex?null:this._pageIds[this._selectedIndex]},set:function(t){t=this._pageIds.indexOf(t);this.selectedIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"oppositePageId",{set:function(t){0<this._pageIds.indexOf(t)?this.selectedIndex=0:1<this._pageIds.length&&(this.selectedIndex=1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"previousPageId",{get:function(){return-1==this._previousIndex?null:this._pageIds[this._previousIndex]},enumerable:!0,configurable:!0}),i.prototype.runActions=function(){if(this._actions)for(var t=this._actions.length,e=0;e<t;e++)this._actions[e].run(this,this.previousPageId,this.selectedPageId)},i.prototype.setup=function(t){var e,i=t.position;t.seek(i,0),this.name=t.readS(),t.readBool()&&(this.autoRadioGroupDepth=!0),t.seek(i,1);for(var r=t.readShort(),n=0;n<r;n++)this._pageIds.push(t.readS()),this._pageNames.push(t.readS());var o=0;if(2<=t.version)switch(t.readByte()){case 1:o=t.readShort();break;case 2:-1==(o=this._pageNames.indexOf(s.UIPackage.branch))&&(o=0);break;case 3:-1==(o=this._pageNames.indexOf(s.UIPackage.getVar(t.readS())))&&(o=0)}if(t.seek(i,2),0<(r=t.readShort()))for(this._actions||(this._actions=new Array),n=0;n<r;n++){e=t.readShort(),e+=t.position;var a=s.ControllerAction.createAction(t.readByte());a.setup(t),this._actions.push(a),t.position=e}this.parent&&0<this._pageIds.length?this._selectedIndex=o:this._selectedIndex=-1},i);function i(){var t=e.call(this)||this;return t._pageIds=[],t._pageNames=[],t._selectedIndex=-1,t._previousIndex=-1,t}s.Controller=t}(fgui=fgui||{}),function(n){var t=(Object.defineProperty(e,"inst",{get:function(){return e._inst=null==e._inst?new e:e._inst},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragAgent",{get:function(){return this._agent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragging",{get:function(){return null!=this._agent.parent},enumerable:!0,configurable:!0}),e.prototype.startDrag=function(t,e,i,r){this._agent.parent||(this._sourceData=i,this._agent.url=e,n.GRoot.inst.addChild(this._agent),e=n.GRoot.inst.globalToLocal(n.GRoot.mouseX,n.GRoot.mouseY),this._agent.setXY(e.x,e.y),this._agent.startDrag(r))},e.prototype.cancel=function(){this._agent.parent&&(this._agent.stopDrag(),n.GRoot.inst.removeChild(this._agent),this._sourceData=null)},e.prototype.__dragEnd=function(t){if(null!=this._agent.parent){n.GRoot.inst.removeChild(this._agent);var e=this._sourceData;this._sourceData=null;for(var i=n.GRoot.inst.getObjectUnderPoint(t.stageX,t.stageY);i;){if(i.hasEventListener(n.DropEvent.DROP)){var r=new n.DropEvent(n.DropEvent.DROP,e);return i.requestFocus(),void i.dispatchEvent(r)}i=i.parent}}},e);function e(){this._agent=new n.GLoader,this._agent.draggable=!0,this._agent.touchable=!1,this._agent.setSize(100,100),this._agent.setPivot(.5,.5,!0),this._agent.align=n.AlignType.Center,this._agent.verticalAlign=n.VertAlignType.Middle,this._agent.sortingOrder=1e6,this._agent.addEventListener(n.DragEvent.DRAG_END,this.__dragEnd,this)}n.DragDropManager=t}(fgui=fgui||{}),function(t){var e;(e=t.ButtonMode||(t.ButtonMode={}))[e.Common=0]="Common",e[e.Check=1]="Check",e[e.Radio=2]="Radio",(e=t.AutoSizeType||(t.AutoSizeType={}))[e.None=0]="None",e[e.Both=1]="Both",e[e.Height=2]="Height",(e=t.AlignType||(t.AlignType={}))[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",(e=t.VertAlignType||(t.VertAlignType={}))[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom",(e=t.LoaderFillType||(t.LoaderFillType={}))[e.None=0]="None",e[e.Scale=1]="Scale",e[e.ScaleMatchHeight=2]="ScaleMatchHeight",e[e.ScaleMatchWidth=3]="ScaleMatchWidth",e[e.ScaleFree=4]="ScaleFree",e[e.ScaleNoBorder=5]="ScaleNoBorder",(e=t.ListLayoutType||(t.ListLayoutType={}))[e.SingleColumn=0]="SingleColumn",e[e.SingleRow=1]="SingleRow",e[e.FlowHorizontal=2]="FlowHorizontal",e[e.FlowVertical=3]="FlowVertical",e[e.Pagination=4]="Pagination",(e=t.ListSelectionMode||(t.ListSelectionMode={}))[e.Single=0]="Single",e[e.Multiple=1]="Multiple",e[e.Multiple_SingleClick=2]="Multiple_SingleClick",e[e.None=3]="None",(e=t.OverflowType||(t.OverflowType={}))[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.Scroll=2]="Scroll",(e=t.PackageItemType||(t.PackageItemType={}))[e.Image=0]="Image",e[e.MovieClip=1]="MovieClip",e[e.Sound=2]="Sound",e[e.Component=3]="Component",e[e.Atlas=4]="Atlas",e[e.Font=5]="Font",e[e.Swf=6]="Swf",e[e.Misc=7]="Misc",e[e.Unknown=8]="Unknown",e[e.Spine=9]="Spine",e[e.DragonBones=10]="DragonBones",(e=t.ObjectType||(t.ObjectType={}))[e.Image=0]="Image",e[e.MovieClip=1]="MovieClip",e[e.Swf=2]="Swf",e[e.Graph=3]="Graph",e[e.Loader=4]="Loader",e[e.Group=5]="Group",e[e.Text=6]="Text",e[e.RichText=7]="RichText",e[e.InputText=8]="InputText",e[e.Component=9]="Component",e[e.List=10]="List",e[e.Label=11]="Label",e[e.Button=12]="Button",e[e.ComboBox=13]="ComboBox",e[e.ProgressBar=14]="ProgressBar",e[e.Slider=15]="Slider",e[e.ScrollBar=16]="ScrollBar",e[e.Tree=17]="Tree",e[e.Loader3D=18]="Loader3D",(e=t.ProgressTitleType||(t.ProgressTitleType={}))[e.Percent=0]="Percent",e[e.ValueAndMax=1]="ValueAndMax",e[e.Value=2]="Value",e[e.Max=3]="Max",(e=t.ScrollBarDisplayType||(t.ScrollBarDisplayType={}))[e.Default=0]="Default",e[e.Visible=1]="Visible",e[e.Auto=2]="Auto",e[e.Hidden=3]="Hidden",(e=t.ScrollType||(t.ScrollType={}))[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Both=2]="Both",(e=t.FlipType||(t.FlipType={}))[e.None=0]="None",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical",e[e.Both=3]="Both",(e=t.ChildrenRenderOrder||(t.ChildrenRenderOrder={}))[e.Ascent=0]="Ascent",e[e.Descent=1]="Descent",e[e.Arch=2]="Arch",(e=t.GroupLayoutType||(t.GroupLayoutType={}))[e.None=0]="None",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical",(e=t.PopupDirection||(t.PopupDirection={}))[e.Auto=0]="Auto",e[e.Up=1]="Up",e[e.Down=2]="Down",(e=t.RelationType||(t.RelationType={}))[e.Left_Left=0]="Left_Left",e[e.Left_Center=1]="Left_Center",e[e.Left_Right=2]="Left_Right",e[e.Center_Center=3]="Center_Center",e[e.Right_Left=4]="Right_Left",e[e.Right_Center=5]="Right_Center",e[e.Right_Right=6]="Right_Right",e[e.Top_Top=7]="Top_Top",e[e.Top_Middle=8]="Top_Middle",e[e.Top_Bottom=9]="Top_Bottom",e[e.Middle_Middle=10]="Middle_Middle",e[e.Bottom_Top=11]="Bottom_Top",e[e.Bottom_Middle=12]="Bottom_Middle",e[e.Bottom_Bottom=13]="Bottom_Bottom",e[e.Width=14]="Width",e[e.Height=15]="Height",e[e.LeftExt_Left=16]="LeftExt_Left",e[e.LeftExt_Right=17]="LeftExt_Right",e[e.RightExt_Left=18]="RightExt_Left",e[e.RightExt_Right=19]="RightExt_Right",e[e.TopExt_Top=20]="TopExt_Top",e[e.TopExt_Bottom=21]="TopExt_Bottom",e[e.BottomExt_Top=22]="BottomExt_Top",e[e.BottomExt_Bottom=23]="BottomExt_Bottom",e[e.Size=24]="Size",(e=t.FillMethod||(t.FillMethod={}))[e.None=0]="None",e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical",e[e.Radial90=3]="Radial90",e[e.Radial180=4]="Radial180",e[e.Radial360=5]="Radial360",(e=t.FillOrigin||(t.FillOrigin={}))[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight",(e=t.FillOrigin90||(t.FillOrigin90={}))[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight",(t=t.ObjectPropID||(t.ObjectPropID={}))[t.Text=0]="Text",t[t.Icon=1]="Icon",t[t.Color=2]="Color",t[t.OutlineColor=3]="OutlineColor",t[t.Playing=4]="Playing",t[t.Frame=5]="Frame",t[t.DeltaTime=6]="DeltaTime",t[t.TimeScale=7]="TimeScale",t[t.FontSize=8]="FontSize",t[t.Selected=9]="Selected"}(fgui=fgui||{}),function(o){var r,t=(r=egret.EventDispatcher,__extends(a,r),a.getPreRes=function(){return[]},Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(t){this.setXY(t,this._y)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(t){this.setXY(this._x,t)},enumerable:!0,configurable:!0}),a.prototype.setXY=function(t,e){var i,r;this._x==t&&this._y==e||(i=t-this._x,r=e-this._y,this._x=t,this._y=e,this.handleXYChanged(),this instanceof o.GGroup&&this.moveChildren(i,r),this.updateGear(1),!this._parent||this._parent instanceof o.GList||(this._parent.setBoundsChangedFlag(),this._group&&this._group.setBoundsChangedFlag(!0),this.dispatchEventWith(a.XY_CHANGED)),a.draggingObject!=this||s||this.localToGlobalRect(0,0,this._width,this._height,l))},Object.defineProperty(a.prototype,"xMin",{get:function(){return this._pivotAsAnchor?this._x-this._width*this._pivotX:this._x},set:function(t){this._pivotAsAnchor?this.setXY(t+this._width*this._pivotX,this._y):this.setXY(t,this._y)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"yMin",{get:function(){return this._pivotAsAnchor?this._y-this._height*this._pivotY:this._y},set:function(t){this._pivotAsAnchor?this.setXY(this._x,t+this._height*this._pivotY):this.setXY(this._x,t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pixelSnapping",{get:function(){return this._pixelSnapping},set:function(t){this._pixelSnapping!=t&&(this._pixelSnapping=t,this.handleXYChanged())},enumerable:!0,configurable:!0}),a.prototype.center=function(t){var e=this._parent?this.parent:this.root;this.setXY((e.width-this._width)/2,(e.height-this._height)/2),t&&(this.addRelation(e,o.RelationType.Center_Center),this.addRelation(e,o.RelationType.Middle_Middle))},Object.defineProperty(a.prototype,"width",{get:function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._width},set:function(t){this.setSize(t,this._rawHeight)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.ensureSizeCorrect(),this._relations.sizeDirty&&this._relations.ensureRelationsSizeCorrect(),this._height},set:function(t){this.setSize(this._rawWidth,t)},enumerable:!0,configurable:!0}),a.prototype.setSize=function(t,e,i){var r,n;this._rawWidth==t&&this._rawHeight==e||(this._rawWidth=t,this._rawHeight=e,t<this.minWidth&&(t=this.minWidth),e<this.minHeight&&(e=this.minHeight),0<this.maxWidth&&t>this.maxWidth&&(t=this.maxWidth),0<this.maxHeight&&e>this.maxHeight&&(e=this.maxHeight),r=t-this._width,n=e-this._height,this._width=t,this._height=e,this.handleSizeChanged(),0==this._pivotX&&0==this._pivotY||(this._pivotAsAnchor?this.applyPivot():(i||this.setXY(this.x-this._pivotX*r,this.y-this._pivotY*n),this.updatePivotOffset())),this instanceof o.GGroup&&this.resizeChildren(r,n),this.updateGear(2),this._parent&&(this._relations.onOwnerSizeChanged(r,n,this._pivotAsAnchor||!i),this._parent.setBoundsChangedFlag(),this._group&&this._group.setBoundsChangedFlag()),this.dispatchEventWith(a.SIZE_CHANGED))},a.prototype.makeFullScreen=function(){this.setSize(o.GRoot.inst.width,o.GRoot.inst.height)},a.prototype.ensureSizeCorrect=function(){},Object.defineProperty(a.prototype,"actualWidth",{get:function(){return this.width*Math.abs(this._scaleX)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"actualHeight",{get:function(){return this.height*Math.abs(this._scaleY)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scaleX",{get:function(){return this._scaleX},set:function(t){this.setScale(t,this._scaleY)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scaleY",{get:function(){return this._scaleY},set:function(t){this.setScale(this._scaleX,t)},enumerable:!0,configurable:!0}),a.prototype.setScale=function(t,e){this._scaleX==t&&this._scaleY==e||(this._scaleX=t,this._scaleY=e,this.handleScaleChanged(),this.applyPivot(),this.updateGear(2))},Object.defineProperty(a.prototype,"skewX",{get:function(){return this._skewX},set:function(t){this.setSkew(t,this._skewY)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"skewY",{get:function(){return this._skewY},set:function(t){this.setSkew(this._skewX,t)},enumerable:!0,configurable:!0}),a.prototype.setSkew=function(t,e){this._skewX==t&&this._skewY==e||(this._skewX=t,this._skewY=e,this._displayObject&&(this._displayObject.skewX=t,this._displayObject.skewY=e),this.applyPivot())},Object.defineProperty(a.prototype,"pivotX",{get:function(){return this._pivotX},set:function(t){this.setPivot(t,this._pivotY)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pivotY",{get:function(){return this._pivotY},set:function(t){this.setPivot(this._pivotX,t)},enumerable:!0,configurable:!0}),a.prototype.setPivot=function(t,e,i){this._pivotX==t&&this._pivotY==e&&this._pivotAsAnchor==i||(this._pivotX=t,this._pivotY=e,this._pivotAsAnchor=i,this.updatePivotOffset(),this.handleXYChanged())},Object.defineProperty(a.prototype,"pivotAsAnchor",{get:function(){return this._pivotAsAnchor},enumerable:!0,configurable:!0}),a.prototype.internalSetPivot=function(t,e,i){this._pivotX=t,this._pivotY=e,(this._pivotAsAnchor=i)&&this.handleXYChanged()},a.prototype.updatePivotOffset=function(){var t,e;this._displayObject&&(0!=this._pivotX||0!=this._pivotY?(t=this._pivotX*this._width,e=this._pivotY*this._height,e=this._displayObject.matrix.transformPoint(t,e,u),this._pivotOffsetX=this._pivotX*this._width-(e.x-this._displayObject.x),this._pivotOffsetY=this._pivotY*this._height-(e.y-this._displayObject.y)):(this._pivotOffsetX=0,this._pivotOffsetY=0))},a.prototype.applyPivot=function(){0==this._pivotX&&0==this._pivotY||(this.updatePivotOffset(),this.handleXYChanged())},Object.defineProperty(a.prototype,"touchable",{get:function(){return this._touchable},set:function(t){this._touchable!=t&&(this._touchable=t,this.updateGear(3),this instanceof o.GImage||this instanceof o.GMovieClip||!(!(this instanceof o.GTextField)||this instanceof o.GTextInput||this instanceof o.GRichTextField)||this._displayObject&&(this._displayObject.touchEnabled=this._touchable,this._displayObject instanceof egret.DisplayObjectContainer&&(this._displayObject.touchChildren=this._touchable)))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"grayed",{get:function(){return this._grayed},set:function(t){this._grayed!=t&&(this._grayed=t,this.handleGrayedChanged(),this.updateGear(3))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"enabled",{get:function(){return!this._grayed&&this._touchable},set:function(t){this.grayed=!t,this.touchable=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!=t&&(this._rotation=t,this._displayObject&&(this._displayObject.rotation=this.normalizeRotation),this.applyPivot(),this.updateGear(3))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"normalizeRotation",{get:function(){var t=this._rotation%360;return 180<t?t-=360:t<-180&&(t+=360),t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!=t&&(this._alpha=t,this.handleAlphaChanged(),this.updateGear(3))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!=t&&(this._visible=t,this.handleVisibleChanged(),this._parent&&this._parent.setBoundsChangedFlag(),this._group&&this._group.excludeInvisibles&&this._group.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"internalVisible",{get:function(){return this._internalVisible&&(!this._group||this._group.internalVisible)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"internalVisible2",{get:function(){return this._visible&&(!this._group||this._group.internalVisible2)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"internalVisible3",{get:function(){return this._visible&&this._internalVisible},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sortingOrder",{get:function(){return this._sortingOrder},set:function(t){var e;this._sortingOrder!=(t=t<0?0:t)&&(e=this._sortingOrder,this._sortingOrder=t,this._parent&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"focused",{get:function(){return this.root.focus==this},enumerable:!0,configurable:!0}),a.prototype.requestFocus=function(){this.root.focus=this},Object.defineProperty(a.prototype,"tooltips",{get:function(){return this._tooltips},set:function(t){this._tooltips=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"blendMode",{get:function(){return this._displayObject.blendMode},set:function(t){this._displayObject.blendMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"filters",{get:function(){return this._displayObject.filters},set:function(t){this._displayObject.filters=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"inContainer",{get:function(){return null!=this._displayObject&&null!=this._displayObject.parent},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onStage",{get:function(){return null!=this._displayObject&&null!=this._displayObject.stage},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"resourceURL",{get:function(){return this.packageItem?"ui://"+this.packageItem.owner.id+this.packageItem.id:null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"group",{get:function(){return this._group},set:function(t){this._group!=t&&(this._group&&this._group.setBoundsChangedFlag(),this._group=t,this._group&&this._group.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),a.prototype.getGear=function(t){var e=this._gears[t];return null==e&&(this._gears[t]=e=o.GearBase.create(this,t)),e},a.prototype.updateGear=function(t){this._underConstruct||this._gearLocked||(t=this._gears[t])&&t.controller&&t.updateState()},a.prototype.checkGearController=function(t,e){return null!=this._gears[t]&&this._gears[t].controller==e},a.prototype.updateGearFromRelations=function(t,e,i){this._gears[t]&&this._gears[t].updateFromRelations(e,i)},a.prototype.addDisplayLock=function(){var t=this._gears[0];if(t&&t.controller){t=t.addLock();return this.checkGearDisplay(),t}return 0},a.prototype.releaseDisplayLock=function(t){var e=this._gears[0];e&&e.controller&&(e.releaseLock(t),this.checkGearDisplay())},a.prototype.checkGearDisplay=function(){var t;this._handlingController||(t=null==this._gears[0]||this._gears[0].connected,(t=this._gears[8]?this._gears[8].evaluate(t):t)!=this._internalVisible&&(this._internalVisible=t,this._parent&&this._parent.childStateChanged(this),this._group&&this._group.excludeInvisibles&&this._group.setBoundsChangedFlag()))},Object.defineProperty(a.prototype,"gearXY",{get:function(){return this.getGear(1)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"gearSize",{get:function(){return this.getGear(2)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"gearLook",{get:function(){return this.getGear(3)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"relations",{get:function(){return this._relations},enumerable:!0,configurable:!0}),a.prototype.addRelation=function(t,e,i){this._relations.add(t,e,i)},a.prototype.removeRelation=function(t,e){this._relations.remove(t,e||0)},Object.defineProperty(a.prototype,"displayObject",{get:function(){return this._displayObject},enumerable:!0,configurable:!0}),a.prototype.setDisplayObject=function(t){this._displayObject!=t&&(this._displayObject&&delete this._displayObject.$owner,this._displayObject=t,this._displayObject.$owner=this)},Object.defineProperty(a.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent=t},enumerable:!0,configurable:!0}),a.prototype.removeFromParent=function(){this._parent&&this._parent.removeChild(this)},Object.defineProperty(a.prototype,"root",{get:function(){if(this instanceof o.GRoot)return this;for(var t=this._parent;t;){if(t instanceof o.GRoot)return t;t=t.parent}return o.GRoot.inst},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asCom",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asButton",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asLabel",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asProgress",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asTextField",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asRichTextField",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asTextInput",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asLoader",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asList",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asTree",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asGraph",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asGroup",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asSlider",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asComboBox",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asImage",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"asMovieClip",{get:function(){return this},enumerable:!0,configurable:!0}),a.cast=function(t){return t.$owner},Object.defineProperty(a.prototype,"text",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"icon",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isDisposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"treeNode",{get:function(){return this._treeNode},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){if(!this._disposed){this._disposed=!0,this.removeFromParent(),this._relations.dispose(),this._displayObject=null;for(var t=0;t<10;t++){var e=this._gears[t];e&&e.dispose()}}},a.prototype.addClickListener=function(t,e){this.addEventListener(egret.TouchEvent.TOUCH_TAP,t,e)},a.prototype.removeClickListener=function(t,e){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,t,e)},a.prototype.hasClickListener=function(){return this.hasEventListener(egret.TouchEvent.TOUCH_TAP)},a.prototype.addEventListener=function(t,e,i){r.prototype.addEventListener.call(this,t,e,i),this._displayObject&&this._displayObject.addEventListener(t,this._reDispatch,this)},a.prototype.removeEventListener=function(t,e,i){r.prototype.removeEventListener.call(this,t,e,i),this._displayObject&&!this.hasEventListener(t)&&this._displayObject.removeEventListener(t,this._reDispatch,this)},a.prototype._reDispatch=function(t){this.dispatchEvent(t)},Object.defineProperty(a.prototype,"draggable",{get:function(){return this._draggable},set:function(t){this._draggable!=t&&(this._draggable=t,this.initDrag())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dragBounds",{get:function(){return this._dragBounds},set:function(t){this._dragBounds=t},enumerable:!0,configurable:!0}),a.prototype.startDrag=function(t,e,i){null!=this._displayObject.stage&&this.dragBegin(t,e,i)},a.prototype.stopDrag=function(){this.dragEnd()},Object.defineProperty(a.prototype,"dragging",{get:function(){return a.draggingObject==this},enumerable:!0,configurable:!0}),a.prototype.localToGlobal=function(t,e,i){return this._displayObject?(t=t||0,e=e||0,this._pivotAsAnchor&&(t+=this._pivotX*this._width,e+=this._pivotY*this._height),this._displayObject.localToGlobal(t,e,i)):new egret.Point},a.prototype.globalToLocal=function(t,e,i){if(!this._displayObject)return new egret.Point;i=this._displayObject.globalToLocal(t=t||0,e=e||0,i);return this._pivotAsAnchor&&(i.x-=this._pivotX*this._width,i.y-=this._pivotY*this._height),i},a.prototype.localToRoot=function(t,e,i){if(!this._displayObject)return new egret.Point;i=this._displayObject.localToGlobal(t=t||0,e=e||0,i);return i.x/=o.GRoot.contentScaleFactor,i.y/=o.GRoot.contentScaleFactor,i},a.prototype.rootToLocal=function(t,e,i){return this._displayObject?(t=t||0,e=e||0,t*=o.GRoot.contentScaleFactor,e*=o.GRoot.contentScaleFactor,this._displayObject.globalToLocal(t,e,i)):new egret.Point},a.prototype.localToGlobalRect=function(t,e,i,r,n){t=t||0,e=e||0,i=i||0,r=r||0,n=n||new egret.Rectangle;var o=this.localToGlobal(t,e);return n.x=o.x,n.y=o.y,o=this.localToGlobal(t+i,e+r),n.right=o.x,n.bottom=o.y,n},a.prototype.globalToLocalRect=function(t,e,i,r,n){t=t||0,e=e||0,i=i||0,r=r||0,n=n||new egret.Rectangle;var o=this.globalToLocal(t,e);return n.x=o.x,n.y=o.y,o=this.globalToLocal(t+i,e+r),n.right=o.x,n.bottom=o.y,n},a.prototype.handleControllerChanged=function(t){this._handlingController=!0;for(var e=0;e<10;e++){var i=this._gears[e];i&&i.controller==t&&i.apply()}this._handlingController=!1,this.checkGearDisplay()},a.prototype.createDisplayObject=function(){},a.prototype.switchDisplayObject=function(t){var e,i;this.displayObject&&t!=this._displayObject&&(e=this._displayObject,this._displayObject&&this._displayObject.parent&&(i=this._displayObject.parent.getChildIndex(this._displayObject),this._displayObject.parent.addChildAt(t,i),this._displayObject.parent.removeChild(this._displayObject)),this._displayObject=t,this._displayObject.x=e.x,this._displayObject.y=e.y,this._displayObject.rotation=e.rotation,this._displayObject.alpha=e.alpha,this._displayObject.visible=e.visible,this._displayObject.touchEnabled=e.touchEnabled,this._displayObject.scaleX=e.scaleX,this._displayObject.scaleY=e.scaleY,o.ToolSet.setColorFilter(this._displayObject,this._grayed),this._displayObject instanceof egret.DisplayObjectContainer&&(this._displayObject.touchChildren=this._touchable))},a.prototype.handleXYChanged=function(){var t,e;this._displayObject&&(t=this._x,e=this._y,this._pivotAsAnchor&&(t-=this._pivotX*this._width,e-=this._pivotY*this._height),this._pixelSnapping&&(t=Math.round(t),e=Math.round(e)),this._displayObject.x=t+this._pivotOffsetX,this._displayObject.y=e+this._pivotOffsetY)},a.prototype.handleSizeChanged=function(){this._displayObject&&(this._displayObject.width=this._width,this._displayObject.height=this._height)},a.prototype.handleScaleChanged=function(){this._displayObject&&(this._displayObject.scaleX=this._scaleX,this._displayObject.scaleY=this._scaleY)},a.prototype.handleGrayedChanged=function(){this._displayObject&&o.ToolSet.setColorFilter(this._displayObject,this._grayed)},a.prototype.handleAlphaChanged=function(){this._displayObject&&(this._displayObject.alpha=this._alpha)},a.prototype.handleVisibleChanged=function(){this._displayObject&&(this._displayObject.visible=this.internalVisible2),this instanceof o.GGroup&&this.handleVisibleChanged()},a.prototype.getProp=function(t){switch(t){case o.ObjectPropID.Text:return this.text;case o.ObjectPropID.Icon:return this.icon;case o.ObjectPropID.Color:case o.ObjectPropID.OutlineColor:return NaN;case o.ObjectPropID.Playing:return!1;case o.ObjectPropID.Frame:case o.ObjectPropID.DeltaTime:return 0;case o.ObjectPropID.TimeScale:return 1;case o.ObjectPropID.FontSize:return 0;case o.ObjectPropID.Selected:return!1;default:return}},a.prototype.setProp=function(t,e){switch(t){case o.ObjectPropID.Text:this.text=e;break;case o.ObjectPropID.Icon:this.icon=e}},a.prototype.constructFromResource=function(){},a.prototype.setup_beforeAdd=function(t,e){t.seek(e,0),t.skip(5),this._id=t.readS(),this._name=t.readS(),i=t.readInt(),e=t.readInt(),this.setXY(i,e),t.readBool()&&(this.initWidth=t.readInt(),this.initHeight=t.readInt(),this instanceof o.GList&&(this.initHeight=this.initHeight+1),this.setSize(this.initWidth,this.initHeight,!0)),t.readBool()&&(this.minWidth=t.readInt(),this.maxWidth=t.readInt(),this.minHeight=t.readInt(),this.maxHeight=t.readInt()),t.readBool()&&(i=t.readFloat(),e=t.readFloat(),this.setScale(i,e)),t.readBool()&&(i=t.readFloat(),e=t.readFloat(),this.setSkew(i,e)),t.readBool()&&(i=t.readFloat(),e=t.readFloat(),this.setPivot(i,e,t.readBool())),1!=(i=t.readFloat())&&(this.alpha=i),0!=(i=t.readFloat())&&(this.rotation=i),t.readBool()||(this.visible=!1),t.readBool()||(this.touchable=!1),t.readBool()&&(this.grayed=!0);var i=t.readByte();2==i?this.blendMode=egret.BlendMode.ADD:5==i&&(this.blendMode=egret.BlendMode.ERASE),1==t.readByte()&&this._displayObject&&o.ToolSet.setColorFilter(this._displayObject,[t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()]);t=t.readS();null!=t&&(this.data=t)},a.prototype.setup_afterAdd=function(t,e){t.seek(e,1);var i=t.readS();null!=i&&(this.tooltips=i);i=t.readShort();0<=i&&(this.group=this.parent.getChildAt(i)),t.seek(e,2);for(var r=t.readShort(),n=0;n<r;n++){var o=t.readShort();o+=t.position,this.getGear(t.readByte()).setup(t),t.position=o}},a.prototype.initDrag=function(){this._draggable?this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__begin,this):this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__begin,this)},a.prototype.dragBegin=function(t,e,i){var r,n;a.draggingObject&&((r=a.draggingObject).stopDrag(),a.draggingObject=null,(n=new o.DragEvent(o.DragEvent.DRAG_END)).stageX=e||o.GRoot.mouseX,n.stageY=i||o.GRoot.mouseY,n.touchPointID=t||0,r.dispatchEvent(n)),h.x=e||o.GRoot.mouseX,h.y=i||o.GRoot.mouseY,this.localToGlobalRect(0,0,this._width,this._height,l),this._dragTesting=!0,a.draggingObject=this,o.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving,this),o.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__end,this)},a.prototype.dragEnd=function(){a.draggingObject==this&&(this.reset(),this._dragTesting=!1,a.draggingObject=null)},a.prototype.reset=function(){o.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving,this),o.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__end,this)},a.prototype.__begin=function(t){null==this._dragStartPos&&(this._dragStartPos=new egret.Point),this._dragStartPos.x=t.stageX,this._dragStartPos.y=t.stageY,this._dragTesting=!0,o.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__moving,this),o.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__end,this)},a.prototype.__moving=function(t){if(a.draggingObject!=this&&this._draggable&&this._dragTesting){var e=o.UIConfig.touchDragSensitivity;if(this._dragStartPos&&Math.abs(this._dragStartPos.x-t.stageX)<e&&Math.abs(this._dragStartPos.y-t.stageY)<e)return;this._dragTesting=!1,(n=new o.DragEvent(o.DragEvent.DRAG_START)).stageX=t.stageX,n.stageY=t.stageY,n.touchPointID=t.touchPointID,this.dispatchEvent(n),n.isDefaultPrevented()||this.dragBegin(t.touchPointID,t.stageX,t.stageY)}var i,r,n;a.draggingObject==this&&(i=t.stageX-h.x+l.x,r=t.stageY-h.y+l.y,this._dragBounds&&((i<(e=o.GRoot.inst.localToGlobalRect(this._dragBounds.x,this._dragBounds.y,this._dragBounds.width,this._dragBounds.height,c)).x||i+l.width>e.right&&(i=e.right-l.width)<e.x)&&(i=e.x),(r<e.y||r+l.height>e.bottom&&(r=e.bottom-l.height)<e.y)&&(r=e.y)),s=!0,r=this.parent.globalToLocal(i,r,u),this.setXY(Math.round(r.x),Math.round(r.y)),s=!1,(n=new o.DragEvent(o.DragEvent.DRAG_MOVING)).stageX=t.stageX,n.stageY=t.stageY,n.touchPointID=t.touchPointID,this.dispatchEvent(n))},a.prototype.__end=function(t){var e;a.draggingObject==this?(a.draggingObject=null,this.reset(),(e=new o.DragEvent(o.DragEvent.DRAG_END)).stageX=t.stageX,e.stageY=t.stageY,e.touchPointID=t.touchPointID,this.dispatchEvent(e)):this._dragTesting&&(this._dragTesting=!1,this.reset())},a.XY_CHANGED="__xyChanged",a.SIZE_CHANGED="__sizeChanged",a.SIZE_DELAY_CHANGE="__sizeDelayChange",a.GEAR_STOP="gearStop",a);function a(){var t=r.call(this)||this;return t._x=0,t._y=0,t._alpha=1,t._rotation=0,t._visible=!0,t._touchable=!0,t._scaleX=1,t._scaleY=1,t._skewX=0,t._skewY=0,t._pivotX=0,t._pivotY=0,t._pivotOffsetX=0,t._pivotOffsetY=0,t._sortingOrder=0,t._internalVisible=!0,t._disposed=!1,t.sourceWidth=0,t.sourceHeight=0,t.initWidth=0,t.initHeight=0,t.minWidth=0,t.minHeight=0,t.maxWidth=0,t.maxHeight=0,t._width=0,t._height=0,t._rawWidth=0,t._rawHeight=0,t._sizePercentInGroup=0,t._id=""+e++,t._name="",t.createDisplayObject(),t._relations=new o.Relations(t),t._gears=new Array(10),t}o.GObject=t;var s,e=0,h=new egret.Point,l=new egret.Rectangle,u=new egret.Point,c=new egret.Rectangle}(fgui=fgui||{}),function(T){var l,t=(l=T.GObject,__extends(a,l),a.prototype.createDisplayObject=function(){this._rootContainer=new T.UIContainer,this.setDisplayObject(this._rootContainer),this._container=this._rootContainer},a.prototype.dispose=function(){for(var t=this._transitions.length,e=0;e<t;++e)this._transitions[e].dispose();for(t=this._controllers.length,e=0;e<t;++e)this._controllers[e].dispose();for(this._scrollPane&&this._scrollPane.dispose(),e=(t=this._children.length)-1;0<=e;--e){var i=this._children[e];i.parent=null,i.dispose()}this._boundsChanged=!1,l.prototype.dispose.call(this)},Object.defineProperty(a.prototype,"displayListContainer",{get:function(){return this._container},enumerable:!0,configurable:!0}),a.prototype.addChild=function(t){return this.addChildAt(t,this._children.length),t},a.prototype.addChildAt=function(t,e){if(void 0===e&&(e=0),t){var i=this._children.length;if(0<=e&&e<=i)return t.parent==this?this.setChildIndex(t,e):(t.removeFromParent(),i=(t.parent=this)._children.length,0!=t.sortingOrder?(this._sortingChildCount++,e=this.getInsertPosForSortingChild(t)):0<this._sortingChildCount&&e>i-this._sortingChildCount&&(e=i-this._sortingChildCount),e==i?this._children.push(t):this._children.splice(e,0,t),this.childStateChanged(t),this.setBoundsChangedFlag()),t;throw"Invalid child index"}console.error("child is null")},a.prototype.getInsertPosForSortingChild=function(t){for(var e=this._children.length,i=0,i=0;i<e;i++){var r=this._children[i];if(r!=t&&t.sortingOrder<r.sortingOrder)break}return i},a.prototype.removeChild=function(t,e){var i=this._children.indexOf(t);return-1!=i&&this.removeChildAt(i,e),t},a.prototype.removeChildAt=function(t,e){if(0<=t&&t<this.numChildren){var i=this._children[t];return i.parent=null,0!=i.sortingOrder&&this._sortingChildCount--,this._children.splice(t,1),i.group=null,i.inContainer&&(this._container.removeChild(i.displayObject),this._childrenRenderOrder==T.ChildrenRenderOrder.Arch&&T.GTimers.inst.callLater(this.buildNativeDisplayList,this)),e&&i.dispose(),this.setBoundsChangedFlag(),i}throw"Invalid child index"},a.prototype.removeChildren=function(t,e,i){((e=null==e?-1:e)<0||e>=this.numChildren)&&(e=this.numChildren-1);for(var r=t=null==t?0:t;r<=e;++r)this.removeChildAt(t,i)},a.prototype.getChildAt=function(t){if(0<=t&&t<this.numChildren)return this._children[t];throw"Invalid child index"},a.prototype.getChild=function(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null},a.prototype.getChildByPath=function(t){for(var e,i=t.split("."),r=i.length,n=this,o=0;o<r&&(e=n.getChild(i[o]));++o)if(o!=r-1){if(!(e instanceof a)){e=null;break}n=e}return e},a.prototype.getVisibleChild=function(t){for(var e=this._children.length,i=0;i<e;++i){var r=this._children[i];if(r.internalVisible&&r.internalVisible&&r.name==t)return r}return null},a.prototype.getChildInGroup=function(t,e){for(var i=this._children.length,r=0;r<i;++r){var n=this._children[r];if(n.group==e&&n.name==t)return n}return null},a.prototype.getChildById=function(t){for(var e=this._children.length,i=0;i<e;++i)if(this._children[i]._id==t)return this._children[i];return null},a.prototype.getChildIndex=function(t){return this._children.indexOf(t)},a.prototype.setChildIndex=function(t,e){var i,r=this._children.indexOf(t);if(-1==r)throw"Not a child of this container";0==t.sortingOrder&&(i=this._children.length,0<this._sortingChildCount&&e>i-this._sortingChildCount-1&&(e=i-this._sortingChildCount-1),this._setChildIndex(t,r,e))},a.prototype.setChildIndexBefore=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";if(0!=t.sortingOrder)return i;var r=this._children.length;return i<(e=0<this._sortingChildCount&&e>r-this._sortingChildCount-1?r-this._sortingChildCount-1:e)?this._setChildIndex(t,i,e-1):this._setChildIndex(t,i,e)},a.prototype._setChildIndex=function(t,e,i){var r=this._children.length;if(e==(i=r<i?r:i))return e;if(this._children.splice(e,1),this._children.splice(i,0,t),t.inContainer){var n,o=0;if(this._childrenRenderOrder==T.ChildrenRenderOrder.Ascent){for(n=0;n<i;n++)this._children[n].inContainer&&o++;o==this._container.numChildren&&o--,this._container.setChildIndex(t.displayObject,o)}else if(this._childrenRenderOrder==T.ChildrenRenderOrder.Descent){for(n=r-1;i<n;n--)this._children[n].inContainer&&o++;o==this._container.numChildren&&o--,this._container.setChildIndex(t.displayObject,o)}else T.GTimers.inst.callLater(this.buildNativeDisplayList,this);this.setBoundsChangedFlag()}return i},a.prototype.swapChildren=function(t,e){t=this._children.indexOf(t),e=this._children.indexOf(e);if(-1==t||-1==e)throw"Not a child of this container";this.swapChildrenAt(t,e)},a.prototype.swapChildrenAt=function(t,e){var i=this._children[t],r=this._children[e];this.setChildIndex(i,e),this.setChildIndex(r,t)},Object.defineProperty(a.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),a.prototype.isAncestorOf=function(t){if(!t)return!1;for(var e=t.parent;e;){if(e==this)return!0;e=e.parent}return!1},a.prototype.addController=function(t){this._controllers.push(t),(t.parent=this).applyController(t)},a.prototype.getControllerAt=function(t){return this._controllers[t]},a.prototype.getController=function(t){for(var e=this._controllers.length,i=0;i<e;++i){var r=this._controllers[i];if(r.name==t)return r}return null},a.prototype.removeController=function(t){var e=this._controllers.indexOf(t);if(-1==e)throw"controller not exists";t.parent=null,this._controllers.splice(e,1);for(var i=this._children.length,r=0;r<i;r++)this._children[r].handleControllerChanged(t)},Object.defineProperty(a.prototype,"controllers",{get:function(){return this._controllers},enumerable:!0,configurable:!0}),a.prototype.childStateChanged=function(t){if(!this._buildingDisplayList){var e,i,r=this._children.length;if(t instanceof T.GGroup)for(i=0;i<r;i++)(e=this._children[i]).group==t&&this.childStateChanged(e);else if(t.displayObject)if(t.internalVisible){if(!t.displayObject.parent){var n=0;if(this._childrenRenderOrder==T.ChildrenRenderOrder.Ascent){for(i=0;i<r&&(e=this._children[i])!=t;i++)e.displayObject&&e.displayObject.parent&&n++;this._container.addChildAt(t.displayObject,n)}else if(this._childrenRenderOrder==T.ChildrenRenderOrder.Descent){for(i=r-1;0<=i&&(e=this._children[i])!=t;i--)e.displayObject&&e.displayObject.parent&&n++;this._container.addChildAt(t.displayObject,n)}else this._container.addChild(t.displayObject),T.GTimers.inst.callLater(this.buildNativeDisplayList,this)}}else t.displayObject.parent&&this._container.removeChild(t.displayObject)}},a.prototype.buildNativeDisplayList=function(){var t,e=this._children.length;if(0!=e)switch(this._childrenRenderOrder){case T.ChildrenRenderOrder.Ascent:for(r=0;r<e;r++)(t=this._children[r]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject);break;case T.ChildrenRenderOrder.Descent:for(r=e-1;0<=r;r--)(t=this._children[r]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject);break;case T.ChildrenRenderOrder.Arch:for(var i=T.ToolSet.clamp(this._apexIndex,0,e),r=0;r<i;r++)(t=this._children[r]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject);for(r=e-1;i<=r;r--)(t=this._children[r]).displayObject&&t.internalVisible&&this._container.addChild(t.displayObject)}},a.prototype.applyController=function(t){this._applyingController=t;for(var e=this._children.length,i=0;i<e;i++)this._children[i].handleControllerChanged(t);this._applyingController=null,t.runActions()},a.prototype.applyAllControllers=function(){for(var t=this._controllers.length,e=0;e<t;++e)this.applyController(this._controllers[e])},a.prototype.adjustRadioGroupDepth=function(t,e){for(var i,r=this._children.length,n=-1,o=-1,a=0;a<r;a++)(i=this._children[a])==t?n=a:i instanceof T.GButton&&i.relatedController==e&&o<a&&(o=a);n<o&&(this._applyingController&&this._children[o].handleControllerChanged(this._applyingController),this.swapChildrenAt(n,o))},a.prototype.getTransitionAt=function(t){return this._transitions[t]},a.prototype.getTransition=function(t){for(var e=this._transitions.length,i=0;i<e;++i){var r=this._transitions[i];if(r.name==t)return r}return null},a.prototype.isChildInView=function(t){return this._rootContainer.scrollRect?0<=t.x+t.width&&t.x<=this.width&&0<=t.y+t.height&&t.y<=this.height:!this._scrollPane||this._scrollPane.isChildInView(t)},a.prototype.getFirstChildInView=function(){for(var t=this._children.length,e=0;e<t;++e){var i=this._children[e];if(this.isChildInView(i))return e}return-1},Object.defineProperty(a.prototype,"scrollPane",{get:function(){return this._scrollPane},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"opaque",{get:function(){return this._rootContainer.opaque},set:function(t){this._rootContainer.opaque=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"margin",{get:function(){return this._margin},set:function(t){this._margin.copy(t),this._rootContainer.scrollRect&&(this._container.x=this._margin.left+this._alignOffset.x,this._container.y=this._margin.top+this._alignOffset.y),this.handleSizeChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"childrenRenderOrder",{get:function(){return this._childrenRenderOrder},set:function(t){this._childrenRenderOrder!=t&&(this._childrenRenderOrder=t,this.buildNativeDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"apexIndex",{get:function(){return this._apexIndex},set:function(t){this._apexIndex!=t&&(this._apexIndex=t,this._childrenRenderOrder==T.ChildrenRenderOrder.Arch&&this.buildNativeDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mask",{get:function(){return this._rootContainer.mask},set:function(t){this._rootContainer.mask=t,this.reversedMask&&(this._rootContainer.cacheAsBitmap=!0,this.mask.blendMode=egret.BlendMode.ERASE,this._rootContainer.mask=null)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"baseUserData",{get:function(){var t=this.packageItem.rawData;return t.seek(0,4),t.readS()},enumerable:!0,configurable:!0}),a.prototype.updateScrollRect=function(){var t=this._rootContainer.scrollRect;null==t&&(t=new egret.Rectangle);var e=this.width-this._margin.right,i=this.height-this._margin.bottom;t.setTo(0,0,e,i),this._rootContainer.scrollRect=t},a.prototype.setupScroll=function(t){this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this._scrollPane=new T.ScrollPane(this),this._scrollPane.setup(t),this.setBoundsChangedFlag()},a.prototype.setupOverflow=function(t){t==T.OverflowType.Hidden?(this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this.updateScrollRect(),this._container.x=this._margin.left,this._container.y=this._margin.top):0==this._margin.left&&0==this._margin.top||(this._rootContainer==this._container&&(this._container=new egret.DisplayObjectContainer,this._rootContainer.addChild(this._container)),this._container.x=this._margin.left,this._container.y=this._margin.top),this.setBoundsChangedFlag()},a.prototype.handleSizeChanged=function(){var t;l.prototype.handleSizeChanged.call(this),this._scrollPane?this._scrollPane.onOwnerSizeChanged():this._rootContainer.scrollRect&&this.updateScrollRect(),this._rootContainer.hitArea instanceof T.PixelHitTest&&(t=this._rootContainer.hitArea,0!=this.sourceWidth&&(t.scaleX=this._width/this.sourceWidth),0!=this.sourceHeight&&(t.scaleY=this._height/this.sourceHeight))},a.prototype.handleGrayedChanged=function(){var t=this.getController("grayed");if(t)t.selectedIndex=this.grayed?1:0;else for(var e=this.grayed,i=this._children.length,r=0;r<i;++r)this._children[r].grayed=e},a.prototype.handleControllerChanged=function(t){l.prototype.handleControllerChanged.call(this,t),this._scrollPane&&this._scrollPane.handleControllerChanged(t)},a.prototype.setBoundsChangedFlag=function(){(this._scrollPane||this._trackBounds)&&(this._boundsChanged||(this._boundsChanged=!0,egret.callLater(this.__render,this)))},a.prototype.__render=function(){if(this._boundsChanged){var t=this._children.length;if(0<t)for(var e=0;e<t;e++)this._children[e].ensureSizeCorrect();this.updateBounds()}},a.prototype.ensureBoundsCorrect=function(){var t=this._children.length;if(0<t)for(var e=0;e<t;e++)this._children[e].ensureSizeCorrect();this._boundsChanged&&this.updateBounds()},a.prototype.updateBounds=function(){var t=0,e=0,i=0,r=0,n=this._children.length;if(0<n){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=0,h=0,h=0;h<n;h++){var l=this._children[h];l.noScrollCalBound||((s=l.x)<t&&(t=s),(s=l.y)<e&&(e=s),o<(s=l.x+l.actualWidth)&&(o=s),a<(s=l.y+l.actualHeight)&&(a=s))}i=o-t,r=a-e}this.setBounds(t,e,i,r)},a.prototype.setBounds=function(t,e,i,r){void 0===r&&(r=0),this._boundsChanged=!1,this._scrollPane&&this._scrollPane.setContentSize(Math.round(t+i),Math.round(e+r))},Object.defineProperty(a.prototype,"viewWidth",{get:function(){return this._scrollPane?this._scrollPane.viewWidth:this.width-this._margin.left-this._margin.right},set:function(t){this._scrollPane?this._scrollPane.viewWidth=t:this.width=t+this._margin.left+this._margin.right},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"viewHeight",{get:function(){return this._scrollPane?this._scrollPane.viewHeight:this.height-this._margin.top-this._margin.bottom},set:function(t){this._scrollPane?this._scrollPane.viewHeight=t:this.height=t+this._margin.top+this._margin.bottom},enumerable:!0,configurable:!0}),a.prototype.getSnappingPosition=function(t,e,i){i=i||new egret.Point;var r=this._children.length;if(0==r)return i.x=0,i.y=0,i;this.ensureBoundsCorrect();var n=null,o=null,a=0;if(0!=e){for(;a<r;a++)if(e<(n=this._children[a]).y){if(0==a){e=0;break}e=(e<(o=this._children[a-1]).y+o.actualHeight/2?o:n).y;break}a==r&&(e=n.y)}if(0!=t){for(0<a&&a--;a<r;a++)if(t<(n=this._children[a]).x){if(0==a){t=0;break}t=(t<(o=this._children[a-1]).x+o.actualWidth/2?o:n).x;break}a==r&&(t=n.x)}return i.x=t,i.y=e,i},a.prototype.childSortingOrderChanged=function(t,e,i){0==(i=void 0===i?0:i)?(this._sortingChildCount--,this.setChildIndex(t,this._children.length)):(0==e&&this._sortingChildCount++,(i=this._children.indexOf(t))<(e=this.getInsertPosForSortingChild(t))?this._setChildIndex(t,i,e-1):this._setChildIndex(t,i,e))},a.prototype.constructFromResource=function(){this.constructFromResource2(null,0)},a.prototype.constructFromResource2=function(t,e){var i,r=this.packageItem.getBranch();r.decoded||(r.decoded=!0,T.TranslationHelper.translateComponent(r));var n=r.rawData;n.seek(0,0),this._underConstruct=!0,this.sourceWidth=n.readInt(),this.sourceHeight=n.readInt(),this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),n.readBool()&&(this.minWidth=n.readInt(),this.maxWidth=n.readInt(),this.minHeight=n.readInt(),this.maxHeight=n.readInt()),n.readBool()&&(o=n.readFloat(),y=n.readFloat(),this.internalSetPivot(o,y,n.readBool())),n.readBool()&&(this._margin.top=n.readInt(),this._margin.bottom=n.readInt(),this._margin.left=n.readInt(),this._margin.right=n.readInt());var o=n.readByte();o==T.OverflowType.Scroll?(m=n.position,n.seek(0,7),this.setupScroll(n),n.position=m):this.setupOverflow(o),n.readBool()&&n.skip(8),this._buildingDisplayList=!0,n.seek(0,1);for(var a,s=n.readShort(),h=0;h<s;h++){i=n.readShort(),i+=n.position;var l=new T.Controller;this._controllers.push(l),l.parent=this,l.setup(n),n.position=i}n.seek(0,2);var u=n.readShort();for(h=0;h<u;h++){var c,p,d,f,_=n.readShort(),g=n.position;t?a=t[e+h]:(n.seek(g,0),c=n.readByte(),p=n.readS(),d=n.readS(),(f=(f=null)!=p?(d=null!=d?T.UIPackage.getById(d):r.owner)?d.getItemById(p):null:f)?(a=T.UIObjectFactory.newObject(f)).constructFromResource():a=T.UIObjectFactory.newObject(c)),a._underConstruct=!0,a.setup_beforeAdd(n,g),(a.parent=this)._children.push(a),n.position=g+_}for(n.seek(0,3),this.relations.setup(n,!0),n.seek(0,2),n.skip(2),h=0;h<u;h++)i=n.readShort(),i+=n.position,n.seek(n.position,3),this._children[h].relations.setup(n,!1),n.position=i;for(n.seek(0,2),n.skip(2),h=0;h<u;h++)i=n.readShort(),i+=n.position,(a=this._children[h]).setup_afterAdd(n,n.position),a._underConstruct=!1,n.position=i;n.seek(0,4),n.skip(2),this.opaque=n.readBool();var y=n.readShort();-1!=y&&(this.reversedMask=n.readBool(),this.mask=this.getChildAt(y).displayObject);var m=n.readS(),o=n.readInt(),y=n.readInt();null!=m?(f=r.owner.getItemById(m))&&f.pixelHitTestData&&(this._rootContainer.hitArea=new T.PixelHitTest(f.pixelHitTestData,o,y)):0!=o&&-1!=y&&(this._rootContainer.hitArea=this.getChildAt(y).displayObject),n.seek(0,5);var v=n.readShort();for(h=0;h<v;h++){i=n.readShort(),i+=n.position;var b=new T.Transition(this);b.setup(n),this._transitions.push(b),n.position=i}0<this._transitions.length&&(this.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,this.___added,this),this.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.___removed,this)),this.applyAllControllers(),this._buildingDisplayList=!1,this._underConstruct=!1,this.buildNativeDisplayList(),this.setBoundsChangedFlag(),r.objectType!=T.ObjectType.Component&&this.constructExtension(n),this.onConstruct()},a.prototype.onConstruct=function(){this.constructFromXML(null)},a.prototype.constructExtension=function(t){},a.prototype.constructFromXML=function(t){},a.prototype.setup_afterAdd=function(t,e){l.prototype.setup_afterAdd.call(this,t,e),t.seek(e,4);e=t.readShort();-1!=e&&this._scrollPane&&(this._scrollPane.pageController=this._parent.getControllerAt(e));for(var i=t.readShort(),r=0;r<i;r++){var n=this.getController(t.readS()),o=t.readS();n&&(n.selectedPageId=o)}if(2<=t.version)for(i=t.readShort(),r=0;r<i;r++){var a=t.readS(),s=t.readShort(),h=t.readS(),a=this.getChildByPath(a);a&&a.setProp(s,h)}},a.prototype.___added=function(t){for(var e=this._transitions.length,i=0;i<e;++i)this._transitions[i].onOwnerAddedToStage()},a.prototype.___removed=function(t){for(var e=this._transitions.length,i=0;i<e;++i)this._transitions[i].onOwnerRemovedFromStage()},a);function a(){var t=l.call(this)||this;return t._sortingChildCount=0,t._childrenRenderOrder=T.ChildrenRenderOrder.Ascent,t._apexIndex=0,t._children=new Array,t._controllers=new Array,t._transitions=new Array,t._margin=new T.Margin,t._alignOffset=new egret.Point,t}T.GComponent=t}(fgui=fgui||{}),function(a){var r,t=(r=a.GComponent,__extends(s,r),Object.defineProperty(s.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectedIcon",{get:function(){return this._selectedIcon},set:function(t){this._selectedIcon=t,t=this._selected&&this._selectedIcon?this._selectedIcon:this._icon,this._iconObject&&(this._iconObject.icon=t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title),this.updateGear(6)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"text",{get:function(){return this.title},set:function(t){this.title=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selectedTitle",{get:function(){return this._selectedTitle},set:function(t){this._selectedTitle=t,this._titleObject&&(this._titleObject.text=this._selected&&this._selectedTitle?this._selectedTitle:this._title)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"titleColor",{get:function(){var t=this.getTextField();return t?t.color:0},set:function(t){var e=this.getTextField();e&&(e.color=t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"titleFontSize",{get:function(){var t=this.getTextField();return t?t.fontSize:0},set:function(t){var e=this.getTextField();e&&(e.fontSize=t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"sound",{get:function(){return this._sound},set:function(t){this._sound=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"soundVolumeScale",{get:function(){return this._soundVolumeScale},set:function(t){this._soundVolumeScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"selected",{get:function(){return this._selected},set:function(t){this._mode!=a.ButtonMode.Common&&this._selected!=t&&(this._selected=t,this.grayed&&this._buttonController&&this._buttonController.hasPage(s.DISABLED)?this._selected?this.setState(s.SELECTED_DISABLED):this.setState(s.DISABLED):this._selected?this.setState(this._over?s.SELECTED_OVER:s.DOWN):this.setState(this._over?s.OVER:s.UP),this._selectedTitle&&this._titleObject&&(this._titleObject.text=this._selected?this._selectedTitle:this._title),this._selectedIcon&&(t=this._selected?this._selectedIcon:this._icon,this._iconObject&&(this._iconObject.icon=t)),this._relatedController&&this._parent&&!this._parent._buildingDisplayList&&(this._selected?(this._relatedController.selectedPageId=this._relatedPageId,this._relatedController.autoRadioGroupDepth&&this._parent.adjustRadioGroupDepth(this,this._relatedController)):this._mode==a.ButtonMode.Check&&this._relatedController.selectedPageId==this._relatedPageId&&(this._relatedController.oppositePageId=this._relatedPageId)))},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode!=t&&(t==a.ButtonMode.Common&&(this.selected=!1),this._mode=t)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"relatedController",{get:function(){return this._relatedController},set:function(t){this._relatedController=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"relatedPageId",{get:function(){return this._relatedPageId},set:function(t){this._relatedPageId=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"changeStateOnClick",{get:function(){return this._changeStateOnClick},set:function(t){this._changeStateOnClick=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"linkedPopup",{get:function(){return this._linkedPopup},set:function(t){this._linkedPopup=t},enumerable:!0,configurable:!0}),s.prototype.getTextField=function(){return this._titleObject instanceof a.GTextField?this._titleObject:this._titleObject instanceof a.GLabel||this._titleObject instanceof s?this._titleObject.getTextField():null},s.prototype.addStateListener=function(t,e){this.addEventListener(a.StateChangeEvent.CHANGED,t,e)},s.prototype.removeStateListener=function(t,e){this.removeEventListener(a.StateChangeEvent.CHANGED,t,e)},s.prototype.fireClick=function(t){t&&this._mode==a.ButtonMode.Common&&(this.setState(s.OVER),a.GTimers.inst.add(100,1,function(){this.setState(s.DOWN)},this),a.GTimers.inst.add(200,1,function(){this.setState(s.UP)},this)),this.__click(null)},s.prototype.setState=function(t){if(this._buttonController&&(this._buttonController.selectedPage=t),1==this._downEffect){var e=this.numChildren;if(t==s.DOWN||t==s.SELECTED_OVER||t==s.SELECTED_DISABLED)for(var i=255*this._downEffectValue,r=(i<<16)+(i<<8)+i,n=0;n<e;n++)null==(o=this.getChildAt(n)).color||o instanceof a.GTextField||(o.color=r);else for(var o,n=0;n<e;n++)null==(o=this.getChildAt(n)).color||o instanceof a.GTextField||(o.color=16777215)}else 2==this._downEffect&&(t==s.DOWN||t==s.SELECTED_OVER||t==s.SELECTED_DISABLED?this._downScaled||(this._downScaled=!0,this._rootContainer.cacheHitArea(!0),this.setScale(this.scaleX*this._downEffectValue,this.scaleY*this._downEffectValue)):this._downScaled&&(this._downScaled=!1,this._rootContainer.cacheHitArea(!1),this.setScale(this.scaleX/this._downEffectValue,this.scaleY/this._downEffectValue)))},s.prototype.handleControllerChanged=function(t){r.prototype.handleControllerChanged.call(this,t),this._relatedController==t&&(this.selected=this._relatedPageId==t.selectedPageId)},s.prototype.handleGrayedChanged=function(){this._buttonController&&this._buttonController.hasPage(s.DISABLED)?this.grayed?this._selected&&this._buttonController.hasPage(s.SELECTED_DISABLED)?this.setState(s.SELECTED_DISABLED):this.setState(s.DISABLED):this._selected?this.setState(s.DOWN):this.setState(s.UP):r.prototype.handleGrayedChanged.call(this)},s.prototype.getProp=function(t){switch(t){case a.ObjectPropID.Color:return this.titleColor;case a.ObjectPropID.OutlineColor:var e=this.getTextField();return e?e.strokeColor:0;case a.ObjectPropID.FontSize:return this.titleFontSize;case a.ObjectPropID.Selected:return this.selected;default:return r.prototype.getProp.call(this,t)}},s.prototype.setProp=function(t,e){switch(t){case a.ObjectPropID.Color:this.titleColor=e;break;case a.ObjectPropID.OutlineColor:var i=this.getTextField();i&&(i.strokeColor=e);break;case a.ObjectPropID.FontSize:this.titleFontSize=e;break;case a.ObjectPropID.Selected:this.selected=e;break;default:r.prototype.setProp.call(this,t,e)}},s.prototype.constructExtension=function(t){t.seek(0,6),this._mode=t.readByte();var e=t.readS();e&&(this._sound=e),this._soundVolumeScale=t.readFloat(),this._downEffect=t.readByte(),this._downEffectValue=t.readFloat(),2==this._downEffect&&this.setPivot(.5,.5,this.pivotAsAnchor),this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),this._titleObject&&(this._title=this._titleObject.text),this._iconObject&&(this._icon=this._iconObject.icon),this._mode==a.ButtonMode.Common&&this.setState(s.UP),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mousedown,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__click,this)},s.prototype.setup_afterAdd=function(t,e){var i;r.prototype.setup_afterAdd.call(this,t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(null!=(i=t.readS())&&(this.title=i),null!=(i=t.readS())&&(this.selectedTitle=i),null!=(i=t.readS())&&(this.icon=i),null!=(i=t.readS())&&(this.selectedIcon=i),t.readBool()&&(this.titleColor=t.readColor()),0!=(e=t.readInt())&&(this.titleFontSize=e),0<=(e=t.readShort())&&(this._relatedController=this.parent.getControllerAt(e)),this._relatedPageId=t.readS(),null!=(i=t.readS())&&(this._sound=i),t.readBool()&&(this._soundVolumeScale=t.readFloat()),this.selected=t.readBool())},s.prototype.__mousedown=function(t){this._down=!0,a.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this._mode==a.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(s.DISABLED)?this.setState(s.SELECTED_DISABLED):this.setState(s.DOWN)),this._linkedPopup&&(this._linkedPopup instanceof a.Window?this._linkedPopup.toggleStatus():this.root.togglePopup(this._linkedPopup,this))},s.prototype.__mouseup=function(t){this._down&&(a.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this._down=!1,this.displayObject&&this._mode==a.ButtonMode.Common&&(this.grayed&&this._buttonController&&this._buttonController.hasPage(s.DISABLED)?this.setState(s.DISABLED):this._over?this.setState(s.OVER):this.setState(s.UP)))},s.prototype.__click=function(t){var e;this._sound&&(!(e=a.UIPackage.getItemByURL(this._sound))||(e=e.owner.getItemAsset(e))&&a.GRoot.inst.playOneShotSound(e,this._soundVolumeScale)),this._mode==a.ButtonMode.Check?this._changeStateOnClick&&(this.selected=!this._selected,this.dispatchEvent(new a.StateChangeEvent(a.StateChangeEvent.CHANGED))):this._mode==a.ButtonMode.Radio?this._changeStateOnClick&&!this._selected&&(this.selected=!0,this.dispatchEvent(new a.StateChangeEvent(a.StateChangeEvent.CHANGED))):this._relatedController&&(this._relatedController.selectedPageId=this._relatedPageId)},s.UP="up",s.DOWN="down",s.OVER="over",s.SELECTED_OVER="selectedOver",s.DISABLED="disabled",s.SELECTED_DISABLED="selectedDisabled",s);function s(){var t=r.call(this)||this;return t._mode=a.ButtonMode.Common,t._title="",t._icon="",t._sound=a.UIConfig.buttonSound,t._soundVolumeScale=a.UIConfig.buttonSoundVolumeScale,t._changeStateOnClick=!0,t._downEffect=0,t._downEffectValue=.8,t}a.GButton=t}(fgui=fgui||{}),function(r){var a,t=(a=r.GComponent,__extends(e,a),Object.defineProperty(e.prototype,"text",{get:function(){return this._titleObject?this._titleObject.text:null},set:function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._iconObject?this._iconObject.icon:null},set:function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleColor",{get:function(){var t=this.getTextField();return t?t.color:0},set:function(t){var e=this.getTextField();e&&(e.color=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleFontSize",{get:function(){var t=this.getTextField();return t?t.fontSize:0},set:function(t){var e=this.getTextField();e&&(e.fontSize=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleItemCount",{get:function(){return this._visibleItemCount},set:function(t){this._visibleItemCount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"popupDirection",{get:function(){return this._popupDirection},set:function(t){this._popupDirection=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){t?this._items=t.concat():this._items.length=0,0<this._items.length?(this._selectedIndex>=this._items.length?this._selectedIndex=this._items.length-1:-1==this._selectedIndex&&(this._selectedIndex=0),this.text=this._items[this._selectedIndex],this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",this._icons&&(this.icon=null),this._selectedIndex=-1),this._itemsUpdated=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icons",{get:function(){return this._icons},set:function(t){this._icons=t,this._icons&&-1!=this._selectedIndex&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this._values},set:function(t){t?this._values=t.concat():this._values.length=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(t){this._selectedIndex!=t&&(this._selectedIndex=t,0<=this._selectedIndex&&this._selectedIndex<this._items.length?(this.text=this._items[this._selectedIndex],this._icons&&this._selectedIndex<this._icons.length&&(this.icon=this._icons[this._selectedIndex])):(this.text="",this._icons&&(this.icon=null)),this.updateSelectionController())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._values[this._selectedIndex]},set:function(t){var e=this._values.indexOf(t);-1==e&&null==t&&(e=this._values.indexOf("")),this.selectedIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionController",{get:function(){return this._selectionController},set:function(t){this._selectionController=t},enumerable:!0,configurable:!0}),e.prototype.getTextField=function(){return this._titleObject instanceof r.GTextField?this._titleObject:this._titleObject instanceof r.GLabel||this._titleObject instanceof r.GButton?this._titleObject.getTextField():null},e.prototype.setState=function(t){this._buttonController&&(this._buttonController.selectedPage=t)},e.prototype.getProp=function(t){switch(t){case r.ObjectPropID.Color:return this.titleColor;case r.ObjectPropID.OutlineColor:var e=this.getTextField();return e?e.strokeColor:0;case r.ObjectPropID.FontSize:return(e=this.getTextField())?e.fontSize:0;default:return a.prototype.getProp.call(this,t)}},e.prototype.setProp=function(t,e){switch(t){case r.ObjectPropID.Color:this.titleColor=e;break;case r.ObjectPropID.OutlineColor:var i=this.getTextField();i&&(i.strokeColor=e);break;case r.ObjectPropID.FontSize:(i=this.getTextField())&&(i.fontSize=e);break;default:a.prototype.setProp.call(this,t,e)}},e.prototype.constructExtension=function(t){if(this._buttonController=this.getController("button"),this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon"),t=t.readS()){if(this.dropdown=r.UIPackage.createObjectFromURL(t),!this.dropdown)return void console.error("\u4e0b\u62c9\u6846\u5fc5\u987b\u4e3a\u5143\u4ef6");if(this.dropdown.name="this.dropdown",this._list=this.dropdown.getChild("list").asList,null==this._list)return void console.error(this.resourceURL+": \u4e0b\u62c9\u6846\u7684\u5f39\u51fa\u5143\u4ef6\u91cc\u5fc5\u987b\u5305\u542b\u540d\u4e3alist\u7684\u5217\u8868");this._list.addEventListener(r.ItemEvent.CLICK,this.__clickItem,this),this._list.addRelation(this.dropdown,r.RelationType.Width),this._list.removeRelation(this.dropdown,r.RelationType.Height),this.dropdown.addRelation(this._list,r.RelationType.Height),this.dropdown.removeRelation(this._list,r.RelationType.Width),this.dropdown.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__popupWinClosed,this)}this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__mousedown,this)},e.prototype.handleControllerChanged=function(t){a.prototype.handleControllerChanged.call(this,t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)},e.prototype.updateSelectionController=function(){var t;this._selectionController&&!this._selectionController.changing&&this._selectedIndex<this._selectionController.pageCount&&(t=this._selectionController,this._selectionController=null,t.selectedIndex=this._selectedIndex,this._selectionController=t)},e.prototype.dispose=function(){this.dropdown&&(this.dropdown.dispose(),this.dropdown=null),a.prototype.dispose.call(this)},e.prototype.setup_afterAdd=function(t,e){if(a.prototype.setup_afterAdd.call(this,t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType){for(var i,r,n=t.readShort(),o=0;o<n;o++)i=t.readShort(),i+=t.position,this._items[o]=t.readS(),this._values[o]=t.readS(),null!=(r=t.readS())&&(null==this._icons&&(this._icons=new Array),this._icons[o]=r),t.position=i;null!=(r=t.readS())?(this.text=r,this._selectedIndex=this._items.indexOf(r)):0<this._items.length?(this._selectedIndex=0,this.text=this._items[0]):this._selectedIndex=-1,null!=(r=t.readS())&&(this.icon=r),t.readBool()&&(this.titleColor=t.readColor()),0<(e=t.readInt())&&(this._visibleItemCount=e),this._popupDirection=t.readByte(),0<=(e=t.readShort())&&(this._selectionController=this.parent.getControllerAt(e))}},e.prototype.showDropdown=function(){if(this._itemsUpdated){this._itemsUpdated=!1,this._list.removeChildrenToPool();for(var t=this._items.length,e=0;e<t;e++){var i=this._list.addItemFromPool();i.name=e<this._values.length?this._values[e]:"",i.text=this._items[e],i.icon=this._icons&&e<this._icons.length?this._icons[e]:null}this._list.resizeToFit(this._visibleItemCount)}this._list.selectedIndex=-1,this.dropdown.width=this.width,this._list.ensureBoundsCorrect(),this.root.togglePopup(this.dropdown,this,this._popupDirection),this.dropdown.parent&&this.setState(r.GButton.DOWN)},e.prototype.__popupWinClosed=function(t){this._over?this.setState(r.GButton.OVER):this.setState(r.GButton.UP)},e.prototype.__clickItem=function(t){r.GTimers.inst.add(100,1,this.__clickItem2,this,this._list.getChildIndex(t.itemObject))},e.prototype.__clickItem2=function(t){this.dropdown.parent instanceof r.GRoot&&this.dropdown.parent.hidePopup(),this._selectedIndex=-1,this.selectedIndex=t,this.dispatchEvent(new r.StateChangeEvent(r.StateChangeEvent.CHANGED))},e.prototype.__mousedown=function(t){t.target instanceof egret.TextField&&t.target.type==egret.TextFieldType.INPUT||(this._down=!0,r.GRoot.inst.nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this.dropdown&&this.showDropdown())},e.prototype.__mouseup=function(t){this._down&&(this._down=!1,r.GRoot.inst.nativeStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.__mouseup,this),this.dropdown&&!this.dropdown.parent&&(this._over?this.setState(r.GButton.OVER):this.setState(r.GButton.UP)))},e);function e(){var t=a.call(this)||this;return t._visibleItemCount=0,t._selectedIndex=0,t._popupDirection=r.PopupDirection.Auto,t._visibleItemCount=r.UIConfig.defaultComboBoxVisibleItemCount,t._itemsUpdated=!0,t._selectedIndex=-1,t._items=[],t._values=[],t}r.GComboBox=t}(fgui=fgui||{}),function(u){var n,t=(n=u.GObject,__extends(e,n),Object.defineProperty(e.prototype,"graphics",{get:function(){return this._graphics},enumerable:!0,configurable:!0}),e.prototype.drawRect=function(t,e,i,r,n,o){this._type=1,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=r,this._fillAlpha=n,this._cornerRadius=o,this.updateGraph()},e.prototype.drawEllipse=function(t,e,i,r,n){this._type=2,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=r,this._fillAlpha=n,this._cornerRadius=null,this.updateGraph()},e.prototype.drawRegularPolygon=function(t,e,i,r,n,o,a,s){this._type=4,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=r,this._fillAlpha=n,this._sides=o,this._startAngle=a||0,this._distances=s,this.updateGraph()},e.prototype.drawPolygon=function(t,e,i,r,n,o){this._type=3,this._lineSize=t,this._lineColor=e,this._lineAlpha=i,this._fillColor=r,this._fillAlpha=n,this._polygonPoints=o,this.updateGraph()},Object.defineProperty(e.prototype,"distances",{get:function(){return this._distances},set:function(t){this._distances=t,3==this._type&&this.updateGraph()},enumerable:!0,configurable:!0}),e.prototype.clearGraphics=function(){this._graphics&&(this._type=0,this._graphics.clear())},Object.defineProperty(e.prototype,"color",{get:function(){return this._fillColor},set:function(t){this._fillColor=t,0!=this._type&&this.updateGraph()},enumerable:!0,configurable:!0}),e.prototype.updateGraph=function(){var t=this.graphics;t.clear();var e=this.width,i=this.height;if(0!=e&&0!=i){if(0==this._lineSize?t.lineStyle(0,0,0):t.lineStyle(this._lineSize,this._lineColor,this._lineAlpha),t.beginFill(this._fillColor,this._fillAlpha),1==this._type)this._cornerRadius?1==this._cornerRadius.length?t.drawRoundRect(0,0,e,i,2*this._cornerRadius[0],2*this._cornerRadius[0]):t.drawRoundRect(0,0,e,i,2*this._cornerRadius[0],2*this._cornerRadius[1]):t.drawRect(0,0,e,i);else if(2==this._type)t.drawEllipse(0,0,e,i);else if(3==this._type)u.ToolSet.fillPath(t,this._polygonPoints,0,0);else if(4==this._type){this._polygonPoints||(this._polygonPoints=[]);var r=Math.min(this._width,this._height)/2;this._polygonPoints.length=0;for(var n,o=this._startAngle*Math.PI/180,a=2*Math.PI/this._sides,s=0;s<this._sides;s++){this._distances?(n=this._distances[s],isNaN(n)&&(n=1)):n=1;var h=r+r*n*Math.cos(o),l=r+r*n*Math.sin(o);this._polygonPoints.push(h,l),o+=a}u.ToolSet.fillPath(t,this._polygonPoints,0,0)}t.endFill()}},e.prototype.replaceMe=function(t){if(!this._parent)throw"parent not set";t.name=this.name,t.alpha=this.alpha,t.rotation=this.rotation,t.visible=this.visible,t.touchable=this.touchable,t.grayed=this.grayed,t.setXY(this.x,this.y),t.setSize(this.width,this.height);var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e),t.relations.copyFrom(this.relations),this._parent.removeChild(this,!0)},e.prototype.addBeforeMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,e)},e.prototype.addAfterMe=function(t){if(null==this._parent)throw"parent not set";var e=this._parent.getChildIndex(this);this._parent.addChildAt(t,++e)},e.prototype.setNativeObject=function(t){var e=new egret.Sprite;this.setDisplayObject(e),this._parent&&this._parent.childStateChanged(this),this.handleXYChanged(),e.alpha=this.alpha,e.rotation=this.rotation,e.visible=this.visible,e.touchEnabled=this.touchable,e.touchChildren=this.touchable,e.addChild(t)},e.prototype.createDisplayObject=function(){var t=new egret.Sprite;t.touchEnabled=!0,this._graphics=t.graphics,this.setDisplayObject(t)},e.prototype.getProp=function(t){return t==u.ObjectPropID.Color?this.color:n.prototype.getProp.call(this,t)},e.prototype.setProp=function(t,e){t==u.ObjectPropID.Color?this.color=e:n.prototype.setProp.call(this,t,e)},e.prototype.handleSizeChanged=function(){n.prototype.handleSizeChanged.call(this),0!=this._type&&this.updateGraph()},e.prototype.setup_beforeAdd=function(t,e){if(n.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),this._type=t.readByte(),0!=this._type){var i,r;this._lineSize=t.readInt();e=t.readColor(!0);if(this._lineColor=16777215&e,this._lineAlpha=(e>>24&255)/255,e=t.readColor(!0),this._fillColor=16777215&e,this._fillAlpha=(e>>24&255)/255,t.readBool())for(this._cornerRadius=new Array(4),i=0;i<4;i++)this._cornerRadius[i]=t.readFloat();if(3==this._type)for(r=t.readShort(),this._polygonPoints=[],this._polygonPoints.length=r,i=0;i<r;i++)this._polygonPoints[i]=t.readFloat();else if(4==this._type&&(this._sides=t.readShort(),this._startAngle=t.readFloat(),0<(r=t.readShort())))for(this._distances=[],i=0;i<r;i++)this._distances[i]=t.readFloat();this.updateGraph()}},e);function e(){var t=n.call(this)||this;return t._type=0,t._lineSize=0,t._lineColor=0,t._fillColor=0,t._lineSize=1,t._lineAlpha=1,t._fillAlpha=1,t._fillColor=16777215,t}u.GGraph=t}(fgui=fgui||{}),function(c){var i,t=(i=c.GObject,__extends(e,i),e.prototype.dispose=function(){this._boundsChanged=!1,i.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},set:function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineGap",{get:function(){return this._lineGap},set:function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnGap",{get:function(){return this._columnGap},set:function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"excludeInvisibles",{get:function(){return this._excludeInvisibles},set:function(t){this._excludeInvisibles!=t&&(this._excludeInvisibles=t,this.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoSizeDisabled",{get:function(){return this._autoSizeDisabled},set:function(t){this._autoSizeDisabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainGridMinSize",{get:function(){return this._mainGridMinSize},set:function(t){this._mainGridMinSize!=t&&(this._mainGridMinSize=t,this.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainGridIndex",{get:function(){return this._mainGridIndex},set:function(t){this._mainGridIndex!=t&&(this._mainGridIndex=t,this.setBoundsChangedFlag())},enumerable:!0,configurable:!0}),e.prototype.setBoundsChangedFlag=function(t){0==this._updating&&this._parent&&(t||(this._percentReady=!1),this._boundsChanged||(this._boundsChanged=!0,this._layout!=c.GroupLayoutType.None&&c.GTimers.inst.callLater(this.ensureBoundsCorrect,this)))},e.prototype.ensureSizeCorrect=function(){null!=this._parent&&this._boundsChanged&&0!=this._layout&&(this._boundsChanged=!1,this._autoSizeDisabled?this.resizeChildren(0,0):(this.handleLayout(),this.updateBounds()))},e.prototype.ensureBoundsCorrect=function(){null!=this._parent&&this._boundsChanged&&(this._boundsChanged=!1,0==this._layout?this.updateBounds():this._autoSizeDisabled?this.resizeChildren(0,0):(this.handleLayout(),this.updateBounds()))},e.prototype.updateBounds=function(){if(c.GTimers.inst.remove(this.ensureBoundsCorrect,this),this.parent){for(var t,e,i=this._parent.numChildren,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=!0,h=0;h<i;h++)(t=this._parent.getChildAt(h)).group!=this||this._excludeInvisibles&&!t.internalVisible3||((e=t.xMin)<r&&(r=e),(e=t.yMin)<n&&(n=e),o<(e=t.xMin+t.width)&&(o=e),a<(e=t.yMin+t.height)&&(a=e),s=!1);var l=0,u=0;s||(this._updating|=1,this.setXY(r,n),this._updating&=2,l=o-r,u=a-n),0==(2&this._updating)?(this._updating|=2,this.setSize(l,u),this._updating&=1):(this._updating&=1,this.resizeChildren(this._width-l,this._height-u))}},e.prototype.handleLayout=function(){if(this.parent){var t;if(this._updating|=1,this._layout==c.GroupLayoutType.Horizontal)for(var e=this.x,i=this._parent.numChildren,r=0;r<i;r++)(t=this._parent.getChildAt(r)).group==this&&(this._excludeInvisibles&&!t.internalVisible3||(t.xMin=e,0!=t.width&&(e+=t.width+this._columnGap)));else if(this._layout==c.GroupLayoutType.Vertical){var n=this.y;for(i=this._parent.numChildren,r=0;r<i;r++)(t=this._parent.getChildAt(r)).group==this&&(this._excludeInvisibles&&!t.internalVisible3||(t.yMin=n,0!=t.height&&(n+=t.height+this._lineGap)))}this._updating&=2}},e.prototype.moveChildren=function(t,e){if(0==(1&this._updating)&&null!=this._parent){this._updating|=1;for(var i,r=this._parent.numChildren,n=0;n<r;n++)(i=this._parent.getChildAt(n)).group==this&&i.setXY(i.x+t,i.y+e);this._updating&=2}},e.prototype.resizeChildren=function(t,e){if(this._layout!=c.GroupLayoutType.None&&0==(2&this._updating)&&null!=this._parent)if(this._updating|=2,!this._boundsChanged||(this._boundsChanged=!1,this._autoSizeDisabled)){var i,r=this._parent.numChildren;if(!this._percentReady){this._percentReady=!0,this._numChildren=0,this._totalSize=0,this._mainChildIndex=-1;for(var n=0,o=0;o<r;o++)(i=this._parent.getChildAt(o)).group==this&&(this._excludeInvisibles&&!i.internalVisible3||(n==this._mainGridIndex&&(this._mainChildIndex=o),this._numChildren++,1==this._layout?this._totalSize+=i.width:this._totalSize+=i.height),n++);for(-1!=this._mainChildIndex&&(1==this._layout?(i=this._parent.getChildAt(this._mainChildIndex),this._totalSize+=this._mainGridMinSize-i.width):(i=this._parent.getChildAt(this._mainChildIndex),this._totalSize+=this._mainGridMinSize-i.height),i._sizePercentInGroup=this._mainGridMinSize/this._totalSize),o=0;o<r;o++)(i=this._parent.getChildAt(o)).group==this&&o!=this._mainChildIndex&&(0<this._totalSize?i._sizePercentInGroup=(1==this._layout?i.width:i.height)/this._totalSize:i._sizePercentInGroup=0)}var a=0,s=1,h=!1;if(1==this._layout){a=this.width-(this._numChildren-1)*this._columnGap,-1!=this._mainChildIndex&&a>=this._totalSize&&((i=this._parent.getChildAt(this._mainChildIndex)).setSize(a-(this._totalSize-this._mainGridMinSize),i._rawHeight+e,!0),a-=i.width,s-=i._sizePercentInGroup,h=!0);var l=this.x;for(o=0;o<r;o++)(i=this._parent.getChildAt(o)).group==this&&(!this._excludeInvisibles||i.internalVisible3?(h&&o==this._mainChildIndex||(i.setSize(Math.round(i._sizePercentInGroup/s*a),i._rawHeight+e,!0),s-=i._sizePercentInGroup,a-=i.width),i.xMin=l,0!=i.width&&(l+=i.width+this._columnGap)):i.setSize(i._rawWidth,i._rawHeight+e,!0))}else{a=this.height-(this._numChildren-1)*this._lineGap,-1!=this._mainChildIndex&&a>=this._totalSize&&((i=this._parent.getChildAt(this._mainChildIndex)).setSize(i._rawWidth+t,a-(this._totalSize-this._mainGridMinSize),!0),a-=i.height,s-=i._sizePercentInGroup,h=!0);var u=this.y;for(o=0;o<r;o++)(i=this._parent.getChildAt(o)).group==this&&(!this._excludeInvisibles||i.internalVisible3?(h&&o==this._mainChildIndex||(i.setSize(i._rawWidth+t,Math.round(i._sizePercentInGroup/s*a),!0),s-=i._sizePercentInGroup,a-=i.height),i.yMin=u,0!=i.height&&(u+=i.height+this._lineGap)):i.setSize(i._rawWidth+t,i._rawHeight,!0))}this._updating&=1}else this.updateBounds()},e.prototype.handleAlphaChanged=function(){if(this.parent&&!this._underConstruct)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&(i.alpha=this.alpha)}},e.prototype.handleVisibleChanged=function(){if(this._parent)for(var t=this._parent.numChildren,e=0;e<t;e++){var i=this._parent.getChildAt(e);i.group==this&&i.handleVisibleChanged()}},e.prototype.setup_beforeAdd=function(t,e){i.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),this._layout=t.readByte(),this._lineGap=t.readInt(),this._columnGap=t.readInt(),2<=t.version&&(this._excludeInvisibles=t.readBool(),this._autoSizeDisabled=t.readBool(),this._mainGridIndex=t.readInt())},e.prototype.setup_afterAdd=function(t,e){i.prototype.setup_afterAdd.call(this,t,e),this.visible||this.handleVisibleChanged()},e);function e(){var t=i.call(this)||this;return t._layout=0,t._lineGap=0,t._columnGap=0,t._mainGridIndex=-1,t._mainGridMinSize=50,t._mainChildIndex=-1,t._totalSize=0,t._numChildren=0,t._updating=0,t}c.GGroup=t}(fgui=fgui||{}),function(i){var r,t=(r=i.GObject,__extends(e,r),Object.defineProperty(e.prototype,"color",{get:function(){return this._content.color},set:function(t){this._content.color!=t&&(this._content.color=t,this.updateGear(4))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flip",{get:function(){return this._flip},set:function(t){var e;this._flip!=t&&(this._flip=t,t=e=1,this._flip!=i.FlipType.Horizontal&&this._flip!=i.FlipType.Both||(e=-1),this._flip!=i.FlipType.Vertical&&this._flip!=i.FlipType.Both||(t=-1),this._content.scaleX=e,this._content.scaleY=t,this.handleXYChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillMethod",{get:function(){return this._content.fillMethod},set:function(t){this._content.fillMethod=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOrigin",{get:function(){return this._content.fillOrigin},set:function(t){this._content.fillOrigin=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillClockwise",{get:function(){return this._content.fillClockwise},set:function(t){this._content.fillClockwise=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillAmount",{get:function(){return this._content.fillAmount},set:function(t){this._content.fillAmount=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._content.texture},set:function(t){t?(this.sourceWidth=t.textureWidth,this.sourceHeight=t.textureHeight):(this.sourceWidth=0,this.sourceHeight=0),this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this._content.scale9Grid=null,this._content.fillMode=egret.BitmapFillMode.SCALE,this._content.texture=t},enumerable:!0,configurable:!0}),e.prototype.createDisplayObject=function(){this._content=new i.Image,this._content.touchEnabled=!1,this.setDisplayObject(this._content)},e.prototype.constructFromResource=function(){var t=this.packageItem.getBranch();this.sourceWidth=t.width,this.sourceHeight=t.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),(t=t.getHighResolution()).load(),this._content.scale9Grid=t.scale9Grid,this._content.smoothing=t.smoothing,t.scaleByTile&&(this._content.fillMode=egret.BitmapFillMode.REPEAT),this.setSize(this.sourceWidth,this.sourceHeight),this._content.texture=t.asset},e.prototype.handleXYChanged=function(){r.prototype.handleXYChanged.call(this),this._flip!=i.FlipType.None&&(-1==this._content.scaleX&&(this._content.x+=this.width),-1==this._content.scaleY&&(this._content.y+=this.height))},e.prototype.getProp=function(t){return t==i.ObjectPropID.Color?this.color:r.prototype.getProp.call(this,t)},e.prototype.setProp=function(t,e){t==i.ObjectPropID.Color?this.color=e:r.prototype.setProp.call(this,t,e)},e.prototype.setup_beforeAdd=function(t,e){r.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),t.readBool()&&(this.color=t.readColor()),this.flip=t.readByte(),this._content.fillMethod=t.readByte(),0!=this._content.fillMethod&&(this._content.fillOrigin=t.readByte(),this._content.fillClockwise=t.readBool(),this._content.fillAmount=t.readFloat())},e);function e(){var t=r.call(this)||this;return t._flip=i.FlipType.None,t}i.GImage=t}(fgui=fgui||{}),function(n){var o,t=(o=n.GComponent,__extends(e,o),Object.defineProperty(e.prototype,"icon",{get:function(){if(this._iconObject)return this._iconObject.icon},set:function(t){this._iconObject&&(this._iconObject.icon=t),this.updateGear(7)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._titleObject?this._titleObject.text:null},set:function(t){this._titleObject&&(this._titleObject.text=t),this.updateGear(6)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.title},set:function(t){this.title=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleColor",{get:function(){var t=this.getTextField();return t?t.color:0},set:function(t){var e=this.getTextField();e&&(e.color=t),this.updateGear(4)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleFontSize",{get:function(){var t=this.getTextField();return t?t.fontSize:0},set:function(t){var e=this.getTextField();e&&(e.fontSize=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editable",{get:function(){return!!(this._titleObject&&this._titleObject instanceof n.GTextInput)&&this._titleObject.asTextInput.editable},set:function(t){this._titleObject&&(this._titleObject.asTextInput.editable=t)},enumerable:!0,configurable:!0}),e.prototype.getTextField=function(){return this._titleObject instanceof n.GTextField?this._titleObject:this._titleObject instanceof e||this._titleObject instanceof n.GButton?this._titleObject.getTextField():null},e.prototype.getProp=function(t){switch(t){case n.ObjectPropID.Color:return this.titleColor;case n.ObjectPropID.OutlineColor:var e=this.getTextField();return e?e.strokeColor:0;case n.ObjectPropID.FontSize:return this.titleFontSize;default:return o.prototype.getProp.call(this,t)}},e.prototype.setProp=function(t,e){switch(t){case n.ObjectPropID.Color:this.titleColor=e;break;case n.ObjectPropID.OutlineColor:var i=this.getTextField();i&&(i.strokeColor=e);break;case n.ObjectPropID.FontSize:this.titleFontSize=e;break;default:o.prototype.setProp.call(this,t,e)}},e.prototype.constructExtension=function(t){this._titleObject=this.getChild("title"),this._iconObject=this.getChild("icon")},e.prototype.setup_afterAdd=function(t,e){var i,r;o.prototype.setup_afterAdd.call(this,t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(null!=(i=t.readS())&&(this.title=i),null!=(i=t.readS())&&(this.icon=i),t.readBool()&&(this.titleColor=t.readColor()),0!=(r=t.readInt())&&(this.titleFontSize=r),t.readBool()&&((e=this.getTextField())instanceof n.GTextInput?(null!=(i=t.readS())&&(e.promptText=i),null!=(i=t.readS())&&(e.restrict=i),0!=(r=t.readInt())&&(e.maxLength=r),r=t.readInt(),t.readBool()&&(e.password=!0)):t.skip(13)))},e);function e(){return o.call(this)||this}n.GLabel=t}(fgui=fgui||{}),function(S){var o,t=(o=S.GComponent,__extends(e,o),e.prototype.dispose=function(){S.GTimers.inst.remove(this._refreshVirtualList,this),this._pool.clear(),o.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},set:function(t){this._layout!=t&&(this._layout=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineCount",{get:function(){return this._lineCount},set:function(t){this._lineCount!=t&&(this._lineCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnCount",{get:function(){return this._columnCount},set:function(t){this._columnCount!=t&&(this._columnCount=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineGap",{get:function(){return this._lineGap},set:function(t){this._lineGap!=t&&(this._lineGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnGap",{get:function(){return this._columnGap},set:function(t){this._columnGap!=t&&(this._columnGap=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"virtualItemSize",{get:function(){return this._itemSize},set:function(t){this._virtual&&(this._itemSize||(this._itemSize=new egret.Point),this._itemSize.copyFrom(t),this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultItem",{get:function(){return this._defaultItem},set:function(t){this._defaultItem=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoResizeItem",{get:function(){return this._autoResizeItem},set:function(t){this._autoResizeItem!=t&&(this._autoResizeItem=t,this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionMode",{get:function(){return this._selectionMode},set:function(t){this._selectionMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionController",{get:function(){return this._selectionController},set:function(t){this._selectionController=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemPool",{get:function(){return this._pool},enumerable:!0,configurable:!0}),e.prototype.getFromPool=function(t){t=t||this._defaultItem;t=this._pool.getObject(t);return t&&(t.visible=!0),t},e.prototype.returnToPool=function(t){t.displayObject.cacheAsBitmap=!1,this._pool.returnObject(t)},e.prototype.addChildAt=function(t,e){return o.prototype.addChildAt.call(this,t,e),t instanceof S.GButton&&(t.selected=!1,t.changeStateOnClick=!1),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__clickItem,this),t},e.prototype.addItem=function(t){return t=t||this._defaultItem,this.addChild(S.UIPackage.createObjectFromURL(t))},e.prototype.addItemFromPool=function(t){return this.addChild(this.getFromPool(t))},e.prototype.removeChildAt=function(t,e){e=o.prototype.removeChildAt.call(this,t,e);return e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__clickItem,this),e},e.prototype.removeChildToPoolAt=function(t){t=o.prototype.removeChildAt.call(this,t);this.returnToPool(t)},e.prototype.removeChildToPool=function(t){o.prototype.removeChild.call(this,t),this.returnToPool(t)},e.prototype.removeChildrenToPool=function(t,e){((e=null==e?-1:e)<0||e>=this._children.length)&&(e=this._children.length-1);for(var i=t=null==t?0:t;i<=e;++i)this.removeChildToPoolAt(t)},Object.defineProperty(e.prototype,"selectedIndex",{get:function(){if(this._virtual)for(i=0;i<this._realNumItems;i++){var t=this._virtualItems[i];if(t.obj instanceof S.GButton&&t.obj.selected||null==t.obj&&t.selected)return this._loop?i%this._numItems:i}else for(var e=this._children.length,i=0;i<e;i++){var r=this._children[i];if(r instanceof S.GButton&&r.selected)return i}return-1},set:function(t){0<=t&&t<this.numItems?(this._selectionMode!=S.ListSelectionMode.Single&&this.clearSelection(),this.addSelection(t)):this.clearSelection()},enumerable:!0,configurable:!0}),e.prototype.getSelection=function(t){if(t=t||new Array,this._virtual)for(r=0;r<this._realNumItems;r++){var e=this._virtualItems[r];(e.obj instanceof S.GButton&&e.obj.selected||null==e.obj&&e.selected)&&(e=r,this._loop&&(e=r%this._numItems,-1!=t.indexOf(e))||t.push(e))}else for(var i=this._children.length,r=0;r<i;r++){var n=this._children[r];n instanceof S.GButton&&n.selected&&t.push(r)}return t},e.prototype.addSelection=function(t,e){var i;this._selectionMode!=S.ListSelectionMode.None&&(this.checkVirtualList(),this._selectionMode==S.ListSelectionMode.Single&&this.clearSelection(),e&&this.scrollToView(t),this._lastSelectedIndex=t,this._virtual?((e=this._virtualItems[t]).obj&&(i=e.obj),e.selected=!0):i=this.getChildAt(t),i instanceof S.GButton&&!i.selected&&(i.selected=!0,this.updateSelectionController(t)))},e.prototype.removeSelection=function(t){var e,i;this._selectionMode!=S.ListSelectionMode.None&&(this._virtual?((i=this._virtualItems[t]).obj&&(e=i.obj),i.selected=!1):e=this.getChildAt(t),e instanceof S.GButton&&(e.selected=!1))},e.prototype.clearSelection=function(){if(this._virtual)for(i=0;i<this._realNumItems;i++){var t=this._virtualItems[i];t.obj instanceof S.GButton&&(t.obj.selected=!1),t.selected=!1}else for(var e=this._children.length,i=0;i<e;i++){var r=this._children[i];r instanceof S.GButton&&(r.selected=!1)}},e.prototype.clearSelectionExcept=function(t){if(this._virtual)for(r=0;r<this._realNumItems;r++){var e=this._virtualItems[r];e.obj!=t&&(e.obj instanceof S.GButton&&(e.obj.selected=!1),e.selected=!1)}else for(var i=this._children.length,r=0;r<i;r++){var n=this._children[r];n instanceof S.GButton&&n!=t&&(n.selected=!1)}},e.prototype.selectAll=function(){this.checkVirtualList();var t=-1;if(this._virtual)for(r=0;r<this._realNumItems;r++){var e=this._virtualItems[r];e.obj instanceof S.GButton&&!e.obj.selected&&(e.obj.selected=!0,t=r),e.selected=!0}else for(var i=this._children.length,r=0;r<i;r++){var n=this._children[r];n instanceof S.GButton&&!n.selected&&(n.selected=!0,t=r)}-1!=t&&this.updateSelectionController(t)},e.prototype.selectNone=function(){this.clearSelection()},e.prototype.selectReverse=function(){this.checkVirtualList();var t=-1;if(this._virtual)for(r=0;r<this._realNumItems;r++){var e=this._virtualItems[r];e.obj instanceof S.GButton&&(e.obj.selected=!e.obj.selected,e.obj.selected&&(t=r)),e.selected=!e.selected}else for(var i=this._children.length,r=0;r<i;r++){var n=this._children[r];n instanceof S.GButton&&(n.selected=!n.selected,n.selected&&(t=r))}-1!=t&&this.updateSelectionController(t)},e.prototype.handleArrowKey=function(t){var e=this.selectedIndex;if(-1!=e)switch(t){case 1:if(this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowVertical)0<=--e&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==S.ListLayoutType.FlowHorizontal||this._layout==S.ListLayoutType.Pagination){for(var i=this._children[e],r=0,n=e-1;0<=n;n--){var o=this._children[n];if(o.y!=i.y){i=o;break}r++}for(;0<=n;n--)if((o=this._children[n]).y!=i.y){this.clearSelection(),this.addSelection(n+r+1,!0);break}}break;case 3:if(this._layout==S.ListLayoutType.SingleRow||this._layout==S.ListLayoutType.FlowHorizontal||this._layout==S.ListLayoutType.Pagination)++e<this._children.length&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==S.ListLayoutType.FlowVertical){for(var i=this._children[e],r=0,a=this._children.length,n=e+1;n<a;n++){if((o=this._children[n]).x!=i.x){i=o;break}r++}for(;n<a;n++)if((o=this._children[n]).x!=i.x){this.clearSelection(),this.addSelection(n-r-1,!0);break}}break;case 5:if(this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowVertical)++e<this._children.length&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==S.ListLayoutType.FlowHorizontal||this._layout==S.ListLayoutType.Pagination){for(i=this._children[e],r=0,a=this._children.length,n=e+1;n<a;n++){if((o=this._children[n]).y!=i.y){i=o;break}r++}for(;n<a;n++)if((o=this._children[n]).y!=i.y){this.clearSelection(),this.addSelection(n-r-1,!0);break}}break;case 7:if(this._layout==S.ListLayoutType.SingleRow||this._layout==S.ListLayoutType.FlowHorizontal||this._layout==S.ListLayoutType.Pagination)0<=--e&&(this.clearSelection(),this.addSelection(e,!0));else if(this._layout==S.ListLayoutType.FlowVertical){for(i=this._children[e],r=0,n=e-1;0<=n;n--){if((o=this._children[n]).x!=i.x){i=o;break}r++}for(;0<=n;n--)if((o=this._children[n]).x!=i.x){this.clearSelection(),this.addSelection(n+r+1,!0);break}}}},e.prototype.__clickItem=function(t){var e;this.parent&&(this._scrollPane&&this._scrollPane.isDragged||(e=t.currentTarget,this.setSelectionOnEvent(e),this._scrollPane&&this.scrollItemToViewOnClick&&this._scrollPane.scrollToView(e,!0),(e=new S.ItemEvent(S.ItemEvent.CLICK,e)).stageX=t.stageX,e.stageY=t.stageY,this.dispatchItemEvent(e)))},e.prototype.dispatchItemEvent=function(t){this.dispatchEvent(t)},e.prototype.setSelectionOnEvent=function(t){if(t instanceof S.GButton&&this._selectionMode!=S.ListSelectionMode.None){var e=!1,i=this.childIndexToItemIndex(this.getChildIndex(t));if(this._selectionMode==S.ListSelectionMode.Single)t.selected||(this.clearSelectionExcept(t),t.selected=!0);else if(S.GRoot.shiftKeyDown){if(!t.selected)if(-1!=this._lastSelectedIndex){var r,n=Math.min(this._lastSelectedIndex,i),o=Math.max(this._lastSelectedIndex,i),o=Math.min(o,this.numItems-1);if(this._virtual)for(r=n;r<=o;r++){var a=this._virtualItems[r];a.obj instanceof S.GButton&&(a.obj.selected=!0),a.selected=!0}else for(r=n;r<=o;r++){var s=this.getChildAt(r);s instanceof S.GButton&&(s.selected=!0)}e=!0}else t.selected=!0}else S.GRoot.ctrlKeyDown||this._selectionMode==S.ListSelectionMode.Multiple_SingleClick?t.selected=!t.selected:t.selected?this.clearSelectionExcept(t):(this.clearSelectionExcept(t),t.selected=!0);e||(this._lastSelectedIndex=i),t.selected&&this.updateSelectionController(i)}},e.prototype.resizeToFit=function(t,e){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===e&&(e=0),this.ensureBoundsCorrect();var i=this.numItems;if(i<t&&(t=i),this._virtual){i=Math.ceil(t/this._curLineItemCount);this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal?this.viewHeight=i*this._itemSize.y+Math.max(0,i-1)*this._lineGap:this.viewWidth=i*this._itemSize.x+Math.max(0,i-1)*this._columnGap}else if(0==t)this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal?this.viewHeight=e:this.viewWidth=e;else{for(var r,n=t-1;0<=n&&(r=this.getChildAt(n),this.foldInvisibleItems&&!r.visible);)n--;n<0?this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal?this.viewHeight=e:this.viewWidth=e:(t=0,this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal?((t=r.y+r.height)<e&&(t=e),this.viewHeight=t):((t=r.x+r.width)<e&&(t=e),this.viewWidth=t))}},e.prototype.getMaxItemWidth=function(){for(var t=this._children.length,e=0,i=0;i<t;i++){var r=this.getChildAt(i);r.width>e&&(e=r.width)}return e},e.prototype.handleSizeChanged=function(){o.prototype.handleSizeChanged.call(this),this.setBoundsChangedFlag(),this._virtual&&this.setVirtualListChangedFlag(!0)},e.prototype.handleControllerChanged=function(t){o.prototype.handleControllerChanged.call(this,t),this._selectionController==t&&(this.selectedIndex=t.selectedIndex)},e.prototype.updateSelectionController=function(t){var e;this._selectionController&&!this._selectionController.changing&&t<this._selectionController.pageCount&&(e=this._selectionController,this._selectionController=null,e.selectedIndex=t,this._selectionController=e)},e.prototype.getSnappingPosition=function(t,e,i){var r,n;return this._virtual?(i=i||new egret.Point,this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal?(C=r=e,n=this.getIndexOnPos1(!1),e=C,n<this._virtualItems.length&&r-e>this._virtualItems[n].height/2&&n<this._realNumItems&&(e+=this._virtualItems[n].height+this._lineGap)):(t=(n=this._layout==S.ListLayoutType.SingleRow||this._layout==S.ListLayoutType.FlowVertical?(C=r=t,this.getIndexOnPos2(!1)):(C=r=t,this.getIndexOnPos3(!1)),C),n<this._virtualItems.length&&r-t>this._virtualItems[n].width/2&&n<this._realNumItems&&(t+=this._virtualItems[n].width+this._columnGap)),i.x=t,i.y=e,i):o.prototype.getSnappingPosition.call(this,t,e,i)},e.prototype.scrollToView=function(t,e,i){if(t<0&&(console.error("scrollToView index:",t),t=0),this._virtual){if(0!=this._numItems){if(this.checkVirtualList(),t>=this._virtualItems.length)throw"Invalid child index: "+t+">"+this._virtualItems.length;this._loop&&(t=Math.floor(this._firstIndex/this._numItems)*this._numItems+t);var r,n=this._virtualItems[t],o=0;if(this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal){for(r=this._curLineItemCount-1;r<t;r+=this._curLineItemCount)o+=this._virtualItems[r].height+this._lineGap;s=new egret.Rectangle(0,o,this._itemSize.x,n.height)}else if(this._layout==S.ListLayoutType.SingleRow||this._layout==S.ListLayoutType.FlowVertical){for(r=this._curLineItemCount-1;r<t;r+=this._curLineItemCount)o+=this._virtualItems[r].width+this._columnGap;s=new egret.Rectangle(o,0,n.width,this._itemSize.y)}else var a=t/(this._curLineItemCount*this._curLineItemCount2),s=new egret.Rectangle(a*this.viewWidth+t%this._curLineItemCount*(n.width+this._columnGap),t/this._curLineItemCount%this._curLineItemCount2*(n.height+this._lineGap),n.width,n.height);this._scrollPane&&this._scrollPane.scrollToView(s,e,i)}}else{s=this.getChildAt(t);s&&(this._scrollPane?this._scrollPane.scrollToView(s,e,i):this.parent&&this.parent.scrollPane&&this.parent.scrollPane.scrollToView(s,e,i))}},e.prototype.getFirstChildInView=function(){return this.childIndexToItemIndex(o.prototype.getFirstChildInView.call(this))},e.prototype.childIndexToItemIndex=function(t){if(!this._virtual)return t;if(this._layout!=S.ListLayoutType.Pagination)return t+=this._firstIndex,this._loop&&0<this._numItems&&(t%=this._numItems),t;for(var e=this._firstIndex;e<this._realNumItems;e++)if(this._virtualItems[e].obj&&--t<0)return e;return t},e.prototype.itemIndexToChildIndex=function(t){return this._virtual?this._layout==S.ListLayoutType.Pagination?this.getChildIndex(this._virtualItems[t].obj):(this._loop&&0<this._numItems?(e=this._firstIndex%this._numItems)<=t?t-=e:t=this._numItems-e+t:t-=this._firstIndex,t):t;var e},e.prototype.setVirtual=function(){this._setVirtual(!1)},e.prototype.setVirtualAndLoop=function(){this._setVirtual(!0)},e.prototype._setVirtual=function(t){if(!this._virtual){if(null==this._scrollPane)throw"Virtual list must be scrollable!";if(t){if(this._layout==S.ListLayoutType.FlowHorizontal||this._layout==S.ListLayoutType.FlowVertical)throw"Loop list is not supported for FlowHorizontal or FlowVertical layout!";this._scrollPane.bouncebackEffect=!1}if(this._virtual=!0,this._loop=t,this._virtualItems=new Array,this.removeChildrenToPool(),null==this._itemSize){this._itemSize=new egret.Point;t=this.getFromPool(null);if(null==t)throw"Virtual List must have a default list item resource.";this._itemSize.x=t.width,this._itemSize.y=t.height,this.returnToPool(t)}this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal?(this._scrollPane.scrollStep=this._itemSize.y,this._loop&&(this._scrollPane._loop=2)):(this._scrollPane.scrollStep=this._itemSize.x,this._loop&&(this._scrollPane._loop=1)),this._scrollPane.addEventListener(S.ScrollPane.SCROLL,this.__scrolled,this),this.setVirtualListChangedFlag(!0)}},Object.defineProperty(e.prototype,"numItems",{get:function(){return this._virtual?this._numItems:this._children.length},set:function(t){if(this._virtual)if(null!=this.itemRenderer){this._numItems=t,this._loop?this._realNumItems=6*this._numItems:this._realNumItems=this._numItems;var e=this._virtualItems.length;if(this._realNumItems>e)for(n=e;n<this._realNumItems;n++){var i={width:this._itemSize.x,height:this._itemSize.y,updateFlag:0};this._virtualItems.push(i)}else for(n=this._realNumItems;n<e;n++)this._virtualItems[n].selected=!1;0!=this._virtualListChanged&&S.GTimers.inst.remove(this._refreshVirtualList,this),this._refreshVirtualList()}else console.error("Set itemRenderer first!");else{var r=this._children.length;if(r<t)for(var n=r;n<t;n++)null==this.itemProvider?this.addItemFromPool():this.addItemFromPool(this.itemProvider.call(this.callbackThisObj,n));else this.removeChildrenToPool(t,r);if(null!=this.itemRenderer)for(n=0;n<t;n++)this.itemRenderer.call(this.callbackThisObj,n,this.getChildAt(n))}},enumerable:!0,configurable:!0}),e.prototype.refreshVirtualList=function(){this.setVirtualListChangedFlag(!1)},e.prototype.checkVirtualList=function(){0!=this._virtualListChanged&&(this._refreshVirtualList(),S.GTimers.inst.remove(this._refreshVirtualList,this))},e.prototype.setVirtualListChangedFlag=function(t){t?this._virtualListChanged=2:0==this._virtualListChanged&&(this._virtualListChanged=1),S.GTimers.inst.callLater(this._refreshVirtualList,this)},e.prototype._refreshVirtualList=function(){var t=2==this._virtualListChanged;this._virtualListChanged=0,this._eventLocked=!0,t&&(this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.SingleRow?this._curLineItemCount=1:this._layout==S.ListLayoutType.FlowHorizontal?0<this._columnCount?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):this._layout==S.ListLayoutType.FlowVertical?0<this._lineCount?this._curLineItemCount=this._lineCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)):(0<this._columnCount?this._curLineItemCount=this._columnCount:(this._curLineItemCount=Math.floor((this._scrollPane.viewWidth+this._columnGap)/(this._itemSize.x+this._columnGap)),this._curLineItemCount<=0&&(this._curLineItemCount=1)),0<this._lineCount?this._curLineItemCount2=this._lineCount:(this._curLineItemCount2=Math.floor((this._scrollPane.viewHeight+this._lineGap)/(this._itemSize.y+this._lineGap)),this._curLineItemCount2<=0&&(this._curLineItemCount2=1))));var e=0,i=0;if(0<this._realNumItems){var r,n=Math.ceil(this._realNumItems/this._curLineItemCount)*this._curLineItemCount,o=Math.min(this._curLineItemCount,this._realNumItems);if(this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal){for(r=0;r<n;r+=this._curLineItemCount)e+=this._virtualItems[r].height+this._lineGap;if(0<e&&(e-=this._lineGap),this._autoResizeItem)i=this._scrollPane.viewWidth;else{for(r=0;r<o;r++)i+=this._virtualItems[r].width+this._columnGap;0<i&&(i-=this._columnGap)}}else if(this._layout==S.ListLayoutType.SingleRow||this._layout==S.ListLayoutType.FlowVertical){for(r=0;r<n;r+=this._curLineItemCount)i+=this._virtualItems[r].width+this._columnGap;if(0<i&&(i-=this._columnGap),this._autoResizeItem)e=this._scrollPane.viewHeight;else{for(r=0;r<o;r++)e+=this._virtualItems[r].height+this._lineGap;0<e&&(e-=this._lineGap)}}else i=Math.ceil(n/(this._curLineItemCount*this._curLineItemCount2))*this.viewWidth,e=this.viewHeight}this.handleAlign(i,e),this._scrollPane.setContentSize(i,e),this._eventLocked=!1,this.handleScroll(!0)},e.prototype.__scrolled=function(t){this.handleScroll(!1)},e.prototype.getIndexOnPos1=function(t){if(this._realNumItems<this._curLineItemCount)return C=0;var e,i,r;if(0<this.numChildren&&!t){if(i=this.getChildAt(0).y,C<i){for(e=this._firstIndex-this._curLineItemCount;0<=e;e-=this._curLineItemCount)if((i-=this._virtualItems[e].height+this._lineGap)<=C)return C=i,e;return C=0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(r=i+this._virtualItems[e].height+this._lineGap,C<r)return C=i,e;i=r}return C=i,this._realNumItems-this._curLineItemCount}for(e=i=0;e<this._realNumItems;e+=this._curLineItemCount){if(r=i+this._virtualItems[e].height+this._lineGap,C<r)return C=i,e;i=r}return C=i,this._realNumItems-this._curLineItemCount},e.prototype.getIndexOnPos2=function(t){if(this._realNumItems<this._curLineItemCount)return C=0;var e,i,r;if(0<this.numChildren&&!t){if(i=this.getChildAt(0).x,C<i){for(e=this._firstIndex-this._curLineItemCount;0<=e;e-=this._curLineItemCount)if((i-=this._virtualItems[e].width+this._columnGap)<=C)return C=i,e;return C=0}for(e=this._firstIndex;e<this._realNumItems;e+=this._curLineItemCount){if(r=i+this._virtualItems[e].width+this._columnGap,C<r)return C=i,e;i=r}return C=i,this._realNumItems-this._curLineItemCount}for(e=i=0;e<this._realNumItems;e+=this._curLineItemCount){if(r=i+this._virtualItems[e].width+this._columnGap,C<r)return C=i,e;i=r}return C=i,this._realNumItems-this._curLineItemCount},e.prototype.getIndexOnPos3=function(t){if(this._realNumItems<this._curLineItemCount)return C=0;for(var e,i=this.viewWidth,r=Math.floor(C/i),n=r*(this._curLineItemCount*this._curLineItemCount2),o=r*i,a=0;a<this._curLineItemCount;a++){if(e=o+this._virtualItems[n+a].width+this._columnGap,C<e)return C=o,n+a;o=e}return C=o,n+this._curLineItemCount-1},e.prototype.handleScroll=function(t){if(this.parent&&!this._eventLocked){if(this._layout==S.ListLayoutType.SingleColumn||this._layout==S.ListLayoutType.FlowHorizontal){for(var e=0;this.handleScroll1(t);)if(t=!1,20<++e){console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");break}this.handleArchOrder1()}else if(this._layout==S.ListLayoutType.SingleRow||this._layout==S.ListLayoutType.FlowVertical){for(e=0;this.handleScroll2(t);)if(t=!1,20<++e){console.log("FairyGUI: list will never be filled as the item renderer function always returns a different size.");break}this.handleArchOrder2()}else this.handleScroll3(t);this._boundsChanged=!1}},e.prototype.handleScroll1=function(t){var e=(n=this._scrollPane.scrollingPosY)+this._scrollPane.viewHeight,i=e==this._scrollPane.contentHeight;C=n;var r=this.getIndexOnPos1(t),n=C;if(r==this._firstIndex&&!t)return!1;var o,a=this._firstIndex,s=this._firstIndex=r,h=r<a,l=this.numChildren,u=a+l-1,c=h?u:a,p=0,d=n;0==d&&(d=1);var f,_,g,y,m=0,v=0,b=this.defaultItem,T=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;s<this._realNumItems&&(i||d<e);){if(null!=(f=this._virtualItems[s]).obj&&!t||(null!=this.itemProvider&&(null==(b=this.itemProvider.call(this.callbackThisObj,s%this._numItems))&&(b=this._defaultItem),b=S.UIPackage.normalizeURL(b)),f.obj&&f.obj.resourceURL!=b&&(f.obj instanceof S.GButton&&(f.selected=f.obj.selected),this.removeChildToPool(f.obj),f.obj=null)),null==f.obj){if(h){for(y=c;a<=y;y--)if((_=this._virtualItems[y]).obj&&_.updateFlag!=this.itemInfoVer&&_.obj.resourceURL==b){_.obj instanceof S.GButton&&(_.selected=_.obj.selected),f.obj=_.obj,_.obj=null,y==c&&c--;break}}else for(y=c;y<=u;y++)if((_=this._virtualItems[y]).obj&&_.updateFlag!=this.itemInfoVer&&_.obj.resourceURL==b){_.obj instanceof S.GButton&&(_.selected=_.obj.selected),f.obj=_.obj,_.obj=null,y==c&&c++;break}if(f.obj)this.setChildIndex(f.obj,h?s-r:this.numChildren);else{if(f.obj=this._pool.getObject(b),!f.obj)return console.error("ii.obj is null"),!1;h?this.addChildAt(f.obj,s-r):this.addChild(f.obj)}f.obj instanceof S.GButton&&(f.obj.selected=f.selected),o=!0}else o=t;o&&(this._autoResizeItem&&(this._layout==S.ListLayoutType.SingleColumn||0<this._columnCount)&&f.obj.setSize(T,f.obj.height,!0),this.itemRenderer.call(this.callbackThisObj,s%this._numItems,f.obj),s%this._curLineItemCount==0&&(m+=Math.ceil(f.obj.height)-f.height,s==r&&r<a&&(v=Math.ceil(f.obj.height)-f.height)),f.width=Math.ceil(f.obj.width),f.height=Math.ceil(f.obj.height)),f.updateFlag=this.itemInfoVer,f.obj.setXY(p,d),s==r&&(e+=f.height),p+=f.width+this._columnGap,s%this._curLineItemCount==this._curLineItemCount-1&&(p=0,d+=f.height+this._lineGap),s++}for(g=0;g<l;g++)(f=this._virtualItems[a+g]).updateFlag!=this.itemInfoVer&&f.obj&&(f.obj instanceof S.GButton&&(f.selected=f.obj.selected),this.removeChildToPool(f.obj),f.obj=null);for(l=this._children.length,g=0;g<l;g++){var x=this._virtualItems[r+g].obj;this._children[g]!=x&&this.setChildIndex(x,g)}return 0==m&&0==v||this._scrollPane.changeContentSizeOnScrolling(0,m,0,v),0<s&&0<this.numChildren&&this._container.y<=0&&this.getChildAt(0).y>-this._container.y},e.prototype.handleScroll2=function(t){var e=(n=this._scrollPane.scrollingPosX)+this._scrollPane.viewWidth,i=n==this._scrollPane.contentWidth;C=n;var r=this.getIndexOnPos2(t),n=C;if(r==this._firstIndex&&!t)return!1;var o,a,s,h,l,u=this._firstIndex,c=this._firstIndex=r,p=r<u,d=this.numChildren,f=u+d-1,_=p?f:u,g=n,y=0,m=0,v=0,b=this.defaultItem,T=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount-1))/this._curLineItemCount;for(this.itemInfoVer++;c<this._realNumItems&&(i||g<e);){if(null!=(a=this._virtualItems[c]).obj&&!t||(null!=this.itemProvider&&(null==(b=this.itemProvider.call(this.callbackThisObj,c%this._numItems))&&(b=this._defaultItem),b=S.UIPackage.normalizeURL(b)),a.obj&&a.obj.resourceURL!=b&&(a.obj instanceof S.GButton&&(a.selected=a.obj.selected),this.removeChildToPool(a.obj),a.obj=null)),null==a.obj){if(p){for(l=_;u<=l;l--)if((s=this._virtualItems[l]).obj&&s.updateFlag!=this.itemInfoVer&&s.obj.resourceURL==b){s.obj instanceof S.GButton&&(s.selected=s.obj.selected),a.obj=s.obj,s.obj=null,l==_&&_--;break}}else for(l=_;l<=f;l++)if((s=this._virtualItems[l]).obj&&s.updateFlag!=this.itemInfoVer&&s.obj.resourceURL==b){s.obj instanceof S.GButton&&(s.selected=s.obj.selected),a.obj=s.obj,s.obj=null,l==_&&_++;break}a.obj?this.setChildIndex(a.obj,p?c-r:this.numChildren):(a.obj=this._pool.getObject(b),p?this.addChildAt(a.obj,c-r):this.addChild(a.obj)),a.obj instanceof S.GButton&&(a.obj.selected=a.selected),o=!0}else o=t;o&&(this._autoResizeItem&&(this._layout==S.ListLayoutType.SingleRow||0<this._lineCount)&&a.obj.setSize(a.obj.width,T,!0),this.itemRenderer.call(this.callbackThisObj,c%this._numItems,a.obj),c%this._curLineItemCount==0&&(m+=Math.ceil(a.obj.width)-a.width,c==r&&r<u&&(v=Math.ceil(a.obj.width)-a.width)),a.width=Math.ceil(a.obj.width),a.height=Math.ceil(a.obj.height)),a.updateFlag=this.itemInfoVer,a.obj.setXY(g,y),c==r&&(e+=a.width),y+=a.height+this._lineGap,c%this._curLineItemCount==this._curLineItemCount-1&&(y=0,g+=a.width+this._columnGap),c++}for(h=0;h<d;h++)(a=this._virtualItems[u+h]).updateFlag!=this.itemInfoVer&&a.obj&&(a.obj instanceof S.GButton&&(a.selected=a.obj.selected),this.removeChildToPool(a.obj),a.obj=null);for(d=this._children.length,h=0;h<d;h++){var x=this._virtualItems[r+h].obj;this._children[h]!=x&&this.setChildIndex(x,h)}return 0==m&&0==v||this._scrollPane.changeContentSizeOnScrolling(m,0,v,0),0<c&&0<this.numChildren&&this._container.x<=0&&this.getChildAt(0).x>-this._container.x},e.prototype.handleScroll3=function(t){var e=this._scrollPane.scrollingPosX;C=e;var i=this.getIndexOnPos3(t);if(i!=this._firstIndex||t){e=this._firstIndex;this._firstIndex=i;var r,n,o,a,s,h=e,l=this._virtualItems.length,u=this._curLineItemCount*this._curLineItemCount2,c=i%this._curLineItemCount,p=this.viewWidth,d=Math.floor(i/u)*u,f=d+2*u,_=this._defaultItem,g=(this._scrollPane.viewWidth-this._columnGap*(this._curLineItemCount-1))/this._curLineItemCount,y=(this._scrollPane.viewHeight-this._lineGap*(this._curLineItemCount2-1))/this._curLineItemCount2;for(this.itemInfoVer++,v=d;v<f;v++)if(!(v>=this._realNumItems)){if(a=v%this._curLineItemCount,v-d<u){if(a<c)continue}else if(c<a)continue;(n=this._virtualItems[v]).updateFlag=this.itemInfoVer}for(var m=0,v=d;v<f;v++)if(!(v>=this._realNumItems)&&(n=this._virtualItems[v]).updateFlag==this.itemInfoVer){if(null==n.obj){for(;h<l;){if((o=this._virtualItems[h]).obj&&o.updateFlag!=this.itemInfoVer){o.obj instanceof S.GButton&&(o.selected=o.obj.selected),n.obj=o.obj,o.obj=null;break}h++}-1==m&&(m=this.getChildIndex(s)+1),null==n.obj?(null!=this.itemProvider&&(null==(_=this.itemProvider.call(this.callbackThisObj,v%this._numItems))&&(_=this._defaultItem),_=S.UIPackage.normalizeURL(_)),n.obj=this._pool.getObject(_),this.addChildAt(n.obj,m)):m=this.setChildIndexBefore(n.obj,m),m++,n.obj instanceof S.GButton&&(n.obj.selected=n.selected),r=!0}else r=t,m=-1,s=n.obj;r&&(this._autoResizeItem&&(this._curLineItemCount==this._columnCount&&this._curLineItemCount2==this._lineCount?n.obj.setSize(g,y,!0):this._curLineItemCount==this._columnCount?n.obj.setSize(g,n.obj.height,!0):this._curLineItemCount2==this._lineCount&&n.obj.setSize(n.obj.width,y,!0)),this.itemRenderer.call(this.callbackThisObj,v%this._numItems,n.obj),n.width=Math.ceil(n.obj.width),n.height=Math.ceil(n.obj.height))}var b=d/u*p,T=b,x=0,w=0;for(v=d;v<f;v++)v>=this._realNumItems||((n=this._virtualItems[v]).updateFlag==this.itemInfoVer&&n.obj.setXY(T,x),n.height>w&&(w=n.height),v%this._curLineItemCount==this._curLineItemCount-1?(T=b,x+=w+this._lineGap,w=0,v==d+u-1&&(T=b+=p,x=0)):T+=n.width+this._columnGap);for(v=h;v<l;v++)(n=this._virtualItems[v]).updateFlag!=this.itemInfoVer&&n.obj&&(n.obj instanceof S.GButton&&(n.selected=n.obj.selected),this.removeChildToPool(n.obj),n.obj=null)}},e.prototype.handleArchOrder1=function(){if(this._childrenRenderOrder==S.ChildrenRenderOrder.Arch){for(var t,e=this._scrollPane.posY+this.viewHeight/2,i=Number.POSITIVE_INFINITY,r=0,n=this.numChildren,o=0;o<n;o++){var a=this.getChildAt(o);this.foldInvisibleItems&&!a.visible||(t=Math.abs(e-a.y-a.height/2))<i&&(i=t,r=o)}this.apexIndex=r}},e.prototype.handleArchOrder2=function(){if(this._childrenRenderOrder==S.ChildrenRenderOrder.Arch){for(var t,e=this._scrollPane.posX+this.viewWidth/2,i=Number.POSITIVE_INFINITY,r=0,n=this.numChildren,o=0;o<n;o++){var a=this.getChildAt(o);this.foldInvisibleItems&&!a.visible||(t=Math.abs(e-a.x-a.width/2))<i&&(i=t,r=o)}this.apexIndex=r}},e.prototype.handleAlign=function(t,e){var i=0,r=0;e<this.viewHeight&&(this._verticalAlign==S.VertAlignType.Middle?r=Math.floor((this.viewHeight-e)/2):this._verticalAlign==S.VertAlignType.Bottom&&(r=this.viewHeight-e)),t<this.viewWidth&&(this._align==S.AlignType.Center?i=Math.floor((this.viewWidth-t)/2):this._align==S.AlignType.Right&&(i=this.viewWidth-t)),i==this._alignOffset.x&&r==this._alignOffset.y||(this._alignOffset.setTo(i,r),this._scrollPane?this._scrollPane.adjustMaskContainer():(this._container.x=this._margin.left+this._alignOffset.x,this._container.y=this._margin.top+this._alignOffset.y))},e.prototype.updateBounds=function(){if(!this._virtual){var t,e,i,r=0,n=1,o=0,a=0,s=0,h=0,l=0,u=0,c=0,p=this._children.length,d=this.viewWidth,f=this.viewHeight,_=0,g=0,y=0;if(this._layout==S.ListLayoutType.SingleColumn){for(t=0;t<p;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=n&&(n+=this._lineGap),e.y=n,this._autoResizeItem&&e.setSize(d,e.height,!0),n+=Math.ceil(e.height),e.width>o&&(o=e.width));if((h=n)<=f&&this._autoResizeItem&&this._scrollPane&&this._scrollPane._displayInDemand&&this._scrollPane.vtScrollBar)for(d+=this._scrollPane.vtScrollBar.width,t=0;t<p;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(e.setSize(d,e.height,!0),e.width>o&&(o=e.width));s=Math.ceil(o)}else if(this._layout==S.ListLayoutType.SingleRow){for(t=0;t<p;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=r&&(r+=this._columnGap),e.x=r,this._autoResizeItem&&e.setSize(e.width,f,!0),r+=Math.ceil(e.width),e.height>a&&(a=e.height));if((s=r)<=d&&this._autoResizeItem&&this._scrollPane&&this._scrollPane._displayInDemand&&this._scrollPane.hzScrollBar)for(f+=this._scrollPane.hzScrollBar.height,t=0;t<p;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(e.setSize(e.width,f,!0),e.height>a&&(a=e.height));h=Math.ceil(a)}else if(this._layout==S.ListLayoutType.FlowHorizontal)if(this._autoResizeItem&&0<this._columnCount){for(t=0;t<p;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(_+=e.sourceWidth,++l==this._columnCount||t==p-1)){for(y=(d-_-(l-1)*this._columnGap)/_,r=0,l=g;l<=t;l++)e=this.getChildAt(l),this.foldInvisibleItems&&!e.visible||(e.setXY(r,n),l<t?(e.setSize(e.sourceWidth+Math.round(e.sourceWidth*y),e.height,!0),r+=Math.ceil(e.width)+this._columnGap):e.setSize(d-r,e.height,!0),e.height>a&&(a=e.height));n+=Math.ceil(a)+this._lineGap,g=t+1,_=l=a=0}h=n+Math.ceil(a),s=d}else{for(t=0;t<p;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=r&&(r+=this._columnGap),(0!=this._columnCount&&l>=this._columnCount||0==this._columnCount&&r+e.width>d&&0!=a)&&(r=0,n+=Math.ceil(a)+this._lineGap,l=a=0),e.setXY(r,n),o<(r+=Math.ceil(e.width))&&(o=r),e.height>a&&(a=e.height),l++);h=n+Math.ceil(a),s=Math.ceil(o)}else if(this._layout==S.ListLayoutType.FlowVertical)if(this._autoResizeItem&&0<this._lineCount){for(t=0;t<p;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(_+=e.sourceHeight,++l==this._lineCount||t==p-1)){for(y=(f-_-(l-1)*this._lineGap)/_,n=0,l=g;l<=t;l++)e=this.getChildAt(l),this.foldInvisibleItems&&!e.visible||(e.setXY(r,n),l<t?(e.setSize(e.width,e.sourceHeight+Math.round(e.sourceHeight*y),!0),n+=Math.ceil(e.height)+this._lineGap):e.setSize(e.width,f-n,!0),e.width>o&&(o=e.width));r+=Math.ceil(o)+this._columnGap,g=t+1,_=l=o=0}s=r+Math.ceil(o),h=f}else{for(t=0;t<p;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=n&&(n+=this._lineGap),(0!=this._lineCount&&l>=this._lineCount||0==this._lineCount&&n+e.height>f&&0!=o)&&(n=0,r+=Math.ceil(o)+this._columnGap,l=o=0),e.setXY(r,n),a<(n+=Math.ceil(e.height))&&(a=n),e.width>o&&(o=e.width),l++);s=r+Math.ceil(o),h=Math.ceil(a)}else{if(this._autoResizeItem&&0<this._lineCount&&(i=Math.floor((f-(this._lineCount-1)*this._lineGap)/this._lineCount)),this._autoResizeItem&&0<this._columnCount){for(t=0;t<p;t++)if(e=this.getChildAt(t),(!this.foldInvisibleItems||e.visible)&&(0==l&&(0!=this._lineCount&&c>=this._lineCount||0==this._lineCount&&n+(0<this._lineCount?i:e.height)>f)&&(u++,c=n=0),_+=e.sourceWidth,++l==this._columnCount||t==p-1)){for(y=(d-_-(l-1)*this._columnGap)/_,r=0,l=g;l<=t;l++)e=this.getChildAt(l),this.foldInvisibleItems&&!e.visible||(e.setXY(u*d+r,n),l<t?(e.setSize(e.sourceWidth+Math.round(e.sourceWidth*y),0<this._lineCount?i:e.height,!0),r+=Math.ceil(e.width)+this._columnGap):e.setSize(d-r,0<this._lineCount?i:e.height,!0),e.height>a&&(a=e.height));n+=Math.ceil(a)+this._lineGap,g=t+1,_=l=a=0,c++}}else for(t=0;t<p;t++)e=this.getChildAt(t),this.foldInvisibleItems&&!e.visible||(0!=r&&(r+=this._columnGap),this._autoResizeItem&&0<this._lineCount&&e.setSize(e.width,i,!0),(0!=this._columnCount&&l>=this._columnCount||0==this._columnCount&&r+e.width>d&&0!=a)&&(r=0,n+=Math.ceil(a)+this._lineGap,c++,((l=a=0)!=this._lineCount&&c>=this._lineCount||0==this._lineCount&&n+e.height>f&&0!=o)&&(u++,c=n=0)),e.setXY(u*d+r,n),o<(r+=Math.ceil(e.width))&&(o=r),e.height>a&&(a=e.height),l++);h=0<u?f:n+Math.ceil(a),s=(u+1)*d}this.handleAlign(s,h),this.setBounds(0,0,s,h)}},e.prototype.setup_beforeAdd=function(t,e){o.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),this._layout=t.readByte(),this._selectionMode=t.readByte(),this._align=t.readByte(),this._verticalAlign=t.readByte(),this._lineGap=t.readShort(),this._columnGap=t.readShort(),this._lineCount=t.readShort(),this._columnCount=t.readShort(),this._autoResizeItem=t.readBool(),this._childrenRenderOrder=t.readByte(),this._apexIndex=t.readShort(),t.readBool()&&(this._margin.top=t.readInt(),this._margin.bottom=t.readInt(),this._margin.left=t.readInt(),this._margin.right=t.readInt());var i,r=t.readByte();r==S.OverflowType.Scroll?(i=t.position,t.seek(e,7),this.setupScroll(t),t.position=i):this.setupOverflow(r),t.readBool()&&t.skip(8),2<=t.version&&(t.readBool(),this.foldInvisibleItems=t.readBool()),t.seek(e,8),this._defaultItem=t.readS(),this.readItems(t)},e.prototype.readItems=function(t){for(var e=t.readShort(),i=0;i<e;i++){var r,n=t.readShort();n+=t.position,null!=(r=t.readS())||(r=this.defaultItem)?(null!=(r=this.getFromPool(r))&&(this.addChild(r),this.setupItem(t,r)),t.position=n):t.position=n}},e.prototype.setupItem=function(t,e){var i,r;if(null!=(o=t.readS())&&(e.text=o),null!=(o=t.readS())&&e instanceof S.GButton&&(e.selectedTitle=o),null!=(o=t.readS())&&(e.icon=o),null!=(o=t.readS())&&e instanceof S.GButton&&(e.selectedIcon=o),null!=(o=t.readS())&&(e.name=o),e instanceof S.GComponent){for(i=t.readShort(),r=0;r<i;r++){var n=e.getController(t.readS()),o=t.readS();n&&(n.selectedPageId=o)}if(2<=t.version)for(i=t.readShort(),r=0;r<i;r++){var a=t.readS(),s=t.readShort(),h=t.readS(),a=e.getChildByPath(a);a&&a.setProp(s,h)}}},e.prototype.setup_afterAdd=function(t,e){o.prototype.setup_afterAdd.call(this,t,e),t.seek(e,6);t=t.readShort();-1!=t&&(this._selectionController=this.parent.getControllerAt(t))},e);function e(){var t=o.call(this)||this;return t.scrollItemToViewOnClick=!1,t.foldInvisibleItems=!1,t._lineCount=0,t._columnCount=0,t._lineGap=0,t._columnGap=0,t._lastSelectedIndex=0,t._numItems=0,t._realNumItems=0,t._firstIndex=0,t._curLineItemCount=0,t._curLineItemCount2=0,t._virtualListChanged=0,t.itemInfoVer=0,t._trackBounds=!0,t._pool=new S.GObjectPool,t._layout=S.ListLayoutType.SingleColumn,t._autoResizeItem=!0,t._lastSelectedIndex=-1,t._selectionMode=S.ListSelectionMode.Single,t.opaque=!0,t._align=S.AlignType.Left,t._verticalAlign=S.VertAlignType.Top,t._container=new egret.DisplayObjectContainer,t._rootContainer.addChild(t._container),t}S.GList=t;var C=0}(fgui=fgui||{}),function(i){var t=(e.prototype.clear=function(){for(var t in this._pool)for(var e=this._pool[t],i=e.length,r=0;r<i;r++)e[r].dispose();this._pool={},this._count=0},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype.getObject=function(t){if(null==(t=i.UIPackage.normalizeURL(t)))return null;var e=this._pool[t];return e&&e.length?(this._count--,e.shift()):i.UIPackage.createObjectFromURL(t)},e.prototype.returnObject=function(t){var e,i=t.resourceURL;i&&(null==(e=this._pool[i])&&(e=new Array,this._pool[i]=e),this._count++,e.push(t))},e);function e(){this._count=0,this._pool={}}i.GObjectPool=t}(fgui=fgui||{}),function(n){var i,t=(i=n.GObject,__extends(e,i),e.prototype.createDisplayObject=function(){this._container=new n.UIContainer,this._container.opaque=!0,this.setDisplayObject(this._container),this._content=new n.MovieClip,this._container.addChild(this._content)},e.prototype.dispose=function(){var t;this._contentItem||(t=this._content.texture)&&this.freeExternal(t),this._content2&&this._content2.dispose(),i.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url!=t&&(this.clearContent(),this._url=t,this.loadContent(),this.updateGear(7))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._url},set:function(t){this.url=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fill},set:function(t){this._fill!=t&&(this._fill=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shrinkOnly",{get:function(){return this._shrinkOnly},set:function(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._content.playing},set:function(t){this._content.playing!=t&&(this._content.playing=t,this.updateGear(5))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._content.frame},set:function(t){this._content.frame!=t&&(this._content.frame=t,this.updateGear(5))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._content.color},set:function(t){this._content.color!=t&&(this._content.color=t,this.updateGear(4))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showErrorSign",{get:function(){return this._showErrorSign},set:function(t){this._showErrorSign=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"component",{get:function(){return this._content2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._content.texture},set:function(t){this.url=null,this._content.frames=null,(this._content.texture=t)?(this.sourceWidth=t.textureWidth,this.sourceHeight=t.textureHeight):this.sourceWidth=this.sourceHeight=0,this.updateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillMethod",{get:function(){return this._content.fillMethod},set:function(t){this._content.fillMethod=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOrigin",{get:function(){return this._content.fillOrigin},set:function(t){this._content.fillOrigin=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillClockwise",{get:function(){return this._content.fillClockwise},set:function(t){this._content.fillClockwise=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillAmount",{get:function(){return this._content.fillAmount},set:function(t){this._content.fillAmount=t},enumerable:!0,configurable:!0}),e.prototype.loadContent=function(){this._url&&(n.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},e.prototype.loadFromPackage=function(t){var e;this._contentItem=n.UIPackage.getItemByURL(t),this._contentItem?(this._contentItem=this._contentItem.getBranch(),this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this._contentItem=this._contentItem.getHighResolution(),this._contentItem.load(),this._autoSize&&this.setSize(this.sourceWidth,this.sourceHeight),this._contentItem.type==n.PackageItemType.Image?null==this._contentItem.asset?this.setErrorState():(this._content.texture=this._contentItem.asset,this._content.scale9Grid=this._contentItem.scale9Grid,this._contentItem.scaleByTile?this._content.fillMode=egret.BitmapFillMode.REPEAT:this._content.fillMode=egret.BitmapFillMode.SCALE,this.updateLayout()):this._contentItem.type==n.PackageItemType.MovieClip?(this._content.interval=this._contentItem.interval,this._content.swing=this._contentItem.swing,this._content.repeatDelay=this._contentItem.repeatDelay,this._content.frames=this._contentItem.frames,this.updateLayout()):this._contentItem.type==n.PackageItemType.Component&&(e=n.UIPackage.createObjectFromURL(t))?e instanceof n.GComponent?(this._content2=e.asCom,this._container.addChild(this._content2.displayObject),this.updateLayout()):(e.dispose(),this.setErrorState()):this.setErrorState()):this.setErrorState()},e.prototype.loadExternal=function(){RES.getResByUrl(this._url,this.__getResCompleted,this)},e.prototype.freeExternal=function(t){},e.prototype.onExternalLoadSuccess=function(t){this._content.texture=t,this._content.scale9Grid=null,this._content.fillMode=egret.BitmapFillMode.SCALE,this.sourceWidth=t.textureWidth,this.sourceHeight=t.textureHeight,this.updateLayout()},e.prototype.onExternalLoadFailed=function(){this.setErrorState()},e.prototype.__getResCompleted=function(t,e){t instanceof egret.Texture?this.onExternalLoadSuccess(t):this.onExternalLoadFailed()},e.prototype.setErrorState=function(){this._showErrorSign&&(null==this._errorSign&&null!=n.UIConfig.loaderErrorSign&&(this._errorSign=e._errorSignPool.getObject(n.UIConfig.loaderErrorSign)),this._errorSign&&(this._errorSign.setSize(this.width,this.height),this._container.addChild(this._errorSign.displayObject)))},e.prototype.clearErrorState=function(){this._errorSign&&(this._container.removeChild(this._errorSign.displayObject),e._errorSignPool.returnObject(this._errorSign),this._errorSign=null)},e.prototype.updateLayout=function(){var t,e,i,r;this._content2||this._content?(i=this.sourceWidth,r=this.sourceHeight,this._autoSize&&(this._updatingLayout=!0,this.setSize(i=0==i?50:i,r=0==r?30:r),this._updatingLayout=!1,i==this._width&&r==this._height)?this._content2?(this._content2.setXY(0,0),this._content2.setScale(1,1)):(this._content.x=0,this._content.y=0,this._content.width=i,this._content.height=r):(e=t=1,this._fill!=n.LoaderFillType.None&&(t=this.width/this.sourceWidth,e=this.height/this.sourceHeight,1==t&&1==e||(this._fill==n.LoaderFillType.ScaleMatchHeight?t=e:this._fill==n.LoaderFillType.ScaleMatchWidth?e=t:this._fill==n.LoaderFillType.Scale?e<t?t=e:e=t:this._fill==n.LoaderFillType.ScaleNoBorder&&(e<t?e=t:t=e),this._shrinkOnly&&(1<t&&(t=1),1<e&&(e=1)),i=this.sourceWidth*t,r=this.sourceHeight*e)),this._content2?this._content2.setScale(t,e):(this._content.width=i,this._content.height=r),i=this._align==n.AlignType.Center?Math.floor((this.width-i)/2):this._align==n.AlignType.Right?this.width-i:0,r=this._verticalAlign==n.VertAlignType.Middle?Math.floor((this.height-r)/2):this._verticalAlign==n.VertAlignType.Bottom?this.height-r:0,this._content2?this._content2.setXY(i,r):(this._content.x=i,this._content.y=r))):this._autoSize&&(this._updatingLayout=!0,this.setSize(50,30),this._updatingLayout=!1)},e.prototype.clearContent=function(){this.clearErrorState(),!this._contentItem&&this._content.texture&&this.freeExternal(this._content.texture),this._content.texture=null,this._content.frames=null,this._content2&&(this._container.removeChild(this._content2.displayObject),this._content2.dispose(),this._content2=null),this._contentItem=null},e.prototype.handleSizeChanged=function(){i.prototype.handleSizeChanged.call(this),this._updatingLayout||this.updateLayout()},e.prototype.getProp=function(t){switch(t){case n.ObjectPropID.Color:return this.color;case n.ObjectPropID.Playing:return this.playing;case n.ObjectPropID.Frame:return this.frame;case n.ObjectPropID.TimeScale:return this._content.timeScale;default:return i.prototype.getProp.call(this,t)}},e.prototype.setProp=function(t,e){switch(t){case n.ObjectPropID.Color:this.color=e;break;case n.ObjectPropID.Playing:this.playing=e;break;case n.ObjectPropID.Frame:this.frame=e;break;case n.ObjectPropID.TimeScale:this._content.timeScale=e;break;case n.ObjectPropID.DeltaTime:this._content.advance(e);break;default:i.prototype.setProp.call(this,t,e)}},e.prototype.setup_beforeAdd=function(t,e){i.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),this._url=t.readS(),this._align=t.readByte(),this._verticalAlign=t.readByte(),this._fill=t.readByte(),this._shrinkOnly=t.readBool(),this._autoSize=t.readBool(),this._showErrorSign=t.readBool(),this._content.playing=t.readBool(),this._content.frame=t.readInt(),t.readBool()&&(this.color=t.readColor()),this._content.fillMethod=t.readByte(),0!=this._content.fillMethod&&(this._content.fillOrigin=t.readByte(),this._content.fillClockwise=t.readBool(),this._content.fillAmount=t.readFloat()),this._url&&this.loadContent()},e._errorSignPool=new n.GObjectPool,e);function e(){var t=i.call(this)||this;return t._url="",t._fill=n.LoaderFillType.None,t._align=n.AlignType.Left,t._verticalAlign=n.VertAlignType.Top,t._showErrorSign=!0,t}n.GLoader=t}(fgui=fgui||{}),function(n){var i,t=(i=n.GObject,__extends(e,i),e.prototype.createDisplayObject=function(){var t=new n.UIContainer;t.opaque=!0,this.setDisplayObject(t),this._container=new egret.DisplayObjectContainer,t.addChild(this._container)},e.prototype.dispose=function(){this.clearContent(),i.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url!=t&&(this._url=t,this.loadContent(),this.updateGear(7))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._url},set:function(t){this.url=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fill},set:function(t){this._fill!=t&&(this._fill=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shrinkOnly",{get:function(){return this._shrinkOnly},set:function(t){this._shrinkOnly!=t&&(this._shrinkOnly=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this.updateLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},set:function(t){this._playing!=t&&(this._playing=t,this.updateGear(5),this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame!=t&&(this._frame=t,this.updateGear(5),this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationName",{get:function(){return this._animationName},set:function(t){this._animationName!=t&&(this._animationName=t,this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skinName",{get:function(){return this._skinName},set:function(t){this._skinName!=t&&(this._skinName=t,this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop!=t&&(this._loop=t,this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,this.updateGear(4),this._content&&(this._content.tint=t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),e.prototype.loadContent=function(){this.clearContent(),this._url&&(n.ToolSet.startsWith(this._url,"ui://")?this.loadFromPackage(this._url):this.loadExternal())},e.prototype.loadFromPackage=function(t){this._contentItem=n.UIPackage.getItemByURL(t),this._contentItem&&(this._contentItem=this._contentItem.getBranch(),this.sourceWidth=this._contentItem.width,this.sourceHeight=this._contentItem.height,this._contentItem=this._contentItem.getHighResolution(),this._autoSize&&this.setSize(this.sourceWidth,this.sourceHeight),this._contentItem.type!=n.PackageItemType.Spine&&this._contentItem.type!=n.PackageItemType.DragonBones||this._contentItem.owner.getItemAssetAsync(this._contentItem,this.onLoaded.bind(this)))},e.prototype.onLoaded=function(t,e){this._contentItem==e&&(t&&console.warn(t),this._contentItem.asset&&this._contentItem.type==n.PackageItemType.DragonBones&&(t=this._contentItem.asset,this.setDragonBones(this._contentItem.armatureName,t.data.name,this._skinName,t.atlasData.name,this._contentItem.skeletonAnchor)))},e.prototype.setDragonBones=function(t,e,i,r,n){this.url=null;var o=dragonBones.EgretFactory.factory;this._content=o.buildArmatureDisplay(t,e,i,r),this._container.addChild(this._content),this._content.x=n.x,this._content.y=n.y,this._content.tint=this._color,this.onChangeDragonBones(),this.updateLayout()},e.prototype.onChange=function(){this.onChangeDragonBones()},e.prototype.onChangeDragonBones=function(){this._content instanceof dragonBones.EgretArmatureDisplay&&(this._animationName?this._playing?this._content.animation.play(this._animationName,this._loop?0:1):this._content.animation.gotoAndStopByFrame(this._animationName,this._frame):this._content.animation.reset())},e.prototype.loadExternal=function(){},e.prototype.updateLayout=function(){var t=this.sourceWidth,e=this.sourceHeight;if(this._autoSize&&(this._updatingLayout=!0,this.setSize(t=0==t?50:t,e=0==e?30:e),this._updatingLayout=!1,t==this._width&&e==this._height))return this._container.scaleX=this._container.scaleY=1,void(this._container.x=this._container.y=0);var i=1,r=1;this._fill!=n.LoaderFillType.None&&(i=this.width/this.sourceWidth,r=this.height/this.sourceHeight,1==i&&1==r||(this._fill==n.LoaderFillType.ScaleMatchHeight?i=r:this._fill==n.LoaderFillType.ScaleMatchWidth?r=i:this._fill==n.LoaderFillType.Scale?r<i?i=r:r=i:this._fill==n.LoaderFillType.ScaleNoBorder&&(r<i?r=i:i=r),this._shrinkOnly&&(1<i&&(i=1),1<r&&(r=1)),t=this.sourceWidth*i,e=this.sourceHeight*r)),this._container.scaleX=i,this._container.scaleY=r,t=this._align==n.AlignType.Center?Math.floor((this.width-t)/2):this._align==n.AlignType.Right?this.width-t:0,e=this._verticalAlign==n.VertAlignType.Middle?Math.floor((this.height-e)/2):this._verticalAlign==n.VertAlignType.Bottom?this.height-e:0,this._container.x=t,this._container.y=e},e.prototype.clearContent=function(){this._contentItem=null,this._content&&(this._container.removeChild(this._content),"dispose"in this._content&&this._content.dispose(),this._content=null)},e.prototype.handleSizeChanged=function(){i.prototype.handleSizeChanged.call(this),this._updatingLayout||this.updateLayout()},e.prototype.handleGrayedChanged=function(){},e.prototype.getProp=function(t){switch(t){case n.ObjectPropID.Color:return this.color;case n.ObjectPropID.Playing:return this.playing;case n.ObjectPropID.Frame:return this.frame;case n.ObjectPropID.TimeScale:return 1;default:return i.prototype.getProp.call(this,t)}},e.prototype.setProp=function(t,e){switch(t){case n.ObjectPropID.Color:this.color=e;break;case n.ObjectPropID.Playing:this.playing=e;break;case n.ObjectPropID.Frame:this.frame=e;break;case n.ObjectPropID.TimeScale:case n.ObjectPropID.DeltaTime:break;default:i.prototype.setProp.call(this,t,e)}},e.prototype.setup_beforeAdd=function(t,e){i.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),this._url=t.readS(),this._align=t.readByte(),this._verticalAlign=t.readByte(),this._fill=t.readByte(),this._shrinkOnly=t.readBool(),this._autoSize=t.readBool(),this._animationName=t.readS(),this._skinName=t.readS(),this._playing=t.readBool(),this._frame=t.readInt(),this._loop=t.readBool(),t.readBool()&&(this.color=t.readColor()),this._url&&this.loadContent()},e);function e(){var t=i.call(this)||this;return t._frame=0,t._playing=!0,t._url="",t._fill=n.LoaderFillType.None,t._align=n.AlignType.Left,t._verticalAlign=n.VertAlignType.Top,t._color=16777215,t}n.GLoader3D=t}(fgui=fgui||{}),function(i){var r,t=(r=i.GObject,__extends(e,r),Object.defineProperty(e.prototype,"color",{get:function(){return this._content.color},set:function(t){this._content.color!=t&&(this._content.color=t,this.updateGear(4))},enumerable:!0,configurable:!0}),e.prototype.createDisplayObject=function(){this._content=new i.MovieClip,this._content.touchEnabled=!1,this.setDisplayObject(this._content)},Object.defineProperty(e.prototype,"playing",{get:function(){return this._content.playing},set:function(t){this._content.playing!=t&&(this._content.playing=t,this.updateGear(5))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._content.frame},set:function(t){this._content.frame!=t&&(this._content.frame=t,this.updateGear(5))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._content.timeScale},set:function(t){this._content.timeScale=t},enumerable:!0,configurable:!0}),e.prototype.rewind=function(){this._content.rewind()},e.prototype.syncStatus=function(t){this._content.syncStatus(t._content)},e.prototype.advance=function(t){this._content.advance(t)},e.prototype.setPlaySettings=function(t,e,i,r,n,o){this._content.setPlaySettings(t,e,i,r,n,o)},e.prototype.getProp=function(t){switch(t){case i.ObjectPropID.Color:return this.color;case i.ObjectPropID.Playing:return this.playing;case i.ObjectPropID.Frame:return this.frame;case i.ObjectPropID.TimeScale:return this.timeScale;default:return r.prototype.getProp.call(this,t)}},e.prototype.setProp=function(t,e){switch(t){case i.ObjectPropID.Color:this.color=e;break;case i.ObjectPropID.Playing:this.playing=e;break;case i.ObjectPropID.Frame:this.frame=e;break;case i.ObjectPropID.TimeScale:this.timeScale=e;break;case i.ObjectPropID.DeltaTime:this.advance(e);break;default:r.prototype.setProp.call(this,t,e)}},e.prototype.constructFromResource=function(){var t=this.packageItem.getBranch();this.sourceWidth=t.width,this.sourceHeight=t.height,this.initWidth=this.sourceWidth,this.initHeight=this.sourceHeight,this.setSize(this.sourceWidth,this.sourceHeight),(t=t.getHighResolution()).load(),this._content.interval=t.interval,this._content.swing=t.swing,this._content.repeatDelay=t.repeatDelay,this._content.frames=t.frames,this._content.smoothing=t.smoothing},e.prototype.setup_beforeAdd=function(t,e){r.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),t.readBool()&&(this.color=t.readColor()),t.readByte(),this._content.frame=t.readInt(),this._content.playing=t.readBool()},e);function e(){return r.call(this)||this}i.GMovieClip=t}(fgui=fgui||{}),function(n){var i,t=(i=n.GComponent,__extends(e,i),Object.defineProperty(e.prototype,"titleType",{get:function(){return this._titleType},set:function(t){this._titleType!=t&&(this._titleType=t,this.update(this._value))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min!=t&&(this._min=t,this.update(this._value))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.update(this._value))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value!=t&&(n.GTween.kill(this,!1,this.update),this._value=t,this.update(t))},enumerable:!0,configurable:!0}),e.prototype.tweenValue=function(t,e){var i,r=n.GTween.getTween(this,this.update);return r?(i=r.value.x,r.kill()):i=this._value,this._value=t,n.GTween.to(i,this._value,e).setTarget(this,this.update).setEase(n.EaseType.Linear)},e.prototype.update=function(t){var e=n.ToolSet.clamp01((t-this._min)/(this._max-this._min));if(this._titleObject)switch(this._titleType){case n.ProgressTitleType.Percent:this._titleObject.text=(100*e).toFixed(this.fixed)+"%";break;case n.ProgressTitleType.ValueAndMax:this._titleObject.text=Math.floor(t)+"/"+Math.floor(this._max);break;case n.ProgressTitleType.Value:this._titleObject.text=""+Math.floor(t);break;case n.ProgressTitleType.Max:this._titleObject.text=""+Math.floor(this._max)}var i=this.width-this._barMaxWidthDelta,r=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this.setFillAmount(this._barObjectH,1-e)||(this._barObjectH.width=Math.round(i*e),this._barObjectH.x=this._barStartX+(i-this._barObjectH.width))),this._barObjectV&&(this.setFillAmount(this._barObjectV,1-e)||(this._barObjectV.height=Math.round(r*e),this._barObjectV.y=this._barStartY+(r-this._barObjectV.height)))):(this._barObjectH&&(this.setFillAmount(this._barObjectH,e)||(this._barObjectH.width=Math.round(i*e))),this._barObjectV&&(this.setFillAmount(this._barObjectV,e)||(this._barObjectV.height=Math.round(r*e)))),this._aniObject&&this._aniObject.setProp(n.ObjectPropID.Frame,Math.floor(100*e))},e.prototype.setFillAmount=function(t,e){return(t instanceof n.GImage||t instanceof n.GLoader)&&t.fillMethod!=n.FillMethod.None&&(t.fillAmount=e,!0)},e.prototype.constructExtension=function(t){t.seek(0,6),this._titleType=t.readByte(),this._reverse=t.readBool(),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._aniObject=this.getChild("ani"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y)},e.prototype.handleSizeChanged=function(){i.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update(this._value)},e.prototype.setup_afterAdd=function(t,e){i.prototype.setup_afterAdd.call(this,t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(this._value=t.readInt(),this._max=t.readInt(),2<=t.version&&(this._min=t.readInt())),this.update(this._value)},e);function e(){var t=i.call(this)||this;return t.fixed=0,t._min=0,t._max=0,t._value=0,t._barMaxWidth=0,t._barMaxHeight=0,t._barMaxWidthDelta=0,t._barMaxHeightDelta=0,t._barStartX=0,t._barStartY=0,t._titleType=n.ProgressTitleType.Percent,t._value=50,t._max=100,t}n.GProgressBar=t}(fgui=fgui||{}),function(F){var i,t=(i=F.GObject,__extends(n,i),n.prototype.createDisplayObject=function(){this._textField=new egret.TextField,this._textField.touchEnabled=!1,this.setDisplayObject(this._textField)},n.prototype.switchBitmapMode=function(t){t&&this.displayObject==this._textField?(null==this._bitmapContainer&&(this._bitmapContainer=new egret.Sprite),this.switchDisplayObject(this._bitmapContainer)):t||this.displayObject!=this._bitmapContainer||this.switchDisplayObject(this._textField)},n.prototype.dispose=function(){i.prototype.dispose.call(this),this._bitmapFont=null,this._requireRender=!1},Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){this._text=t,null==this._text&&(this._text=""),this.updateGear(6),this.parent&&this.parent._underConstruct?this.renderNow():this.render()},enumerable:!0,configurable:!0}),n.prototype.updateTextFieldText=function(){var t=this._text;if(this._templateVars&&(t=this.parseTemplate(t)),this._ubbEnabled){var e=n._htmlParser.parser(F.UBBParser.inst.parse(F.ToolSet.encodeHTML(t)));if(this._underline)for(var i=0;i<e.length;i++){var r=e[i];r.style?r.style.underline=!0:r.style={underline:!0}}this._textField.textFlow=e}else this._underline?((e=new Array(1))[0]={text:t,style:{underline:!0}},this._textField.textFlow=e):this._textField.text=t},Object.defineProperty(n.prototype,"font",{get:function(){return this._font},set:function(t){this._font!=t&&(this._font=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){t<0||this._fontSize!=t&&(this._fontSize=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,this.updateGear(4),this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},set:function(t){this._align!=t&&(this._align=t,this._textField.textAlign=this.getAlignTypeString(this._align),this._bitmapFont&&!this._underConstruct&&this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this._textField.verticalAlign=this.getVertAlignTypeString(this._verticalAlign),this._bitmapFont&&!this._underConstruct&&this.render())},enumerable:!0,configurable:!0}),n.prototype.getAlignTypeString=function(t){return t==F.AlignType.Left?egret.HorizontalAlign.LEFT:t==F.AlignType.Center?egret.HorizontalAlign.CENTER:egret.HorizontalAlign.RIGHT},n.prototype.getVertAlignTypeString=function(t){return t==F.VertAlignType.Top?egret.VerticalAlign.TOP:t==F.VertAlignType.Middle?egret.VerticalAlign.MIDDLE:egret.VerticalAlign.BOTTOM},Object.defineProperty(n.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!=t&&(this._leading=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!=t&&(this._letterSpacing=t,this.updateTextFormat())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"underline",{get:function(){return this._underline},set:function(t){this._underline=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bold",{get:function(){return this._textField.bold},set:function(t){this._textField.bold=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"italic",{get:function(){return this._textField.italic},set:function(t){this._textField.italic=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"singleLine",{get:function(){return!this._textField.multiline},set:function(t){this._textField.multiline!=(t=!t)&&(this._textField.multiline=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this._textField.stroke},set:function(t){this._textField.stroke=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this._textField.strokeColor},set:function(t){this._textField.strokeColor=t,this.updateGear(4)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ubbEnabled",{get:function(){return this._ubbEnabled},set:function(t){this._ubbEnabled!=t&&(this._ubbEnabled=t,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"autoSize",{get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this._widthAutoSize=t==F.AutoSizeType.Both,this._heightAutoSize=t==F.AutoSizeType.Both||t==F.AutoSizeType.Height,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textWidth",{get:function(){return this._requireRender&&this.renderNow(),this._textWidth},enumerable:!0,configurable:!0}),n.prototype.ensureSizeCorrect=function(){this._sizeDirty&&this._requireRender&&this.renderNow()},n.prototype.updateTextFormat=function(){var t;this._textField.size=this._fontSize,this._bitmapFont=null,!F.ToolSet.startsWith(this._font,"ui://")||(t=F.UIPackage.getItemByURL(this._font))&&(this._bitmapFont=t.owner.getItemAsset(t)),null==this._bitmapFont&&(this._font?this._textField.fontFamily=this._font:this._textField.fontFamily=F.UIConfig.defaultFont),this.grayed?this._textField.textColor=11184810:this._textField.textColor=this._color,this._textField.lineSpacing=this._leading,this._underConstruct||this.render()},n.prototype.render=function(){this._requireRender||(this._requireRender=!0,egret.callLater(this.__render,this)),this._sizeDirty||!this._widthAutoSize&&!this._heightAutoSize||(this._sizeDirty=!0,this.dispatchEventWith(F.GObject.SIZE_DELAY_CHANGE))},n.prototype.__render=function(){this._requireRender&&this.renderNow()},n.prototype.renderNow=function(t){var e,i;void 0===t&&(t=!0),this._requireRender=!1,this._sizeDirty=!1,this._bitmapFont?this.renderWithBitmapFont(t):(this.switchBitmapMode(!1),this._textField.width=this._widthAutoSize?this.maxWidth<=0?1e4:this.maxWidth:Math.ceil(this.width),this.updateTextFieldText(),this._textWidth=Math.ceil(this._textField.textWidth),0<this._textWidth&&(this._textWidth+=4),this._textHeight=Math.ceil(this._textField.textHeight),0<this._textHeight&&(this._textHeight+=4),i=0,this._widthAutoSize?(e=this._textWidth,this._textField.width=e):e=this.width,this._heightAutoSize?(i=this._textHeight,this._textField.height!=this._textHeight&&(this._textField.height=this._textHeight)):(i=this.height,this._textHeight>i&&(this._textHeight=i)),t&&(this._updatingSize=!0,this.setSize(e,i),this._updatingSize=!1))},n.prototype.renderWithBitmapFont=function(t){this.switchBitmapMode(!0),this._bitmapPool||(this._bitmapPool=[]);for(var e=this._bitmapContainer.numChildren,i=0;i<e;i++){var r=this._bitmapContainer.getChildAt(i);this._bitmapPool.push(r)}this._bitmapContainer.removeChildren(),this._lines?function(t){for(var e=t.length,i=0;i<e;i++){var r=t[i];k.push(r)}t.length=0}(this._lines):this._lines=new Array;var n=this._letterSpacing,o=this._leading-1,a=this.width-2*N,s=0,h=0,l=0,u=0,c=0,p=0,d=0,f=0,_=0,g="",y=G,m=!this._widthAutoSize&&this._textField.multiline,v=this._bitmapFont.resizable?this._fontSize/this._bitmapFont.size:1,b=this._bitmapFont.tint;this._textWidth=0,this._textHeight=0;for(var T=this._text,x=(T=this._templateVars?this.parseTemplate(T):T).length,w=0;w<x;++w){var S,C,E=T.charAt(w),P=E.charCodeAt(0);10!=P?(65<=P&&P<=90||97<=P&&P<=122?(0==p&&(d=s),p++):(0<p&&(f=s),p=0),l<(c=32==P?(u=Math.ceil(this._fontSize/2),this._fontSize):(M=this._bitmapFont.glyphs[E])?(u=Math.ceil(M.advance*v),Math.ceil(M.lineHeight*v)):u=0)&&(l=c),h<c&&(h=c),0!=s&&(s+=n),s+=u,!m||s<=a?g+=E:((C=j()).height=h,C.textHeight=l,0==g.length?C.text=E:0<p&&0<f?(S=(g+=E).length-p,C.text=F.ToolSet.trimRight(g.substr(0,S)),C.width=f,g=g.substr(S),s-=d):(C.text=g,C.width=s-(u+n),g=E,s=u,l=h=c),C.y=y,y+=C.height+o,C.width>this._textWidth&&(this._textWidth=C.width),f=d=p=0,this._lines.push(C))):(g+=E,(C=j()).width=s,0==l&&(0==_&&(_=this._fontSize),l=h=0==h?_:h),_=C.height=h,C.textHeight=l,C.text=g,C.y=y,y+=C.height+o,C.width>this._textWidth&&(this._textWidth=C.width),this._lines.push(C),g="",f=d=p=l=h=s=0)}0<g.length&&((C=j()).width=s,0==h&&(h=_),0==l&&(l=h),C.height=h,C.textHeight=l,C.text=g,C.y=y,C.width>this._textWidth&&(this._textWidth=C.width),this._lines.push(C)),0<this._textWidth&&(this._textWidth+=2*N),0==this._lines.length?this._textHeight=0:(C=this._lines[this._lines.length-1],this._textHeight=C.y+C.height+G);var D=0,O=this._widthAutoSize?0==this._textWidth?0:this._textWidth:this.width,D=this._heightAutoSize?0==this._textHeight?0:this._textHeight:this.height;if(t&&(this._updatingSize=!0,this.setSize(O,D),this._updatingSize=!1),0!=O&&0!=D){for(var I=N,$=0,A=0,a=this.width-2*N,R=this._lines.length,i=0;i<R;i++){C=this._lines[i];for(var B,M,I=N,$=this._align==F.AlignType.Center?(a-C.width)/2:this._align==F.AlignType.Right?a-C.width:0,x=C.text.length,L=0;L<x;L++)10!=(P=(E=C.text.charAt(L)).charCodeAt(0))&&(32!=P?(M=this._bitmapFont.glyphs[E])?(A=(C.height+C.textHeight)/2-Math.ceil(M.lineHeight*v),this._bitmapPool.length?B=this._bitmapPool.pop():(B=new egret.Bitmap).smoothing=!0,B.x=I+$+Math.ceil(M.x*v),B.y=C.y+A+Math.ceil(M.y*v),B.$backupY=B.y,B.texture=M.texture,B.scaleX=v,B.scaleY=v,B.tint=b?this._color:16777215,this._bitmapContainer.addChild(B),I+=n+Math.ceil(M.advance*v)):I+=n:I+=n+Math.ceil(this._fontSize/2))}this.doAlign()}},n.prototype.handleSizeChanged=function(){this._updatingSize||(this._bitmapFont?this._widthAutoSize?this.doAlign():this.render():this._underConstruct?(this._textField.width=this.width,this._textField.height=this.height):this._widthAutoSize||(this._heightAutoSize?this._textField.width=this.width:(this._textField.width=this.width,this._textField.height=this.height)))},n.prototype.parseTemplate=function(t){for(var e,i,r,n,o=0,a="";-1!=(e=t.indexOf("{",o));)if(0<e&&92==t.charCodeAt(e-1))a+=t.substring(o,e-1),a+="{",o=e+1;else{if(a+=t.substring(o,e),o=e,-1==(e=t.indexOf("}",o)))break;o=(e!=o+1?-1!=(i=(r=t.substring(o+1,e)).indexOf("="))?a+=null==(n=this._templateVars[r.substring(0,i)])?r.substring(i+1):n:null!=(n=this._templateVars[r])&&(a+=n):a+=t.substr(o,2),e+1)}return o<t.length&&(a+=t.substr(o)),a},Object.defineProperty(n.prototype,"templateVars",{get:function(){return this._templateVars},set:function(t){(this._templateVars||t)&&(this._templateVars=t,this.flushVars())},enumerable:!0,configurable:!0}),n.prototype.setVar=function(t,e){return this._templateVars||(this._templateVars={}),this._templateVars[t]=e,this},n.prototype.flushVars=function(){this.render()},n.prototype.handleGrayedChanged=function(){i.prototype.handleGrayedChanged.call(this),this.updateTextFormat()},n.prototype.doAlign=function(){for(var t,e=this._verticalAlign==F.VertAlignType.Top||0==this._textHeight?G:((t=this.height-this._textHeight)<0&&(t=0),this._verticalAlign==F.VertAlignType.Middle?Math.floor(t/2):Math.floor(t)),i=this._bitmapContainer.numChildren,r=0;r<i;r++){var n=this._bitmapContainer.getChildAt(r);n.y=n.$backupY+e}},n.prototype.getProp=function(t){switch(t){case F.ObjectPropID.Color:return this.color;case F.ObjectPropID.OutlineColor:return this.strokeColor;case F.ObjectPropID.FontSize:return this.fontSize;default:return i.prototype.getProp.call(this,t)}},n.prototype.setProp=function(t,e){switch(t){case F.ObjectPropID.Color:this.color=e;break;case F.ObjectPropID.OutlineColor:this.strokeColor=e;break;case F.ObjectPropID.FontSize:this.fontSize=e;break;default:i.prototype.setProp.call(this,t,e)}},n.prototype.setup_beforeAdd=function(t,e){i.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,5),this._font=t.readS(),this._fontSize=t.readShort(),this._color=t.readColor(),this.align=t.readByte(),this.verticalAlign=t.readByte(),this._leading=t.readShort(),this._letterSpacing=t.readShort(),this._ubbEnabled=t.readBool(),this._autoSize=t.readByte(),this._widthAutoSize=this._autoSize==F.AutoSizeType.Both,this._heightAutoSize=this._autoSize==F.AutoSizeType.Both||this._autoSize==F.AutoSizeType.Height,this._underline=t.readBool(),this._textField.italic=t.readBool(),this._textField.bold=t.readBool(),this._textField.multiline=!t.readBool(),t.readBool()&&(this._textField.strokeColor=t.readColor(),this.stroke=t.readFloat()+1),t.readBool()&&t.skip(12),t.readBool()&&(this._templateVars={})},n.prototype.setup_afterAdd=function(t,e){i.prototype.setup_afterAdd.call(this,t,e),this.updateTextFormat(),t.seek(e,6);t=t.readS();null!=t&&(this.text=t),this._sizeDirty=!1},n._htmlParser=new egret.HtmlTextParser,n);function n(){var t=i.call(this)||this;return t._fontSize=0,t._leading=0,t._letterSpacing=0,t._textWidth=0,t._textHeight=0,t._fontSize=12,t._align=F.AlignType.Left,t._verticalAlign=F.VertAlignType.Top,t._text="",t._leading=3,t._color=0,t._autoSize=F.AutoSizeType.Both,t._widthAutoSize=!0,t._heightAutoSize=!0,t}F.GTextField=t;var k=[];function j(){if(k.length){var t=k.pop();return t.width=0,t.height=0,t.textHeight=0,t.text=null,t.y=0,t}return{width:0,height:0,textHeight:0,text:null,y:0}}var N=2,G=2}(fgui=fgui||{}),function(n){var e,t=(e=n.GTextField,__extends(i,e),i.prototype.updateTextFieldText=function(){var t,e=this._text;if(this._templateVars&&(e=this.parseTemplate(e)),t=this._ubbEnabled?n.GTextField._htmlParser.parser(n.UBBParser.inst.parse(e)):n.GTextField._htmlParser.parser(e),this._underline)for(var i=0;i<t.length;i++){var r=t[i];r.style?r.style.underline=!0:r.style={underline:!0}}this._textField.textFlow=t},i);function i(){var t=e.call(this)||this;return t._textField.touchEnabled=!0,t}n.GRichTextField=t}(fgui=fgui||{}),function(l){var e,t=(e=l.GComponent,__extends(u,e),Object.defineProperty(u,"inst",{get:function(){return null==u._inst&&new u,u._inst},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"nativeStage",{get:function(){return this._nativeStage},enumerable:!0,configurable:!0}),u.prototype.showWindow=function(t){this.addChild(t),t.requestFocus(),t.x>this.width?t.x=this.width-t.width:t.x+t.width<0&&(t.x=0),t.y>this.height?t.y=this.height-t.height:t.y+t.height<0&&(t.y=0),this.adjustModalLayer()},u.prototype.hideWindow=function(t){t.hide()},u.prototype.hideWindowImmediately=function(t){t.parent==this&&this.removeChild(t),this.adjustModalLayer()},u.prototype.bringToFront=function(t){for(var e=this.numChildren,i=null==this._modalLayer.parent||t.modal?e-1:this.getChildIndex(this._modalLayer)-1;0<=i;i--){var r=this.getChildAt(i);if(r==t)return;if(r instanceof l.Window)break}0<=i&&this.setChildIndex(t,i)},u.prototype.showModalWait=function(t){null!=l.UIConfig.globalModalWaiting&&(null==this._modalWaitPane&&(this._modalWaitPane=l.UIPackage.createObjectFromURL(l.UIConfig.globalModalWaiting)),this._modalWaitPane.setSize(this.width,this.height),this._modalWaitPane.addRelation(this,l.RelationType.Size),this.addChild(this._modalWaitPane),this._modalWaitPane.text=t)},u.prototype.closeModalWait=function(){null!=this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane)},u.prototype.closeAllExceptModals=function(){for(var t=this._children.slice(),e=t.length,i=0;i<e;i++){var r=t[i];r instanceof l.Window&&!r.modal&&r.hide()}},u.prototype.closeAllWindows=function(){for(var t=this._children.slice(),e=t.length,i=0;i<e;i++){var r=t[i];r instanceof l.Window&&r.hide()}},u.prototype.getTopWindow=function(){for(var t=this.numChildren-1;0<=t;t--){var e=this.getChildAt(t);if(e instanceof l.Window)return e}return null},Object.defineProperty(u.prototype,"modalLayer",{get:function(){return this._modalLayer},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"hasModalWindow",{get:function(){return null!=this._modalLayer.parent},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"modalWaiting",{get:function(){return this._modalWaitPane&&this._modalWaitPane.inContainer},enumerable:!0,configurable:!0}),u.prototype.showPopup=function(t,e,i){if(0<this._popupStack.length){var r=this._popupStack.indexOf(t);if(-1!=r)for(var n=this._popupStack.length-1;r<=n;n--)this.removeChild(this._popupStack.pop())}if(this._popupStack.push(t),e)for(var o=e;o;){if(o.parent==this){t.sortingOrder<o.sortingOrder&&(t.sortingOrder=o.sortingOrder);break}o=o.parent}var a;this.addChild(t),this.adjustModalLayer();var s=0,h=0;e?(a=e.localToRoot(),s=e.width,h=e.height):a=this.globalToLocal(u.mouseX,u.mouseY),(e=a.x)+t.width>this.width&&(e=e+s-t.width),h=a.y+h,((void 0===i||i===l.PopupDirection.Auto)&&a.y+t.height>this.height||!1===i||i===l.PopupDirection.Up)&&(h=a.y-t.height-1)<0&&(h=0,e+=s/2),t.x=e,t.y=h},u.prototype.togglePopup=function(t,e,i){-1==this._justClosedPopups.indexOf(t)&&this.showPopup(t,e,i)},u.prototype.hidePopup=function(t){if(t){var e=this._popupStack.indexOf(t);if(-1!=e)for(var i=this._popupStack.length-1;e<=i;i--)this.closePopup(this._popupStack.pop())}else{for(i=this._popupStack.length-1;0<=i;i--)this.closePopup(this._popupStack[i]);this._popupStack.length=0}},Object.defineProperty(u.prototype,"hasAnyPopup",{get:function(){return 0!=this._popupStack.length},enumerable:!0,configurable:!0}),u.prototype.closePopup=function(t){t.parent&&(t instanceof l.Window?t.hide():this.removeChild(t))},u.prototype.showTooltips=function(t){if(null==this._defaultTooltipWin){var e=l.UIConfig.tooltipsWin;if(!e)return void console.error("UIConfig.tooltipsWin not defined");this._defaultTooltipWin=l.UIPackage.createObjectFromURL(e)}this._defaultTooltipWin.text=t,this.showTooltipsWin(this._defaultTooltipWin)},u.prototype.showTooltipsWin=function(t,e){this.hideTooltips(),this._tooltipWin=t;var i=0,t=0,t=e?(i=e.x,e.y):(i=u.mouseX+10,u.mouseY+20),e=this.globalToLocal(i,t),i=e.x;t=e.y,i+this._tooltipWin.width>this.width&&(i=i-this._tooltipWin.width-1)<0&&(i=10),t+this._tooltipWin.height>this.height&&(t=t-this._tooltipWin.height-1,0<i-this._tooltipWin.width-1&&(i=i-this._tooltipWin.width-1),t<0&&(t=10)),this._tooltipWin.x=i,this._tooltipWin.y=t,this.addChild(this._tooltipWin)},u.prototype.hideTooltips=function(){this._tooltipWin&&(this._tooltipWin.parent&&this.removeChild(this._tooltipWin),this._tooltipWin=null)},u.prototype.getObjectUnderPoint=function(t,e){e=this._nativeStage.$hitTest(t,e);return e?l.ToolSet.displayObjectToGObject(e):null},Object.defineProperty(u.prototype,"focus",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),u.prototype.setFocus=function(t){},Object.defineProperty(u.prototype,"volumeScale",{get:function(){return this._volumeScale},set:function(t){this._volumeScale=t},enumerable:!0,configurable:!0}),u.prototype.playOneShotSound=function(t,e){e=this._volumeScale*(e=e||1);t.play(0,1).volume=e},u.prototype.adjustModalLayer=function(){var t=this.numChildren;this._modalWaitPane&&this._modalWaitPane.parent&&this.setChildIndex(this._modalWaitPane,t-1);for(var e=t-1;0<=e;e--){var i=this.getChildAt(e);if(i instanceof l.Window&&i.modal)return void(null==this._modalLayer.parent?this.addChildAt(this._modalLayer,e):this.setChildIndexBefore(this._modalLayer,e))}this._modalLayer.parent&&this.removeChild(this._modalLayer)},u.prototype.__addedToStage=function(t){this.displayObject.removeEventListener(egret.Event.ADDED_TO_STAGE,this.__addedToStage,this),this._nativeStage=this.displayObject.stage,this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__stageMouseDownCapture,this,!0),this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_END,this.__stageMouseUpCapture,this,!0),this._nativeStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__stageMouseMoveCapture,this,!0),this._modalLayer=new l.GGraph,this._modalLayer.setSize(this.width,this.height),this._modalLayer.drawRect(0,0,0,l.UIConfig.modalLayerColor,l.UIConfig.modalLayerAlpha),this._modalLayer.addRelation(this,l.RelationType.Size),this.displayObject.stage.addEventListener(egret.Event.RESIZE,this.__winResize,this),this.__winResize(null)},u.prototype.__stageMouseDownCapture=function(t){if(u.mouseX=t.stageX,u.mouseY=t.stageY,u.touchDown=!0,this._tooltipWin&&this.hideTooltips(),(this._justClosedPopups.length=0)<this._popupStack.length){for(var e=t.target;e!=this.displayObject.stage&&e;){if(e.$owner){var i=this._popupStack.indexOf(e.$owner);if(-1!=i){for(var r=this._popupStack.length-1;i<r;r--){var n=this._popupStack.pop();this.closePopup(n),this._justClosedPopups.push(n)}return}}e=e.parent}for(r=this._popupStack.length-1;0<=r;r--)n=this._popupStack[r],this.closePopup(n),this._justClosedPopups.push(n);this._popupStack.length=0}},u.prototype.__stageMouseMoveCapture=function(t){u.mouseX=t.stageX,u.mouseY=t.stageY},u.prototype.__stageMouseUpCapture=function(t){u.touchDown=!1},u.prototype.__winResize=function(t){this.setSize(this._nativeStage.stageWidth,this._nativeStage.stageHeight)},u.prototype.updateContentScaleLevel=function(){u.contentScaleLevel=0},u.contentScaleLevel=0,u.contentScaleFactor=1,u);function u(){var t=e.call(this)||this;return null==u._inst&&(u._inst=t),t.opaque=!1,t._volumeScale=1,t._popupStack=new Array,t._justClosedPopups=new Array,t.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,t.__addedToStage,t),t}l.GRoot=t}(fgui=fgui||{}),function(t){var e,i=(e=t.GComponent,__extends(r,e),r.prototype.setScrollPane=function(t,e){this._target=t,this._vertical=e},r.prototype.setDisplayPerc=function(t){this._vertical?(this._fixedGripSize||(this._grip.height=Math.floor(t*this._bar.height)),this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc):(this._fixedGripSize||(this._grip.width=Math.floor(t*this._bar.width)),this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc),this._grip.visible=0!=t&&1!=t},r.prototype.setScrollPerc=function(t){this._scrollPerc=t,this._vertical?this._grip.y=this._bar.y+(this._bar.height-this._grip.height)*this._scrollPerc:this._grip.x=this._bar.x+(this._bar.width-this._grip.width)*this._scrollPerc},Object.defineProperty(r.prototype,"minSize",{get:function(){return this._vertical?(this._arrowButton1?this._arrowButton1.height:0)+(this._arrowButton2?this._arrowButton2.height:0):(this._arrowButton1?this._arrowButton1.width:0)+(this._arrowButton2?this._arrowButton2.width:0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"gripDragging",{get:function(){return this._gripDragging},enumerable:!0,configurable:!0}),r.prototype.constructExtension=function(t){t.seek(0,6),this._fixedGripSize=t.readBool(),this._grip=this.getChild("grip"),this._grip?(this._bar=this.getChild("bar"),this._bar?(this._arrowButton1=this.getChild("arrow1"),this._arrowButton2=this.getChild("arrow2"),this._grip.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__gripMouseDown,this),this._arrowButton1&&this._arrowButton1.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__arrowButton1Click,this),this._arrowButton2&&this._arrowButton2.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__arrowButton2Click,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__barMouseDown,this)):console.error("\u9700\u8981\u5b9a\u4e49bar")):console.error("\u9700\u8981\u5b9a\u4e49grip")},r.prototype.__gripMouseDown=function(t){this._gripDragging=!0,this._target.updateScrollBarVisible(),t.stopPropagation(),this.globalToLocal(t.stageX,t.stageY,this._dragOffset),this._dragOffset.x-=this._grip.x,this._dragOffset.y-=this._grip.y,this._grip.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),this._grip.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},r.prototype.__gripMouseMove=function(t){var e;this.onStage&&(e=this.globalToLocal(t.stageX,t.stageY,n),this._vertical?(t=e.y-this._dragOffset.y,this._target.setPercY((t-this._bar.y)/(this._bar.height-this._grip.height),!1)):(e=e.x-this._dragOffset.x,this._target.setPercX((e-this._bar.x)/(this._bar.width-this._grip.width),!1)))},r.prototype.__gripMouseUp=function(t){t=t.currentTarget;t.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this),this.onStage||(this._gripDragging=!1,this._target.updateScrollBarVisible())},r.prototype.__arrowButton1Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollUp():this._target.scrollLeft()},r.prototype.__arrowButton2Click=function(t){t.stopPropagation(),this._vertical?this._target.scrollDown():this._target.scrollRight()},r.prototype.__barMouseDown=function(t){t=this._grip.globalToLocal(t.stageX,t.stageY,n);this._vertical?t.y<0?this._target.scrollUp(4):this._target.scrollDown(4):t.x<0?this._target.scrollLeft(4):this._target.scrollRight(4)},r);function r(){var t=e.call(this)||this;return t._dragOffset=new egret.Point,t._scrollPerc=0,t}t.GScrollBar=i;var n=new egret.Point}(fgui=fgui||{}),function(r){var i,t=(i=r.GComponent,__extends(e,i),Object.defineProperty(e.prototype,"titleType",{get:function(){return this._titleType},set:function(t){this._titleType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wholeNumbers",{get:function(){return this._wholeNumbers},set:function(t){this._wholeNumbers!=t&&(this._wholeNumbers=t,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min!=t&&(this._min=t,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max!=t&&(this._max=t,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=t,this.update())},enumerable:!0,configurable:!0}),e.prototype.update=function(){this.updateWithPercent((this._value-this._min)/(this._max-this._min))},e.prototype.updateWithPercent=function(t,e){if(t=r.ToolSet.clamp01(t),e&&(i=r.ToolSet.clamp(this._min+(this._max-this._min)*t,this._min,this._max),this._wholeNumbers&&(i=Math.round(i),t=r.ToolSet.clamp01((i-this._min)/(this._max-this._min))),i!=this._value&&(this._value=i,this.dispatchEvent(new r.StateChangeEvent(r.StateChangeEvent.CHANGED)))),this._titleObject)switch(this._titleType){case r.ProgressTitleType.Percent:this._titleObject.text=Math.floor(100*t)+"%";break;case r.ProgressTitleType.ValueAndMax:this._titleObject.text=this._value+"/"+this._max;break;case r.ProgressTitleType.Value:this._titleObject.text=""+this._value;break;case r.ProgressTitleType.Max:this._titleObject.text=""+this._max}var e=this.width-this._barMaxWidthDelta,i=this.height-this._barMaxHeightDelta;this._reverse?(this._barObjectH&&(this._barObjectH.width=Math.round(e*t),this._barObjectH.x=this._barStartX+(e-this._barObjectH.width)),this._barObjectV&&(this._barObjectV.height=Math.round(i*t),this._barObjectV.y=this._barStartY+(i-this._barObjectV.height))):(this._barObjectH&&(this._barObjectH.width=Math.round(e*t)),this._barObjectV&&(this._barObjectV.height=Math.round(i*t)))},e.prototype.constructExtension=function(t){t.seek(0,6),this._titleType=t.readByte(),this._reverse=t.readBool(),2<=t.version&&(this._wholeNumbers=t.readBool(),this.changeOnClick=t.readBool()),this._titleObject=this.getChild("title"),this._barObjectH=this.getChild("bar"),this._barObjectV=this.getChild("bar_v"),this._gripObject=this.getChild("grip"),this._barObjectH&&(this._barMaxWidth=this._barObjectH.width,this._barMaxWidthDelta=this.width-this._barMaxWidth,this._barStartX=this._barObjectH.x),this._barObjectV&&(this._barMaxHeight=this._barObjectV.height,this._barMaxHeightDelta=this.height-this._barMaxHeight,this._barStartY=this._barObjectV.y),this._gripObject&&this._gripObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__gripMouseDown,this),this.displayObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__barMouseDown,this)},e.prototype.handleSizeChanged=function(){i.prototype.handleSizeChanged.call(this),this._barObjectH&&(this._barMaxWidth=this.width-this._barMaxWidthDelta),this._barObjectV&&(this._barMaxHeight=this.height-this._barMaxHeightDelta),this._underConstruct||this.update()},e.prototype.setup_afterAdd=function(t,e){i.prototype.setup_afterAdd.call(this,t,e),t.seek(e,6)&&t.readByte()==this.packageItem.objectType&&(this._value=t.readInt(),this._max=t.readInt(),2<=t.version&&(this._min=t.readInt())),this.update()},e.prototype.__gripMouseDown=function(t){this.canDrag=!0,t.stopPropagation(),this._clickPos=this.globalToLocal(t.stageX,t.stageY),this._clickPercent=r.ToolSet.clamp01((this._value-this._min)/(this._max-this._min)),this._gripObject.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),this._gripObject.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},e.prototype.__gripMouseMove=function(t){var e;this.canDrag&&(t=(e=this.globalToLocal(t.stageX,t.stageY,n)).x-this._clickPos.x,e=e.y-this._clickPos.y,this._reverse&&(t=-t,e=-e),e=this._barObjectH?this._clickPercent+t/this._barMaxWidth:this._clickPercent+e/this._barMaxHeight,this.updateWithPercent(e,!0))},e.prototype.__gripMouseUp=function(t){t.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__gripMouseMove,this),t.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.__gripMouseUp,this)},e.prototype.__barMouseDown=function(t){var e,i;this.changeOnClick&&(e=this._gripObject.globalToLocal(t.stageX,t.stageY,n),t=r.ToolSet.clamp01((this._value-this._min)/(this._max-this._min)),this._barObjectH&&(i=e.x/this._barMaxWidth),this._barObjectV&&(i=e.y/this._barMaxHeight),this._reverse?t-=i:t+=i,this.updateWithPercent(t,!0))},e);function e(){var t=i.call(this)||this;return t._min=0,t._max=0,t._value=0,t._barMaxWidth=0,t._barMaxHeight=0,t._barMaxWidthDelta=0,t._barMaxHeightDelta=0,t._clickPercent=0,t._barStartX=0,t._barStartY=0,t.changeOnClick=!0,t.canDrag=!0,t._titleType=r.ProgressTitleType.Percent,t._value=50,t._max=100,t._clickPos=new egret.Point,t}r.GSlider=t;var n=new egret.Point}(fgui=fgui||{}),function(i){var r,t=(r=i.GTextField,__extends(e,r),e.prototype.dispose=function(){r.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"editable",{get:function(){return this._textField.type==egret.TextFieldType.INPUT},set:function(t){this._textField.type=t?egret.TextFieldType.INPUT:egret.TextFieldType.DYNAMIC},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this._textField.maxChars},set:function(t){this._textField.maxChars=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"promptText",{get:function(){return this._promptText},set:function(t){this._promptText=t,this.updateTextFieldText()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrict",{get:function(){return this._textField.restrict},set:function(t){this._textField.restrict=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"password",{get:function(){return this._password},set:function(t){this._password!=t&&(this._password=t,this._textField.displayAsPassword=this._password,this._textField.inputType=t?egret.TextFieldInputType.PASSWORD:egret.TextFieldInputType.TEXT,this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.updateVertAlign())},enumerable:!0,configurable:!0}),e.prototype.updateVertAlign=function(){switch(this._verticalAlign){case i.VertAlignType.Top:this._textField.verticalAlign=egret.VerticalAlign.TOP;break;case i.VertAlignType.Middle:this._textField.verticalAlign=egret.VerticalAlign.MIDDLE;break;case i.VertAlignType.Bottom:this._textField.verticalAlign=egret.VerticalAlign.BOTTOM}},e.prototype.updateTextFieldText=function(){!this._text&&this._promptText?(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(i.UBBParser.inst.parse(this._promptText))):(this._textField.displayAsPassword=this._password,this._ubbEnabled?this._textField.textFlow=(new egret.HtmlTextParser).parser(i.UBBParser.inst.parse(i.ToolSet.encodeHTML(this._text))):this._textField.text=this._text)},e.prototype.handleSizeChanged=function(){this._updatingSize||(this._textField.width=Math.ceil(this.width),this._textField.height=Math.ceil(this.height))},e.prototype.setup_beforeAdd=function(t,e){r.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,4);e=t.readS();null!=e&&(this._promptText=e),null!=(e=t.readS())&&(this._textField.restrict=e);e=t.readInt();0!=e&&(this._textField.maxChars=e),e=t.readInt(),t.readBool()&&(this.password=!0),this.updateVertAlign()},e.prototype.setup_afterAdd=function(t,e){r.prototype.setup_afterAdd.call(this,t,e),!this._text&&this._promptText&&(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(i.UBBParser.inst.parse(i.ToolSet.encodeHTML(this._promptText))))},e.prototype.__textChanged=function(t){this._text=this._textField.text},e.prototype.__focusIn=function(t){!this._text&&this._promptText&&(this._textField.displayAsPassword=this._password,this._textField.text="")},e.prototype.__focusOut=function(t){this._text=this._textField.text,!this._text&&this._promptText&&(this._textField.displayAsPassword=!1,this._textField.textFlow=(new egret.HtmlTextParser).parser(i.UBBParser.inst.parse(i.ToolSet.encodeHTML(this._promptText))))},e);function e(){var t=r.call(this)||this;return t._widthAutoSize=!1,t._heightAutoSize=!1,t.displayObject.touchChildren=!0,t._textField.type=egret.TextFieldType.INPUT,t._textField.addEventListener(egret.Event.CHANGE,t.__textChanged,t),t._textField.addEventListener(egret.FocusEvent.FOCUS_IN,t.__focusIn,t),t._textField.addEventListener(egret.FocusEvent.FOCUS_OUT,t.__focusOut,t),t}i.GTextInput=t}(fgui=fgui||{}),function(u){var o,t=(o=u.GList,__extends(e,o),Object.defineProperty(e.prototype,"rootNode",{get:function(){return this._rootNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indent",{get:function(){return this._indent},set:function(t){this._indent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clickToExpand",{get:function(){return this._clickToExpand},set:function(t){this._clickToExpand=t},enumerable:!0,configurable:!0}),e.prototype.getSelectedNode=function(){return-1!=this.selectedIndex?this.getChildAt(this.selectedIndex)._treeNode:null},e.prototype.getSelectedNodes=function(t){t=t||new Array,a.length=0,o.prototype.getSelection.call(this,a);for(var e=a.length,i=new Array,r=0;r<e;r++){var n=this.getChildAt(a[r])._treeNode;i.push(n)}return i},e.prototype.selectNode=function(t,e){for(var i=t.parent;i&&i!=this._rootNode;)i.expanded=!0,i=i.parent;t._cell&&this.addSelection(this.getChildIndex(t._cell),e)},e.prototype.unselectNode=function(t){t._cell&&this.removeSelection(this.getChildIndex(t._cell))},e.prototype.expandAll=function(t){(t=t||this._rootNode).expanded=!0;for(var e=t.numChildren,i=0;i<e;i++){var r=t.getChildAt(i);r.isFolder&&this.expandAll(r)}},e.prototype.collapseAll=function(t){(t=t||this._rootNode)!=this._rootNode&&(t.expanded=!1);for(var e=t.numChildren,i=0;i<e;i++){var r=t.getChildAt(i);r.isFolder&&this.collapseAll(r)}},e.prototype.createCell=function(t){var e=this.getFromPool(t._resURL||this.defaultItem);if(!(e instanceof u.GComponent))throw new Error("cannot create tree node object.");var i=((e._treeNode=t)._cell=e).getChild("indent");null!=i&&(i.width=(t.level-1)*this._indent),(i=e.getController("expanded"))&&(i.addEventListener(u.StateChangeEvent.CHANGED,this.__expandedStateChanged,this),i.selectedIndex=t.expanded?1:0),(i=e.getController("leaf"))&&(i.selectedIndex=t.isFolder?0:1),t.isFolder&&e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.__cellMouseDown,this),this.treeNodeRender&&this.treeNodeRender.call(this.callbackThisObj,t,e)},e.prototype._afterInserted=function(t){t._cell||this.createCell(t);var e=this.getInsertIndexForNode(t);this.addChildAt(t._cell,e),this.treeNodeRender&&this.treeNodeRender.call(this.callbackThisObj,t,t._cell),t.isFolder&&t.expanded&&this.checkChildren(t,e)},e.prototype.getInsertIndexForNode=function(t){var e=t.getPrevSibling();null==e&&(e=t.parent);for(var i=this.getChildIndex(e._cell)+1,r=t.level,n=this.numChildren,o=i;o<n;o++){if(this.getChildAt(o)._treeNode.level<=r)break;i++}return i},e.prototype._afterRemoved=function(t){this.removeNode(t)},e.prototype._afterExpanded=function(t){var e;t!=this._rootNode?(null!=this.treeNodeWillExpand&&this.treeNodeWillExpand.call(this.callbackThisObj,t,!0),null!=t._cell&&(this.treeNodeRender&&this.treeNodeRender.call(this.callbackThisObj,t,t._cell),(e=t._cell.getController("expanded"))&&(e.selectedIndex=1),t._cell.parent&&this.checkChildren(t,this.getChildIndex(t._cell)))):this.checkChildren(this._rootNode,0)},e.prototype._afterCollapsed=function(t){var e;t!=this._rootNode?(this.treeNodeWillExpand&&this.treeNodeWillExpand.call(this.callbackThisObj,t,!1),null!=t._cell&&(this.treeNodeRender&&this.treeNodeRender.call(this.callbackThisObj,t,t._cell),(e=t._cell.getController("expanded"))&&(e.selectedIndex=0),t._cell.parent&&this.hideFolderNode(t))):this.checkChildren(this._rootNode,0)},e.prototype._afterMoved=function(t){var e,i,r=this.getChildIndex(t._cell),n=t.isFolder?this.getFolderEndIndex(r,t.level):r+1,o=this.getInsertIndexForNode(t),a=n-r;if(o<r)for(e=0;e<a;e++)i=this.getChildAt(r+e),this.setChildIndex(i,o+e);else for(e=0;e<a;e++)i=this.getChildAt(r),this.setChildIndex(i,o)},e.prototype.getFolderEndIndex=function(t,e){for(var i=this.numChildren,r=t+1;r<i;r++)if(this.getChildAt(r)._treeNode.level<=e)return r;return i},e.prototype.checkChildren=function(t,e){for(var i=t.numChildren,r=0;r<i;r++){e++;var n=t.getChildAt(r);null==n._cell&&this.createCell(n),n._cell.parent||this.addChildAt(n._cell,e),n.isFolder&&n.expanded&&(e=this.checkChildren(n,e))}return e},e.prototype.hideFolderNode=function(t){for(var e=t.numChildren,i=0;i<e;i++){var r=t.getChildAt(i);r._cell&&this.removeChild(r._cell),r.isFolder&&r.expanded&&this.hideFolderNode(r)}},e.prototype.removeNode=function(t){if(t._cell&&(t._cell.parent&&this.removeChild(t._cell),this.returnToPool(t._cell),t._cell._treeNode=null,t._cell=null),t.isFolder)for(var e=t.numChildren,i=0;i<e;i++){var r=t.getChildAt(i);this.removeNode(r)}},e.prototype.__cellMouseDown=function(t){t=t.currentTarget._treeNode;this._expandedStatusInEvt=t.expanded},e.prototype.__expandedStateChanged=function(t){t=t.currentTarget;t.parent._treeNode.expanded=1==t.selectedIndex},e.prototype.dispatchItemEvent=function(t){var e;0==this._clickToExpand||(e=t.itemObject._treeNode)&&e.isFolder&&this._expandedStatusInEvt==e.expanded&&(2==this._clickToExpand||(e.expanded=!e.expanded)),o.prototype.dispatchItemEvent.call(this,t)},e.prototype.setup_beforeAdd=function(t,e){o.prototype.setup_beforeAdd.call(this,t,e),t.seek(e,9),this._indent=t.readInt(),this._clickToExpand=t.readByte()},e.prototype.readItems=function(t){for(var e,i,r=0,n=t.readShort(),o=0;o<n;o++)if(e=t.readShort(),e+=t.position,null!=(h=t.readS())||(h=this.defaultItem)){var a=t.readBool(),s=t.readByte(),h=new u.GTreeNode(a,h);if(h.expanded=!0,0==o)this._rootNode.addChild(h);else if(r<s)i.addChild(h);else if(s<r){for(var l=s;l<=r;l++)i=i.parent;i.addChild(h)}else i.parent.addChild(h);r=s,this.setupItem(t,(i=h).cell),t.position=e}else t.position=e},e);function e(){var t=o.call(this)||this;return t._indent=15,t._rootNode=new u.GTreeNode(!0),t._rootNode._setTree(t),t._rootNode.expanded=!0,t}u.GTree=t;var a=new Array}(fgui=fgui||{}),function(t){var e=(Object.defineProperty(i.prototype,"expanded",{get:function(){return this._expanded},set:function(t){this._children&&this._expanded!=t&&(this._expanded=t,this._tree&&(this._expanded?this._tree._afterExpanded(this):this._tree._afterCollapsed(this)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isFolder",{get:function(){return null!=this._children},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this._cell?this._cell.text:null},set:function(t){this._cell&&(this._cell.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"icon",{get:function(){return this._cell?this._cell.icon:null},set:function(t){this._cell&&(this._cell.icon=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),i.prototype._setLevel=function(t){this._level=t},i.prototype.addChild=function(t){return this.addChildAt(t,this._children.length),t},i.prototype.addChildAt=function(t,e){if(t){var i=this._children.length;if(0<=e&&e<=i)return t._parent==this?this.setChildIndex(t,e):(t._parent&&t._parent.removeChild(t),e==this._children.length?this._children.push(t):this._children.splice(e,0,t),t._parent=this,t._level=this._level+1,t._setTree(this._tree),(this._tree&&this==this._tree.rootNode||this._cell&&this._cell.parent&&this._expanded)&&this._tree._afterInserted(t)),t;throw new RangeError("Invalid child index")}console.error("child is null")},i.prototype.removeChild=function(t){var e=this._children.indexOf(t);return-1!=e&&this.removeChildAt(e),t},i.prototype.removeChildAt=function(t){if(0<=t&&t<this.numChildren){var e=this._children[t];return this._children.splice(t,1),e._parent=null,this._tree&&(e._setTree(null),this._tree._afterRemoved(e)),e}throw"Invalid child index"},i.prototype.removeChildren=function(t,e){((e=null==e?-1:e)<0||e>=this.numChildren)&&(e=this.numChildren-1);for(var i=t=t||0;i<=e;++i)this.removeChildAt(t)},i.prototype.getChildAt=function(t){if(0<=t&&t<this.numChildren)return this._children[t];throw"Invalid child index"},i.prototype.getChildIndex=function(t){return this._children.indexOf(t)},i.prototype.getPrevSibling=function(){if(null==this._parent)return null;var t=this._parent._children.indexOf(this);return t<=0?null:this._parent._children[t-1]},i.prototype.getNextSibling=function(){if(null==this._parent)return null;var t=this._parent._children.indexOf(this);return t<0||t>=this._parent._children.length-1?null:this._parent._children[t+1]},i.prototype.setChildIndex=function(t,e){var i=this._children.indexOf(t);if(-1==i)throw"Not a child of this container";var r=this._children.length;e<0?e=0:r<e&&(e=r),i!=e&&(this._children.splice(i,1),this._children.splice(e,0,t),(this._tree&&this==this._tree.rootNode||this._cell&&this._cell.parent&&this._expanded)&&this._tree._afterMoved(t))},i.prototype.swapChildren=function(t,e){t=this._children.indexOf(t),e=this._children.indexOf(e);if(-1==t||-1==e)throw"Not a child of this container";this.swapChildrenAt(t,e)},i.prototype.swapChildrenAt=function(t,e){var i=this._children[t],r=this._children[e];this.setChildIndex(i,e),this.setChildIndex(r,t)},Object.defineProperty(i.prototype,"numChildren",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),i.prototype.expandToRoot=function(){for(var t=this;t;)t.expanded=!0,t=t.parent},Object.defineProperty(i.prototype,"tree",{get:function(){return this._tree},enumerable:!0,configurable:!0}),i.prototype._setTree=function(t){if(this._tree=t,this._tree&&this._tree.treeNodeWillExpand&&this._expanded&&this._tree.treeNodeWillExpand(this,!0),this._children)for(var e=this._children.length,i=0;i<e;i++){var r=this._children[i];r._level=this._level+1,r._setTree(t)}},i);function i(t,e){this._level=0,this._resURL=e,t&&(this._children=new Array)}t.GTreeNode=e}(fgui=fgui||{}),function(t){var e=(i.prototype.copy=function(t){this.top=t.top,this.bottom=t.bottom,this.left=t.left,this.right=t.right},i);function i(){this.left=0,this.right=0,this.top=0,this.bottom=0}t.Margin=e}(fgui=fgui||{}),function(t){var e=(i.prototype.contains=function(t,e){if(t=Math.floor((t/this.scaleX-this.offsetX)*this._data.scale),e=Math.floor((e/this.scaleY-this.offsetY)*this._data.scale),t<0||e<0||t>=this._data.pixelWidth)return!1;e=e*this._data.pixelWidth+t,t=Math.floor(e/8);return 0<=t&&t<this._data.pixels.length&&1==(this._data.pixels[t]>>e%8&1)},i);function i(t,e,i){this._data=t,this.offsetX=e,this.offsetY=i,this.scaleX=1,this.scaleY=1}t.PixelHitTest=e;r.prototype.load=function(t){t.readInt(),this.pixelWidth=t.readInt(),this.scale=1/t.readByte();var e=t.readInt();this.pixels=[];for(var i=0;i<e;i++){var r=t.readByte();r<0&&(r+=256),this.pixels[i]=r}},e=r;function r(){}t.PixelHitTestData=e}(fgui=fgui||{}),function(e){var t=(i.prototype.load=function(){return this.owner.getItemAsset(this)},i.prototype.getBranch=function(){if(this.branches&&-1!=this.owner._branchIndex){var t=this.branches[this.owner._branchIndex];if(t)return this.owner.getItemById(t)}return this},i.prototype.getHighResolution=function(){if(this.highResolution&&0<e.GRoot.contentScaleLevel){var t=this.highResolution[e.GRoot.contentScaleLevel-1];if(t)return this.owner.getItemById(t)}return this},i.prototype.toString=function(){return this.name},i);function i(){this.width=0,this.height=0}e.PackageItem=t}(fgui=fgui||{}),function(i){var t=(e.prototype.dispose=function(){this._contentPane.dispose()},e.prototype.addItem=function(t,e){var i=this._list.addItemFromPool().asButton;i.title=t,i.data=e,i.grayed=!1;e=i.getController("checked");return e&&(e.selectedIndex=0),i},e.prototype.addItemAt=function(t,e,i){var r=this._list.getFromPool().asButton;this._list.addChildAt(r,e),r.title=t,r.data=i,r.grayed=!1;i=r.getController("checked");return i&&(i.selectedIndex=0),r},e.prototype.addSeperator=function(){if(null==i.UIConfig.popupMenu_seperator)throw"UIConfig.popupMenu_seperator not defined";this.list.addItemFromPool(i.UIConfig.popupMenu_seperator)},e.prototype.getItemName=function(t){return this._list.getChildAt(t).name},e.prototype.setItemText=function(t,e){this._list.getChild(t).asButton.title=e},e.prototype.setItemVisible=function(t,e){t=this._list.getChild(t).asButton;t.visible!=e&&(t.visible=e,this._list.setBoundsChangedFlag())},e.prototype.setItemGrayed=function(t,e){this._list.getChild(t).asButton.grayed=e},e.prototype.setItemCheckable=function(t,e){t=this._list.getChild(t).asButton.getController("checked");t&&(e?0==t.selectedIndex&&(t.selectedIndex=1):t.selectedIndex=0)},e.prototype.setItemChecked=function(t,e){t=this._list.getChild(t).asButton.getController("checked");t&&(t.selectedIndex=e?2:1)},e.prototype.isItemChecked=function(t){t=this._list.getChild(t).asButton.getController("checked");return!!t&&2==t.selectedIndex},e.prototype.removeItem=function(t){t=this._list.getChild(t);if(t){t=this._list.getChildIndex(t);return this._list.removeChildToPoolAt(t),!0}return!1},e.prototype.clearItems=function(){this._list.removeChildrenToPool()},Object.defineProperty(e.prototype,"itemCount",{get:function(){return this._list.numChildren},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentPane",{get:function(){return this._contentPane},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this._list},enumerable:!0,configurable:!0}),e.prototype.show=function(t,e){(t?t.root:i.GRoot.inst).showPopup(this.contentPane,t instanceof i.GRoot?null:t,e)},e.prototype.__clickItem=function(t){i.GTimers.inst.add(100,1,this.__clickItem2,this,t)},e.prototype.__clickItem2=function(t){var e,i=t.itemObject.asButton;null!=i&&(i.grayed?this._list.selectedIndex=-1:((e=i.getController("checked"))&&0!=e.selectedIndex&&(1==e.selectedIndex?e.selectedIndex=2:e.selectedIndex=1),this._contentPane.parent.hidePopup(this.contentPane),null!=i.data&&(1==i.data.length?i.data(t):i.data())))},e.prototype.__addedToStage=function(t){this._list.selectedIndex=-1,this._list.resizeToFit(1e5,10)},e);function e(t){if(!t&&!(t=i.UIConfig.popupMenu))throw"UIConfig.popupMenu not defined";this._contentPane=i.UIPackage.createObjectFromURL(t).asCom,this._contentPane.addEventListener(egret.Event.ADDED_TO_STAGE,this.__addedToStage,this),this._list=this._contentPane.getChild("list"),this._list.removeChildrenToPool(),this._list.addRelation(this._contentPane,i.RelationType.Width),this._list.removeRelation(this._contentPane,i.RelationType.Height),this._contentPane.addRelation(this._list,i.RelationType.Height),this._list.addEventListener(i.ItemEvent.CLICK,this.__clickItem,this)}i.PopupMenu=t}(fgui=fgui||{}),function(h){var t=(Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target!=t&&(this._target&&this.releaseRefTarget(this._target),this._target=t,this._target&&this.addRefTarget(this._target))},enumerable:!0,configurable:!0}),e.prototype.add=function(t,e){if(t==h.RelationType.Size)return this.add(h.RelationType.Width,e),void this.add(h.RelationType.Height,e);for(var i=this._defs.length,r=0;r<i;r++)if(this._defs[r].type==t)return;this.internalAdd(t,e)},e.prototype.internalAdd=function(t,e){if(t==h.RelationType.Size)return this.internalAdd(h.RelationType.Width,e),void this.internalAdd(h.RelationType.Height,e);var i=new o;i.percent=e,i.type=t,i.axis=t<=h.RelationType.Right_Right||t==h.RelationType.Width||t>=h.RelationType.LeftExt_Left&&t<=h.RelationType.RightExt_Right?0:1,this._defs.push(i),!e&&t!=h.RelationType.Left_Center&&t!=h.RelationType.Center_Center&&t!=h.RelationType.Right_Center&&t!=h.RelationType.Top_Middle&&t!=h.RelationType.Middle_Middle&&t!=h.RelationType.Bottom_Middle||(this._owner.pixelSnapping=!0)},e.prototype.remove=function(t){if((t=void 0===t?0:t)==h.RelationType.Size)return this.remove(h.RelationType.Width),void this.remove(h.RelationType.Height);for(var e=this._defs.length,i=0;i<e;i++)if(this._defs[i].type==t){this._defs.splice(i,1);break}},e.prototype.copyFrom=function(t){this.target=t.target,this._defs.length=0;for(var e=t._defs.length,i=0;i<e;i++){var r=t._defs[i],n=new o;n.copyFrom(r),this._defs.push(n)}},e.prototype.dispose=function(){this._target&&(this.releaseRefTarget(this._target),this._target=null)},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0==this._defs.length},enumerable:!0,configurable:!0}),e.prototype.applyOnSelfResized=function(t,e,i){for(var r=this._owner.x,n=this._owner.y,o=this._defs.length,a=0;a<o;a++)switch(this._defs[a].type){case h.RelationType.Center_Center:this._owner.x-=(.5-(i?this._owner.pivotX:0))*t;break;case h.RelationType.Right_Center:case h.RelationType.Right_Left:case h.RelationType.Right_Right:this._owner.x-=(1-(i?this._owner.pivotX:0))*t;break;case h.RelationType.Middle_Middle:this._owner.y-=(.5-(i?this._owner.pivotY:0))*e;break;case h.RelationType.Bottom_Middle:case h.RelationType.Bottom_Top:case h.RelationType.Bottom_Bottom:this._owner.y-=(1-(i?this._owner.pivotY:0))*e}if((r!=this._owner.x||n!=this._owner.y)&&(r=this._owner.x-r,n=this._owner.y-n,this._owner.updateGearFromRelations(1,r,n),this._owner.parent)){var s=this._owner.parent._transitions.length;if(0<s)for(a=0;a<s;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,r,n)}},e.prototype.applyOnXYChanged=function(t,e,i){var r;switch(t.type){case h.RelationType.Left_Left:case h.RelationType.Left_Center:case h.RelationType.Left_Right:case h.RelationType.Center_Center:case h.RelationType.Right_Left:case h.RelationType.Right_Center:case h.RelationType.Right_Right:this._owner.x+=e;break;case h.RelationType.Top_Top:case h.RelationType.Top_Middle:case h.RelationType.Top_Bottom:case h.RelationType.Middle_Middle:case h.RelationType.Bottom_Top:case h.RelationType.Bottom_Middle:case h.RelationType.Bottom_Bottom:this._owner.y+=i;break;case h.RelationType.Width:case h.RelationType.Height:break;case h.RelationType.LeftExt_Left:case h.RelationType.LeftExt_Right:this._owner!=this._target.parent?(r=this._owner.xMin,this._owner.width=this._owner._rawWidth-e,this._owner.xMin=r+e):this._owner.width=this._owner._rawWidth-e;break;case h.RelationType.RightExt_Left:case h.RelationType.RightExt_Right:this._owner!=this._target.parent?(r=this._owner.xMin,this._owner.width=this._owner._rawWidth+e,this._owner.xMin=r):this._owner.width=this._owner._rawWidth+e;break;case h.RelationType.TopExt_Top:case h.RelationType.TopExt_Bottom:this._owner!=this._target.parent?(r=this._owner.yMin,this._owner.height=this._owner._rawHeight-i,this._owner.yMin=r+i):this._owner.height=this._owner._rawHeight-i;break;case h.RelationType.BottomExt_Top:case h.RelationType.BottomExt_Bottom:this._owner!=this._target.parent?(r=this._owner.yMin,this._owner.height=this._owner._rawHeight+i,this._owner.yMin=r):this._owner.height=this._owner._rawHeight+i}},e.prototype.applyOnSizeChanged=function(t){var e,i,r=0,n=0,o=0;switch(0==t.axis?(this._target!=this._owner.parent&&(r=this._target.x,this._target.pivotAsAnchor&&(n=this._target.pivotX)),t.percent?0!=this._targetWidth&&(o=this._target._width/this._targetWidth):o=this._target._width-this._targetWidth):(this._target!=this._owner.parent&&(r=this._target.y,this._target.pivotAsAnchor&&(n=this._target.pivotY)),t.percent?0!=this._targetHeight&&(o=this._target._height/this._targetHeight):o=this._target._height-this._targetHeight),t.type){case h.RelationType.Left_Left:t.percent?this._owner.xMin=r+(this._owner.xMin-r)*o:0!=n&&(this._owner.x+=o*-n);break;case h.RelationType.Left_Center:t.percent?this._owner.xMin=r+(this._owner.xMin-r)*o:this._owner.x+=o*(.5-n);break;case h.RelationType.Left_Right:t.percent?this._owner.xMin=r+(this._owner.xMin-r)*o:this._owner.x+=o*(1-n);break;case h.RelationType.Center_Center:t.percent?this._owner.xMin=r+(this._owner.xMin+.5*this._owner._rawWidth-r)*o-.5*this._owner._rawWidth:this._owner.x+=o*(.5-n);break;case h.RelationType.Right_Left:t.percent?this._owner.xMin=r+(this._owner.xMin+this._owner._rawWidth-r)*o-this._owner._rawWidth:0!=n&&(this._owner.x+=o*-n);break;case h.RelationType.Right_Center:t.percent?this._owner.xMin=r+(this._owner.xMin+this._owner._rawWidth-r)*o-this._owner._rawWidth:this._owner.x+=o*(.5-n);break;case h.RelationType.Right_Right:t.percent?this._owner.xMin=r+(this._owner.xMin+this._owner._rawWidth-r)*o-this._owner._rawWidth:this._owner.x+=o*(1-n);break;case h.RelationType.Top_Top:t.percent?this._owner.yMin=r+(this._owner.yMin-r)*o:0!=n&&(this._owner.y+=o*-n);break;case h.RelationType.Top_Middle:t.percent?this._owner.yMin=r+(this._owner.yMin-r)*o:this._owner.y+=o*(.5-n);break;case h.RelationType.Top_Bottom:t.percent?this._owner.yMin=r+(this._owner.yMin-r)*o:this._owner.y+=o*(1-n);break;case h.RelationType.Middle_Middle:t.percent?this._owner.yMin=r+(this._owner.yMin+.5*this._owner._rawHeight-r)*o-.5*this._owner._rawHeight:this._owner.y+=o*(.5-n);break;case h.RelationType.Bottom_Top:t.percent?this._owner.yMin=r+(this._owner.yMin+this._owner._rawHeight-r)*o-this._owner._rawHeight:0!=n&&(this._owner.y+=o*-n);break;case h.RelationType.Bottom_Middle:t.percent?this._owner.yMin=r+(this._owner.yMin+this._owner._rawHeight-r)*o-this._owner._rawHeight:this._owner.y+=o*(.5-n);break;case h.RelationType.Bottom_Bottom:t.percent?this._owner.yMin=r+(this._owner.yMin+this._owner._rawHeight-r)*o-this._owner._rawHeight:this._owner.y+=o*(1-n);break;case h.RelationType.Width:e=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceWidth-this._target.initWidth:this._owner._rawWidth-this._targetWidth,t.percent&&(e*=o),this._target==this._owner.parent?this._owner.pivotAsAnchor?(i=this._owner.xMin,this._owner.setSize(this._target._width+e,this._owner._rawHeight,!0),this._owner.xMin=i):this._owner.setSize(this._target._width+e,this._owner._rawHeight,!0):this._owner.width=this._target._width+e;break;case h.RelationType.Height:e=this._owner._underConstruct&&this._owner==this._target.parent?this._owner.sourceHeight-this._target.initHeight:this._owner._rawHeight-this._targetHeight,t.percent&&(e*=o),this._target==this._owner.parent?this._owner.pivotAsAnchor?(i=this._owner.yMin,this._owner.setSize(this._owner._rawWidth,this._target._height+e,!0),this._owner.yMin=i):this._owner.setSize(this._owner._rawWidth,this._target._height+e,!0):this._owner.height=this._target._height+e;break;case h.RelationType.LeftExt_Left:i=this._owner.xMin,e=t.percent?r+(i-r)*o-i:o*-n,this._owner.width=this._owner._rawWidth-e,this._owner.xMin=i+e;break;case h.RelationType.LeftExt_Right:i=this._owner.xMin,e=t.percent?r+(i-r)*o-i:o*(1-n),this._owner.width=this._owner._rawWidth-e,this._owner.xMin=i+e;break;case h.RelationType.RightExt_Left:i=this._owner.xMin,e=t.percent?r+(i+this._owner._rawWidth-r)*o-(i+this._owner._rawWidth):o*-n,this._owner.width=this._owner._rawWidth+e,this._owner.xMin=i;break;case h.RelationType.RightExt_Right:i=this._owner.xMin,t.percent?this._owner==this._target.parent?this._owner._underConstruct?this._owner.width=r+this._target._width-this._target._width*n+(this._owner.sourceWidth-r-this._target.initWidth+this._target.initWidth*n)*o:this._owner.width=r+(this._owner._rawWidth-r)*o:(e=r+(i+this._owner._rawWidth-r)*o-(i+this._owner._rawWidth),this._owner.width=this._owner._rawWidth+e,this._owner.xMin=i):this._owner==this._target.parent?this._owner._underConstruct?this._owner.width=this._owner.sourceWidth+(this._target._width-this._target.initWidth)*(1-n):this._owner.width=this._owner._rawWidth+o*(1-n):(this._owner.width=this._owner._rawWidth+(e=o*(1-n)),this._owner.xMin=i);break;case h.RelationType.TopExt_Top:i=this._owner.yMin,e=t.percent?r+(i-r)*o-i:o*-n,this._owner.height=this._owner._rawHeight-e,this._owner.yMin=i+e;break;case h.RelationType.TopExt_Bottom:i=this._owner.yMin,e=t.percent?r+(i-r)*o-i:o*(1-n),this._owner.height=this._owner._rawHeight-e,this._owner.yMin=i+e;break;case h.RelationType.BottomExt_Top:i=this._owner.yMin,e=t.percent?r+(i+this._owner._rawHeight-r)*o-(i+this._owner._rawHeight):o*-n,this._owner.height=this._owner._rawHeight+e,this._owner.yMin=i;break;case h.RelationType.BottomExt_Bottom:i=this._owner.yMin,t.percent?this._owner==this._target.parent?this._owner._underConstruct?this._owner.height=r+this._target._height-this._target._height*n+(this._owner.sourceHeight-r-this._target.initHeight+this._target.initHeight*n)*o:this._owner.height=r+(this._owner._rawHeight-r)*o:(e=r+(i+this._owner._rawHeight-r)*o-(i+this._owner._rawHeight),this._owner.height=this._owner._rawHeight+e,this._owner.yMin=i):this._owner==this._target.parent?this._owner._underConstruct?this._owner.height=this._owner.sourceHeight+(this._target._height-this._target.initHeight)*(1-n):this._owner.height=this._owner._rawHeight+o*(1-n):(this._owner.height=this._owner._rawHeight+(e=o*(1-n)),this._owner.yMin=i)}},e.prototype.addRefTarget=function(t){t!=this._owner.parent&&t.addEventListener(h.GObject.XY_CHANGED,this.__targetXYChanged,this),t.addEventListener(h.GObject.SIZE_CHANGED,this.__targetSizeChanged,this),t.addEventListener(h.GObject.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this),this._targetX=this._target.x,this._targetY=this._target.y,this._targetWidth=this._target._width,this._targetHeight=this._target._height},e.prototype.releaseRefTarget=function(t){t.removeEventListener(h.GObject.XY_CHANGED,this.__targetXYChanged,this),t.removeEventListener(h.GObject.SIZE_CHANGED,this.__targetSizeChanged,this),t.removeEventListener(h.GObject.SIZE_DELAY_CHANGE,this.__targetSizeWillChange,this)},e.prototype.__targetXYChanged=function(t){if(null!=this._owner.relations.handling||null!=this._owner.group&&this._owner.group._updating)return this._targetX=this._target.x,void(this._targetY=this._target.y);this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,r=this._target.x-this._targetX,n=this._target.y-this._targetY,o=this._defs.length,a=0;a<o;a++){var s=this._defs[a];this.applyOnXYChanged(s,r,n)}if(this._targetX=this._target.x,this._targetY=this._target.y,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),this._owner.parent)){var h=this._owner.parent._transitions.length;if(0<h)for(a=0;a<h;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,e,i)}this._owner.relations.handling=null},e.prototype.__targetSizeChanged=function(t){if(null==this._owner.relations.handling){this._owner.relations.handling=this._target;for(var e=this._owner.x,i=this._owner.y,r=this._owner._rawWidth,n=this._owner._rawHeight,o=this._defs.length,a=0;a<o;a++){var s=this._defs[a];this.applyOnSizeChanged(s)}if(this._targetWidth=this._target._width,this._targetHeight=this._target._height,(e!=this._owner.x||i!=this._owner.y)&&(e=this._owner.x-e,i=this._owner.y-i,this._owner.updateGearFromRelations(1,e,i),this._owner.parent)){var h=this._owner.parent._transitions.length;if(0<h)for(a=0;a<h;++a)this._owner.parent._transitions[a].updateFromRelations(this._owner.id,e,i)}r==this._owner._rawWidth&&n==this._owner._rawHeight||(r=this._owner._rawWidth-r,n=this._owner._rawHeight-n,this._owner.updateGearFromRelations(2,r,n)),this._owner.relations.handling=null}},e.prototype.__targetSizeWillChange=function(t){this._owner.relations.sizeDirty=!0},e);function e(t){this._owner=t,this._defs=new Array}h.RelationItem=t;var o=(i.prototype.copyFrom=function(t){this.percent=t.percent,this.type=t.type,this.axis=t.axis},i);function i(){}h.RelationDef=o}(fgui=fgui||{}),function(u){var t=(e.prototype.add=function(t,e,i){for(var r=this._items.length,n=0;n<r;n++){var o=this._items[n];if(o.target==t)return void o.add(e,i)}var a=new u.RelationItem(this._owner);a.target=t,a.add(e,i),this._items.push(a)},e.prototype.remove=function(t,e){e=e||0;for(var i=this._items.length,r=0;r<i;){var n=this._items[r];n.target==t?(n.remove(e),n.isEmpty?(n.dispose(),this._items.splice(r,1),i--):r++):r++}},e.prototype.contains=function(t){for(var e=this._items.length,i=0;i<e;i++)if(this._items[i].target==t)return!0;return!1},e.prototype.clearFor=function(t){for(var e=this._items.length,i=0;i<e;){var r=this._items[i];r.target==t?(r.dispose(),this._items.splice(i,1),e--):i++}},e.prototype.clearAll=function(){for(var t=this._items.length,e=0;e<t;e++)this._items[e].dispose();this._items.length=0},e.prototype.copyFrom=function(t){this.clearAll();for(var e=t._items,i=e.length,r=0;r<i;r++){var n=e[r],o=new u.RelationItem(this._owner);o.copyFrom(n),this._items.push(o)}},e.prototype.dispose=function(){this.clearAll()},e.prototype.onOwnerSizeChanged=function(t,e,i){if(0!=this._items.length)for(var r=this._items.length,n=0;n<r;n++)this._items[n].applyOnSelfResized(t,e,i)},e.prototype.ensureRelationsSizeCorrect=function(){if(0!=this._items.length){this.sizeDirty=!1;for(var t=this._items.length,e=0;e<t;e++)this._items[e].target.ensureSizeCorrect()}},Object.defineProperty(e.prototype,"empty",{get:function(){return 0==this._items.length},enumerable:!0,configurable:!0}),e.prototype.setup=function(t,e){for(var i=t.readByte(),r=0;r<i;r++){var n=t.readShort(),n=-1==n?this._owner.parent:(e?this._owner:this._owner.parent).getChildAt(n),o=new u.RelationItem(this._owner);o.target=n,this._items.push(o);for(var a=t.readByte(),s=0;s<a;s++){var h=t.readByte(),l=t.readBool();o.internalAdd(h,l)}}},e);function e(t){this._owner=t,this._items=new Array}u.Relations=t}(fgui=fgui||{}),function(c){var i,t=(i=egret.EventDispatcher,__extends(p,i),Object.defineProperty(p.prototype,"tweenTimeGo",{set:function(t){this._tweenTimeGo=t},enumerable:!0,configurable:!0}),p.prototype.setup=function(t){this._scrollType=t.readByte();var e=t.readByte(),i=t.readInt();t.readBool()&&(this._scrollBarMargin.top=t.readInt(),this._scrollBarMargin.bottom=t.readInt(),this._scrollBarMargin.left=t.readInt(),this._scrollBarMargin.right=t.readInt());var r,n=t.readS(),o=t.readS(),a=t.readS(),t=t.readS();if(0!=(1&i)&&(this._displayOnLeft=!0),0!=(2&i)&&(this._snapToItem=!0),0!=(4&i)&&(this._displayInDemand=!0),0!=(8&i)&&(this._pageMode=!0),this._touchEffect=!!(16&i)||!(32&i)&&c.UIConfig.defaultScrollTouchEffect,this._bouncebackEffect=!!(64&i)||!(128&i)&&c.UIConfig.defaultScrollBounceEffect,0!=(256&i)&&(this._inertiaDisabled=!0),0==(512&i)&&(this._maskContainer.scrollRect=new egret.Rectangle),0!=(1024&i)&&(this._floating=!0),0!=(2048&i)&&(this._dontClipMargin=!0),(e=e==c.ScrollBarDisplayType.Default?c.UIConfig.defaultScrollBarDisplay:e)!=c.ScrollBarDisplayType.Hidden){if(this._scrollType==c.ScrollType.Both||this._scrollType==c.ScrollType.Vertical)if(r=n||c.UIConfig.verticalScrollBar){if(this._vtScrollBar=c.UIPackage.createObjectFromURL(r),!this._vtScrollBar)throw"cannot create scrollbar from "+r;this._vtScrollBar.setScrollPane(this,!0),this._owner._rootContainer.addChild(this._vtScrollBar.displayObject)}if(this._scrollType==c.ScrollType.Both||this._scrollType==c.ScrollType.Horizontal)if(r=o||c.UIConfig.horizontalScrollBar){if(this._hzScrollBar=c.UIPackage.createObjectFromURL(r),!this._hzScrollBar)throw"cannot create scrollbar from "+r;this._hzScrollBar.setScrollPane(this,!1),this._owner._rootContainer.addChild(this._hzScrollBar.displayObject)}e==c.ScrollBarDisplayType.Auto&&(this._scrollBarDisplayAuto=!0),this._scrollBarDisplayAuto&&(this._vtScrollBar&&(this._vtScrollBar.displayObject.visible=!1),this._hzScrollBar&&(this._hzScrollBar.displayObject.visible=!1))}if(a&&(this._header=c.UIPackage.createObjectFromURL(a),!this._header))throw"cannot create scrollPane header from "+a;if(t&&(this._footer=c.UIPackage.createObjectFromURL(t),!this._footer))throw"cannot create scrollPane footer from "+t;(this._header||this._footer)&&(this._refreshBarAxis=this._scrollType==c.ScrollType.Both||this._scrollType==c.ScrollType.Vertical?"y":"x"),this.setSize(this._owner.width,this._owner.height)},p.prototype.dispose=function(){0!=this._tweening&&c.GTimers.inst.remove(this.tweenUpdate,this),delete this._pageController,this._hzScrollBar&&this._hzScrollBar.dispose(),this._vtScrollBar&&this._vtScrollBar.dispose(),this._header&&this._header.dispose(),this._footer&&this._footer.dispose()},Object.defineProperty(p.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"hzScrollBar",{get:function(){return this._hzScrollBar},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"vtScrollBar",{get:function(){return this._vtScrollBar},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"header",{get:function(){return this._header},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"footer",{get:function(){return this._footer},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"bouncebackEffect",{get:function(){return this._bouncebackEffect},set:function(t){this._bouncebackEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"touchEffect",{get:function(){return this._touchEffect},set:function(t){this._touchEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"scrollStep",{get:function(){return this._scrollStep},set:function(t){this._scrollStep=t,0==this._scrollStep&&(this._scrollStep=c.UIConfig.defaultScrollStep)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"decelerationRate",{get:function(){return this._decelerationRate},set:function(t){this._decelerationRate=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"snapToItem",{get:function(){return this._snapToItem},set:function(t){this._snapToItem=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"isDragged",{get:function(){return this._dragged},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"percX",{get:function(){return 0==this._overlapSize.x?0:this._xPos/this._overlapSize.x},set:function(t){this.setPercX(t,!1)},enumerable:!0,configurable:!0}),p.prototype.setPercX=function(t,e){void 0===e&&(e=!1),this._owner.ensureBoundsCorrect(),this.setPosX(this._overlapSize.x*c.ToolSet.clamp01(t),e)},Object.defineProperty(p.prototype,"percY",{get:function(){return 0==this._overlapSize.y?0:this._yPos/this._overlapSize.y},set:function(t){this.setPercY(t,!1)},enumerable:!0,configurable:!0}),p.prototype.setPercY=function(t,e){void 0===e&&(e=!1),this._owner.ensureBoundsCorrect(),this.setPosY(this._overlapSize.y*c.ToolSet.clamp01(t),e)},Object.defineProperty(p.prototype,"posX",{get:function(){return this._xPos},set:function(t){this.setPosX(t,!1)},enumerable:!0,configurable:!0}),p.prototype.setPosX=function(t,e){this._owner.ensureBoundsCorrect(),1==this._loop&&(t=this.loopCheckingNewPos(t,"x")),(t=c.ToolSet.clamp(t,0,this._overlapSize.x))!=this._xPos&&(this._xPos=t,this.posChanged(e))},Object.defineProperty(p.prototype,"posY",{get:function(){return this._yPos},set:function(t){this.setPosY(t,!1)},enumerable:!0,configurable:!0}),p.prototype.setPosY=function(t,e){this._owner.ensureBoundsCorrect(),1==this._loop&&(t=this.loopCheckingNewPos(t,"y")),(t=c.ToolSet.clamp(t,0,this._overlapSize.y))!=this._yPos&&(this._yPos=t,this.posChanged(e))},Object.defineProperty(p.prototype,"contentWidth",{get:function(){return this._contentSize.x},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"contentHeight",{get:function(){return this._contentSize.y},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"viewWidth",{get:function(){return this._viewSize.x},set:function(t){t=t+this._owner.margin.left+this._owner.margin.right,this._vtScrollBar&&!this._floating&&(t+=this._vtScrollBar.width),this._owner.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"viewHeight",{get:function(){return this._viewSize.y},set:function(t){t=t+this._owner.margin.top+this._owner.margin.bottom,this._hzScrollBar&&!this._floating&&(t+=this._hzScrollBar.height),this._owner.height=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"currentPageX",{get:function(){if(!this._pageMode)return 0;var t=Math.floor(this._xPos/this._pageSize.x);return this._xPos-t*this._pageSize.x>.5*this._pageSize.x&&t++,t},set:function(t){this.setCurrentPageX(t,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"currentPageY",{get:function(){if(!this._pageMode)return 0;var t=Math.floor(this._yPos/this._pageSize.y);return this._yPos-t*this._pageSize.y>.5*this._pageSize.y&&t++,t},set:function(t){this.setCurrentPageY(t,!1)},enumerable:!0,configurable:!0}),p.prototype.setCurrentPageX=function(t,e){this._pageMode&&(this._owner.ensureBoundsCorrect(),0<this._overlapSize.x&&this.setPosX(t*this._pageSize.x,e))},p.prototype.setCurrentPageY=function(t,e){this._pageMode&&(this._owner.ensureBoundsCorrect(),0<this._overlapSize.y&&this.setPosY(t*this._pageSize.y,e))},Object.defineProperty(p.prototype,"isBottomMost",{get:function(){return this._yPos==this._overlapSize.y||0==this._overlapSize.y},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"isRightMost",{get:function(){return this._xPos==this._overlapSize.x||0==this._overlapSize.x},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"pageController",{get:function(){return this._pageController},set:function(t){this._pageController=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"scrollingPosX",{get:function(){return c.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"scrollingPosY",{get:function(){return c.ToolSet.clamp(-this._container.y,0,this._overlapSize.y)},enumerable:!0,configurable:!0}),p.prototype.scrollTop=function(t){this.setPercY(0,t)},p.prototype.scrollBottom=function(t){this.setPercY(1,t)},p.prototype.scrollUp=function(t,e){t=t||1,this._pageMode?this.setPosY(this._yPos-this._pageSize.y*t,e):this.setPosY(this._yPos-this._scrollStep*t,e)},p.prototype.scrollDown=function(t,e){t=t||1,this._pageMode?this.setPosY(this._yPos+this._pageSize.y*t,e):this.setPosY(this._yPos+this._scrollStep*t,e)},p.prototype.scrollLeft=function(t,e){t=t||1,this._pageMode?this.setPosX(this._xPos-this._pageSize.x*t,e):this.setPosX(this._xPos-this._scrollStep*t,e)},p.prototype.scrollRight=function(t,e){t=t||1,this._pageMode?this.setPosX(this._xPos+this._pageSize.x*t,e):this.setPosX(this._xPos+this._scrollStep*t,e)},p.prototype.scrollRightWithGap=function(t,e,i){void 0===i&&(i=!1),this._pageMode?this.setPosX(this._xPos+this._pageSize.x*t,i):this.setPosX(this._xPos+(e+this._scrollStep)*t,i)},p.prototype.scrollToView=function(t,e,i){var r,n;void 0===e&&(e=!1),void 0===i&&(i=!1),this._owner.ensureBoundsCorrect(),this._needRefresh&&this.refresh(),t instanceof c.GObject?t.parent!=this._owner?(t.parent.localToGlobalRect(t.x,t.y,t.width,t.height,o),r=this._owner.globalToLocalRect(o.x,o.y,o.width,o.height,o)):(r=o).setTo(t.x,t.y,t.width,t.height):r=t,0<this._overlapSize.y&&(n=this._yPos+this._viewSize.y,i||r.y<=this._yPos||r.height>=this._viewSize.y?this._pageMode?this.setPosY(Math.floor(r.y/this._pageSize.y)*this._pageSize.y,e):this.setPosY(r.y,e):r.y+r.height>n&&(this._pageMode?this.setPosY(Math.floor(r.y/this._pageSize.y)*this._pageSize.y,e):r.height<=this._viewSize.y/2?this.setPosY(r.y+2*r.height-this._viewSize.y,e):this.setPosY(r.y+r.height-this._viewSize.y,e))),0<this._overlapSize.x&&(n=this._xPos+this._viewSize.x,i||r.x<=this._xPos||r.width>=this._viewSize.x?this._pageMode?this.setPosX(Math.floor(r.x/this._pageSize.x)*this._pageSize.x,e):this.setPosX(r.x,e):r.x+r.width>n&&(this._pageMode?this.setPosX(Math.floor(r.x/this._pageSize.x)*this._pageSize.x,e):r.width<=this._viewSize.x/2?this.setPosX(r.x+2*r.width-this._viewSize.x,e):this.setPosX(r.x+r.width-this._viewSize.x,e))),!e&&this._needRefresh&&this.refresh()},p.prototype.isChildInView=function(t){if(0<this._overlapSize.y){var e=t.y+this._container.y;if(e<-t.height||e>this._viewSize.y)return!1}return!(0<this._overlapSize.x&&((e=t.x+this._container.x)<-t.width||e>this._viewSize.x))},p.prototype.cancelDragging=function(){this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),this._owner.displayObject.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this),p.draggingPane==this&&(p.draggingPane=null),d=0,this._dragged=!1,this._maskContainer.touchChildren=!0},p.prototype.lockHeader=function(t){this._headerLockedSize!=t&&(this._headerLockedSize=t,!this._refreshEventDispatching&&0<=this._container[this._refreshBarAxis]&&(this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(0,0),this._tweenChange[this._refreshBarAxis]=this._headerLockedSize-this._tweenStart[this._refreshBarAxis],this._tweenDuration.setTo(s,s),this.startTween(2)))},p.prototype.lockFooter=function(t){this._footerLockedSize!=t&&(this._footerLockedSize=t,!this._refreshEventDispatching&&this._container[this._refreshBarAxis]<=-this._overlapSize[this._refreshBarAxis]&&(this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(0,0),0==(t=this._overlapSize[this._refreshBarAxis])?t=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):t+=this._footerLockedSize,this._tweenChange[this._refreshBarAxis]=-t-this._tweenStart[this._refreshBarAxis],this._tweenDuration.setTo(s,s),this.startTween(2)))},p.prototype.onOwnerSizeChanged=function(){this.setSize(this._owner.width,this._owner.height),this.posChanged(!1)},p.prototype.handleControllerChanged=function(t){this._pageController==t&&(this._scrollType==c.ScrollType.Horizontal?this.setCurrentPageX(t.selectedIndex,!0):this.setCurrentPageY(t.selectedIndex,!0))},p.prototype.updatePageController=function(){var t,e;!this._pageController||this._pageController.changing||(e=this._scrollType==c.ScrollType.Horizontal?this.currentPageX:this.currentPageY)<this._pageController.pageCount&&(t=this._pageController,this._pageController=null,t.selectedIndex=e,this._pageController=t)},p.prototype.adjustMaskContainer=function(){var t=0,e=0;this._dontClipMargin?this._displayOnLeft&&this._vtScrollBar&&!this._floating&&(t=this._vtScrollBar.width):(t=this._displayOnLeft&&this._vtScrollBar&&!this._floating?this._owner.margin.left+this._vtScrollBar.width:this._owner.margin.left,e=this._owner.margin.top),this._maskContainer.x=t,this._maskContainer.y=e,t=this._owner._alignOffset.x,e=this._owner._alignOffset.y,0==t&&0==e&&!this._dontClipMargin||this._alignContainer||(this._alignContainer=new egret.DisplayObjectContainer,this._maskContainer.addChild(this._alignContainer),this._alignContainer.addChild(this._container)),this._alignContainer&&(this._dontClipMargin&&(t+=this._owner.margin.left,e+=this._owner.margin.top),this._alignContainer.x=t,this._alignContainer.y=e)},p.prototype.setSize=function(t,e){this.adjustMaskContainer(),this._hzScrollBar&&(this._hzScrollBar.y=e-this._hzScrollBar.height,this._vtScrollBar&&!this._vScrollNone?(this._hzScrollBar.width=t-this._vtScrollBar.width-this._scrollBarMargin.left-this._scrollBarMargin.right,this._displayOnLeft?this._hzScrollBar.x=this._scrollBarMargin.left+this._vtScrollBar.width:this._hzScrollBar.x=this._scrollBarMargin.left):(this._hzScrollBar.width=t-this._scrollBarMargin.left-this._scrollBarMargin.right,this._hzScrollBar.x=this._scrollBarMargin.left)),this._vtScrollBar&&(this._displayOnLeft||(this._vtScrollBar.x=t-this._vtScrollBar.width),this._hzScrollBar?this._vtScrollBar.height=e-this._hzScrollBar.height-this._scrollBarMargin.top-this._scrollBarMargin.bottom:this._vtScrollBar.height=e-this._scrollBarMargin.top-this._scrollBarMargin.bottom,this._vtScrollBar.y=this._scrollBarMargin.top),this._viewSize.x=t,this._viewSize.y=e,this._hzScrollBar&&!this._floating&&(this._viewSize.y-=this._hzScrollBar.height),this._vtScrollBar&&!this._floating&&(this._viewSize.x-=this._vtScrollBar.width),this._viewSize.x-=this._owner.margin.left+this._owner.margin.right,this._viewSize.y-=this._owner.margin.top+this._owner.margin.bottom,this._viewSize.x=Math.max(1,this._viewSize.x),this._viewSize.y=Math.max(1,this._viewSize.y),this._pageSize.x=this._viewSize.x,this._pageSize.y=this._viewSize.y,this.handleSizeChanged()},p.prototype.setContentSize=function(t,e){this._contentSize.x==t&&this._contentSize.y==e||(this._contentSize.x=t,this._contentSize.y=e,this.handleSizeChanged())},p.prototype.changeContentSizeOnScrolling=function(t,e,i,r){var n=this._xPos==this._overlapSize.x,o=this._yPos==this._overlapSize.y;this._contentSize.x+=t,this._contentSize.y+=e,this.handleSizeChanged(),1==this._tweening?(0!=t&&n&&this._tweenChange.x<0&&(this._xPos=this._overlapSize.x,this._tweenChange.x=-this._xPos-this._tweenStart.x),0!=e&&o&&this._tweenChange.y<0&&(this._yPos=this._overlapSize.y,this._tweenChange.y=-this._yPos-this._tweenStart.y)):2==this._tweening?(0!=i&&(this._container.x-=i,this._tweenStart.x-=i,this._xPos=-this._container.x),0!=r&&(this._container.y-=r,this._tweenStart.y-=r,this._yPos=-this._container.y)):this._dragged?(0!=i&&(this._container.x-=i,this._containerPos.x-=i,this._xPos=-this._container.x),0!=r&&(this._container.y-=r,this._containerPos.y-=r,this._yPos=-this._container.y)):(0!=t&&n&&(this._xPos=this._overlapSize.x,this._container.x=-this._xPos),0!=e&&o&&(this._yPos=this._overlapSize.y,this._container.y=-this._yPos)),this._pageMode&&this.updatePageController()},p.prototype.handleSizeChanged=function(){this._displayInDemand&&(this._vScrollNone=this._contentSize.y<=this._viewSize.y,this._hScrollNone=this._contentSize.x<=this._viewSize.x),this._vtScrollBar&&(0==this._contentSize.y?this._vtScrollBar.setDisplayPerc(0):this._vtScrollBar.setDisplayPerc(Math.min(1,this._viewSize.y/this._contentSize.y))),this._hzScrollBar&&(0==this._contentSize.x?this._hzScrollBar.setDisplayPerc(0):this._hzScrollBar.setDisplayPerc(Math.min(1,this._viewSize.x/this._contentSize.x))),this.updateScrollBarVisible();var t=this._maskContainer.scrollRect;t&&(t.width=this._viewSize.x,t.height=this._viewSize.y,this._vScrollNone&&this._vtScrollBar&&(t.width+=this._vtScrollBar.width),this._hScrollNone&&this._hzScrollBar&&(t.height+=this._hzScrollBar.height),this._dontClipMargin&&(t.width+=this._owner.margin.left+this._owner.margin.right,t.height+=this._owner.margin.top+this._owner.margin.bottom),this._maskContainer.scrollRect=t),this._scrollType==c.ScrollType.Horizontal||this._scrollType==c.ScrollType.Both?this._overlapSize.x=Math.ceil(Math.max(0,this._contentSize.x-this._viewSize.x)):this._overlapSize.x=0,this._scrollType==c.ScrollType.Vertical||this._scrollType==c.ScrollType.Both?this._overlapSize.y=Math.ceil(Math.max(0,this._contentSize.y-this._viewSize.y)):this._overlapSize.y=0,this._xPos=c.ToolSet.clamp(this._xPos,0,this._overlapSize.x),this._yPos=c.ToolSet.clamp(this._yPos,0,this._overlapSize.y),null!=this._refreshBarAxis?(0==(t=this._overlapSize[this._refreshBarAxis])?t=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):t+=this._footerLockedSize,"x"==this._refreshBarAxis?(this._container.x=c.ToolSet.clamp(this._container.x,-t,this._headerLockedSize),this._container.y=c.ToolSet.clamp(this._container.y,-this._overlapSize.y,0)):(this._container.x=c.ToolSet.clamp(this._container.x,-this._overlapSize.x,0),this._container.y=c.ToolSet.clamp(this._container.y,-t,this._headerLockedSize)),this._header&&("x"==this._refreshBarAxis?this._header.height=this._viewSize.y:this._header.width=this._viewSize.x),this._footer&&("y"==this._refreshBarAxis?this._footer.height=this._viewSize.y:this._footer.width=this._viewSize.x)):(this._container.x=c.ToolSet.clamp(this._container.x,-this._overlapSize.x,0),this._container.y=c.ToolSet.clamp(this._container.y,-this._overlapSize.y,0)),this.updateScrollBarPos(),this._pageMode&&this.updatePageController()},p.prototype.posChanged=function(t){0==this._aniFlag?this._aniFlag=t?1:-1:1!=this._aniFlag||t||(this._aniFlag=-1),this._needRefresh=!0,c.GTimers.inst.callLater(this.refresh,this),0!=this._tweening&&this.killTween()},p.prototype.refresh=function(){this._needRefresh=!1,c.GTimers.inst.remove(this.refresh,this),(this._pageMode||this._snapToItem)&&(n.setTo(-this._xPos,-this._yPos),this.alignPosition(n,!1),this._xPos=-n.x,this._yPos=-n.y),this.refresh2(),this.dispatchEventWith(p.SCROLL),this._needRefresh&&(this._needRefresh=!1,c.GTimers.inst.remove(this.refresh,this),this.refresh2()),this.updateScrollBarPos(),this._aniFlag=0},p.prototype.refresh2=function(){var t,e;1!=this._aniFlag||this._dragged?(0!=this._tweening&&this.killTween(),this._container.x=Math.floor(-this._xPos),this._container.y=Math.floor(-this._yPos),this.loopCheckingCurrent()):(t=0<this._overlapSize.x?-Math.floor(this._xPos):(0!=this._container.x&&(this._container.x=0),0),e=0<this._overlapSize.y?-Math.floor(this._yPos):(0!=this._container.y&&(this._container.y=0),0),t!=this._container.x||e!=this._container.y?(this._tweenDuration.setTo(r,r),this._tweenStart.setTo(this._container.x,this._container.y),this._tweenChange.setTo(t-this._tweenStart.x,e-this._tweenStart.y),this.startTween(1)):0!=this._tweening&&this.killTween()),this._pageMode&&this.updatePageController()},p.prototype.__touchBegin=function(t){var e;this._touchEffect&&(0!=this._tweening?(this.killTween(),this._dragged=!0):this._dragged=!1,e=this._owner.globalToLocal(t.stageX,t.stageY,_),this._containerPos.setTo(this._container.x,this._container.y),this._beginTouchPos.setTo(e.x,e.y),this._lastTouchPos.setTo(e.x,e.y),this._lastTouchGlobalPos.setTo(t.stageX,t.stageY),this._isHoldAreaDone=!1,this._velocity.setTo(0,0),this._velocityScale=1,this._lastMoveTime=egret.getTimer()/1e3,this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),this._owner.displayObject.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this))},p.prototype.__touchMove=function(t){if(this._owner.displayObject&&null!=this._owner.displayObject.stage&&this._touchEffect&&!(p.draggingPane&&p.draggingPane.owner&&p.draggingPane.owner.parent&&p.draggingPane!=this||c.GObject.draggingObject)){var e,i=this._owner.globalToLocal(t.stageX,t.stageY,_),r=c.UIConfig.touchScrollSensitivity;if(this._scrollType==c.ScrollType.Vertical){if(!this._isHoldAreaDone){if(d|=1,(l=Math.abs(this._beginTouchPos.y-i.y))<r)return;if(0!=(2&d)&&l<Math.abs(this._beginTouchPos.x-i.x))return}a=!0}else if(this._scrollType==c.ScrollType.Horizontal){if(!this._isHoldAreaDone){if(d|=2,(l=Math.abs(this._beginTouchPos.x-i.x))<r)return;if(0!=(1&d)&&l<Math.abs(this._beginTouchPos.y-i.y))return}e=!0}else{if(d=3,!this._isHoldAreaDone&&(l=Math.abs(this._beginTouchPos.y-i.y))<r&&(l=Math.abs(this._beginTouchPos.x-i.x))<r)return;a=e=!0}var n=Math.floor(this._containerPos.x+i.x-this._beginTouchPos.x),o=Math.floor(this._containerPos.y+i.y-this._beginTouchPos.y);a&&(0<o?this._bouncebackEffect?this._header&&0!=this._header.maxHeight?this._container.y=Math.floor(Math.min(.5*o,this._header.maxHeight)):this._container.y=Math.floor(Math.min(.5*o,this._viewSize.y*f)):this._container.y=0:o<-this._overlapSize.y?this._bouncebackEffect?this._footer&&0<this._footer.maxHeight?this._container.y=Math.floor(Math.max(.5*(o+this._overlapSize.y),-this._footer.maxHeight)-this._overlapSize.y):this._container.y=Math.floor(Math.max(.5*(o+this._overlapSize.y),-this._viewSize.y*f)-this._overlapSize.y):this._container.y=-this._overlapSize.y:this._container.y=o),e&&(0<n?this._bouncebackEffect?this._header&&0!=this._header.maxWidth?this._container.x=Math.floor(Math.min(.5*n,this._header.maxWidth)):this._container.x=Math.floor(Math.min(.5*n,this._viewSize.x*f)):this._container.x=0:n<0-this._overlapSize.x?this._bouncebackEffect?this._footer&&0<this._footer.maxWidth?this._container.x=Math.floor(Math.max(.5*(n+this._overlapSize.x),-this._footer.maxWidth)-this._overlapSize.x):this._container.x=Math.floor(Math.max(.5*(n+this._overlapSize.x),-this._viewSize.x*f)-this._overlapSize.x):this._container.x=-this._overlapSize.x:this._container.x=n);var a,s=egret.getTimer()/1e3,h=Math.max(s-this._lastMoveTime,1/60),l=i.x-this._lastTouchPos.x,r=i.y-this._lastTouchPos.y;e||(l=0),a||(r=0),0!=h&&(1<(a=h*(u=this._owner.displayObject.stage.frameRate)-1)&&(a=Math.pow(.833,a),this._velocity.x=this._velocity.x*a,this._velocity.y=this._velocity.y*a),this._velocity.x=c.ToolSet.lerp(this._velocity.x,60*l/u/h,10*h),this._velocity.y=c.ToolSet.lerp(this._velocity.y,60*r/u/h,10*h));var u=this._lastTouchGlobalPos.x-t.stageX,h=this._lastTouchGlobalPos.y-t.stageY;0!=l?this._velocityScale=Math.abs(u/l):0!=r&&(this._velocityScale=Math.abs(h/r)),this._lastTouchPos.setTo(i.x,i.y),this._lastTouchGlobalPos.setTo(t.stageX,t.stageY),this._lastMoveTime=s,0<this._overlapSize.x&&(this._xPos=c.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)),0<this._overlapSize.y&&(this._yPos=c.ToolSet.clamp(-this._container.y,0,this._overlapSize.y)),0!=this._loop&&(n=this._container.x,o=this._container.y,this.loopCheckingCurrent()&&(this._containerPos.x+=this._container.x-n,this._containerPos.y+=this._container.y-o)),(p.draggingPane=this)._isHoldAreaDone=!0,this._dragged=!0,this._maskContainer.touchChildren=!1,this.updateScrollBarPos(),this.updateScrollBarVisible(),this._pageMode&&this.updatePageController(),this.dispatchEventWith(p.SCROLL)}},p.prototype.__touchEnd=function(t){if(t.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.__touchMove,this),t.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.__touchEnd,this),t.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__touchTap,this),this._owner.displayObject){if(p.draggingPane==this&&(p.draggingPane=null),d=0,!this._dragged||!this._touchEffect||null==this._owner.displayObject.stage)return this._dragged=!1,void(this._maskContainer.touchChildren=!0);this._dragged=!1,this._maskContainer.touchChildren=!0,this._tweenStart.setTo(this._container.x,this._container.y),n.setTo(this._tweenStart.x,this._tweenStart.y);var e,t=!1;if(0<this._container.x?t=!(n.x=0):this._container.x<-this._overlapSize.x&&(n.x=-this._overlapSize.x,t=!0),0<this._container.y?t=!(n.y=0):this._container.y<-this._overlapSize.y&&(n.y=-this._overlapSize.y,t=!0),t)this._tweenChange.setTo(n.x-this._tweenStart.x,n.y-this._tweenStart.y),this._tweenChange.x<-c.UIConfig.touchDragSensitivity||this._tweenChange.y<-c.UIConfig.touchDragSensitivity?(this._refreshEventDispatching=!0,this.dispatchEventWith(p.PULL_DOWN_RELEASE),this._refreshEventDispatching=!1):(this._tweenChange.x>c.UIConfig.touchDragSensitivity||this._tweenChange.y>c.UIConfig.touchDragSensitivity)&&(this._refreshEventDispatching=!0,this.dispatchEventWith(p.PULL_UP_RELEASE),this._refreshEventDispatching=!1),0<this._headerLockedSize&&0==n[this._refreshBarAxis]?(n[this._refreshBarAxis]=this._headerLockedSize,this._tweenChange.x=n.x-this._tweenStart.x,this._tweenChange.y=n.y-this._tweenStart.y):0<this._footerLockedSize&&n[this._refreshBarAxis]==-this._overlapSize[this._refreshBarAxis]&&(0==(e=this._overlapSize[this._refreshBarAxis])?e=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):e+=this._footerLockedSize,n[this._refreshBarAxis]=-e,this._tweenChange.x=n.x-this._tweenStart.x,this._tweenChange.y=n.y-this._tweenStart.y),this._tweenDuration.setTo(s,s);else{if(this._inertiaDisabled?this._tweenDuration.setTo(s,s):(e=this._owner.displayObject.stage.frameRate,1<(e=(egret.getTimer()/1e3-this._lastMoveTime)*e-1)&&(e=Math.pow(.833,e),this._velocity.x=this._velocity.x*e,this._velocity.y=this._velocity.y*e),this.updateTargetAndDuration(this._tweenStart,n)),a.setTo(n.x-this._tweenStart.x,n.y-this._tweenStart.y),this.loopCheckingTarget(n),(this._pageMode||this._snapToItem)&&this.alignPosition(n,!0),this._tweenChange.x=n.x-this._tweenStart.x,this._tweenChange.y=n.y-this._tweenStart.y,0==this._tweenChange.x&&0==this._tweenChange.y)return void this.updateScrollBarVisible();(this._pageMode||this._snapToItem)&&(this.fixDuration("x",a.x),this.fixDuration("y",a.y))}this.startTween(2)}},p.prototype.__touchTap=function(t){this._dragged=!1},p.prototype.updateScrollBarPos=function(){this._vtScrollBar&&this._vtScrollBar.setScrollPerc(0==this._overlapSize.y?0:c.ToolSet.clamp(-this._container.y,0,this._overlapSize.y)/this._overlapSize.y),this._hzScrollBar&&this._hzScrollBar.setScrollPerc(0==this._overlapSize.x?0:c.ToolSet.clamp(-this._container.x,0,this._overlapSize.x)/this._overlapSize.x),this.checkRefreshBar()},p.prototype.updateScrollBarVisible=function(){this._vtScrollBar&&(this._viewSize.y<=this._vtScrollBar.minSize||this._vScrollNone?this._vtScrollBar.displayObject.visible=!1:this.updateScrollBarVisible2(this._vtScrollBar)),this._hzScrollBar&&(this._viewSize.x<=this._hzScrollBar.minSize||this._hScrollNone?this._hzScrollBar.displayObject.visible=!1:this.updateScrollBarVisible2(this._hzScrollBar))},p.prototype.updateScrollBarVisible2=function(t){this._scrollBarDisplayAuto&&c.GTween.kill(t,!1,"alpha"),!this._scrollBarDisplayAuto||0!=this._tweening||this._dragged||t.gripDragging?(t.alpha=1,t.displayObject.visible=!0):t.displayObject.visible&&c.GTween.to(1,0,.5).setDelay(.5).onComplete(this.__barTweenComplete,this).setTarget(t,"alpha")},p.prototype.__barTweenComplete=function(t){t=t.target;t.alpha=1,t.displayObject.visible=!1},p.prototype.getLoopPartSize=function(t,e){return(this._contentSize[e]+("x"==e?this._owner.columnGap:this._owner.lineGap))/t},p.prototype.loopCheckingCurrent=function(){var t=!1;return 1==this._loop&&0<this._overlapSize.x?this._xPos<.001?(this._xPos+=this.getLoopPartSize(2,"x"),t=!0):this._xPos>=this._overlapSize.x&&(this._xPos-=this.getLoopPartSize(2,"x"),t=!0):2==this._loop&&0<this._overlapSize.y&&(this._yPos<.001?(this._yPos+=this.getLoopPartSize(2,"y"),t=!0):this._yPos>=this._overlapSize.y&&(this._yPos-=this.getLoopPartSize(2,"y"),t=!0)),t&&(this._container.x=Math.floor(-this._xPos),this._container.y=Math.floor(-this._yPos)),t},p.prototype.loopCheckingTarget=function(t){1==this._loop&&this.loopCheckingTarget2(t,"x"),2==this._loop&&this.loopCheckingTarget2(t,"y")},p.prototype.loopCheckingTarget2=function(t,e){var i,r;0<t[e]?(i=this.getLoopPartSize(2,e),(r=this._tweenStart[e]-i)<=0&&r>=-this._overlapSize[e]&&(t[e]-=i,this._tweenStart[e]=r)):t[e]<-this._overlapSize[e]&&(i=this.getLoopPartSize(2,e),(r=this._tweenStart[e]+i)<=0&&r>=-this._overlapSize[e]&&(t[e]+=i,this._tweenStart[e]=r))},p.prototype.loopCheckingNewPos=function(t,e){if(0==this._overlapSize[e])return t;var i,r="x"==e?this._xPos:this._yPos,n=!1;return t<.001?r<(t+=this.getLoopPartSize(2,e))&&(i=this.getLoopPartSize(6,e),i=Math.ceil((t-r)/i)*i,r=c.ToolSet.clamp(r+i,0,this._overlapSize[e]),n=!0):t>=this._overlapSize[e]&&(t-=this.getLoopPartSize(2,e))<r&&(i=this.getLoopPartSize(6,e),i=Math.ceil((r-t)/i)*i,r=c.ToolSet.clamp(r-i,0,this._overlapSize[e]),n=!0),n&&("x"==e?this._container.x=-Math.floor(r):this._container.y=-Math.floor(r)),t},p.prototype.alignPosition=function(t,e){this._pageMode?(t.x=this.alignByPage(t.x,"x",e),t.y=this.alignByPage(t.y,"y",e)):this._snapToItem&&(e=this._owner.getSnappingPosition(-t.x,-t.y,_),t.x<0&&t.x>-this._overlapSize.x&&(t.x=-e.x),t.y<0&&t.y>-this._overlapSize.y&&(t.y=-e.y))},p.prototype.alignByPage=function(t,e,i){var r,n,o,a;return 0<t?r=0:t<-this._overlapSize[e]?r=Math.ceil(this._contentSize[e]/this._pageSize[e])-1:(r=Math.floor(-t/this._pageSize[e]),n=i?t-this._containerPos[e]:t-this._container[e],o=Math.min(this._pageSize[e],this._contentSize[e]-(r+1)*this._pageSize[e]),a=-t-r*this._pageSize[e],Math.abs(n)>this._pageSize[e]?.5*o<a&&r++:o*(n<0?.3:.7)<a&&r++,(t=-r*this._pageSize[e])<-this._overlapSize[e]&&(t=-this._overlapSize[e])),i&&(i=0<(a=this._tweenStart[e])?0:a<-this._overlapSize[e]?Math.ceil(this._contentSize[e]/this._pageSize[e])-1:Math.floor(-a/this._pageSize[e]),a=Math.floor(-this._containerPos[e]/this._pageSize[e]),1<Math.abs(r-a)&&Math.abs(i-a)<=1&&(t=-(r=a<r?a+1:a-1)*this._pageSize[e])),t},p.prototype.updateTargetAndDuration=function(t,e){e.x=this.updateTargetAndDuration2(t.x,"x"),e.y=this.updateTargetAndDuration2(t.y,"y")},p.prototype.updateTargetAndDuration2=function(t,e){var i,r,n,o=this._velocity[e],a=0;return 0<t?t=0:t<-this._overlapSize[e]?t=-this._overlapSize[e]:(i=egret.Capabilities.isMobile,r=Math.abs(o)*this._velocityScale,i&&(r*=1136/Math.max(this._owner.displayObject.stage.stageWidth,this._owner.displayObject.stage.stageHeight)),n=0,this._pageMode||!i?500<r&&(n=Math.pow((r-500)/500,2)):1e3<r&&(n=Math.pow((r-1e3)/1e3,2)),0!=n&&(r*=n=1<n?1:n,this._velocity[e]=o*=n,a=Math.log(60/r)/Math.log(this._decelerationRate)/60,t+=Math.floor(o*a*.4))),this._tweenDuration[e]=a=a<s?s:a,t},p.prototype.fixDuration=function(t,e){0==this._tweenChange[t]||Math.abs(this._tweenChange[t])>=Math.abs(e)||(e=Math.abs(this._tweenChange[t]/e)*this._tweenDuration[t],this._tweenDuration[t]=e=e<s?s:e)},p.prototype.startTween=function(t){this._tweenTime.setTo(0,0),this._tweening=t,c.GTimers.inst.add(1,0,this.tweenUpdate,this),this.updateScrollBarVisible()},p.prototype.killTween=function(){1==this._tweening&&(this._container.x=this._tweenStart.x+this._tweenChange.x,this._container.y=this._tweenStart.y+this._tweenChange.y,this.dispatchEventWith(p.SCROLL)),this._tweening=0,c.GTimers.inst.remove(this.tweenUpdate,this),this.updateScrollBarVisible(),this.dispatchEventWith(p.SCROLL_END)},p.prototype.checkRefreshBar=function(){var t,e,i;null==this._header&&null==this._footer||(t=this._container[this._refreshBarAxis],this._header&&(0<t?(null==this._header.displayObject.parent&&this._maskContainer.addChildAt(this._header.displayObject,0),(e=_).setTo(this._header.width,this._header.height),e[this._refreshBarAxis]=t,this._header.setSize(e.x,e.y)):this._header.displayObject.parent&&this._maskContainer.removeChild(this._header.displayObject)),this._footer&&(t<-(i=this._overlapSize[this._refreshBarAxis])||0==i&&0<this._footerLockedSize?(null==this._footer.displayObject.parent&&this._maskContainer.addChildAt(this._footer.displayObject,0),(e=_).setTo(this._footer.x,this._footer.y),e[this._refreshBarAxis]=0<i?t+this._contentSize[this._refreshBarAxis]:Math.max(Math.min(t+this._viewSize[this._refreshBarAxis],this._viewSize[this._refreshBarAxis]-this._footerLockedSize),this._viewSize[this._refreshBarAxis]-this._contentSize[this._refreshBarAxis]),this._footer.setXY(e.x,e.y),e.setTo(this._footer.width,this._footer.height),e[this._refreshBarAxis]=0<i?-i-t:this._viewSize[this._refreshBarAxis]-this._footer[this._refreshBarAxis],this._footer.setSize(e.x,e.y)):this._footer.displayObject.parent&&this._maskContainer.removeChild(this._footer.displayObject)))},p.prototype.tweenUpdate=function(t){if(!this.owner||!this.owner.parent)return this._tweening=0,c.GTimers.inst.remove(this.tweenUpdate,this),void console.warn("\u7236\u8282\u70b9\u5df2\u4e0d\u5b58\u5728 \u4e0d\u89e6\u53d1tweenUpdate");var e=this.runTween("x"),i=this.runTween("y");return this._container.x=e,this._container.y=i,2==this._tweening&&(0<this._overlapSize.x&&(this._xPos=c.ToolSet.clamp(-e,0,this._overlapSize.x)),0<this._overlapSize.y&&(this._yPos=c.ToolSet.clamp(-i,0,this._overlapSize.y)),this._pageMode&&this.updatePageController()),0==this._tweenChange.x&&0==this._tweenChange.y?(this._tweening=0,c.GTimers.inst.remove(this.tweenUpdate,this),this.loopCheckingCurrent(),this.updateScrollBarPos(),this.updateScrollBarVisible(),this.dispatchEventWith(p.SCROLL),this.dispatchEventWith(p.SCROLL_END)):(this.updateScrollBarPos(),this.dispatchEventWith(p.SCROLL)),!0},p.prototype.runTween=function(t){var e,i,r,n;return 0!=this._tweenChange[t]?(this._tweenTime[t]+=c.GTimers.deltaTime/1e3,this._tweenTime[t]>=this._tweenDuration[t]?(e=this._tweenStart[t]+this._tweenChange[t],this._tweenChange[t]=0):(r=this._tweenTime[t],n=this._tweenDuration[t],i=(r=r/n-1)*r*r+1,e=this._tweenStart[t]+Math.floor(this._tweenChange[t]*i)),n=-this._overlapSize[t],(r=0)<this._headerLockedSize&&this._refreshBarAxis==t&&(r=this._headerLockedSize),0<this._footerLockedSize&&this._refreshBarAxis==t&&(0==(i=this._overlapSize[this._refreshBarAxis])?i=Math.max(this._contentSize[this._refreshBarAxis]+this._footerLockedSize-this._viewSize[this._refreshBarAxis],0):i+=this._footerLockedSize,n=-i),2==this._tweening&&this._bouncebackEffect?20+r<e&&0<this._tweenChange[t]||r<e&&0==this._tweenChange[t]?(this._tweenTime[t]=0,this._tweenDuration[t]=s,this._tweenChange[t]=-e+r,this._tweenStart[t]=e):(e<n-20&&this._tweenChange[t]<0||e<n&&0==this._tweenChange[t])&&(this._tweenTime[t]=0,this._tweenDuration[t]=s,this._tweenChange[t]=n-e,this._tweenStart[t]=e):r<e?(e=r,this._tweenChange[t]=0):e<n&&(e=n,this._tweenChange[t]=0)):e=this._container[t],e},p.SCROLL="__scroll",p.SCROLL_END="__scrollEnd",p.PULL_DOWN_RELEASE="pullDownRelease",p.PULL_UP_RELEASE="pullUpRelease",p);function p(t){var e=i.call(this)||this;return e._tweenTimeGo=0,e._owner=t,e._maskContainer=new egret.DisplayObjectContainer,e._owner._rootContainer.addChild(e._maskContainer),e._container=e._owner._container,e._container.x=0,e._container.y=0,e._maskContainer.addChild(e._container),e._scrollBarMargin=new c.Margin,e._xPos=0,e._yPos=0,e._aniFlag=0,e._tweening=0,e._footerLockedSize=0,e._headerLockedSize=0,e._viewSize=new egret.Point,e._contentSize=new egret.Point,e._pageSize=new egret.Point(1,1),e._overlapSize=new egret.Point,e._tweenTime=new egret.Point,e._tweenStart=new egret.Point,e._tweenDuration=new egret.Point,e._tweenChange=new egret.Point,e._velocity=new egret.Point,e._containerPos=new egret.Point,e._beginTouchPos=new egret.Point,e._lastTouchPos=new egret.Point,e._lastTouchGlobalPos=new egret.Point,e._scrollStep=c.UIConfig.defaultScrollStep,e._decelerationRate=c.UIConfig.defaultScrollDecelerationRate,e._owner.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.__touchBegin,e),e}c.ScrollPane=t;var d=0,r=.5,s=.3,f=.5,_=new egret.Point,o=new egret.Rectangle,n=new egret.Point,a=new egret.Point}(fgui=fgui||{}),function(f){var t=(e.prototype.play=function(t,e,i,r,n,o,a){this._play(t,e,i,r,n,o,a,!1)},e.prototype.playReverse=function(t,e,i,r,n){this._play(t,e,i,r,n,0,-1,!0)},e.prototype.changePlayTimes=function(t){this._totalTimes=t},e.prototype.setAutoPlay=function(t,e,i){null==e&&(e=-1),null==i&&(i=0),this._autoPlay!=t&&(this._autoPlay=t,this._autoPlayTimes=e,this._autoPlayDelay=i,this._autoPlay?this._owner.onStage&&this.play(null,null,this._autoPlayTimes,this._autoPlayDelay):this._owner.onStage||this.stop(!1,!0))},e.prototype._play=function(t,e,i,r,n,o,a,s){null==r&&(r=1),null==n&&(n=0),null==o&&(o=0),null==a&&(a=-1),this.stop(!0,!0),this._totalTimes=r,this._reversed=s,this._startTime=o,this._endTime=a,this._playing=!0,this._paused=!1,this._onComplete=t,this._onCompleteParam=i,this._onCompleteCaller=e;for(var h=this._items.length,l=0;l<h;l++){var u=this._items[l];if(u.target?u.target!=this._owner&&u.target.parent!=this._owner&&(u.target=null):u.targetId?u.target=this._owner.getChildById(u.targetId):u.target=this._owner,u.target&&u.type==_.Transition){var c=u.target.getTransition(u.value.transName);if(c=c==this?null:c)if(0==u.value.playTimes){for(var p=l-1;0<=p;p--){var d=this._items[p];if(d.type==_.Transition&&d.value.trans==c){d.value.stopTime=u.time-d.time;break}}p<0?u.value.stopTime=0:c=null}else u.value.stopTime=-1;u.value.trans=c}}0==n?this.onDelayedPlay():f.GTween.delayedCall(n).setTarget(this).onComplete(this.onDelayedPlay,this)},e.prototype.stop=function(t,e){if(null==t&&(t=!0),this._playing){this._playing=!1,this._totalTasks=0,this._totalTimes=0;var i=this._onComplete,r=this._onCompleteParam,n=this._onCompleteCaller;this._onComplete=null,this._onCompleteParam=null,this._onCompleteCaller=null,f.GTween.kill(this);var o=this._items.length;if(this._reversed)for(var a=o-1;0<=a;a--){var s=this._items[a];s.target&&this.stopItem(s,t)}else for(a=0;a<o;a++)(s=this._items[a]).target&&this.stopItem(s,t);e&&null!=i&&i.call(n,r)}},e.prototype.stopItem=function(t,e){0!=t.displayLockToken&&(t.target.releaseDisplayLock(t.displayLockToken),t.displayLockToken=0),t.tweener&&(t.tweener.kill(e),t.tweener=null,t.type!=_.Shake||e||(t.target._gearLocked=!0,t.target.setXY(t.target.x-t.value.lastOffsetX,t.target.y-t.value.lastOffsetY),t.target._gearLocked=!1)),t.type!=_.Transition||(t=t.value.trans)&&t.stop(e,!1)},e.prototype.setPaused=function(t){if(this._playing&&this._paused!=t){this._paused=t;var e=f.GTween.getTween(this);e&&e.setPaused(t);for(var i=this._items.length,r=0;r<i;r++){var n=this._items[r];n.target&&(n.type==_.Transition?n.value.trans&&n.value.trans.setPaused(t):n.type==_.Animation&&(t?(n.value.flag=n.target.getProp(f.ObjectPropID.Playing),n.target.setProp(f.ObjectPropID.Playing,!1)):n.target.setProp(f.ObjectPropID.Playing,n.value.flag)),n.tweener&&n.tweener.setPaused(t))}}},e.prototype.dispose=function(){this._playing&&f.GTween.kill(this);for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.tweener&&(i.tweener.kill(),i.tweener=null),i.target=null,i.hook=null,i.tweenConfig&&(i.tweenConfig.endHook=null)}this._items.length=0,this._playing=!1,this._onComplete=null,this._onCompleteCaller=null,this._onCompleteParam=null},Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var r,n=this._items.length,o=0;o<n;o++){var a=this._items[o];if(a.label==t)r=a.tweenConfig?a.tweenConfig.startValue:a.value;else{if(!a.tweenConfig||a.tweenConfig.endLabel!=t)continue;r=a.tweenConfig.endValue}switch(a.type){case _.XY:case _.Size:case _.Pivot:case _.Scale:case _.Skew:r.b1=!0,r.b2=!0,r.f1=parseFloat(e[0]),r.f2=parseFloat(e[1]);break;case _.Alpha:case _.Rotation:case _.Color:r.f1=parseFloat(e[0]);break;case _.Animation:r.frame=parseInt(e[0]),1<e.length&&(r.playing=e[1]);break;case _.Visible:r.visible=e[0];break;case _.Sound:r.sound=e[0],1<e.length&&(r.volume=parseFloat(e[1]));break;case _.Transition:r.transName=e[0],1<e.length&&(r.playTimes=parseInt(e[1]));break;case _.Shake:r.amplitude=parseFloat(e[0]),1<e.length&&(r.duration=parseFloat(e[1]));break;case _.ColorFilter:r.f1=parseFloat(e[0]),r.f2=parseFloat(e[1]),r.f3=parseFloat(e[2]),r.f4=parseFloat(e[3]);break;case _.Text:case _.Icon:r.text=e[0]}}},e.prototype.setHook=function(t,e,i){for(var r=this._items.length,n=0;n<r;n++){var o=this._items[n];if(o.label==t){o.hook=e,o.hookCaller=i;break}if(o.tweenConfig&&o.tweenConfig.endLabel==t){o.tweenConfig.endHook=e,o.tweenConfig.endHookCaller=i;break}}},e.prototype.clearHooks=function(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.hook=null,i.hookCaller=null,i.tweenConfig&&(i.tweenConfig.endHook=null,i.tweenConfig.endHookCaller=null)}},e.prototype.setTarget=function(t,e){for(var i=this._items.length,r=0;r<i;r++){var n=this._items[r];n.label==t&&(n.targetId=e!=this._owner&&e?e.id:"",this._playing?0<n.targetId.length?n.target=this._owner.getChildById(n.targetId):n.target=this._owner:n.target=null)}},e.prototype.setDuration=function(t,e){for(var i=this._items.length,r=0;r<i;r++){var n=this._items[r];n.tweenConfig&&n.label==t&&(n.tweenConfig.duration=e)}},e.prototype.getLabelTime=function(t){for(var e=this._items.length,i=0;i<e;i++){var r=this._items[i];if(r.label==t)return r.time;if(r.tweenConfig&&r.tweenConfig.endLabel==t)return r.time+r.tweenConfig.duration}return Number.NaN},Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(t){if(this._timeScale!=t&&(this._timeScale=t,this._playing))for(var e=this._items.length,i=0;i<e;i++){var r=this._items[i];r.tweener?r.tweener.setTimeScale(t):r.type==_.Transition?r.value.trans&&(r.value.trans.timeScale=t):r.type==_.Animation&&r.target&&r.target.setProp(f.ObjectPropID.TimeScale,t)}},enumerable:!0,configurable:!0}),e.prototype.updateFromRelations=function(t,e,i){var r=this._items.length;if(0!=r)for(var n=0;n<r;n++){var o=this._items[n];o.type==_.XY&&o.targetId==t&&(o.tweenConfig?(o.tweenConfig.startValue.f1+=e,o.tweenConfig.startValue.f2+=i,o.tweenConfig.endValue.f1+=e,o.tweenConfig.endValue.f2+=i):(o.value.f1+=e,o.value.f2+=i))}},e.prototype.onOwnerAddedToStage=function(){this._autoPlay&&!this._playing&&this.play(null,null,null,this._autoPlayTimes,this._autoPlayDelay)},e.prototype.onOwnerRemovedFromStage=function(){0==(this._options&i)&&this.stop(0!=(this._options&r),!1)},e.prototype.onDelayedPlay=function(){var t,e,i;if(this.internalPlay(),this._playing=0<this._totalTasks,this._playing){if(0!=(this._options&a))for(var r=this._items.length,n=0;n<r;n++){var o=this._items[n];o.target&&o.target!=this._owner&&(o.displayLockToken=o.target.addDisplayLock())}}else null!=this._onComplete&&(t=this._onComplete,e=this._onCompleteParam,i=this._onCompleteCaller,this._onComplete=null,this._onCompleteParam=null,this._onCompleteCaller=null,t.call(i,e))},e.prototype.internalPlay=function(){this._ownerBaseX=this._owner.x,this._ownerBaseY=this._owner.y,this._totalTasks=1;var t,e,i=this._items.length,r=!1;if(this._reversed)for(e=i-1;0<=e;e--)(t=this._items[e]).target&&this.playItem(t);else for(e=0;e<i;e++)(t=this._items[e]).target&&(t.type==_.Animation&&0!=this._startTime&&t.time<=this._startTime?t.value.flag=!(r=!0):this.playItem(t));r&&this.skipAnimations(),this._totalTasks--},e.prototype.playItem=function(t){var e;if(t.tweenConfig){if(e=this._reversed?this._totalDuration-t.time-t.tweenConfig.duration:t.time,-1==this._endTime||e<=this._endTime){var i,r=this._reversed?(i=t.tweenConfig.endValue,t.tweenConfig.startValue):(i=t.tweenConfig.startValue,t.tweenConfig.endValue);switch(t.value.b1=i.b1||r.b1,t.value.b2=i.b2||r.b2,t.type){case _.XY:case _.Size:case _.Scale:case _.Skew:t.tweener=f.GTween.to2(i.f1,i.f2,r.f1,r.f2,t.tweenConfig.duration);break;case _.Alpha:case _.Rotation:t.tweener=f.GTween.to(i.f1,r.f1,t.tweenConfig.duration);break;case _.Color:t.tweener=f.GTween.toColor(i.f1,r.f1,t.tweenConfig.duration);break;case _.ColorFilter:t.tweener=f.GTween.to4(i.f1,i.f2,i.f3,i.f4,r.f1,r.f2,r.f3,r.f4,t.tweenConfig.duration)}t.tweener.setDelay(e).setEase(t.tweenConfig.easeType).setRepeat(t.tweenConfig.repeat,t.tweenConfig.yoyo).setTimeScale(this._timeScale).setTarget(t).onStart(this.onTweenStart,this).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),0<=this._endTime&&t.tweener.setBreakpoint(this._endTime-e),this._totalTasks++}}else t.type==_.Shake?(e=this._reversed?this._totalDuration-t.time-t.value.duration:t.time,t.value.offsetX=t.value.offsetY=0,t.value.lastOffsetX=t.value.lastOffsetY=0,t.tweener=f.GTween.shake(0,0,t.value.amplitude,t.value.duration).setDelay(e).setTimeScale(this._timeScale).setTarget(t).onUpdate(this.onTweenUpdate,this).onComplete(this.onTweenComplete,this),0<=this._endTime&&t.tweener.setBreakpoint(this._endTime-t.time),this._totalTasks++):(e=this._reversed?this._totalDuration-t.time:t.time)<=this._startTime?(this.applyValue(t),this.callHook(t,!1)):(-1==this._endTime||e<=this._endTime)&&(this._totalTasks++,t.tweener=f.GTween.delayedCall(e).setTimeScale(this._timeScale).setTarget(t).onComplete(this.onDelayedPlayItem,this));null!=t.tweener&&t.tweener.seek(this._startTime)},e.prototype.skipAnimations=function(){for(var t,e,i=this._items.length,r=0;r<i;r++)if(!((e=this._items[r]).type!=_.Animation||e.time>this._startTime||(t=e.value).flag)){for(var n,o=(n=e.target).getProp(f.ObjectPropID.Frame),a=n.getProp(f.ObjectPropID.Playing)?0:-1,s=0,h=r;h<i;h++)(e=this._items[h]).type!=_.Animation||e.target!=n||e.time>this._startTime||((t=e.value).flag=!0,-1!=t.frame?(o=t.frame,a=t.playing?e.time:-1,s=0):t.playing?a<0&&(a=e.time):(0<=a&&(s+=e.time-a),a=-1),this.callHook(e,!1));0<=a&&(s+=this._startTime-a),n.setProp(f.ObjectPropID.Playing,0<=a),n.setProp(f.ObjectPropID.Frame,o),0<s&&n.setProp(f.ObjectPropID.DeltaTime,1e3*s)}},e.prototype.onDelayedPlayItem=function(t){t=t.target;t.tweener=null,this._totalTasks--,this.applyValue(t),this.callHook(t,!1),this.checkAllComplete()},e.prototype.onTweenStart=function(t){var e,i,r=t.target;r.type!=_.XY&&r.type!=_.Size||(i=this._reversed?(e=r.tweenConfig.endValue,r.tweenConfig.startValue):(e=r.tweenConfig.startValue,r.tweenConfig.endValue),r.type==_.XY?r.target!=this._owner?(e.b1?e.b3&&(t.startValue.x=e.f1*this._owner.width):t.startValue.x=r.target.x,e.b2?e.b3&&(t.startValue.y=e.f2*this._owner.height):t.startValue.y=r.target.y,i.b1?i.b3&&(t.endValue.x=i.f1*this._owner.width):t.endValue.x=t.startValue.x,i.b2?i.b3&&(t.endValue.y=i.f2*this._owner.height):t.endValue.y=t.startValue.y):(e.b1||(t.startValue.x=r.target.x-this._ownerBaseX),e.b2||(t.startValue.y=r.target.y-this._ownerBaseY),i.b1||(t.endValue.x=t.startValue.x),i.b2||(t.endValue.y=t.startValue.y)):(e.b1||(t.startValue.x=r.target.width),e.b2||(t.startValue.y=r.target.height),i.b1||(t.endValue.x=t.startValue.x),i.b2||(t.endValue.y=t.startValue.y)),r.tweenConfig.path&&(r.value.b1=r.value.b2=!0,t.setPath(r.tweenConfig.path))),this.callHook(r,!1)},e.prototype.onTweenUpdate=function(t){var e=t.target;switch(e.type){case _.XY:case _.Size:case _.Scale:case _.Skew:e.value.f1=t.value.x,e.value.f2=t.value.y,e.tweenConfig.path&&(e.value.f1+=t.startValue.x,e.value.f2+=t.startValue.y);break;case _.Alpha:case _.Rotation:e.value.f1=t.value.x;break;case _.Color:e.value.f1=t.value.color;break;case _.ColorFilter:e.value.f1=t.value.x,e.value.f2=t.value.y,e.value.f3=t.value.z,e.value.f4=t.value.w;break;case _.Shake:e.value.offsetX=t.deltaValue.x,e.value.offsetY=t.deltaValue.y}this.applyValue(e)},e.prototype.onTweenComplete=function(t){var e=t.target;e.tweener=null,this._totalTasks--,t.allCompleted&&this.callHook(e,!0),this.checkAllComplete()},e.prototype.onPlayTransCompleted=function(t){this._totalTasks--,this.checkAllComplete()},e.prototype.callHook=function(t,e){e?t.tweenConfig&&t.tweenConfig.endHook&&t.tweenConfig.endHook.call(t.tweenConfig.endHookCaller):t.time>=this._startTime&&null!=t.hook&&t.hook.call(t.hookCaller)},e.prototype.checkAllComplete=function(){if(this._playing&&0==this._totalTasks)if(this._totalTimes<0)this.internalPlay(),0==this._totalTasks&&f.GTween.delayedCall(0).setTarget(this).onComplete(this.checkAllComplete,this);else if(this._totalTimes--,0<this._totalTimes)this.internalPlay(),0==this._totalTasks&&f.GTween.delayedCall(0).setTarget(this).onComplete(this.checkAllComplete,this);else{this._playing=!1;for(var t,e,i,r=this._items.length,n=0;n<r;n++){var o=this._items[n];o.target&&0!=o.displayLockToken&&(o.target.releaseDisplayLock(o.displayLockToken),o.displayLockToken=0)}null!=this._onComplete&&(t=this._onComplete,e=this._onCompleteParam,i=this._onCompleteCaller,this._onComplete=null,this._onCompleteParam=null,this._onCompleteCaller=null,t.call(i,e))}},e.prototype.applyValue=function(t){if(t.target){t.target._gearLocked=!0;var e,i,r,n=t.value;switch(t.type){case _.XY:t.target==this._owner?n.b1&&n.b2?t.target.setXY(n.f1+this._ownerBaseX,n.f2+this._ownerBaseY):n.b1?t.target.x=n.f1+this._ownerBaseX:t.target.y=n.f2+this._ownerBaseY:n.b3?n.b1&&n.b2?t.target.setXY(n.f1*this._owner.width,n.f2*this._owner.height):n.b1?t.target.x=n.f1*this._owner.width:n.b2&&(t.target.y=n.f2*this._owner.height):n.b1&&n.b2?t.target.setXY(n.f1,n.f2):n.b1?t.target.x=n.f1:n.b2&&(t.target.y=n.f2);break;case _.Size:n.b1||(n.f1=t.target.width),n.b2||(n.f2=t.target.height),t.target.setSize(n.f1,n.f2);break;case _.Pivot:t.target.setPivot(n.f1,n.f2,t.target.pivotAsAnchor);break;case _.Alpha:t.target.alpha=n.f1;break;case _.Rotation:t.target.rotation=n.f1;break;case _.Scale:t.target.setScale(n.f1,n.f2);break;case _.Skew:t.target.setSkew(n.f1,n.f2);break;case _.Color:t.target.setProp(f.ObjectPropID.Color,n.f1);break;case _.Animation:0<=n.frame&&t.target.setProp(f.ObjectPropID.Frame,n.frame),t.target.setProp(f.ObjectPropID.Playing,n.playing),t.target.setProp(f.ObjectPropID.TimeScale,this._timeScale);break;case _.Visible:t.target.visible=n.visible;break;case _.Transition:!this._playing||(e=n.trans)&&(this._totalTasks++,i=this._startTime>t.time?this._startTime-t.time:0,r=0<=this._endTime?this._endTime-t.time:-1,0<=n.stopTime&&(r<0||r>n.stopTime)&&(r=n.stopTime),e.timeScale=this._timeScale,e._play(this.onPlayTransCompleted,this,t,n.playTimes,0,i,r,this._reversed));break;case _.Sound:this._playing&&t.time>=this._startTime&&(n.audioClip||(r=f.UIPackage.getItemByURL(n.sound))&&(n.audioClip=r.owner.getItemAsset(r)),n.audioClip&&f.GRoot.inst.playOneShotSound(n.audioClip,n.volume));break;case _.Shake:t.target.setXY(t.target.x-n.lastOffsetX+n.offsetX,t.target.y-n.lastOffsetY+n.offsetY),n.lastOffsetX=n.offsetX,n.lastOffsetY=n.offsetY;break;case _.ColorFilter:f.ToolSet.setColorFilter(t.target.displayObject,[n.f1,n.f2,n.f3,n.f4]);break;case _.Text:t.target.text=n.text;break;case _.Icon:t.target.icon=n.text}t.target._gearLocked=!1}},e.prototype.setup=function(t){this.name=t.readS(),this._options=t.readInt(),this._autoPlay=t.readBool(),this._autoPlayTimes=t.readInt(),this._autoPlayDelay=t.readFloat();for(var e=t.readShort(),i=0;i<e;i++){var r=t.readShort(),n=t.position;t.seek(n,0);var o=new c(t.readByte());(this._items[i]=o).time=t.readFloat();var a=t.readShort();if(o.targetId=a<0?"":this._owner.getChildAt(a).id,o.label=t.readS(),t.readBool()){if(t.seek(n,1),o.tweenConfig=new p,o.tweenConfig.duration=t.readFloat(),o.time+o.tweenConfig.duration>this._totalDuration&&(this._totalDuration=o.time+o.tweenConfig.duration),o.tweenConfig.easeType=t.readByte(),o.tweenConfig.repeat=t.readInt(),o.tweenConfig.yoyo=t.readBool(),o.tweenConfig.endLabel=t.readS(),t.seek(n,2),this.decodeValue(o,t,o.tweenConfig.startValue),t.seek(n,3),this.decodeValue(o,t,o.tweenConfig.endValue),2<=t.version){var s=t.readInt();if(0<s){o.tweenConfig.path=new f.GPath;for(var h=new Array,l=0;l<s;l++){var u=t.readByte();switch(u){case f.CurveType.Bezier:h.push(f.GPathPoint.newBezierPoint(t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()));break;case f.CurveType.CubicBezier:h.push(f.GPathPoint.newCubicBezierPoint(t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat()));break;default:h.push(f.GPathPoint.newPoint(t.readFloat(),t.readFloat(),u))}}o.tweenConfig.path.create(h)}}}else o.time>this._totalDuration&&(this._totalDuration=o.time),t.seek(n,2),this.decodeValue(o,t,o.value);t.position=n+r}},e.prototype.decodeValue=function(t,e,i){switch(t.type){case _.XY:case _.Size:case _.Pivot:case _.Skew:i.b1=e.readBool(),i.b2=e.readBool(),i.f1=e.readFloat(),i.f2=e.readFloat(),2<=e.version&&t.type==_.XY&&(i.b3=e.readBool());break;case _.Alpha:case _.Rotation:i.f1=e.readFloat();break;case _.Scale:i.f1=e.readFloat(),i.f2=e.readFloat();break;case _.Color:i.f1=e.readColor();break;case _.Animation:i.playing=e.readBool(),i.frame=e.readInt();break;case _.Visible:i.visible=e.readBool();break;case _.Sound:i.sound=e.readS(),i.volume=e.readFloat();break;case _.Transition:i.transName=e.readS(),i.playTimes=e.readInt();break;case _.Shake:i.amplitude=e.readFloat(),i.duration=e.readFloat();break;case _.ColorFilter:i.f1=e.readFloat(),i.f2=e.readFloat(),i.f3=e.readFloat(),i.f4=e.readFloat();break;case _.Text:case _.Icon:i.text=e.readS()}},e);function e(t){this._ownerBaseX=0,this._ownerBaseY=0,this._totalTimes=0,this._totalTasks=0,this._options=0,this._totalDuration=0,this._autoPlayTimes=1,this._autoPlayDelay=0,this._timeScale=1,this._startTime=0,this._endTime=0,this._owner=t,this._items=new Array}f.Transition=t;var a=1,i=2,r=4,_=(n.XY=0,n.Size=1,n.Scale=2,n.Pivot=3,n.Alpha=4,n.Rotation=5,n.Color=6,n.Animation=7,n.Visible=8,n.Sound=9,n.Transition=10,n.Shake=11,n.ColorFilter=12,n.Skew=13,n.Text=14,n.Icon=15,n.Unknown=16,n);function n(){}var c=function(t){this.type=t,this.value={},this.displayLockToken=0},p=function(){this.duration=0,this.repeat=0,this.easeType=f.EaseType.QuadOut,this.startValue={b1:!0,b2:!0},this.endValue={b1:!0,b2:!0}}}(fgui=fgui||{}),function(v){var t=(b.loadFromXML=function(t){var e={};b.strings=e;for(var i=egret.XML.parse(t).children,r=i.length,n=0;n<r;n++){var o,a,s,h=i[n];"string"==h.name&&(a=h.attributes.name,o=0<h.children.length?h.children[0].text:"",-1!=(s=a.indexOf("-"))&&(h=a.substr(0,s),a=a.substr(s+1),(s=e[h])||(e[h]=s={}),s[a]=o))}},b.translateComponent=function(t){if(null!=b.strings){var e=b.strings[t.owner.id+t.id];if(null!=e){var i,r,n,o,a,s,h,l=t.rawData;l.seek(0,2);for(var u=l.readShort(),c=0;c<u;c++){a=l.readShort(),s=l.position,l.seek(s,0);var p=l.readByte(),d=p;l.skip(4),i=l.readS(),d==v.ObjectType.Component&&l.seek(s,6)&&(d=l.readByte()),l.seek(s,1),null!=(r=e[i+"-tips"])&&l.writeS(r),l.seek(s,2);for(var f=l.readShort(),_=0;_<f;_++){if(n=l.readShort(),n+=l.position,6==l.readByte()){for(l.skip(2),h=l.readShort(),y=0;y<h;y++)null!=l.readS()&&(null!=(r=e[i+"-texts_"+y])?l.writeS(r):l.skip(2));l.readBool()&&null!=(r=e[i+"-texts_def"])&&l.writeS(r)}if(p==v.ObjectType.Component&&2<=l.version){l.seek(s,4),l.skip(2),l.skip(4*l.readShort());for(var g=l.readShort(),y=0;y<g;y++){var m=l.readS();0==l.readShort()&&null!=(r=e[i+"-cp-"+m])?l.writeS(r):l.skip(2)}}l.position=n}switch(d){case v.ObjectType.Text:case v.ObjectType.RichText:case v.ObjectType.InputText:null!=(r=e[i])&&(l.seek(s,6),l.writeS(r)),null!=(r=e[i+"-prompt"])&&(l.seek(s,4),l.writeS(r));break;case v.ObjectType.List:case v.ObjectType.Tree:for(l.seek(s,8),l.skip(2),o=l.readShort(),_=0;_<o;_++){if(n=l.readShort(),n+=l.position,l.skip(2),d==v.ObjectType.Tree&&l.skip(2),null!=(r=e[i+"-"+_])?l.writeS(r):l.skip(2),null!=(r=e[i+"-"+_+"-0"])?l.writeS(r):l.skip(2),2<=l.version){l.skip(6),l.skip(4*l.readUnsignedShort());for(g=l.readUnsignedShort(),y=0;y<g;y++){m=l.readS();0==l.readUnsignedShort()&&null!=(r=e[i+"-"+_+"-"+m])?l.writeS(r):l.skip(2)}}l.position=n}break;case v.ObjectType.Label:l.seek(s,6)&&l.readByte()==d&&(null!=(r=e[i])?l.writeS(r):l.skip(2),l.skip(2),l.readBool()&&l.skip(4),l.skip(4),l.readBool()&&null!=(r=e[i+"-prompt"])&&l.writeS(r));break;case v.ObjectType.Button:l.seek(s,6)&&l.readByte()==d&&(null!=(r=e[i])?l.writeS(r):l.skip(2),null!=(r=e[i+"-0"])&&l.writeS(r));break;case v.ObjectType.ComboBox:if(l.seek(s,6)&&l.readByte()==d){for(o=l.readShort(),_=0;_<o;_++)n=l.readShort(),n+=l.position,null!=(r=e[i+"-"+_])&&l.writeS(r),l.position=n;null!=(r=e[i])&&l.writeS(r)}}l.position=s+a}}}},b);function b(){}v.TranslationHelper=t}(fgui=fgui||{}),function(t){var e=(i.defaultFont="SimSun",i.modalLayerColor=3355443,i.modalLayerAlpha=.2,i.buttonSoundVolumeScale=1,i.defaultScrollStep=25,i.defaultScrollDecelerationRate=.967,i.defaultScrollBarDisplay=t.ScrollBarDisplayType.Visible,i.defaultScrollTouchEffect=!0,i.defaultScrollBounceEffect=!0,i.defaultComboBoxVisibleItemCount=10,i.touchScrollSensitivity=20,i.touchDragSensitivity=10,i.clickDragSensitivity=2,i.bringWindowToFrontOnClick=!0,i.frameTimeForAsyncUIConstruction=2,i);function i(){}t.UIConfig=e}(fgui=fgui||{}),function(r){var t=(n.setExtension=function(t,e){if(null==t)throw"Invaild url: "+t;var i=r.UIPackage.getItemByURL(t);i&&(i.extensionType=e),n.extensions[t]=e},n.setPackageItemExtension=function(t,e){n.setExtension(t,e)},n.setLoaderExtension=function(t){n.loaderType=t},n.setLoader3DExtension=function(t){n.loader3DType=t},n.resolvePackageItemExtension=function(t){var e=n.extensions["ui://"+t.owner.id+t.id];(e=e||n.extensions["ui://"+t.owner.name+"/"+t.name])&&(t.extensionType=e)},n.newObject=function(t,e){var i;if("number"==typeof t)switch(t){case r.ObjectType.Image:return new r.GImage;case r.ObjectType.MovieClip:return new r.GMovieClip;case r.ObjectType.Component:return new r.GComponent;case r.ObjectType.Text:return new r.GTextField;case r.ObjectType.RichText:return new r.GRichTextField;case r.ObjectType.InputText:return new r.GTextInput;case r.ObjectType.Group:return new r.GGroup;case r.ObjectType.List:return new r.GList;case r.ObjectType.Graph:return new r.GGraph;case r.ObjectType.Loader:return new(n.loaderType||r.GLoader);case r.ObjectType.Button:return new r.GButton;case r.ObjectType.Label:return new r.GLabel;case r.ObjectType.ProgressBar:return new r.GProgressBar;case r.ObjectType.Slider:return new r.GSlider;case r.ObjectType.ScrollBar:return new r.GScrollBar;case r.ObjectType.ComboBox:return new r.GComboBox;case r.ObjectType.Tree:return new r.GTree;case r.ObjectType.Loader3D:return new(n.loader3DType||r.GLoader3D);default:return null}else(i=t.type==r.PackageItemType.Component?e?new e:t.extensionType?new t.extensionType:n.newObject(t.objectType):n.newObject(t.objectType))&&(i.packageItem=t);return i},n.extensions={},n);function n(){}r.UIObjectFactory=t}(fgui=fgui||{}),function(m){var t=(Object.defineProperty(v,"branch",{get:function(){return v._branch},set:function(t){for(var e in v._branch=t,v._instById){e=v._instById[e];e._branches&&(e._branchIndex=e._branches.indexOf(t))}},enumerable:!0,configurable:!0}),v.getVar=function(t){return v._vars[t]},v.setVar=function(t,e){v._vars[t]=e},v.getById=function(t){return v._instById[t]},v.getByName=function(t){return v._instByName[t]},v.loadPackage=function(h){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){return[2,new Promise(function(s){return __awaiter(e,void 0,void 0,function(){var e,i,r,n,o,a;return __generator(this,function(t){switch(t.label){case 0:return(e=v._instById[h])?(s(e),[2]):[4,RES.getResAsync(b(h,"fui"))];case 1:for(i=t.sent(),(e=new v)._resKey=h,e.loadPackage(new m.ByteBuffer(i)),r=e._items.length,n=[],o=0;o<r;o++)(a=e._items[o]).type!=m.PackageItemType.Atlas&&a.type!=m.PackageItemType.Sound||n.push(RES.getResAsync(a.file));return 0<n.length?[4,Promise.all(n)]:[3,3];case 2:t.sent(),t.label=3;case 3:return v._instById[e.id]=e,v._instByName[e.name]=e,v._instById[e._resKey]=e,s(e),[2]}})})})]})})},v.addPackage=function(t,e){if(!e&&!(e=RES.getRes(t)))throw"Resource '"+t+"' not found, please check default.res.json!";var i=new v;return i._resKey=t,i.loadPackage(new m.ByteBuffer(e)),v._instById[i.id]=i,v._instByName[i.name]=i,v._instById[t]=i},v.removePackage=function(t){var e=v._instById[t];if(!(e=e||v._instByName[t]))throw new Error("unknown package: "+t);e.dispose(),delete v._instById[e.id],delete v._instByName[e.name],delete v._instById[e._resKey],null!=e._customId&&delete v._instById[e._customId]},v.createObject=function(t,e,i){t=v.getByName(t);return t?t.createObject(e,i):null},v.createObjectFromURL=function(t,e){t=v.getItemByURL(t);return t?t.owner.internalCreateObject(t,e):null},v.getItemURL=function(t,e){t=v.getByName(t);if(!t)return null;e=t._itemsByName[e];return e?"ui://"+t.id+e.id:null},v.getItemByURL=function(t){var e=t.indexOf("//");if(-1==e)return null;var i=t.indexOf("/",e+2);if(-1==i){if(13<t.length){var r=t.substr(5,8),n=v.getById(r);if(null!=n){r=t.substr(13);return n.getItemById(r)}}}else{e=t.substr(e+2,i-e-2);if(null!=(n=v.getByName(e))){i=t.substr(i+1);return n.getItemByName(i)}}return null},v.normalizeURL=function(t){if(null==t)return null;var e=t.indexOf("//");if(-1==e)return null;var i=t.indexOf("/",e+2);if(-1==i)return t;e=t.substr(e+2,i-e-2),i=t.substr(i+1);return v.getItemURL(e,i)},v.setStringsSource=function(t){m.TranslationHelper.loadFromXML(t)},v.prototype.loadPackage=function(t){if(1179080009!=t.readUnsignedInt())throw"FairyGUI: old package format found in '"+this._resKey+"'";t.version=t.readInt();var e=t.readBool();this._id=t.readUTF(),this._name=t.readUTF(),t.skip(20),e&&(c=new Uint8Array(t.buffer,t.position,t.length-t.position),a=new Zlib.RawInflate(c),(c=new m.ByteBuffer(a.decompress())).version=t.version,t=c);var i,r,n,o=2<=t.version,a=t.position;t.seek(a,4);var s=t.readInt(),h=new Array(s);for(h.reduceRight,i=0;i<s;i++)h[i]=t.readUTF();for(t.stringTable=h,t.seek(a,0),s=t.readShort(),i=0;i<s;i++)this._dependencies.push({id:t.readS(),name:t.readS()});o&&(0<(s=t.readShort())&&(this._branches=t.readSArray(s),v._branch&&(this._branchIndex=this._branches.indexOf(v._branch))),n=0<s),t.seek(a,1);var l,u=this._resKey,c=u.lastIndexOf("/"),p=-1==c?"":u.substr(0,c+1);for(u+="_",s=t.readShort(),i=0;i<s;i++){switch(r=t.readInt(),r+=t.position,(_=new m.PackageItem).owner=this,_.type=t.readByte(),_.id=t.readS(),_.name=t.readS(),t.readS(),_.file=t.readS(),t.readBool(),_.width=t.readInt(),_.height=t.readInt(),_.type){case m.PackageItemType.Image:_.objectType=m.ObjectType.Image;var d=t.readByte();1==d?(_.scale9Grid=new egret.Rectangle,_.scale9Grid.x=t.readInt(),_.scale9Grid.y=t.readInt(),_.scale9Grid.width=t.readInt(),_.scale9Grid.height=t.readInt(),_.tileGridIndice=t.readInt()):2==d&&(_.scaleByTile=!0),_.smoothing=t.readBool();break;case m.PackageItemType.MovieClip:_.smoothing=t.readBool(),_.objectType=m.ObjectType.MovieClip,_.rawData=t.readBuffer();break;case m.PackageItemType.Font:_.rawData=t.readBuffer();break;case m.PackageItemType.Component:d=t.readByte();_.objectType=0<d?d:m.ObjectType.Component,_.rawData=t.readBuffer(),m.UIObjectFactory.resolvePackageItemExtension(_);break;case m.PackageItemType.Atlas:case m.PackageItemType.Sound:case m.PackageItemType.Misc:var f=_.file.lastIndexOf(".");_.file=u+(-1==f?_.file:b(_.file.substring(0,f),_.file.substring(f+1)));break;case m.PackageItemType.Spine:case m.PackageItemType.DragonBones:f=_.file.lastIndexOf(".");_.file=p+(-1==f?_.file:_.file.substring(0,f)),_.skeletonAnchor=new egret.Point,_.skeletonAnchor.x=t.readFloat(),_.skeletonAnchor.y=t.readFloat()}o&&((l=t.readS())&&(_.name=l+"/"+_.name),0<(l=t.readUnsignedByte())&&(n?_.branches=t.readSArray(l):this._itemsById[t.readS()]=_),0<(l=t.readUnsignedByte())&&(_.highResolution=t.readSArray(l))),this._items.push(_),null!=(this._itemsById[_.id]=_).name&&(this._itemsByName[_.name]=_),t.position=r}for(t.seek(a,2),s=t.readShort(),i=0;i<s;i++){r=t.readShort(),r+=t.position;var _,g=t.readS(),y={atlas:_=this._itemsById[t.readS()],rect:new egret.Rectangle,offset:new egret.Point,originalSize:new egret.Point};y.rect.x=t.readInt(),y.rect.y=t.readInt(),y.rect.width=t.readInt(),y.rect.height=t.readInt(),y.rotated=t.readBool(),o&&t.readBool()?(y.offset.x=t.readInt(),y.offset.y=t.readInt(),y.originalSize.x=t.readInt(),y.originalSize.y=t.readInt()):(y.originalSize.x=y.rect.width,y.originalSize.y=y.rect.height),this._sprites[g]=y,t.position=r}if(t.seek(a,3))for(s=t.readShort(),i=0;i<s;i++)r=t.readInt(),r+=t.position,(_=this._itemsById[t.readS()])&&_.type==m.PackageItemType.Image&&(_.pixelHitTestData=new m.PixelHitTestData,_.pixelHitTestData.load(t)),t.position=r},v.prototype.dispose=function(){for(var t=this._items.length,e=0;e<t;e++){var i=this._items[e];i.type==m.PackageItemType.Atlas?RES.destroyRes(i.file,!1):(i.type,m.PackageItemType.Sound)}},Object.defineProperty(v.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"customId",{get:function(){return this._customId},set:function(t){null!=this._customId&&delete v._instById[this._customId],this._customId=t,null!=this._customId&&(v._instById[this._customId]=this)},enumerable:!0,configurable:!0}),v.prototype.createObject=function(t,e){t=this._itemsByName[t];return t?this.internalCreateObject(t,e):null},v.prototype.internalCreateObject=function(t,e){e=m.UIObjectFactory.newObject(t,e);return null==e?null:(v._constructing++,e.constructFromResource(),v._constructing--,e)},v.prototype.getItemById=function(t){return this._itemsById[t]},v.prototype.getItemByName=function(t){return this._itemsByName[t]},v.prototype.getItemAssetByName=function(t){var e=this._itemsByName[t];if(null==e)throw"Resource not found -"+t;return this.getItemAsset(e)},v.prototype.getItemAsset=function(t){switch(t.type){case m.PackageItemType.Image:var e,i;return t.decoded||(t.decoded=!0,(e=this._sprites[t.id])&&(i=this.getItemAsset(e.atlas),i=this.getItemAsset(e.atlas),t.asset=new egret.Texture,t.asset.bitmapData=i.bitmapData,t.asset.$initData(i.$bitmapX+e.rect.x,i.$bitmapY+e.rect.y,e.rect.width,e.rect.height,e.offset.x,e.offset.y,e.originalSize.x,e.originalSize.y,i.$sourceWidth,i.$sourceHeight,e.rotated))),t.asset;case m.PackageItemType.Atlas:case m.PackageItemType.Sound:return t.decoded||(t.decoded=!0,t.asset=RES.getRes(t.file),t.asset||console.log("Resource '"+t.file+"' not found, please check default.res.json!")),t.asset;case m.PackageItemType.Font:return t.decoded||(t.decoded=!0,this.loadFont(t)),t.bitmapFont;case m.PackageItemType.MovieClip:return t.decoded||(t.decoded=!0,this.loadMovieClip(t)),t.frames;case m.PackageItemType.Misc:return t.file?RES.getRes(t.file):null;default:return null}},v.prototype.getItemAssetAsync=function(t,e){t.decoded?e(null,t):t.loading?t.loading.push(e):t.type===m.PackageItemType.DragonBones?(t.loading=[e],this.loadDragonBones(t)):(this.getItemAsset(t),e(null,t))},v.prototype.loadMovieClip=function(t){var e=t.rawData;e.seek(0,0),t.interval=e.readInt(),t.swing=e.readBool(),t.repeatDelay=e.readInt(),e.seek(0,1);var i,r=e.readShort();t.frames=Array(r);for(var n=0;n<r;n++){var o=e.readShort();o+=e.position;var a,s={},h=e.readInt(),l=e.readInt();e.readInt(),e.readInt(),s.addDelay=e.readInt(),null!=(a=e.readS())&&null!=(i=this._sprites[a])&&(a=this.getItemAsset(i.atlas),s.texture=new egret.Texture,a&&(s.texture.bitmapData=a.bitmapData,s.texture.$initData(a.$bitmapX+i.rect.x,a.$bitmapY+i.rect.y,i.rect.width,i.rect.height,h,l,t.width,t.height,a.$sourceWidth,a.$sourceHeight,i.rotated))),t.frames[n]=s,e.position=o}},v.prototype.loadFont=function(t){var e=new m.BitmapFont;t.bitmapFont=e;var i=t.rawData;i.seek(0,0),e.ttf=i.readBool(),e.tint=i.readBool(),e.resizable=i.readBool(),i.readBool(),e.size=i.readInt();var r,n=i.readInt(),o=i.readInt(),a=this._sprites[t.id];a&&(r=this.getItemAsset(a.atlas)),i.seek(0,1);for(var s=i.readInt(),h=0;h<s;h++){var l=i.readShort();l+=i.position;var u={},c=i.readChar();e.glyphs[c]=u;var p=i.readS(),d=i.readInt(),c=i.readInt();u.x=i.readInt(),u.y=i.readInt(),u.width=i.readInt(),u.height=i.readInt(),u.advance=i.readInt(),u.channel=i.readByte(),1==u.channel?u.channel=3:2==u.channel?u.channel=2:3==u.channel&&(u.channel=1),e.ttf?(u.texture=new egret.Texture,u.texture.bitmapData=r.bitmapData,u.texture.$initData(r.$bitmapX+d+a.rect.x,r.$bitmapY+c+a.rect.y,u.width,u.height,a.offset.x,a.offset.y,a.originalSize.x,a.originalSize.y,r.$sourceWidth,r.$sourceHeight,a.rotated),u.lineHeight=o):((p=this._itemsById[p])&&(this.getItemAsset(p),u.width=p.width,u.height=p.height,u.texture=p.asset),0==u.advance&&(u.advance=0==n?u.x+u.width:n),u.lineHeight=u.y<0?u.height:u.y+u.height,u.lineHeight<e.size&&(u.lineHeight=e.size)),i.position=l}},v.prototype.loadDragonBones=function(i){var t=b(i.file,["json","dbbin"]),e=i.file.replace("_ske","_tex"),r=b(e,"json"),e=b(e,"png"),t=RES.getResAsync(t),r=RES.getResAsync(r),e=RES.getResAsync(e);Promise.all([t,r,e]).then(function(t){var e=dragonBones.EgretFactory.factory,t={data:e.parseDragonBonesData(t[0]),atlasData:e.parseTextureAtlasData(t[1],t[2])};i.asset=t,i.armatureName=t.data.armatureNames[0];t=i.loading;delete i.loading,t.forEach(function(t){return t(null,i)})}).catch(function(e){var t=i.loading;delete i.loading,t.forEach(function(t){return t(e,i)})})},v._constructing=0,v._instById={},v._instByName={},v._branch="",v._vars={},v);function v(){this._items=[],this._itemsById={},this._itemsByName={},this._sprites={},this._dependencies=[],this._branches=[],this._branchIndex=-1}function b(t,e){if(Array.isArray(e)){for(var i=0;i<e.length;i++){var r=t+"_"+e[i];if(RES.hasRes(r))return r}return t}r=t+"_"+e;return RES.hasRes(r)?r:t}m.UIPackage=t}(fgui=fgui||{}),function(i){var e,t=(e=i.GComponent,__extends(r,e),r.prototype.addUISource=function(t){this._uiSources.push(t)},Object.defineProperty(r.prototype,"contentPane",{get:function(){return this._contentPane},set:function(t){this._contentPane!=t&&(this._contentPane&&this.removeChild(this._contentPane),this._contentPane=t,this._contentPane&&(this.addChild(this._contentPane),this.setSize(this._contentPane.width,this._contentPane.height),this._contentPane.addRelation(this,i.RelationType.Size),this._frame=this._contentPane.getChild("frame"),this._frame&&(this.closeButton=this._frame.getChild("closeButton"),this.dragArea=this._frame.getChild("dragArea"),this.contentArea=this._frame.getChild("contentArea"))))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"closeButton",{get:function(){return this._closeButton},set:function(t){this._closeButton&&this._closeButton.removeClickListener(this.closeEventHandler,this),this._closeButton=t,this._closeButton&&this._closeButton.addClickListener(this.closeEventHandler,this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dragArea",{get:function(){return this._dragArea},set:function(t){this._dragArea!=t&&(this._dragArea&&(this._dragArea.draggable=!1,this._dragArea.removeEventListener(i.DragEvent.DRAG_START,this.__dragStart,this)),this._dragArea=t,this._dragArea&&(this._dragArea instanceof i.GGraph&&null==this._dragArea.displayObject&&this._dragArea.asGraph.drawRect(0,0,0,0,0),this._dragArea.draggable=!0,this._dragArea.addEventListener(i.DragEvent.DRAG_START,this.__dragStart,this)))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentArea",{get:function(){return this._contentArea},set:function(t){this._contentArea=t},enumerable:!0,configurable:!0}),r.prototype.show=function(){i.GRoot.inst.showWindow(this)},r.prototype.showOn=function(t){t.showWindow(this)},r.prototype.hide=function(){this.isShowing&&this.doHideAnimation()},r.prototype.hideImmediately=function(){((this.parent instanceof i.GRoot?this.parent:null)||i.GRoot.inst).hideWindowImmediately(this)},r.prototype.centerOn=function(t,e){this.setXY(Math.round((t.width-this.width)/2),Math.round((t.height-this.height)/2)),e&&(this.addRelation(t,i.RelationType.Center_Center),this.addRelation(t,i.RelationType.Middle_Middle))},r.prototype.toggleStatus=function(){this.isTop?this.hide():this.show()},Object.defineProperty(r.prototype,"isShowing",{get:function(){return null!=this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isTop",{get:function(){return null!=this.parent&&this.parent.getChildIndex(this)==this.parent.numChildren-1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"modal",{get:function(){return this._modal},set:function(t){this._modal=t},enumerable:!0,configurable:!0}),r.prototype.bringToFront=function(){this.root.bringToFront(this)},r.prototype.showModalWait=function(t){null!=t&&(this._requestingCmd=t),i.UIConfig.windowModalWaiting&&(this._modalWaitPane||(this._modalWaitPane=i.UIPackage.createObjectFromURL(i.UIConfig.windowModalWaiting)),this.layoutModalWaitPane(),this.addChild(this._modalWaitPane))},r.prototype.layoutModalWaitPane=function(){var t;this._contentArea?(t=this._frame.localToGlobal(),t=this.globalToLocal(t.x,t.y,t),this._modalWaitPane.setXY(t.x+this._contentArea.x,t.y+this._contentArea.y),this._modalWaitPane.setSize(this._contentArea.width,this._contentArea.height)):this._modalWaitPane.setSize(this.width,this.height)},r.prototype.closeModalWait=function(t){return(null==t||0==t||this._requestingCmd==t)&&(this._requestingCmd=0,this._modalWaitPane&&null!=this._modalWaitPane.parent&&this.removeChild(this._modalWaitPane),!0)},Object.defineProperty(r.prototype,"modalWaiting",{get:function(){return this._modalWaitPane&&null!=this._modalWaitPane.parent},enumerable:!0,configurable:!0}),r.prototype.init=function(){if(!this._inited&&!this._loading)if(0<this._uiSources.length){this._loading=!1;for(var t=this._uiSources.length,e=0;e<t;e++){var i=this._uiSources[e];i.loaded||(i.load(this.__uiLoadComplete,this),this._loading=!0)}this._loading||this._init()}else this._init()},r.prototype.onInit=function(){},r.prototype.onShown=function(){},r.prototype.onHide=function(){},r.prototype.doShowAnimation=function(){this.onShown()},r.prototype.doHideAnimation=function(){this.hideImmediately()},r.prototype.__uiLoadComplete=function(){for(var t=this._uiSources.length,e=0;e<t;e++)if(!this._uiSources[e].loaded)return;this._loading=!1,this._init()},r.prototype._init=function(){this._inited=!0,this.onInit(),this.isShowing&&this.doShowAnimation()},r.prototype.dispose=function(){this.displayObject.removeEventListener(egret.Event.ADDED_TO_STAGE,this.__onShown,this),this.displayObject.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.__onHidden,this),this.parent&&this.hideImmediately(),e.prototype.dispose.call(this)},r.prototype.closeEventHandler=function(t){this.hide()},r.prototype.__onShown=function(t){this._inited?this.doShowAnimation():this.init()},r.prototype.__onHidden=function(t){this.closeModalWait(),this.onHide()},r.prototype.__mouseDown=function(t){this.isShowing&&this.bringToFontOnClick&&this.bringToFront()},r.prototype.__dragStart=function(t){t.preventDefault(),this.startDrag(t.touchPointID,t.stageX,t.stageY)},r);function r(){var t=e.call(this)||this;return t._requestingCmd=0,t._uiSources=new Array,t.bringToFontOnClick=i.UIConfig.bringWindowToFrontOnClick,t.displayObject.addEventListener(egret.Event.ADDED_TO_STAGE,t.__onShown,t),t.displayObject.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.__onHidden,t),t.displayObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.__mouseDown,t,!0),t}i.Window=t}(fgui=fgui||{}),function(e){var t=(i.createAction=function(t){switch(t){case 0:return new e.PlayTransitionAction;case 1:return new e.ChangePageAction}return null},i.prototype.run=function(t,e,i){null!=this.fromPage&&0!=this.fromPage.length&&-1==this.fromPage.indexOf(e)||null!=this.toPage&&0!=this.toPage.length&&-1==this.toPage.indexOf(i)?this.leave(t):this.enter(t)},i.prototype.enter=function(t){},i.prototype.leave=function(t){},i.prototype.setup=function(t){var e,i=t.readShort();for(this.fromPage=[],e=0;e<i;e++)this.fromPage[e]=t.readS();for(i=t.readShort(),this.toPage=[],e=0;e<i;e++)this.toPage[e]=t.readS()},i);function i(){}e.ControllerAction=t}(fgui=fgui||{}),function(i){var e,t=(e=i.ControllerAction,__extends(r,e),r.prototype.enter=function(t){if(this.controllerName){if(this.objectId){var e=t.parent.getChildById(this.objectId);if(!(e instanceof i.GComponent))return;e=e}else e=t.parent;!e||(e=e.getController(this.controllerName))&&e!=t&&!e.changing&&("~1"==this.targetPage?t.selectedIndex<e.pageCount&&(e.selectedIndex=t.selectedIndex):"~2"==this.targetPage?e.selectedPage=t.selectedPage:e.selectedPageId=this.targetPage)}},r.prototype.setup=function(t){e.prototype.setup.call(this,t),this.objectId=t.readS(),this.controllerName=t.readS(),this.targetPage=t.readS()},r);function r(){return e.call(this)||this}i.ChangePageAction=t}(fgui=fgui||{}),function(t){var e,i=(e=t.ControllerAction,__extends(r,e),r.prototype.enter=function(t){t=t.parent.getTransition(this.transitionName);t&&(this._currentTransition&&this._currentTransition.playing?t.changePlayTimes(this.playTimes):t.play(null,null,null,this.playTimes,this.delay),this._currentTransition=t)},r.prototype.leave=function(t){this.stopOnExit&&this._currentTransition&&(this._currentTransition.stop(),this._currentTransition=null)},r.prototype.setup=function(t){e.prototype.setup.call(this,t),this.transitionName=t.readS(),this.playTimes=t.readInt(),this.delay=t.readFloat(),this.stopOnExit=t.readBool()},r);function r(){var t=e.call(this)||this;return t.playTimes=1,t.delay=0,t.stopOnExit=!1,t}t.PlayTransitionAction=i}(fgui=fgui||{}),(fgui||(fgui={})).BitmapFont=function(){this.size=0,this.glyphs={}},function(h){function s(t,e,i,r,n){var o,a,s;switch((!r||i!=h.FillOrigin.TopRight&&i!=h.FillOrigin.BottomLeft)&&(r||i!=h.FillOrigin.TopLeft&&i!=h.FillOrigin.BottomRight)||(n=1-n),o=((a=t*Math.tan(Math.PI/2*n))-e)/a,i){case h.FillOrigin.TopLeft:s=r?a<=e?[0,0,t,a,t,0]:[0,0,t*(1-o),e,t,e,t,0]:a<=e?[0,0,t,a,t,e,0,e]:[0,0,t*(1-o),e,0,e];break;case h.FillOrigin.TopRight:s=r?a<=e?[t,0,0,a,0,e,t,e]:[t,0,t*o,e,t,e]:a<=e?[t,0,0,a,0,0]:[t,0,t*o,e,0,e,0,0];break;case h.FillOrigin.BottomLeft:s=r?a<=e?[0,e,t,e-a,t,0,0,0]:[0,e,t*(1-o),0,0,0]:a<=e?[0,e,t,e-a,t,e]:[0,e,t*(1-o),0,t,0,t,e];break;case h.FillOrigin.BottomRight:s=r?a<=e?[t,e,0,e-a,0,e]:[t,e,t*o,0,0,0,0,e]:a<=e?[t,e,0,e-a,0,0,t,0]:[t,e,t*o,0,t,0]}return s}function l(t,e,i){for(var r=t.length,n=0;n<r;n+=2)t[n]+=e,t[n+1]+=i}function u(t,e,i,r,n){var o;switch(i){case h.FillOrigin.Top:n<=.5?(o=s(t/2,e,r?h.FillOrigin.TopLeft:h.FillOrigin.TopRight,r,n/=.5),r&&l(o,t/2,0)):(o=s(t/2,e,r?h.FillOrigin.TopRight:h.FillOrigin.TopLeft,r,n=(n-.5)/.5),r?o.push(t,e,t,0):(l(o,t/2,0),o.push(0,e,0,0)));break;case h.FillOrigin.Bottom:n<=.5?(o=s(t/2,e,r?h.FillOrigin.BottomRight:h.FillOrigin.BottomLeft,r,n/=.5),r||l(o,t/2,0)):(o=s(t/2,e,r?h.FillOrigin.BottomLeft:h.FillOrigin.BottomRight,r,n=(n-.5)/.5),r?(l(o,t/2,0),o.push(0,0,0,e)):o.push(t,0,t,e));break;case h.FillOrigin.Left:n<=.5?(o=s(t,e/2,r?h.FillOrigin.BottomLeft:h.FillOrigin.TopLeft,r,n/=.5),r||l(o,0,e/2)):(o=s(t,e/2,r?h.FillOrigin.TopLeft:h.FillOrigin.BottomLeft,r,n=(n-.5)/.5),r?(l(o,0,e/2),o.push(t,0,0,0)):o.push(t,e,0,e));break;case h.FillOrigin.Right:n<=.5?(o=s(t,e/2,r?h.FillOrigin.TopRight:h.FillOrigin.BottomRight,r,n/=.5),r&&l(o,0,e/2)):(o=s(t,e/2,r?h.FillOrigin.BottomRight:h.FillOrigin.TopRight,r,n=(n-.5)/.5),r?o.push(0,e,t,e):(l(o,0,e/2),o.push(0,0,t,0)))}return o}h.fillImage=function(t,e,i,r,n,o){if(o<=0)return null;if(.9999<=o)return[0,0,t,0,t,e,0,e];var a;switch(i){case h.FillMethod.Horizontal:a=function(t,e,i,r){r*=t;return i==h.FillOrigin.Left||i==h.FillOrigin.Top?[0,0,r,0,r,e,0,e]:[t,0,t,e,t-r,e,t-r,0]}(t,e,r,o);break;case h.FillMethod.Vertical:a=function(t,e,i,r){r*=e;return i==h.FillOrigin.Left||i==h.FillOrigin.Top?[0,0,0,r,t,r,t,0]:[0,e,t,e,t,e-r,0,e-r]}(t,e,r,o);break;case h.FillMethod.Radial90:a=s(t,e,r,n,o);break;case h.FillMethod.Radial180:a=u(t,e,r,n,o);break;case h.FillMethod.Radial360:a=function(t,e,i,r,n){var o;switch(i){case h.FillOrigin.Top:n<=.5?(n/=.5,o=u(t/2,e,r?h.FillOrigin.Left:h.FillOrigin.Right,r,n),r&&l(o,t/2,0)):(n=(n-.5)/.5,o=u(t/2,e,r?h.FillOrigin.Right:h.FillOrigin.Left,r,n),r?o.push(t,e,t,0,t/2,0):(l(o,t/2,0),o.push(0,e,0,0,t/2,0)));break;case h.FillOrigin.Bottom:n<=.5?(n/=.5,o=u(t/2,e,r?h.FillOrigin.Right:h.FillOrigin.Left,r,n),r||l(o,t/2,0)):(n=(n-.5)/.5,o=u(t/2,e,r?h.FillOrigin.Left:h.FillOrigin.Right,r,n),r?(l(o,t/2,0),o.push(0,0,0,e,t/2,e)):o.push(t,0,t,e,t/2,e));break;case h.FillOrigin.Left:n<=.5?(n/=.5,o=u(t,e/2,r?h.FillOrigin.Bottom:h.FillOrigin.Top,r,n),r||l(o,0,e/2)):(n=(n-.5)/.5,o=u(t,e/2,r?h.FillOrigin.Top:h.FillOrigin.Bottom,r,n),r?(l(o,0,e/2),o.push(t,0,0,0,0,e/2)):o.push(t,e,0,e,0,e/2));break;case h.FillOrigin.Right:n<=.5?(n/=.5,o=u(t,e/2,r?h.FillOrigin.Top:h.FillOrigin.Bottom,r,n),r&&l(o,0,e/2)):(n=(n-.5)/.5,o=u(t,e/2,r?h.FillOrigin.Bottom:h.FillOrigin.Top,r,n),r?o.push(0,e,t,e,t,e/2):(l(o,0,e/2),o.push(0,0,t,0,t,e/2)))}return o}(t,e,r,n,o)}return a}}(fgui=fgui||{}),function(r){var e,t=(e=egret.Bitmap,__extends(i,e),Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(t){this._color!=t&&(this._color=t,null==this.tint?r.ToolSet.setColorFilter(this,t):this.tint=t)},enumerable:!0,configurable:!0}),i.prototype.$setX=function(t){return this.mask&&(this.mask.x=t),e.prototype.$setX.call(this,t)},i.prototype.$setY=function(t){return this.mask&&(this.mask.y=t),e.prototype.$setY.call(this,t)},Object.defineProperty(i.prototype,"fillMethod",{get:function(){return this._fillMethod},set:function(t){this._fillMethod!=t&&(this._fillMethod=t,0!=this._fillMethod?(this._mask||(this._mask=new egret.Shape,this._mask.touchEnabled=!1),this.mask=this._mask,this._mask.x=this.x,this._mask.y=this.y,this.addEventListener(egret.Event.RESIZE,this.markChanged,this),this.markChanged()):this.mask&&(this._mask.graphics.clear(),this.mask=null,this.removeEventListener(egret.Event.RESIZE,this.markChanged,this)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillOrigin",{get:function(){return this._fillOrigin},set:function(t){this._fillOrigin!=t&&(this._fillOrigin=t,0!=this._fillMethod&&this.markChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillClockwise",{get:function(){return this._fillClockwise},set:function(t){this._fillClockwise!=t&&(this._fillClockwise=t,0!=this._fillMethod&&this.markChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillAmount",{get:function(){return this._fillAmount},set:function(t){this._fillAmount!=t&&(this._fillAmount=t,0!=this._fillMethod&&this.markChanged())},enumerable:!0,configurable:!0}),i.prototype.markChanged=function(){this._maskDirtyFlag||(this._maskDirtyFlag=!0,r.GTimers.inst.callLater(this.doFill,this))},i.prototype.doFill=function(){this._maskDirtyFlag=!1,!this._mask.parent&&this.parent&&this.parent.addChild(this._mask);var t=this.width,e=this.height,i=this._mask.graphics;i.clear(),0==t||0==e||(e=r.fillImage(t,e,this._fillMethod,this._fillOrigin,this._fillClockwise,this._fillAmount))&&(i.beginFill(0,1),r.ToolSet.fillPath(i,e,0,0),i.endFill())},i);function i(){var t=e.call(this)||this;return t._fillMethod=0,t._fillOrigin=0,t._fillAmount=0,t._color=16777215,t}r.Image=t}(fgui=fgui||{}),function(i){var r,t=(r=i.Image,__extends(e,r),Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},set:function(t){this._frames=t,this.scale9Grid=null,this.fillMode=egret.BitmapFillMode.SCALE,this._frames?this._frameCount=this._frames.length:this._frameCount=0,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),(-1==this._endAt||this._endAt>this._frameCount-1)&&(this._endAt=this._frameCount-1),(this._frame<0||this._frame>this._frameCount-1)&&(this._frame=this._frameCount-1),this.drawFrame(),this._frameElapsed=0,this._repeatedCount=0,this._reversed=!1,this.checkTimer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameCount",{get:function(){return this._frameCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame!=t&&(this._frames&&t>=this._frameCount&&(t=this._frameCount-1),this._frame=t,this._frameElapsed=0,this.drawFrame())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},set:function(t){this._playing!=t&&(this._playing=t,this.checkTimer())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"smoothing",{get:function(){return this._smoothing},set:function(t){this._smoothing=t},enumerable:!0,configurable:!0}),e.prototype.rewind=function(){this._frame=0,this._frameElapsed=0,this._reversed=!1,this._repeatedCount=0,this.drawFrame()},e.prototype.syncStatus=function(t){this._frame=t._frame,this._frameElapsed=t._frameElapsed,this._reversed=t._reversed,this._repeatedCount=t._repeatedCount,this.drawFrame()},e.prototype.advance=function(t){for(var e=this._frame,i=this._reversed,r=t;;){var n=this.interval+this._frames[this._frame].addDelay;if(0==this._frame&&0<this._repeatedCount&&(n+=this.repeatDelay),t<n){this._frameElapsed=0;break}t-=n,this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),this._frame==e&&this._reversed==i&&(n=r-t,t-=Math.floor(t/n)*n)}this.drawFrame()},e.prototype.setPlaySettings=function(t,e,i,r,n,o){null==e&&(e=-1),null==i&&(i=0),null==r&&(r=-1),this._start=t=null==t?0:t,this._end=e,(-1==this._end||this._end>this._frameCount-1)&&(this._end=this._frameCount-1),this._times=i,this._endAt=r,-1==this._endAt&&(this._endAt=this._end),this._status=0,this._callback=n,this._callbackObj=o,this.frame=t},e.prototype.update=function(){var t,e;this._playing&&0!=this._frameCount&&3!=this._status&&(t=i.GTimers.deltaTime,1!=this.timeScale&&(t*=this.timeScale),this._frameElapsed+=t,e=this.interval+this._frames[this._frame].addDelay,0==this._frame&&0<this._repeatedCount&&(e+=this.repeatDelay),this._frameElapsed<e||(this._frameElapsed-=e,this._frameElapsed>this.interval&&(this._frameElapsed=this.interval),this.swing?this._reversed?(this._frame--,this._frame<=0&&(this._frame=0,this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=Math.max(0,this._frameCount-2),this._repeatedCount++,this._reversed=!this._reversed)):(this._frame++,this._frame>this._frameCount-1&&(this._frame=0,this._repeatedCount++)),1==this._status?(this._frame=this._start,this._frameElapsed=0,this._status=0):2==this._status?(this._frame=this._endAt,this._frameElapsed=0,this._status=3,null!=this._callback&&(t=this._callback,e=this._callbackObj,this._callback=null,this._callbackObj=null,t.call(e))):this._frame==this._end&&(0<this._times?(this._times--,0==this._times?this._status=2:this._status=1):0!=this._start&&(this._status=1)),this.drawFrame()))},e.prototype.drawFrame=function(){var t;0<this._frameCount&&this._frame<this._frames.length?(t=this._frames[this._frame],this.texture=t.texture):this.texture=null},e.prototype.checkTimer=function(){this._playing&&0<this._frameCount&&null!=this.stage?i.GTimers.inst.add(1,0,this.update,this):i.GTimers.inst.remove(this.update,this)},e.prototype.$onAddToStage=function(t,e){r.prototype.$onAddToStage.call(this,t,e),this._playing&&0<this._frameCount&&i.GTimers.inst.add(1,0,this.update,this)},e.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this),i.GTimers.inst.remove(this.update,this)},e);function e(){var t=r.call(this)||this;return t.interval=0,t.repeatDelay=0,t.timeScale=1,t._playing=!0,t._frameCount=0,t._frame=0,t._start=0,t._end=0,t._times=0,t._endAt=0,t._status=0,t._frameElapsed=0,t._reversed=!1,t._repeatedCount=0,t.touchEnabled=!1,t.setPlaySettings(),t}i.MovieClip=t}(fgui=fgui||{}),function(s){var a,t=(a=egret.DisplayObjectContainer,__extends(e,a),e.prototype.cacheHitArea=function(t){(this._cachedHitArea=t)&&(this._cachedMatrix||(this._cachedMatrix=new egret.Matrix),this._cachedMatrix.copyFrom(this.$getInvertedConcatenatedMatrix()))},Object.defineProperty(e.prototype,"hitArea",{get:function(){return this._hitArea},set:function(t){this._hitArea=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opaque",{get:function(){return this._opaque},set:function(t){this._opaque=t},enumerable:!0,configurable:!0}),e.prototype.$hitTest=function(t,e){if(!this.$visible)return null;if(this._hitArea){if(!this.touchEnabled)return null;if(this._hitArea.$graphics){if(!this._hitArea.$graphics.$hitTest(t,e))return null}else{var i=(o=this._cachedHitArea?this._cachedMatrix:this.$getInvertedConcatenatedMatrix()).a*t+o.c*e+o.tx,r=o.b*t+o.d*e+o.ty;if(!this._hitArea.contains(i,r))return null}return this}var n=a.prototype.$hitTest.call(this,t,e);if(n==this&&!this.touchEnabled)return null;if(null==n&&this._opaque){var o,i=(o=this._cachedHitArea?this._cachedMatrix:this.$getInvertedConcatenatedMatrix()).a*t+o.c*e+o.tx,r=o.b*t+o.d*e+o.ty;return 0<=i&&0<=r&&i<=this.$explicitWidth&&r<=this.$explicitHeight?this.$checkHit(this,t,e):null}return n!=this||this._opaque?this.$checkHit(n,t,e):null},e.prototype.$checkHit=function(t,e,i){var r=this.$owner;if(!r)return t;if(!r.pixelHitTest)return t;if(r instanceof s.GButton){r=r.getChild("icon");return r&&r instanceof s.GLoader?r._container.$checkHit(t,e,i):t}var n=this.$children;if(n&&n.length)for(var o=0;o<n.length;o++){var a=n[o];if(a instanceof s.MovieClip&&a.pixelHitTest&&!a.$hitTest(e,i))return null}return t},e);function e(){var t=a.call(this)||this;return t.touchEnabled=!0,t.touchChildren=!0,t}s.UIContainer=t}(fgui=fgui||{}),function(t){var n,e=(n=egret.Event,__extends(i,n),i.prototype.preventDefault=function(){this._prevented=!0},i.prototype.isDefaultPrevented=function(){return this._prevented},i.DRAG_START="__dragStart",i.DRAG_END="__dragEnd",i.DRAG_MOVING="__dragMoving",i);function i(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=-1);t=n.call(this,t,!1)||this;return t.touchPointID=0,t.stageX=e,t.stageY=i,t.touchPointID=r,t}t.DragEvent=e}(fgui=fgui||{}),function(t){var i,e=(i=egret.Event,__extends(r,i),r.DROP="__drop",r);function r(t,e){t=i.call(this,t,!1)||this;return t.source=e,t}t.DropEvent=e}(fgui=fgui||{}),function(t){var n,e=(n=egret.Event,__extends(i,n),i.CLICK="___itemClick",i);function i(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=0);t=n.call(this,t,!1)||this;return t.itemObject=e,t.stageX=i,t.stageY=r,t}t.ItemEvent=e}(fgui=fgui||{}),function(t){var e,i=(e=egret.Event,__extends(r,e),r.CHANGED="___stateChanged",r);function r(t){return e.call(this,t,!1)||this}t.StateChangeEvent=i}(fgui=fgui||{}),function(n){var i,t=(e.create=function(t,e){return new(i=i||[n.GearDisplay,n.GearXY,n.GearSize,n.GearLook,n.GearColor,n.GearAnimation,n.GearText,n.GearIcon,n.GearDisplay2,n.GearFontSize])[e](t)},e.prototype.dispose=function(){this._tweenConfig&&this._tweenConfig._tweener&&(this._tweenConfig._tweener.kill(),this._tweenConfig._tweener=null)},Object.defineProperty(e.prototype,"controller",{get:function(){return this._controller},set:function(t){t!=this._controller&&(this._controller=t,this._controller&&this.init())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tweenConfig",{get:function(){return this._tweenConfig||(this._tweenConfig=new o),this._tweenConfig},enumerable:!0,configurable:!0}),e.prototype.setup=function(t){var e,i;this._controller=this._owner.parent.getControllerAt(t.readShort()),this.init();var r=t.readShort();if(this instanceof n.GearDisplay)this.pages=t.readSArray(r);else if(this instanceof n.GearDisplay2)this.pages=t.readSArray(r);else{for(e=0;e<r;e++)null!=(i=t.readS())&&this.addStatus(i,t);t.readBool()&&this.addStatus(null,t)}if(t.readBool()&&(this._tweenConfig=new o,this._tweenConfig.easeType=t.readByte(),this._tweenConfig.duration=t.readFloat(),this._tweenConfig.delay=t.readFloat()),2<=t.version)if(this instanceof n.GearXY){if(t.readBool()){for(this.positionsInPercent=!0,e=0;e<r;e++)null!=(i=t.readS())&&this.addExtStatus(i,t);t.readBool()&&this.addExtStatus(null,t)}}else this instanceof n.GearDisplay2&&(this.condition=t.readByte())},e.prototype.updateFromRelations=function(t,e){},e.prototype.addStatus=function(t,e){},e.prototype.init=function(){},e.prototype.apply=function(){},e.prototype.updateState=function(){},e);function e(t){this._owner=t}n.GearBase=t;var o=function(){this.tween=!0,this.easeType=n.EaseType.QuadOut,this.duration=.3,this.delay=0};n.GearTweenConfig=o}(fgui=fgui||{}),function(e){var i,t=(i=e.GearBase,__extends(r,i),r.prototype.init=function(){this._default={playing:this._owner.getProp(e.ObjectPropID.Playing),frame:this._owner.getProp(e.ObjectPropID.Frame)},this._storage={}},r.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.playing=e.readBool(),i.frame=e.readInt()},r.prototype.apply=function(){this._owner._gearLocked=!0;var t=(t=this._storage[this._controller.selectedPageId])||this._default;this._owner.setProp(e.ObjectPropID.Playing,t.playing),this._owner.setProp(e.ObjectPropID.Frame,t.frame),this._owner._gearLocked=!1},r.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.playing=this._owner.getProp(e.ObjectPropID.Playing),t.frame=this._owner.getProp(e.ObjectPropID.Frame)},r);function r(t){return i.call(this,t)||this}e.GearAnimation=t}(fgui=fgui||{}),function(e){var i,t=(i=e.GearBase,__extends(r,i),r.prototype.init=function(){this._default={color:this._owner.getProp(e.ObjectPropID.Color),strokeColor:this._owner.getProp(e.ObjectPropID.OutlineColor)},this._storage={}},r.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.color=e.readColor(),i.strokeColor=e.readColor()},r.prototype.apply=function(){this._owner._gearLocked=!0;var t=(t=this._storage[this._controller.selectedPageId])||this._default;this._owner.setProp(e.ObjectPropID.Color,t.color),this._owner.setProp(e.ObjectPropID.OutlineColor,t.strokeColor),this._owner._gearLocked=!1},r.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.color=this._owner.getProp(e.ObjectPropID.Color),t.strokeColor=this._owner.getProp(e.ObjectPropID.OutlineColor)},r);function r(t){return i.call(this,t)||this}e.GearColor=t}(fgui=fgui||{}),function(t){var e,i=(e=t.GearBase,__extends(r,e),r.prototype.init=function(){this.pages=null},r.prototype.apply=function(){this._displayLockToken++,0==this._displayLockToken&&(this._displayLockToken=1),null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?this._visible=1:this._visible=0},r.prototype.addLock=function(){return this._visible++,this._displayLockToken},r.prototype.releaseLock=function(t){t==this._displayLockToken&&this._visible--},Object.defineProperty(r.prototype,"connected",{get:function(){return null==this._controller||0<this._visible},enumerable:!0,configurable:!0}),r);function r(t){t=e.call(this,t)||this;return t._displayLockToken=1,t._visible=0,t}t.GearDisplay=i}(fgui=fgui||{}),function(t){var e,i=(e=t.GearBase,__extends(r,e),r.prototype.init=function(){this.pages=null},r.prototype.apply=function(){null==this.pages||0==this.pages.length||-1!=this.pages.indexOf(this._controller.selectedPageId)?this._visible=1:this._visible=0},r.prototype.evaluate=function(t){var e=null==this._controller||0<this._visible;return e=0==this.condition?e&&t:e||t},r);function r(t){t=e.call(this,t)||this;return t._visible=0,t}t.GearDisplay2=i}(fgui=fgui||{}),function(e){var i,t=(i=e.GearBase,__extends(r,i),r.prototype.init=function(){this._default=this._owner.getProp(e.ObjectPropID.FontSize),this._storage={}},r.prototype.addStatus=function(t,e){null==t?this._default=e.readInt():this._storage[t]=e.readInt()},r.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];null!=t?this._owner.setProp(e.ObjectPropID.FontSize,t):this._owner.setProp(e.ObjectPropID.FontSize,this._default),this._owner._gearLocked=!1},r.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.getProp(e.ObjectPropID.FontSize)},r);function r(t){t=i.call(this,t)||this;return t._default=0,t}e.GearFontSize=t}(fgui=fgui||{}),function(t){var e,i=(e=t.GearBase,__extends(r,e),r.prototype.init=function(){this._default=this._owner.icon,this._storage={}},r.prototype.addStatus=function(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()},r.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.icon=void 0!==t?t:this._default,this._owner._gearLocked=!1},r.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.icon},r);function r(t){return e.call(this,t)||this}t.GearIcon=i}(fgui=fgui||{}),function(r){var e,t=(e=r.GearBase,__extends(i,e),i.prototype.init=function(){this._default={alpha:this._owner.alpha,rotation:this._owner.rotation,grayed:this._owner.grayed,touchable:this._owner.touchable},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.alpha=e.readFloat(),i.rotation=e.readFloat(),i.grayed=e.readBool(),i.touchable=e.readBool()},i.prototype.apply=function(){var t=(t=this._storage[this._controller.selectedPageId])||this._default;if(this._tweenConfig&&this._tweenConfig.tween&&!r.UIPackage._constructing&&!r.GearBase.disableAllTweenEffect){if(this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.touchable=t.touchable,this._owner._gearLocked=!1,this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t.alpha&&this._tweenConfig._tweener.endValue.y==t.rotation)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var e=t.alpha!=this._owner.alpha,i=t.rotation!=this._owner.rotation;(e||i)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=r.GTween.to2(this._owner.alpha,this._owner.rotation,t.alpha,t.rotation,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e?1:0)+(i?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.grayed=t.grayed,this._owner.touchable=t.touchable,this._owner.alpha=t.alpha,this._owner.rotation=t.rotation,this._owner._gearLocked=!1},i.prototype.__tweenUpdate=function(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&(this._owner.alpha=t.value.x),0!=(2&e)&&(this._owner.rotation=t.value.y),this._owner._gearLocked=!1},i.prototype.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},i.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.alpha=this._owner.alpha,t.rotation=this._owner.rotation,t.grayed=this._owner.grayed,t.touchable=this._owner.touchable},i);function i(t){return e.call(this,t)||this}r.GearLook=t}(fgui=fgui||{}),function(r){var e,t=(e=r.GearBase,__extends(i,e),i.prototype.init=function(){this._default={width:this._owner.width,height:this._owner.height,scaleX:this._owner.scaleX,scaleY:this._owner.scaleY},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.width=e.readInt(),i.height=e.readInt(),i.scaleX=e.readFloat(),i.scaleY=e.readFloat()},i.prototype.apply=function(){var t=(t=this._storage[this._controller.selectedPageId])||this._default;if(this._tweenConfig&&this._tweenConfig.tween&&!r.UIPackage._constructing&&!r.GearBase.disableAllTweenEffect){if(this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t.width&&this._tweenConfig._tweener.endValue.y==t.height&&this._tweenConfig._tweener.endValue.z==t.scaleX&&this._tweenConfig._tweener.endValue.w==t.scaleY)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var e=t.width!=this._owner.width||t.height!=this._owner.height,i=t.scaleX!=this._owner.scaleX||t.scaleY!=this._owner.scaleY;(e||i)&&(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=r.GTween.to4(this._owner.width,this._owner.height,this._owner.scaleX,this._owner.scaleY,t.width,t.height,t.scaleX,t.scaleY,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setUserData((e?1:0)+(i?2:0)).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.setSize(t.width,t.height,this._owner.gearXY.controller==this._controller),this._owner.setScale(t.scaleX,t.scaleY),this._owner._gearLocked=!1},i.prototype.__tweenUpdate=function(t){var e=t.userData;this._owner._gearLocked=!0,0!=(1&e)&&this._owner.setSize(t.value.x,t.value.y,this._owner.checkGearController(1,this._controller)),0!=(2&e)&&this._owner.setScale(t.value.z,t.value.w),this._owner._gearLocked=!1},i.prototype.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},i.prototype.updateState=function(){var t=this._storage[this._controller.selectedPageId];t||(this._storage[this._controller.selectedPageId]=t={}),t.width=this._owner.width,t.height=this._owner.height,t.scaleX=this._owner.scaleX,t.scaleY=this._owner.scaleY},i.prototype.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage){for(var i in this._storage){i=this._storage[i];i.width+=t,i.height+=e}this._default.width+=t,this._default.height+=e,this.updateState()}},i);function i(t){return e.call(this,t)||this}r.GearSize=t}(fgui=fgui||{}),function(t){var e,i=(e=t.GearBase,__extends(r,e),r.prototype.init=function(){this._default=this._owner.text,this._storage={}},r.prototype.addStatus=function(t,e){null==t?this._default=e.readS():this._storage[t]=e.readS()},r.prototype.apply=function(){this._owner._gearLocked=!0;var t=this._storage[this._controller.selectedPageId];this._owner.text=void 0!==t?t:this._default,this._owner._gearLocked=!1},r.prototype.updateState=function(){this._storage[this._controller.selectedPageId]=this._owner.text},r);function r(t){return e.call(this,t)||this}t.GearText=i}(fgui=fgui||{}),function(n){var e,t=(e=n.GearBase,__extends(i,e),i.prototype.init=function(){this._default={x:this._owner.x,y:this._owner.y,px:this._owner.x/this._owner.parent.width,py:this._owner.y/this._owner.parent.height},this._storage={}},i.prototype.addStatus=function(t,e){var i;null==t?i=this._default:this._storage[t]=i={},i.x=e.readInt(),i.y=e.readInt()},i.prototype.addExtStatus=function(t,e){t=null==t?this._default:this._storage[t];t.px=e.readFloat(),t.py=e.readFloat()},i.prototype.apply=function(){var t,e=(e=this._storage[this._controller.selectedPageId])||this._default,i=this.positionsInPercent&&this._owner.parent?(t=e.px*this._owner.parent.width,e.py*this._owner.parent.height):(t=e.x,e.y);if(this._tweenConfig&&this._tweenConfig.tween&&!n.UIPackage._constructing&&!n.GearBase.disableAllTweenEffect){if(this._tweenConfig._tweener){if(this._tweenConfig._tweener.endValue.x==t&&this._tweenConfig._tweener.endValue.y==i)return;this._tweenConfig._tweener.kill(!0),this._tweenConfig._tweener=null}var r=this._owner.x,e=this._owner.y;r==t&&e==i||(this._owner.checkGearController(0,this._controller)&&(this._tweenConfig._displayLockToken=this._owner.addDisplayLock()),this._tweenConfig._tweener=n.GTween.to2(r,e,t,i,this._tweenConfig.duration).setDelay(this._tweenConfig.delay).setEase(this._tweenConfig.easeType).setTarget(this).onUpdate(this.__tweenUpdate,this).onComplete(this.__tweenComplete,this))}else this._owner._gearLocked=!0,this._owner.setXY(t,i),this._owner._gearLocked=!1},i.prototype.__tweenUpdate=function(t){this._owner._gearLocked=!0,this._owner.setXY(t.value.x,t.value.y),this._owner._gearLocked=!1},i.prototype.__tweenComplete=function(){0!=this._tweenConfig._displayLockToken&&(this._owner.releaseDisplayLock(this._tweenConfig._displayLockToken),this._tweenConfig._displayLockToken=0),this._tweenConfig._tweener=null},i.prototype.updateState=function(){var t;this._owner.parent&&((t=this._storage[this._controller.selectedPageId])||(this._storage[this._controller.selectedPageId]=t={}),t.x=this._owner.x,t.y=this._owner.y,t.px=this._owner.x/this._owner.parent.width,t.py=this._owner.y/this._owner.parent.height)},i.prototype.updateFromRelations=function(t,e){if(null!=this._controller&&null!=this._storage&&!this.positionsInPercent){for(var i in this._storage){i=this._storage[i];i.x+=t,i.y+=e}this._default.x+=t,this._default.y+=e,this.updateState()}},i);function i(t){return e.call(this,t)||this}n.GearXY=t}(fgui=fgui||{}),function(s){var h=.5*Math.PI,l=2*Math.PI;function u(t,e){return 1-c(e-t,e)}function c(t,e){return(t/=e)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}s.evaluateEase=function(t,e,i,r,n){switch(t){case s.EaseType.Linear:return e/i;case s.EaseType.SineIn:return 1-Math.cos(e/i*h);case s.EaseType.SineOut:return Math.sin(e/i*h);case s.EaseType.SineInOut:return-.5*(Math.cos(Math.PI*e/i)-1);case s.EaseType.QuadIn:return(e/=i)*e;case s.EaseType.QuadOut:return-(e/=i)*(e-2);case s.EaseType.QuadInOut:return(e/=.5*i)<1?.5*e*e:-.5*(--e*(e-2)-1);case s.EaseType.CubicIn:return(e/=i)*e*e;case s.EaseType.CubicOut:return(e=e/i-1)*e*e+1;case s.EaseType.CubicInOut:return(e/=.5*i)<1?.5*e*e*e:.5*((e-=2)*e*e+2);case s.EaseType.QuartIn:return(e/=i)*e*e*e;case s.EaseType.QuartOut:return-((e=e/i-1)*e*e*e-1);case s.EaseType.QuartInOut:return(e/=.5*i)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2);case s.EaseType.QuintIn:return(e/=i)*e*e*e*e;case s.EaseType.QuintOut:return(e=e/i-1)*e*e*e*e+1;case s.EaseType.QuintInOut:return(e/=.5*i)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2);case s.EaseType.ExpoIn:return 0==e?0:Math.pow(2,10*(e/i-1));case s.EaseType.ExpoOut:return e==i?1:1-Math.pow(2,-10*e/i);case s.EaseType.ExpoInOut:return 0==e?0:e==i?1:(e/=.5*i)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e));case s.EaseType.CircIn:return-(Math.sqrt(1-(e/=i)*e)-1);case s.EaseType.CircOut:return Math.sqrt(1-(e=e/i-1)*e);case s.EaseType.CircInOut:return(e/=.5*i)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1);case s.EaseType.ElasticIn:var o;return 0==e?0:1==(e/=i)?1:(0==n&&(n=.3*i),o=r<1?(r=1,n/4):n/l*Math.asin(1/r),-(r*Math.pow(2,10*--e)*Math.sin((e*i-o)*l/n)));case s.EaseType.ElasticOut:return 0==e?0:1==(e/=i)?1:(0==n&&(n=.3*i),a=r<1?(r=1,n/4):n/l*Math.asin(1/r),r*Math.pow(2,-10*e)*Math.sin((e*i-a)*l/n)+1);case s.EaseType.ElasticInOut:var a;return 0==e?0:2==(e/=.5*i)?1:(0==n&&(n=i*(.3*1.5)),a=r<1?(r=1,n/4):n/l*Math.asin(1/r),e<1?r*Math.pow(2,10*--e)*Math.sin((e*i-a)*l/n)*-.5:r*Math.pow(2,-10*--e)*Math.sin((e*i-a)*l/n)*.5+1);case s.EaseType.BackIn:return(e/=i)*e*((r+1)*e-r);case s.EaseType.BackOut:return(e=e/i-1)*e*((r+1)*e+r)+1;case s.EaseType.BackInOut:return(e/=.5*i)<1?e*e*((1+(r*=1.525))*e-r)*.5:.5*((e-=2)*e*((1+(r*=1.525))*e+r)+2);case s.EaseType.BounceIn:return u(e,i);case s.EaseType.BounceOut:return c(e,i);case s.EaseType.BounceInOut:return function(t,e){if(t<.5*e)return.5*u(2*t,e);return.5*c(2*t-e,e)+.5}(e,i);default:return-(e/=i)*(e-2)}}}(fgui=fgui||{}),function(t){var e=(i.Linear=0,i.SineIn=1,i.SineOut=2,i.SineInOut=3,i.QuadIn=4,i.QuadOut=5,i.QuadInOut=6,i.CubicIn=7,i.CubicOut=8,i.CubicInOut=9,i.QuartIn=10,i.QuartOut=11,i.QuartInOut=12,i.QuintIn=13,i.QuintOut=14,i.QuintInOut=15,i.ExpoIn=16,i.ExpoOut=17,i.ExpoInOut=18,i.CircIn=19,i.CircOut=20,i.CircInOut=21,i.ElasticIn=22,i.ElasticOut=23,i.ElasticInOut=24,i.BackIn=25,i.BackOut=26,i.BackInOut=27,i.BounceIn=28,i.BounceOut=29,i.BounceInOut=30,i.Custom=31,i);function i(){}t.EaseType=e}(fgui=fgui||{}),function(d){var t=(Object.defineProperty(e.prototype,"length",{get:function(){return this._fullLength},enumerable:!0,configurable:!0}),e.prototype.create=function(t,e,i,r){var n;Array.isArray(t)?n=t:((n=new Array).push(t),n.push(e),i&&n.push(i),r&&n.push(r)),this._segments.length=0,this._points.length=0,this._fullLength=0;var o=n.length;if(0!=o){var a=c,s=n[a.length=0];s.curveType==d.CurveType.CRSpline&&a.push(new egret.Point(s.x,s.y));for(var h=1;h<o;h++){var l,u=n[h];s.curveType!=d.CurveType.CRSpline&&((l={}).type=s.curveType,l.ptStart=this._points.length,s.curveType==d.CurveType.Straight?(l.ptCount=2,this._points.push(new egret.Point(s.x,s.y)),this._points.push(new egret.Point(u.x,u.y))):s.curveType==d.CurveType.Bezier?(l.ptCount=3,this._points.push(new egret.Point(s.x,s.y)),this._points.push(new egret.Point(u.x,u.y)),this._points.push(new egret.Point(s.control1_x,s.control1_y))):s.curveType==d.CurveType.CubicBezier&&(l.ptCount=4,this._points.push(new egret.Point(s.x,s.y)),this._points.push(new egret.Point(u.x,u.y)),this._points.push(new egret.Point(s.control1_x,s.control1_y)),this._points.push(new egret.Point(s.control2_x,s.control2_y))),l.length=d.ToolSet.distance(s.x,s.y,u.x,u.y),this._fullLength+=l.length,this._segments.push(l)),u.curveType!=d.CurveType.CRSpline?0<a.length&&(a.push(new egret.Point(u.x,u.y)),this.createSplineSegment()):a.push(new egret.Point(u.x,u.y)),s=u}1<a.length&&this.createSplineSegment()}},e.prototype.createSplineSegment=function(){var t=c,e=t.length;t.splice(0,0,t[0]),t.push(t[e]),t.push(t[e]),e+=3;var i={};i.type=d.CurveType.CRSpline,i.ptStart=this._points.length,i.ptCount=e,this._points=this._points.concat(t),i.length=0;for(var r=1;r<e;r++)i.length+=d.ToolSet.distance(t[r-1].x,t[r-1].y,t[r].x,t[r].y);this._fullLength+=i.length,this._segments.push(i),t.length=0},e.prototype.clear=function(){this._segments.length=0,this._points.length=0},e.prototype.getPointAt=function(t,e){e?e.x=e.y=0:e=new egret.Point,t=d.ToolSet.clamp01(t);var i,r=this._segments.length;if(0==r)return e;if(1==t)return(i=this._segments[r-1]).type==d.CurveType.Straight?(e.x=d.ToolSet.lerp(this._points[i.ptStart].x,this._points[i.ptStart+1].x,t),e.y=d.ToolSet.lerp(this._points[i.ptStart].y,this._points[i.ptStart+1].y,t),e):i.type==d.CurveType.Bezier||i.type==d.CurveType.CubicBezier?this.onBezierCurve(i.ptStart,i.ptCount,t,e):this.onCRSplineCurve(i.ptStart,i.ptCount,t,e);for(var n=t*this._fullLength,o=0;o<r;o++)if((n-=(i=this._segments[o]).length)<0){t=1+n/i.length,i.type==d.CurveType.Straight?(e.x=d.ToolSet.lerp(this._points[i.ptStart].x,this._points[i.ptStart+1].x,t),e.y=d.ToolSet.lerp(this._points[i.ptStart].y,this._points[i.ptStart+1].y,t)):e=i.type==d.CurveType.Bezier||i.type==d.CurveType.CubicBezier?this.onBezierCurve(i.ptStart,i.ptCount,t,e):this.onCRSplineCurve(i.ptStart,i.ptCount,t,e);break}return e},Object.defineProperty(e.prototype,"segmentCount",{get:function(){return this._segments.length},enumerable:!0,configurable:!0}),e.prototype.getAnchorsInSegment=function(t,e){null==e&&(e=new Array);for(var i=this._segments[t],r=0;r<i.ptCount;r++)e.push(new egret.Point(this._points[i.ptStart+r].x,this._points[i.ptStart+r].y));return e},e.prototype.getPointsInSegment=function(t,e,i,r,n,o){null==r&&(r=new Array),o&&!isNaN(o)||(o=.1),n&&n.push(e);var a=this._segments[t];if(a.type==d.CurveType.Straight)r.push(new egret.Point(d.ToolSet.lerp(this._points[a.ptStart].x,this._points[a.ptStart+1].x,e),d.ToolSet.lerp(this._points[a.ptStart].y,this._points[a.ptStart+1].y,e))),r.push(new egret.Point(d.ToolSet.lerp(this._points[a.ptStart].x,this._points[a.ptStart+1].x,i),d.ToolSet.lerp(this._points[a.ptStart].y,this._points[a.ptStart+1].y,i)));else{var s=a.type==d.CurveType.Bezier||a.type==d.CurveType.CubicBezier?this.onBezierCurve:this.onCRSplineCurve;r.push(s.call(this,a.ptStart,a.ptCount,e,new egret.Point));for(var h=Math.min(a.length*o,50),l=0;l<=h;l++){var u=l/h;e<u&&u<i&&(r.push(s.call(this,a.ptStart,a.ptCount,u,new egret.Point)),null!=n&&n.push(u))}r.push(s.call(this,a.ptStart,a.ptCount,i,new egret.Point))}return null!=n&&n.push(i),r},e.prototype.getAllPoints=function(t,e,i){null==t&&(t=new Array),i&&!isNaN(i)||(i=.1);for(var r=this._segments.length,n=0;n<r;n++)this.getPointsInSegment(n,0,1,t,e,i);return t},e.prototype.onCRSplineCurve=function(t,e,i,r){var n=Math.floor(i*(e-4))+t,o=this._points[n].x,a=this._points[n].y,s=this._points[n+1].x,h=this._points[n+1].y,l=this._points[n+2].x,u=this._points[n+2].y,c=this._points[n+3].x,p=this._points[n+3].y,t=1==i?1:d.ToolSet.repeat(i*(e-4),1),n=((2-t)*t-1)*t*.5,i=.5*((3*t-5)*t*t+2),e=((-3*t+4)*t+1)*t*.5,t=(t-1)*t*t*.5;return r.x=o*n+s*i+l*e+c*t,r.y=a*n+h*i+u*e+p*t,r},e.prototype.onBezierCurve=function(t,e,i,r){var n=1-i,o=this._points[t].x,a=this._points[t].y,s=this._points[t+1].x,h=this._points[t+1].y,l=this._points[t+2].x,u=this._points[t+2].y;return 4==e?(e=this._points[t+3].x,t=this._points[t+3].y,r.x=n*n*n*o+3*n*n*i*l+3*n*i*i*e+i*i*i*s,r.y=n*n*n*a+3*n*n*i*u+3*n*i*i*t+i*i*i*h):(r.x=n*n*o+2*n*i*l+i*i*s,r.y=n*n*a+2*n*i*u+i*i*h),r},e);function e(){this._segments=new Array,this._points=new Array}d.GPath=t;var c=new Array}(fgui=fgui||{}),function(t){var s;(e=s=t.CurveType||(t.CurveType={}))[e.CRSpline=0]="CRSpline",e[e.Bezier=1]="Bezier",e[e.CubicBezier=2]="CubicBezier",e[e.Straight=3]="Straight";var e=(h.newPoint=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var r=new h;return r.x=t,r.y=e,r.control1_x=0,r.control1_y=0,r.control2_x=0,r.control2_y=0,r.curveType=i,r},h.newBezierPoint=function(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0);var n=new h;return n.x=t,n.y=e,n.control1_x=i,n.control1_y=r,n.control2_x=0,n.control2_y=0,n.curveType=s.Bezier,n},h.newCubicBezierPoint=function(t,e,i,r,n,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=0);var a=new h;return a.x=t,a.y=e,a.control1_x=i,a.control1_y=r,a.control2_x=n,a.control2_y=o,a.curveType=s.CubicBezier,a},h.prototype.clone=function(){var t=new h;return t.x=this.x,t.y=this.y,t.control1_x=this.control1_x,t.control1_y=this.control1_y,t.control2_x=this.control2_x,t.control2_y=this.control2_y,t.curveType=this.curveType,t},h);function h(){this.x=0,this.y=0,this.control1_x=0,this.control1_y=0,this.control2_x=0,this.control2_y=0,this.curveType=0}t.GPathPoint=e}(fgui=fgui||{}),function(l){var t=(e.to=function(t,e,i){return l.TweenManager.createTween()._to(t,e,i)},e.to2=function(t,e,i,r,n){return l.TweenManager.createTween()._to2(t,e,i,r,n)},e.to3=function(t,e,i,r,n,o,a){return l.TweenManager.createTween()._to3(t,e,i,r,n,o,a)},e.to4=function(t,e,i,r,n,o,a,s,h){return l.TweenManager.createTween()._to4(t,e,i,r,n,o,a,s,h)},e.toColor=function(t,e,i){return l.TweenManager.createTween()._toColor(t,e,i)},e.delayedCall=function(t){return l.TweenManager.createTween().setDelay(t)},e.shake=function(t,e,i,r){return l.TweenManager.createTween()._shake(t,e,i,r)},e.isTweening=function(t,e){return l.TweenManager.isTweening(t,e)},e.kill=function(t,e,i){l.TweenManager.killTweens(t,e,i)},e.getTween=function(t,e){return l.TweenManager.getTween(t,e)},e.catchCallbackExceptions=!0,e);function e(){}l.GTween=t}(fgui=fgui||{}),function(a){var t=(e.prototype.setDelay=function(t){return this._delay=t,this},Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},enumerable:!0,configurable:!0}),e.prototype.setDuration=function(t){return this._duration=t,this},Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),e.prototype.setBreakpoint=function(t){return this._breakpoint=t,this},e.prototype.setEase=function(t){return this._easeType=t,this},e.prototype.setEasePeriod=function(t){return this._easePeriod=t,this},e.prototype.setEaseOvershootOrAmplitude=function(t){return this._easeOvershootOrAmplitude=t,this},e.prototype.setRepeat=function(t,e){return this._repeat=t,this._yoyo=e,this},Object.defineProperty(e.prototype,"repeat",{get:function(){return this._repeat},enumerable:!0,configurable:!0}),e.prototype.setTimeScale=function(t){return this._timeScale=t,this},e.prototype.setSnapping=function(t){return this._snapping=t,this},e.prototype.setTarget=function(t,e){return this._target=t,this._propType=e,this},Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),e.prototype.setUserData=function(t){return this._userData=t,this},Object.defineProperty(e.prototype,"userData",{get:function(){return this._userData},enumerable:!0,configurable:!0}),e.prototype.setPath=function(t){return this._path=t,this},e.prototype.onUpdate=function(t,e){return this._onUpdate=t,this._onUpdateCaller=e,this},e.prototype.onStart=function(t,e){return this._onStart=t,this._onStartCaller=e,this},e.prototype.onComplete=function(t,e){return this._onComplete=t,this._onCompleteCaller=e,this},Object.defineProperty(e.prototype,"startValue",{get:function(){return this._startValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endValue",{get:function(){return this._endValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deltaValue",{get:function(){return this._deltaValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalizedTime",{get:function(){return this._normalizedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){return 0!=this._ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCompleted",{get:function(){return 1==this._ended},enumerable:!0,configurable:!0}),e.prototype.setPaused=function(t){return this._paused=t,this},e.prototype.seek=function(t){if(!this._killed){if(this._elapsedTime=t,this._elapsedTime<this._delay){if(!this._started)return;this._elapsedTime=this._delay}this.update()}},e.prototype.kill=function(t){this._killed||(t&&(0==this._ended&&(0<=this._breakpoint?this._elapsedTime=this._delay+this._breakpoint:0<=this._repeat?this._elapsedTime=this._delay+this._duration*(this._repeat+1):this._elapsedTime=this._delay+2*this._duration,this.update()),this.callCompleteCallback()),this._killed=!0)},e.prototype._to=function(t,e,i){return this._valueSize=1,this._startValue.x=t,this._endValue.x=e,this._value.x=t,this._duration=i,this},e.prototype._to2=function(t,e,i,r,n){return this._valueSize=2,this._startValue.x=t,this._endValue.x=i,this._startValue.y=e,this._endValue.y=r,this._value.x=t,this._value.y=e,this._duration=n,this},e.prototype._to3=function(t,e,i,r,n,o,a){return this._valueSize=3,this._startValue.x=t,this._endValue.x=r,this._startValue.y=e,this._endValue.y=n,this._startValue.z=i,this._endValue.z=o,this._value.x=t,this._value.y=e,this._value.z=i,this._duration=a,this},e.prototype._to4=function(t,e,i,r,n,o,a,s,h){return this._valueSize=4,this._startValue.x=t,this._endValue.x=n,this._startValue.y=e,this._endValue.y=o,this._startValue.z=i,this._endValue.z=a,this._startValue.w=r,this._endValue.w=s,this._value.x=t,this._value.y=e,this._value.z=i,this._value.w=r,this._duration=h,this},e.prototype._toColor=function(t,e,i){return this._valueSize=4,this._startValue.color=t,this._endValue.color=e,this._value.color=t,this._duration=i,this},e.prototype._shake=function(t,e,i,r){return this._valueSize=5,this._startValue.x=t,this._startValue.y=e,this._startValue.w=i,this._duration=r,this},e.prototype._init=function(){this._delay=0,this._duration=0,this._breakpoint=-1,this._easeType=a.EaseType.QuadOut,this._timeScale=1,this._easePeriod=0,this._easeOvershootOrAmplitude=1.70158,this._snapping=!1,this._repeat=0,this._yoyo=!1,this._valueSize=0,this._started=!1,this._paused=!1,this._killed=!1,this._elapsedTime=0,this._normalizedTime=0,this._ended=0},e.prototype._reset=function(){this._target=null,this._propType=null,this._userData=null,this._path=null,this._onStart=this._onUpdate=this._onComplete=null,this._onStartCaller=this._onUpdateCaller=this._onCompleteCaller=null},e.prototype._update=function(t){if(1!=this._timeScale&&(t*=this._timeScale),0!=t){if(0!=this._ended)return this.callCompleteCallback(),void(this._killed=!0);this._elapsedTime+=t,this.update(),0!=this._ended&&(this._killed||(this.callCompleteCallback(),this._killed=!0))}},e.prototype.update=function(){if((this._ended=0)!=this._valueSize){if(!this._started){if(this._elapsedTime<this._delay)return;if(this._started=!0,this.callStartCallback(),this._killed)return}var t,e=!1,i=this._elapsedTime-this._delay;if(0<=this._breakpoint&&i>=this._breakpoint&&(i=this._breakpoint,this._ended=2),0!=this._repeat?(t=Math.floor(i/this._duration),i-=this._duration*t,this._yoyo&&(e=t%2==1),0<this._repeat&&this._repeat-t<0&&(this._yoyo&&(e=this._repeat%2==1),i=this._duration,this._ended=1)):i>=this._duration&&(i=this._duration,this._ended=1),this._normalizedTime=a.evaluateEase(this._easeType,e?this._duration-i:i,this._duration,this._easeOvershootOrAmplitude,this._easePeriod),this._value.setZero(),this._deltaValue.setZero(),5==this._valueSize)0==this._ended?(i=(r=this._startValue.w*(1-this._normalizedTime))*(.5<Math.random()?1:-1),r=r*(.5<Math.random()?1:-1),this._deltaValue.x=i,this._deltaValue.y=r,this._value.x=this._startValue.x+i,this._value.y=this._startValue.y+r):(this._value.x=this._startValue.x,this._value.y=this._startValue.y);else if(this._path){var r=s;this._path.getPointAt(this._normalizedTime,r),this._snapping&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),this._deltaValue.x=r.x-this._value.x,this._deltaValue.y=r.y-this._value.y,this._value.x=r.x,this._value.y=r.y}else for(var n=0;n<this._valueSize;n++){var o=this._startValue.getField(n),o=o+(this._endValue.getField(n)-o)*this._normalizedTime;this._snapping&&(o=Math.round(o)),this._deltaValue.setField(n,o-this._value.getField(n)),this._value.setField(n,o)}if(null!=this._target&&null!=this._propType)if(this._propType instanceof Function)switch(this._valueSize){case 1:this._propType.call(this._target,this._value.x);break;case 2:this._propType.call(this._target,this._value.x,this._value.y);break;case 3:this._propType.call(this._target,this._value.x,this._value.y,this._value.z);break;case 4:this._propType.call(this._target,this._value.x,this._value.y,this._value.z,this._value.w);break;case 5:this._propType.call(this._target,this._value.color);break;case 6:this._propType.call(this._target,this._value.x,this._value.y)}else 5==this._valueSize?this._target[this._propType]=this._value.color:this._target[this._propType]=this._value.x;this.callUpdateCallback()}else this._elapsedTime>=this._delay+this._duration&&(this._ended=1)},e.prototype.callStartCallback=function(){null!=this._onStart&&this._onStart.call(this._onStartCaller,this)},e.prototype.callUpdateCallback=function(){null!=this._onUpdate&&this._onUpdate.call(this._onUpdateCaller,this)},e.prototype.callCompleteCallback=function(){null!=this._onComplete&&this._onComplete.call(this._onCompleteCaller,this)},e);function e(){this._startValue=new a.TweenValue,this._endValue=new a.TweenValue,this._value=new a.TweenValue,this._deltaValue=new a.TweenValue,this._reset()}a.GTweener=t;var s=new egret.Point}(fgui=fgui||{}),function(s){var t=(e.createTween=function(){var t;return i||(egret.startTick(e.update,null),i=!0,c=egret.getTimer()),(t=0<l.length?l.pop():new s.GTweener)._init(),h[u++]=t,u==h.length&&(h.length=h.length+Math.ceil(.5*h.length)),t},e.isTweening=function(t,e){if(null==t)return!1;for(var i=null==e,r=0;r<u;r++){var n=h[r];if(null!=n&&n.target==t&&!n._killed&&(i||n._propType==e))return!0}return!1},e.killTweens=function(t,e,i){if(null==t)return!1;for(var r=!1,n=u,o=null==i,a=0;a<n;a++){var s=h[a];null==s||s.target!=t||s._killed||!o&&s._propType!=i||(s.kill(e),r=!0)}return r},e.getTween=function(t,e){if(null==t)return null;for(var i=u,r=null==e,n=0;n<i;n++){var o=h[n];if(null!=o&&o.target==t&&!o._killed&&(r||o._propType==e))return o}return null},e.update=function(t){var e=t-c;c=t,e/=1e3;for(var i=u,r=-1,n=0;n<i;n++){var o=h[n];null==o?(-1==r&&(r=n),0):o._killed?(o._reset(),l.push(o),h[n]=null,-1==r&&(r=n),0):(o._target instanceof s.GObject&&o._target.isDisposed?o._killed=!0:o._paused||o._update(e),-1!=r&&(h[r]=o,h[n]=null,r++))}if(0<=r){if(u!=i)for(var a=i,i=u-i,n=0;n<i;n++)h[r++]=h[a++];u=r}return!1},e);function e(){}s.TweenManager=t;var i,h=new Array(30),l=new Array,u=0,c=0}(fgui=fgui||{}),function(t){var e=(Object.defineProperty(i.prototype,"color",{get:function(){return(this.w<<24)+(this.x<<16)+(this.y<<8)+this.z},set:function(t){this.x=(16711680&t)>>16,this.y=(65280&t)>>8,this.z=255&t,this.w=(4278190080&t)>>24},enumerable:!0,configurable:!0}),i.prototype.getField=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("Index out of bounds: "+t)}},i.prototype.setField=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("Index out of bounds: "+t)}},i.prototype.setZero=function(){this.x=this.y=this.z=this.w=0},i);function i(){this.x=this.y=this.z=this.w=0}t.TweenValue=e}(fgui=fgui||{}),function(t){var i,e=(i=egret.ByteArray,__extends(r,i),r.prototype.skip=function(t){this.position+=t},r.prototype.readBool=function(){return 1==this.readByte()},r.prototype.readS=function(){var t=this.readUnsignedShort();return 65534==t?null:65533==t?"":this.stringTable[t]},r.prototype.readSArray=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this.readS();return e},r.prototype.writeS=function(t){var e=this.readUnsignedShort();65534!=e&&65533!=e&&(this.stringTable[e]=t)},r.prototype.readColor=function(t){var e=this.readUnsignedByte(),i=this.readUnsignedByte(),r=this.readUnsignedByte(),n=this.readUnsignedByte();return(t?n<<24:0)+(e<<16)+(i<<8)+r},r.prototype.readChar=function(){var t=this.readUnsignedShort();return String.fromCharCode(t)},r.prototype.readBuffer=function(){var t=this.readUnsignedInt(),e=new r(new Uint8Array(this.buffer,this.position,t));return e.stringTable=this.stringTable,e.version=this.version,this.position+=t,e},r.prototype.seek=function(t,e){var i=this.position;if(this.position=t,e<this.readByte()){e=1==this.readByte()?(this.position+=2*e,this.readUnsignedShort()):(this.position+=4*e,this.readUnsignedInt());return 0<e?(this.position=t+e,!0):(this.position=i,!1)}return this.position=i,!1},r);function r(t,e){e=i.call(this,t,e)||this;return e.version=0,e}t.ByteBuffer=e}(fgui=fgui||{}),function(t){var e=(i.prototype.reset=function(){for(var t=0;t<n;t++)this.matrix[t]=r[t]},i.prototype.invert=function(){this.multiplyMatrix([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},i.prototype.adjustColor=function(t,e,i,r){this.adjustHue(r||0),this.adjustContrast(e||0),this.adjustBrightness(t||0),this.adjustSaturation(i||0)},i.prototype.adjustBrightness=function(t){t=255*this.cleanValue(t,1),this.multiplyMatrix([1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0])},i.prototype.adjustContrast=function(t){var e=(t=this.cleanValue(t,1))+1,t=128*(1-e);this.multiplyMatrix([e,0,0,0,t,0,e,0,0,t,0,0,e,0,t,0,0,0,1,0])},i.prototype.adjustSaturation=function(t){t=this.cleanValue(t,1);var e=1-(t+=1),i=e*o,r=e*a,e=e*s;this.multiplyMatrix([i+t,r,e,0,0,i,r+t,e,0,0,i,r,e+t,0,0,0,0,0,1,0])},i.prototype.adjustHue=function(t){t=this.cleanValue(t,1),t*=Math.PI;var e=Math.cos(t),t=Math.sin(t);this.multiplyMatrix([o+e*(1-o)+t*-o,a+e*-a+t*-a,s+e*-s+t*(1-s),0,0,o+e*-o+.143*t,a+e*(1-a)+.14*t,s+e*-s+-.283*t,0,0,o+e*-o+t*-(1-o),a+e*-a+t*a,s+e*(1-s)+t*s,0,0,0,0,0,1,0])},i.prototype.concat=function(t){t.length==n&&this.multiplyMatrix(t)},i.prototype.clone=function(){var t=new i;return t.copyMatrix(this.matrix),t},i.prototype.copyMatrix=function(t){for(var e=n,i=0;i<e;i++)this.matrix[i]=t[i]},i.prototype.multiplyMatrix=function(t){for(var e=[],i=0,r=0;r<4;++r){for(var n=0;n<5;++n)e[i+n]=t[i]*this.matrix[n]+t[i+1]*this.matrix[n+5]+t[i+2]*this.matrix[n+10]+t[i+3]*this.matrix[n+15]+(4==n?t[i+4]:0);i+=5}this.copyMatrix(e)},i.prototype.cleanValue=function(t,e){return Math.min(e,Math.max(-e,t))},i);function i(t,e,i,r){this.matrix=new Array(n),this.reset(),void 0===t&&void 0===e&&void 0===i&&void 0===r||this.adjustColor(t,e,i,r)}t.ColorMatrix=e;var r=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],n=r.length,o=.299,a=.587,s=.114}(fgui=fgui||{}),function(t){var e=(i.prototype.getItem=function(){return this._itemPool.length?this._itemPool.pop():new r},i.prototype.findItem=function(t,e){for(var i=this._items.length,r=0;r<i;r++){var n=this._items[r];if(n.callback==t&&n.thisObj==e)return n}return null},i.prototype.add=function(t,e,i,r,n){var o=this.findItem(i,r);o||((o=this.getItem()).callback=i,o.hasParam=1==i.length,o.thisObj=r,this._items.push(o)),o.delay=t,o.counter=0,o.repeat=e,o.param=n,o.end=!1},i.prototype.callLater=function(t,e,i){this.add(1,1,t,e,i)},i.prototype.callDelay=function(t,e,i,r){this.add(t,1,e,i,r)},i.prototype.exists=function(t,e){return null!=this.findItem(t,e)},i.prototype.remove=function(t,e){t=this.findItem(t,e);t&&(e=this._items.indexOf(t),this._items.splice(e,1),e<this._enumI&&this._enumI--,this._enumCount--,t.reset(),this._itemPool.push(t))},i.prototype.__timer=function(t){for(i.time=t,i.deltaTime=t-this._lastTime,this._lastTime=t,this._enumI=0,this._enumCount=this._items.length;this._enumI<this._enumCount;){var e=this._items[this._enumI];this._enumI++,e.advance(i.deltaTime)&&(e.end&&(this._enumI--,this._enumCount--,this._items.splice(this._enumI,1)),e.hasParam?e.callback.call(e.thisObj,e.param):e.callback.call(e.thisObj),e.end&&(e.reset(),this._itemPool.push(e)))}return!1},i.deltaTime=0,i.time=0,i.inst=new i,i);function i(){this._enumI=0,this._enumCount=0,this._lastTime=0,this._items=new Array,this._itemPool=new Array,this._lastTime=egret.getTimer(),i.time=this._lastTime,egret.startTick(this.__timer,this)}t.GTimers=e;var r=(n.prototype.advance=function(t){return this.counter+=t,this.counter>=this.delay&&(this.counter-=this.delay,this.counter>this.delay&&(this.counter=this.delay),0<this.repeat&&(this.repeat--,0==this.repeat&&(this.end=!0)),!0)},n.prototype.reset=function(){this.callback=null,this.thisObj=null,this.param=null},n);function n(){this.delay=0,this.counter=0,this.repeat=0}}(fgui=fgui||{}),function(t){var e=(i.prototype.onTag_URL=function(t,e,i){return e?"</a>":null!=i?'<a href="'+i+'" target="_blank">':'<a href="'+this.getTagText()+'" target="_blank">'},i.prototype.onTag_IMG=function(t,e,i){if(e)return null;e=this.getTagText(!0);return e?this.defaultImgWidth?'<img src="'+e+'" width="'+this.defaultImgWidth+'" height="'+this.defaultImgHeight+'"/>':'<img src="'+e+'"/>':null},i.prototype.onTag_Simple=function(t,e,i){return e?"</"+t+">":"<"+t+">"},i.prototype.onTag_COLOR=function(t,e,i){return e?"</font>":'<font color="'+i+'">'},i.prototype.onTag_FONT=function(t,e,i){return e?"</font>":'<font face="'+i+'">'},i.prototype.onTag_SIZE=function(t,e,i){return e?"</font>":("normal"==i?i=""+this.normalFontSize:"small"==i?i=""+this.smallFontSize:"large"==i?i=""+this.largeFontSize:i.length&&"+"==i.charAt(0)?i=""+(this.smallFontSize+parseInt(i.substr(1))):i.length&&"-"==i.charAt(0)&&(i=""+(this.smallFontSize-parseInt(i.substr(1)))),'<font size="'+i+'">')},i.prototype.getTagText=function(t){void 0===t&&(t=!1);for(var e,i=this._readPos,r="";-1!=(e=this._text.indexOf("[",i));){if(92!=this._text.charCodeAt(e-1)){r+=this._text.substring(i,e);break}r+=this._text.substring(i,e-1),r+="[",i=e+1}return-1==e?null:(t&&(this._readPos=e),r)},i.prototype.parse=function(t,e){this._text=t;for(var i,r,n,o,a,s=0,h="";-1!=(a=this._text.indexOf("[",s));)if(0<a&&92==this._text.charCodeAt(a-1))h+=this._text.substring(s,a-1),h+="[",s=a+1;else{if(h+=this._text.substring(s,a),s=a,-1==(a=this._text.indexOf("]",s)))break;i="/"==this._text.charAt(s+1),r=this._text.substring(i?s+2:s+1,a),this._readPos=a+1,n=null,-1!=(a=r.indexOf("="))&&(n=r.substring(a+1),r=r.substring(0,a)),r=r.toLowerCase(),null!=(a=this._handlers[r])?e||null!=(o=a.call(this,r,i,n))&&(h+=o):h+=this._text.substring(s,this._readPos),s=this._readPos}return s<this._text.length&&(h+=this._text.substr(s)),this._text=null,h},i.inst=new i,i);function i(){this._readPos=0,this.smallFontSize=12,this.normalFontSize=14,this.largeFontSize=16,this.defaultImgWidth=0,this.defaultImgHeight=0,this._handlers={},this._handlers.url=this.onTag_URL,this._handlers.img=this.onTag_IMG,this._handlers.b=this.onTag_Simple,this._handlers.i=this.onTag_Simple,this._handlers.u=this.onTag_Simple,this._handlers.sup=this.onTag_Simple,this._handlers.sub=this.onTag_Simple,this._handlers.color=this.onTag_COLOR,this._handlers.font=this.onTag_FONT,this._handlers.size=this.onTag_SIZE}t.UBBParser=e}(fgui=fgui||{}),function(l){var t=(e.startsWith=function(t,e,i){return!!t&&(!(t.length<e.length)&&(t=t.substring(0,e.length),i?t.toLowerCase()==e.toLowerCase():t==e))},e.trimRight=function(t){for(var e,i=t.length-1;0<=i&&(" "==(e=t.charAt(i))||"\n"==e||"\r"==e);i--);return t.substring(0,i+1)},e.convertToHtmlColor=function(t,e){var i=e?(t>>24&255).toString(16):"",r=(t>>16&255).toString(16),e=(t>>8&255).toString(16),t=(255&t).toString(16);return"#"+(i=1==i.length?"0"+i:i)+(r=1==r.length?"0"+r:r)+(e=1==e.length?"0"+e:e)+(t=1==t.length?"0"+t:t)},e.convertFromHtmlColor=function(t,e){return t.length<1?0:8==(t="#"==t.charAt(0)?t.substr(1):t).length?(parseInt(t.substr(0,2),16)<<24)+parseInt(t.substr(2),16):e?4278190080+parseInt(t,16):parseInt(t,16)},e.displayObjectToGObject=function(t){for(;t&&!(t instanceof egret.Stage);){if(t.$owner)return l.GObject.cast(t);t=t.parent}return null},e.encodeHTML=function(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"):""},e.clamp=function(t,e,i){return t<e?t=e:i<t&&(t=i),t},e.clamp01=function(t){return 1<t?t=1:t<0&&(t=0),t},e.lerp=function(t,e,i){return t+i*(e-t)},e.repeat=function(t,e){return t-Math.floor(t/e)*e},e.distance=function(t,e,i,r){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-r,2))},e.fillPath=function(t,e,i,r){var n=e.length;t.moveTo(e[0]+i,e[1]+r);for(var o=2;o<n;o+=2)t.lineTo(e[o]+i,e[o+1]+r);t.lineTo(e[0]+i,e[1]+r)},e.setColorFilter=function(t,e){var i,r=t.$_colorFilter_,n=t.filters,o="boolean"==typeof e?(i=r?r.$_color_:null,e):(i=16777215==e?null:e,!!r&&r.$_grayed_);if(i||0===i||o){r||(r=new egret.ColorMatrixFilter,t.$_colorFilter_=r),n?-1==n.indexOf(r)&&n.push(r):n=[r],t.filters=n,r.$_color_=i,r.$_grayed_=o;var a=r.matrix;if(o)for(var s=0;s<20;s++)a[s]=u[s];else if(i instanceof Array)!function(t,e,i,r,n){n=n||new Array(l.ColorMatrix.length);c.reset(),c.adjustColor(t,e,i,r),c.matrix.forEach(function(t,e){return n[e]=t})}(i[0],i[1],i[2],i[3],a);else{for(var h=0;h<20;h++)a[h]=0==h||6==h||12==h||18==h?1:0;a[0]=(e>>16&255)/255,a[6]=(e>>8&255)/255,a[12]=(255&e)/255}r.matrix=a}else n&&r&&(-1!=(r=n.indexOf(r))&&(n.splice(r,1),0<n.length?t.filters=n:t.filters=null))},e);function e(){}l.ToolSet=t;var u=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],c=new l.ColorMatrix}(fgui=fgui||{}),window.fairygui=fgui;var __awaiter=this&&this.__awaiter||function(t,a,s,h){return new(s=s||Promise)(function(i,e){function r(t){try{o(h.next(t))}catch(t){e(t)}}function n(t){try{o(h.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?i(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(r,n)}o((h=h.apply(t,a||[])).next())})},__generator=this&&this.__generator||function(i,r){var n,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(a=2&e[0]?o.return:e[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,e[1])).done)return a;switch(o=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=r.call(i,s)}catch(t){e=[6,t],o=0}finally{n=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},__spreadArray=this&&this.__spreadArray||function(t,e){for(var i=0,r=e.length,n=t.length;i<r;i++,n++)t[n]=e[i];return t},__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){t.promisify=function(r){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Promise(function(e,i){r.apply(void 0,__spreadArray(__spreadArray([],t),[function(t){t?i(t):e(null)}]))})}},t.sleep=function(i,r){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,e){try{egret.setTimeout(function(){r&&r(),t(null)},null,i)}catch(t){e(t)}})]})})}}(god=god||{}),function(t){var o={},a={},l=Math.pow,i=4294967296,r=i*i,n=r/2,e=(s.isLong=function(t){return!0===(t&&t.__isLong__)},s.fromNumber=function(t,e){if(isNaN(t))return e?h:_;if(e){if(t<0)return h;if(r<=t)return v}else{if(t<=-n)return b;if(n<=t+1)return m}return t<0?d(-t,e).neg():p(t%i|0,t/i|0,e)},s.fromInt=function(t,e){var i,r,n;return e?(n=0<=(t>>>=0)&&t<256)&&(r=a[t])?r:(i=p(t,(0|t)<0?-1:0,!0),n&&(a[t]=i),i):(n=-128<=(t|=0)&&t<128)&&(r=o[t])?r:(i=p(t,t<0?-1:0,!1),n&&(o[t]=i),i)},s.fromValue=function(t,e){return"number"==typeof t?d(t,e):"string"==typeof t?u(t,e):p(t.low,t.high,"boolean"==typeof e?e:t.unsigned)},s.fromBits=function(t,e,i){return new s(t,e,i)},s.fromString=function(t,e,i){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return _;if(e="number"==typeof e?(i=e,!1):!!e,(i=i||10)<2||36<i)throw RangeError("radix");var r;if(0<(r=t.indexOf("-")))throw Error("interior hyphen");if(0===r)return u(t.substring(1),e,i).neg();for(var n=d(l(i,8)),o=_,a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a),h=parseInt(t.substring(a,a+s),i);o=s<8?(s=d(l(i,s)),o.mul(s).add(d(h))):(o=o.mul(n)).add(d(h))}return o.unsigned=e,o},s.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},s.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*i+(this.low>>>0):this.high*i+(this.low>>>0)},s.prototype.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(b)){var e=d(t),i=this.div(e),e=i.mul(e).sub(this);return i.toString(t)+e.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var r=d(l(t,6),this.unsigned),n=this,o="";;){var a=n.div(r),s=(n.sub(a.mul(r)).toInt()>>>0).toString(t);if((n=a).isZero())return s+o;for(;s.length<6;)s="0"+s;o=""+s+o}},s.prototype.getHighBitsgetHighBits=function(){return this.high},s.prototype.getHighBitsUnsigned=function(){return this.high>>>0},s.prototype.getLowBits=function(){return this.low},s.prototype.getLowBitsUnsigned=function(){return this.low>>>0},s.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(b)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;0<e&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},s.prototype.isZero=function(){return 0===this.high&&0===this.low},s.prototype.isNegative=function(){return!this.unsigned&&this.high<0},s.prototype.isPositive=function(){return this.unsigned||0<=this.high},s.prototype.isOdd=function(){return 1==(1&this.low)},s.prototype.isEven=function(){return 0==(1&this.low)},s.prototype.equals=function(t){return T(t)||(t=x(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},s.prototype.notEquals=function(t){return!this.eq(t)},s.prototype.lessThan=function(t){return this.comp(t)<0},s.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},s.prototype.greaterThan=function(t){return 0<this.comp(t)},s.prototype.greaterThanOrEqual=function(t){return 0<=this.comp(t)},s.prototype.compare=function(t){if(T(t)||(t=x(t)),this.eq(t))return 0;var e=this.isNegative(),i=t.isNegative();return e&&!i?-1:!e&&i?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},s.prototype.negate=function(){return!this.unsigned&&this.eq(b)?b:this.not().add(c)},s.prototype.add=function(t){T(t)||(t=x(t));var e=this.high>>>16,i=65535&this.high,r=this.low>>>16,n=65535&this.low,o=t.high>>>16,a=65535&t.high,s=t.low>>>16,h=0,l=0,u=0,c=0;return u+=(c+=n+(65535&t.low))>>>16,l+=(u+=r+s)>>>16,h+=(l+=i+a)>>>16,h+=e+o,p((u&=65535)<<16|(c&=65535),(h&=65535)<<16|(l&=65535),this.unsigned)},s.prototype.subtract=function(t){return T(t)||(t=x(t)),this.add(t.neg())},s.prototype.multiply=function(t){if(this.isZero())return _;if((t=!T(t)?x(t):t).isZero())return _;if(this.eq(b))return t.isOdd()?b:_;if(t.eq(b))return this.isOdd()?b:_;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(f)&&t.lt(f))return d(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,i=65535&this.high,r=this.low>>>16,n=65535&this.low,o=t.high>>>16,a=65535&t.high,s=t.low>>>16,h=65535&t.low,l=0,u=0,c=0,t=0;return c+=(t+=n*h)>>>16,u+=(c+=r*h)>>>16,c&=65535,u+=(c+=n*s)>>>16,l+=(u+=i*h)>>>16,u&=65535,l+=(u+=r*s)>>>16,u&=65535,l+=(u+=n*a)>>>16,l+=e*h+i*s+r*a+n*o,p((c&=65535)<<16|(t&=65535),(l&=65535)<<16|(u&=65535),this.unsigned)},s.prototype.divide=function(t){if((t=!T(t)?x(t):t).isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?h:_;var e,i,r;if(this.unsigned){if((t=!t.unsigned?t.toUnsigned():t).gt(this))return h;if(t.gt(this.shru(1)))return g;i=h}else{if(this.eq(b))return t.eq(c)||t.eq(y)?b:t.eq(b)?c:(r=this.shr(1).div(t).shl(1)).eq(_)?t.isNegative()?c:y:(e=this.sub(t.mul(r)),i=r.add(e.div(t)));else if(t.eq(b))return this.unsigned?h:_;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=_}for(e=this;e.gte(t);){r=Math.max(1,Math.floor(e.toNumber()/t.toNumber()));for(var n=Math.ceil(Math.log(r)/Math.LN2),o=n<=48?1:l(2,n-48),a=d(r),s=a.mul(t);s.isNegative()||s.gt(e);)s=(a=d(r-=o,this.unsigned)).mul(t);a.isZero()&&(a=c),i=i.add(a),e=e.sub(s)}return i},s.prototype.modulo=function(t){return T(t)||(t=x(t)),this.sub(this.div(t).mul(t))},s.prototype.not=function(){return p(~this.low,~this.high,this.unsigned)},s.prototype.and=function(t){return T(t)||(t=x(t)),p(this.low&t.low,this.high&t.high,this.unsigned)},s.prototype.or=function(t){return T(t)||(t=x(t)),p(this.low|t.low,this.high|t.high,this.unsigned)},s.prototype.xor=function(t){return T(t)||(t=x(t)),p(this.low^t.low,this.high^t.high,this.unsigned)},s.prototype.shiftLeft=function(t){return T(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?p(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):p(0,this.low<<t-32,this.unsigned)},s.prototype.shiftRight=function(t){return T(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?p(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):p(this.high>>t-32,0<=this.high?0:-1,this.unsigned)},s.prototype.shiftRightUnsigned=function(t){return T(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?p(this.low>>>t|this.high<<32-t,this.high>>>t,this.unsigned):p(32===t?this.high:this.high>>>t-32,0,this.unsigned)},s.prototype.rotateLeft=function(t){var e;return T(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?p(this.high,this.low,this.unsigned):t<32?p(this.low<<t|this.high>>>(e=32-t),this.high<<t|this.low>>>e,this.unsigned):p(this.high<<(t-=32)|this.low>>>(e=32-t),this.low<<t|this.high>>>e,this.unsigned)},s.prototype.rotateRight=function(t){var e;return T(t)&&(t=t.toInt()),0==(t&=63)?this:32===t?p(this.high,this.low,this.unsigned):t<32?p(this.high<<(e=32-t)|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned):p(this.low<<(e=32-(t-=32))|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)},s.prototype.toSigned=function(){return this.unsigned?p(this.low,this.high,!1):this},s.prototype.toUnsigned=function(){return this.unsigned?this:p(this.low,this.high,!0)},s.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},s.prototype.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},s.prototype.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},s.prototype.fromBytes=function(t,e,i){return i?s.fromBytesLE(t,e):s.fromBytesBE(t,e)},s.fromBytesLE=function(t,e){return new s(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},s.fromBytesBE=function(t,e){return new s(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)},s);function s(t,e,i){this.__isLong__=!0,this.low=0|t,this.high=0|e,this.unsigned=!!i}(t.Long=e).prototype.eqz=e.prototype.isZero,e.prototype.eq=e.prototype.equals,e.prototype.neq=e.prototype.notEquals,e.prototype.ne=e.prototype.notEquals,e.prototype.lt=e.prototype.lessThan,e.prototype.lte=e.prototype.lessThanOrEqual,e.prototype.le=e.prototype.lessThanOrEqual,e.prototype.gt=e.prototype.greaterThan,e.prototype.gte=e.prototype.greaterThanOrEqual,e.prototype.ge=e.prototype.greaterThanOrEqual,e.prototype.comp=e.prototype.compare,e.prototype.neg=e.prototype.negate,e.prototype.sub=e.prototype.subtract,e.prototype.mul=e.prototype.multiply,e.prototype.div=e.prototype.divide,e.prototype.mod=e.prototype.modulo,e.prototype.rem=e.prototype.modulo,e.prototype.shl=e.prototype.shiftLeft,e.prototype.shr=e.prototype.shiftRight,e.prototype.shru=e.prototype.shiftRightUnsigned,e.prototype.shr_u=e.prototype.shiftRightUnsigned,e.prototype.rotl=e.prototype.rotateLeft,e.prototype.rotr=e.prototype.rotateRight,e.prototype.eqz=e.prototype.isZero,e.prototype.eq=e.prototype.equals;var p=e.fromBits,d=e.fromNumber,u=e.fromString,f=e.fromInt(1<<24),_=e.fromInt(0),h=e.fromInt(0,!0),c=e.fromInt(1),g=e.fromInt(1,!0),y=e.fromInt(-1),m=p(-1,2147483647,!1);e.MAX_VALUE=m;var v=p(-1,-1,!0);e.MAX_UNSIGNED_VALUE=v;var b=p(0,-2147483648,!1);e.MIN_VALUE=b;var T=e.isLong,x=e.fromValue}(god=god||{}),function(r){var t=(Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return Object.keys(this.dic)},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return null!=this.dic[t]},e.prototype.get=function(t){return this.dic[t]},e.prototype.add=function(t,e){this.dic[t]?r.getLogger().error("ArrayMap.add \u91cd\u590d\u7684\u9879,key:",t):(this.list.push(e),this.dic[t]=e)},e.prototype.set=function(t,e){var i;this.dic[t]?(i=this.dic[t],i=this.list.indexOf(i),this.list[i]=e):this.list.push(e),this.dic[t]=e},e.prototype.delete=function(t){var e,i;return null!=this.dic[t]&&(e=this.dic[t],0<=(i=this.list.indexOf(e))?(this.list.splice(i,1),delete this.dic[t]):r.getLogger().error("ArrayMap.delete \u6570\u7ec4\u91cc\u9762\u4e0d\u5b58\u5728,key:",t)),e},e.prototype.clear=function(){this.list=[],this.dic={}},e);function e(){this.list=[],this.dic={}}r.ArrayMap=t,r.newArryMap=function(){return new t}}(god=god||{}),window.bigInt=function(a){"use strict";var y=1e7,l=7,e=9007199254740992,i=h(e),c="0123456789abcdefghijklmnopqrstuvwxyz",u="function"==typeof BigInt;function p(t,e,i,r){return void 0===t?p[0]:void 0!==e&&(10!=+e||i)?z(t,e,i,r):q(t)}function d(t,e){this.value=t,this.sign=e,this.isSmall=!1}function f(t){this.value=t,this.sign=t<0,this.isSmall=!0}function _(t){this.value=t}function g(t){return-e<t&&t<e}function h(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function m(t){v(t);var e=t.length;if(e<4&&I(t,i)<0)switch(e){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*y;default:return t[0]+(t[1]+t[2]*y)*y}return t}function v(t){for(var e=t.length;0===t[--e];);t.length=e+1}function b(t){for(var e=new Array(t),i=-1;++i<t;)e[i]=0;return e}function T(t){return 0<t?Math.floor(t):Math.ceil(t)}function r(t,e){for(var i,r=t.length,n=e.length,o=new Array(r),a=0,s=y,h=0;h<n;h++)i=t[h]+e[h]+a,o[h]=i-(a=s<=i?1:0)*s;for(;h<r;)i=t[h]+a,o[h++]=i-(a=i===s?1:0)*s;return 0<a&&o.push(a),o}function x(t,e){return t.length>=e.length?r(t,e):r(e,t)}function n(t,e){for(var i,r=t.length,n=new Array(r),o=y,a=0;a<r;a++)i=t[a]-o+e,e=Math.floor(i/o),n[a]=i-e*o,e+=1;for(;0<e;)n[a++]=e%o,e=Math.floor(e/o);return n}function w(t,e){for(var i,r=t.length,n=e.length,o=new Array(r),a=0,s=y,h=0;h<n;h++)a=(i=t[h]-a-e[h])<0?(i+=s,1):0,o[h]=i;for(h=n;h<r;h++){if(!((i=t[h]-a)<0)){o[h++]=i;break}i+=s,o[h]=i}for(;h<r;h++)o[h]=t[h];return v(o),o}function o(t,e,i){for(var r,n=t.length,o=new Array(n),a=-e,s=y,h=0;h<n;h++)r=t[h]+a,a=Math.floor(r/s),o[h]=(r%=s)<0?r+s:r;return"number"==typeof(o=m(o))?new f(o=i?-o:o):new d(o,i)}function S(t,e){for(var i,r,n=t.length,o=e.length,a=b(n+o),s=y,h=0;h<n;++h)for(var l=t[h],u=0;u<o;++u)i=l*e[u]+a[h+u],r=Math.floor(i/s),a[h+u]=i-r*s,a[h+u+1]+=r;return v(a),a}function C(t,e){for(var i,r=t.length,n=new Array(r),o=y,a=0,s=0;s<r;s++)i=t[s]*e+a,a=Math.floor(i/o),n[s]=i-a*o;for(;0<a;)n[s++]=a%o,a=Math.floor(a/o);return n}function E(t,e){for(var i=[];0<e--;)i.push(0);return i.concat(t)}function s(t,e,i){return new d(t<y?C(e,t):S(e,h(t)),i)}function P(t){for(var e,i=t.length,r=b(i+i),n=y,o=0;o<i;o++){for(var a,s=0-(a=t[o])*a,h=o;h<i;h++)e=a*t[h]*2+r[o+h]+s,s=Math.floor(e/n),r[o+h]=e-s*n;r[o+i]=s}return v(r),r}function D(t,e){for(var i,r=t.length,n=b(r),o=y,a=0,s=r-1;0<=s;--s)a=(i=a*o+t[s])-(i=T(i/e))*e,n[s]=0|i;return[n,0|a]}function O(t,e){var i=q(e);if(u)return[new _(t.value/i.value),new _(t.value%i.value)];var r=t.value,n=i.value;if(0===n)throw new Error("Cannot divide by zero");if(t.isSmall)return i.isSmall?[new f(T(r/n)),new f(r%n)]:[p[0],t];if(i.isSmall){if(1===n)return[t,p[0]];if(-1==n)return[t.negate(),p[0]];var o=Math.abs(n);if(o<y){var a=m((s=D(r,o))[0]),e=s[1];return t.sign&&(e=-e),"number"==typeof a?[new f(a=t.sign!==i.sign?-a:a),new f(e)]:[new d(a,t.sign!==i.sign),new f(e)]}n=h(o)}o=I(r,n);if(-1===o)return[p[0],t];if(0===o)return[p[t.sign===i.sign?1:-1],p[0]];a=(s=(r.length+n.length<=200?function(t,e){var i,r,n,o,a,s,h,l=t.length,u=e.length,c=y,p=b(e.length),d=e[u-1],f=Math.ceil(c/(2*d)),_=C(t,f),g=C(e,f);for(_.length<=l&&_.push(0),g.push(0),d=g[u-1],r=l-u;0<=r;r--){for(i=c-1,_[r+u]!==d&&(i=Math.floor((_[r+u]*c+_[r+u-1])/d)),s=g.length,a=o=n=0;a<s;a++)n+=i*g[a],h=Math.floor(n/c),o+=_[r+a]-(n-h*c),n=h,o=o<0?(_[r+a]=o+c,-1):(_[r+a]=o,0);for(;0!==o;){for(--i,a=n=0;a<s;a++)n=(n+=_[r+a]-c+g[a])<0?(_[r+a]=n+c,0):(_[r+a]=n,1);o+=n}p[r]=i}return _=D(_,f)[0],[m(p),m(_)]}:function(t,e){for(var i,r,n,o,a,s=t.length,h=e.length,l=[],u=[],c=y;s;)if(u.unshift(t[--s]),v(u),I(u,e)<0)l.push(0);else{for(n=u[(r=u.length)-1]*c+u[r-2],o=e[h-1]*c+e[h-2],h<r&&(n=(n+1)*c),i=Math.ceil(n/o);!(I(a=C(e,i),u)<=0)&&--i;);l.push(i),u=w(u,a)}return l.reverse(),[m(l),m(u)]})(r,n))[0];var i=t.sign!==i.sign,s=s[1],t=t.sign;return[a="number"==typeof a?new f(a=i?-a:a):new d(a,i),s="number"==typeof s?new f(s=t?-s:s):new d(s,t)]}function I(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var i=t.length-1;0<=i;i--)if(t[i]!==e[i])return t[i]>e[i]?1:-1;return 0}function $(t){t=t.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function A(t,e){for(var i,r,n,o=t.prev(),a=o,s=0;a.isEven();)a=a.divide(2),s++;t:for(r=0;r<e.length;r++)if(!t.lesser(e[r])&&!(n=bigInt(e[r]).modPow(a,t)).isUnit()&&!n.equals(o)){for(i=s-1;0!=i;i--){if((n=n.square().mod(t)).isUnit())return!1;if(n.equals(o))continue t}return!1}return!0}d.prototype=Object.create(p.prototype),f.prototype=Object.create(p.prototype),_.prototype=Object.create(p.prototype),d.prototype.plus=d.prototype.add=function(t){var e=q(t);if(this.sign!==e.sign)return this.subtract(e.negate());var i=this.value,t=e.value;return e.isSmall?new d(n(i,Math.abs(t)),this.sign):new d(x(i,t),this.sign)},f.prototype.add=function(t){var e=q(t),i=this.value;if(i<0!==e.sign)return this.subtract(e.negate());t=e.value;if(e.isSmall){if(g(i+t))return new f(i+t);t=h(Math.abs(t))}return new d(n(t,Math.abs(i)),i<0)},f.prototype.plus=f.prototype.add,_.prototype.plus=_.prototype.add=function(t){return new _(this.value+q(t).value)},d.prototype.subtract=function(t){var e=q(t);if(this.sign!==e.sign)return this.add(e.negate());var i,r=this.value,t=e.value;return e.isSmall?o(r,Math.abs(t),this.sign):(e=r,r=t,t=this.sign,0<=I(e,r)?i=w(e,r):(i=w(r,e),t=!t),"number"==typeof(i=m(i))?new f(i=t?-i:i):new d(i,t))},d.prototype.minus=d.prototype.subtract,f.prototype.minus=f.prototype.subtract=function(t){var e=q(t),i=this.value;if(i<0!==e.sign)return this.add(e.negate());t=e.value;return e.isSmall?new f(i-t):o(t,Math.abs(i),0<=i)},_.prototype.minus=_.prototype.subtract=function(t){return new _(this.value-q(t).value)},d.prototype.negate=function(){return new d(this.value,!this.sign)},f.prototype.negate=function(){var t=this.sign,e=new f(-this.value);return e.sign=!t,e},_.prototype.negate=function(){return new _(-this.value)},d.prototype.abs=function(){return new d(this.value,!1)},f.prototype.abs=function(){return new f(Math.abs(this.value))},_.prototype.abs=function(){return new _(0<=this.value?this.value:-this.value)},d.prototype.multiply=function(t){var e,i=q(t),r=this.value,n=i.value,t=this.sign!==i.sign;if(i.isSmall){if(0===n)return p[0];if(1===n)return this;if(-1===n)return this.negate();if((e=Math.abs(n))<y)return new d(C(r,e),t);n=h(e)}return i=r.length,e=n.length,new d((0<-.012*i-.012*e+15e-6*i*e?function t(e,i){if((r=Math.max(e.length,i.length))<=30)return S(e,i);var r=Math.ceil(r/2),n=e.slice(r),o=e.slice(0,r),a=i.slice(r),s=i.slice(0,r),e=t(o,s),i=t(n,a),a=t(x(o,n),x(s,a)),r=x(x(e,E(w(w(a,e),i),r)),E(i,2*r));return v(r),r}:S)(r,n),t)},d.prototype.times=d.prototype.multiply,f.prototype._multiplyBySmall=function(t){return g(t.value*this.value)?new f(t.value*this.value):s(Math.abs(t.value),h(Math.abs(this.value)),this.sign!==t.sign)},d.prototype._multiplyBySmall=function(t){return 0===t.value?p[0]:1===t.value?this:-1===t.value?this.negate():s(Math.abs(t.value),this.value,this.sign!==t.sign)},f.prototype.times=f.prototype.multiply=function(t){return q(t)._multiplyBySmall(this)},_.prototype.times=_.prototype.multiply=function(t){return new _(this.value*q(t).value)},d.prototype.square=function(){return new d(P(this.value),!1)},f.prototype.square=function(){var t=this.value*this.value;return g(t)?new f(t):new d(P(h(Math.abs(this.value))),!1)},_.prototype.square=function(t){return new _(this.value*this.value)},_.prototype.divmod=f.prototype.divmod=d.prototype.divmod=function(t){t=O(this,t);return{quotient:t[0],remainder:t[1]}},d.prototype.divide=function(t){return t||(console.error("divide \u4e0d\u5e94\u8be5\u4f200\u6216\u8005undefined: v=>",t),t=1),O(this,t)[0]},_.prototype.over=_.prototype.divide=function(t){return t||(console.error("divide \u4e0d\u5e94\u8be5\u4f200\u6216\u8005undefined: v=>",t),t=1),new _(this.value/q(t).value)},f.prototype.over=f.prototype.divide=d.prototype.over=d.prototype.divide,d.prototype.mod=function(t){return O(this,t)[1]},_.prototype.mod=_.prototype.remainder=function(t){return new _(this.value%q(t).value)},f.prototype.remainder=f.prototype.mod=d.prototype.remainder=d.prototype.mod,d.prototype.pow=function(t){var e,i,r,n=q(t),t=this.value,o=n.value;if(0===o)return p[1];if(0===t)return p[0];if(1===t)return p[1];if(-1===t)return n.isEven()?p[1]:p[-1];if(n.sign)return p[0];if(!n.isSmall)throw new Error("The exponent "+n.toString()+" is too large.");if(this.isSmall&&g(e=Math.pow(t,o)))return new f(T(e));for(i=this,r=p[1];;){if(!0&o&&(r=r.times(i),--o),0===o)break;o/=2,i=i.square()}return r},f.prototype.pow=d.prototype.pow,_.prototype.pow=function(t){var e=q(t),t=this.value,i=e.value,r=BigInt(0),n=BigInt(1),o=BigInt(2);if(i===r)return p[1];if(t===r)return p[0];if(t===n)return p[1];if(t===BigInt(-1))return e.isEven()?p[1]:p[-1];if(e.isNegative())return new _(r);for(var a=this,s=p[1];;){if((i&n)===n&&(s=s.times(a),--i),i===r)break;i/=o,a=a.square()}return s},d.prototype.modPow=function(t,e){if(t=q(t),(e=q(e)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var i=p[1],r=this.mod(e);t.isPositive();){if(r.isZero())return p[0];t.isOdd()&&(i=i.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return i},_.prototype.modPow=f.prototype.modPow=d.prototype.modPow,d.prototype.compareAbs=function(t){var e=q(t),i=this.value,t=e.value;return e.isSmall?1:I(i,t)},f.prototype.compareAbs=function(t){var e=q(t),i=Math.abs(this.value),t=e.value;return e.isSmall?i===(t=Math.abs(t))?0:t<i?1:-1:-1},_.prototype.compareAbs=function(t){var e=this.value,t=q(t).value;return(e=0<=e?e:-e)===(t=0<=t?t:-t)?0:t<e?1:-1},d.prototype.compareTo=d.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=q(t),i=this.value,t=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:I(i,t)*(this.sign?-1:1)},f.prototype.compareTo=f.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=q(t),i=this.value,t=e.value;return e.isSmall?i==t?0:t<i?1:-1:i<0!==e.sign?i<0?-1:1:i<0?1:-1},_.prototype.compareTo=_.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,t=q(t).value;return e===t?0:t<e?1:-1},_.prototype.eq=_.prototype.equals=f.prototype.eq=f.prototype.equals=d.prototype.eq=d.prototype.equals=function(t){return 0===this.compare(t)},_.prototype.neq=_.prototype.notEquals=f.prototype.neq=f.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=function(t){return 0!==this.compare(t)},_.prototype.gt=_.prototype.greater=f.prototype.gt=f.prototype.greater=d.prototype.gt=d.prototype.greater=function(t){return 0<this.compare(t)},_.prototype.lt=_.prototype.lesser=f.prototype.lt=f.prototype.lesser=d.prototype.lt=d.prototype.lesser=function(t){return this.compare(t)<0},_.prototype.geq=_.prototype.greaterOrEquals=f.prototype.geq=f.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=function(t){return 0<=this.compare(t)},_.prototype.leq=_.prototype.lesserOrEquals=f.prototype.leq=f.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},d.prototype.isEven=function(){return 0==(1&this.value[0])},f.prototype.isEven=function(){return 0==(1&this.value)},_.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},d.prototype.isOdd=function(){return 1==(1&this.value[0])},f.prototype.isOdd=function(){return 1==(1&this.value)},_.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},d.prototype.isPositive=function(){return!this.sign},_.prototype.isPositive=f.prototype.isPositive=function(){return 0<this.value},d.prototype.isNegative=function(){return this.sign},_.prototype.isNegative=f.prototype.isNegative=function(){return this.value<0},d.prototype.isUnit=function(){return!1},f.prototype.isUnit=function(){return 1===Math.abs(this.value)},_.prototype.isUnit=function(){return this.abs().value===BigInt(1)},d.prototype.isZero=function(){return!1},f.prototype.isZero=function(){return 0===this.value},_.prototype.isZero=function(){return this.value===BigInt(0)},_.prototype.isDivisibleBy=f.prototype.isDivisibleBy=d.prototype.isDivisibleBy=function(t){t=q(t);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},_.prototype.isPrime=f.prototype.isPrime=d.prototype.isPrime=function(t){var e=$(this);if(e!==a)return e;var i=this.abs(),e=i.bitLength();if(e<=64)return A(i,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var e=Math.log(2)*e.toJSNumber(),r=Math.ceil(!0===t?2*Math.pow(e,2):e),n=[],o=0;o<r;o++)n.push(bigInt(o+2));return A(i,n)},_.prototype.isProbablePrime=f.prototype.isProbablePrime=d.prototype.isProbablePrime=function(t){var e=$(this);if(e!==a)return e;for(var i=this.abs(),r=t===a?5:t,n=[],o=0;o<r;o++)n.push(bigInt.randBetween(2,i.minus(2)));return A(i,n)},d.prototype.modInv=function(t){for(var e,i,r,n=bigInt.zero,o=bigInt.one,a=q(t),s=this.abs();!s.isZero();)e=a.divide(s),i=n,r=a,n=o,a=s,o=i.subtract(e.multiply(o)),s=r.subtract(e.multiply(s));if(!a.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===n.compare(0)&&(n=n.add(t)),this.isNegative()?n.negate():n},_.prototype.modInv=f.prototype.modInv=d.prototype.modInv,d.prototype.next=function(){var t=this.value;return this.sign?o(t,1,this.sign):new d(n(t,1),this.sign)},f.prototype.next=function(){var t=this.value;return t+1<e?new f(t+1):new d(i,!1)},_.prototype.next=function(){return new _(this.value+BigInt(1))},d.prototype.prev=function(){var t=this.value;return this.sign?new d(n(t,1),!0):o(t,1,this.sign)},f.prototype.prev=function(){var t=this.value;return-e<t-1?new f(t-1):new d(i,!0)},_.prototype.prev=function(){return new _(this.value-BigInt(1))};for(var R=[1];2*R[R.length-1]<=y;)R.push(2*R[R.length-1]);var B=R.length,M=R[B-1];function L(t){return Math.abs(t)<=y}function F(t,e,i){e=q(e);for(var r=t.isNegative(),n=e.isNegative(),o=r?t.not():t,a=n?e.not():e,s=0,h=0,l=null,u=null,c=[];!o.isZero()||!a.isZero();)s=(l=O(o,M))[1].toJSNumber(),r&&(s=M-1-s),h=(u=O(a,M))[1].toJSNumber(),o=l[0],a=u[0],c.push(i(s,h=n?M-1-h:h));for(var p=0!==i(r?1:0,n?1:0)?bigInt(-1):bigInt(0),d=c.length-1;0<=d;--d)p=p.multiply(M).add(bigInt(c[d]));return p}d.prototype.shiftLeft=function(t){var e=q(t).toJSNumber();if(!L(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var i=this;if(i.isZero())return i;for(;B<=e;)i=i.multiply(M),e-=B-1;return i.multiply(R[e])},_.prototype.shiftLeft=f.prototype.shiftLeft=d.prototype.shiftLeft,d.prototype.shiftRight=function(t){var e,i=q(t).toJSNumber();if(!L(i))throw new Error(String(i)+" is too large for shifting.");if(i<0)return this.shiftLeft(-i);for(var r=this;B<=i;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(e=O(r,M))[1].isNegative()?e[0].prev():e[0],i-=B-1}return(e=O(r,R[i]))[1].isNegative()?e[0].prev():e[0]},_.prototype.shiftRight=f.prototype.shiftRight=d.prototype.shiftRight,_.prototype.not=f.prototype.not=d.prototype.not=function(){return this.negate().prev()},_.prototype.and=f.prototype.and=d.prototype.and=function(t){return F(this,t,function(t,e){return t&e})},_.prototype.or=f.prototype.or=d.prototype.or=function(t){return F(this,t,function(t,e){return t|e})},_.prototype.xor=f.prototype.xor=d.prototype.xor=function(t){return F(this,t,function(t,e){return t^e})};var k=1<<30,j=(y&-y)*(y&-y)|k;function N(t){t=t.value,t="number"==typeof t?t|k:"bigint"==typeof t?t|BigInt(k):t[0]+t[1]*y|j;return t&-t}function G(t,e){return t=q(t),e=q(e),t.greater(e)?t:e}function U(t,e){return t=q(t),e=q(e),t.lesser(e)?t:e}function H(t,e){if(t=q(t).abs(),e=q(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var i,r,n=p[1];t.isEven()&&e.isEven();)i=U(N(t),N(e)),t=t.divide(i),e=e.divide(i),n=n.multiply(i);for(;t.isEven();)t=t.divide(N(t));do{for(;e.isEven();)e=e.divide(N(e))}while(t.greater(e)&&(r=e,e=t,t=r),!(e=e.subtract(t)).isZero());return n.isUnit()?t:t.multiply(n)}d.prototype.bitLength=function(){var t=this;return 0===(t=t.compareTo(bigInt(0))<0?t.negate().subtract(bigInt(1)):t).compareTo(bigInt(0))?bigInt(0):bigInt(function t(e,i){if(i.compareTo(e)<=0){var r=(n=t(e,i.square(i))).p,n=n.e;return(i=r.multiply(i)).compareTo(e)<=0?{p:i,e:2*n+1}:{p:r,e:2*n}}return{p:bigInt(1),e:0}}(t,bigInt(2)).e).add(bigInt(1))},_.prototype.bitLength=f.prototype.bitLength=d.prototype.bitLength;var z=function(t,e,i,r){i=i||c,t=String(t),r||(t=t.toLowerCase(),i=i.toLowerCase());for(var n=t.length,o=Math.abs(e),a={},s=0;s<i.length;s++)a[i[s]]=s;for(s=0;s<n;s++){var h=t[s];if("-"!==h&&(h in a&&a[h]>=o&&("1"!==h||1!==o)))throw new Error(h+" is not a valid digit in base "+e+".")}e=q(e);var l=[],r="-"===t[0];for(s=r?1:0;s<t.length;s++)if((h=t[s])in a)l.push(q(a[h]));else{if("<"!==h)throw new Error(h+" is not a valid character");for(var u=s;">"!==t[++s]&&s<t.length;);l.push(q(t.slice(u+1,s)))}return W(l,e,r)};function W(t,e,i){for(var r=p[0],n=p[1],o=t.length-1;0<=o;o--)r=r.add(t[o].times(n)),n=n.times(e);return i?r.negate():r}function V(t,e){if((e=bigInt(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var i=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return i.unshift([1]),{value:[].concat.apply([],i),isNegative:!1}}i=!1;if(t.isNegative()&&e.isPositive()&&(i=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var r=[],n=t;n.isNegative()||0<=n.compareAbs(e);){var n=(o=n.divmod(e)).quotient,o=o.remainder;o.isNegative()&&(o=e.minus(o).abs(),n=n.next()),r.push(o.toJSNumber())}return r.push(n.toJSNumber()),{value:r.reverse(),isNegative:i}}function Y(t,e,i){e=V(t,e);return(e.isNegative?"-":"")+e.value.map(function(t){return(e=t)<(t=(t=i)||c).length?t[e]:"<"+e+">";var e}).join("")}function X(t){if(g(+t)){var e=+t;if(e===T(e))return u?new _(BigInt(e)):new f(e);throw new Error("Invalid integer: "+t)}var i="-"===t[0],r=(t=i?t.slice(1):t).split(/e/i);if(2<r.length)throw new Error("Invalid integer: "+r.join("e"));if(2===r.length){var n=r[1];if((n=+(n="+"===n[0]?n.slice(1):n))!==T(n)||!g(n))throw new Error("Invalid integer: "+n+" is not a valid exponent.");e=r[0],r=e.indexOf(".");if(0<=r&&(n-=e.length-r-1,e=e.slice(0,r)+e.slice(r+1)),n<0)throw new Error("Cannot include negative exponent part for integers");t=e+=new Array(n+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(u)return new _(BigInt(i?"-"+t:t));for(var o=[],a=t.length,s=l,h=a-s;0<a;)o.push(+t.slice(h,a)),(h-=s)<0&&(h=0),a-=s;return v(o),new d(o,i)}function q(t){return"number"==typeof t?function(t){if(u)return new _(BigInt(t));if(g(t)){if(t!==T(t))throw new Error(t+" is not an integer.");return new f(t)}return X(t.toString())}(t):"string"==typeof t?X(t):"bigint"==typeof t?new _(t):t}d.prototype.toArray=function(t){return V(this,t)},f.prototype.toArray=function(t){return V(this,t)},_.prototype.toArray=function(t){return V(this,t)},d.prototype.toString=function(t,e){if(10!==(t=t===a?10:t))return Y(this,t,e);for(var i,r=this.value,n=r.length,o=String(r[--n]);0<=--n;)i=String(r[n]),o+="0000000".slice(i.length)+i;return(this.sign?"-":"")+o},f.prototype.toString=function(t,e){return 10!=(t=t===a?10:t)?Y(this,t,e):String(this.value)},_.prototype.toString=f.prototype.toString,_.prototype.toJSON=d.prototype.toJSON=f.prototype.toJSON=function(){return this.toString()},d.prototype.toJSNumber=d.prototype.valueOf=function(){return parseInt(this.toString(),10)},f.prototype.toJSNumber=f.prototype.valueOf=function(){return this.value},_.prototype.valueOf=_.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var t=0;t<1e3;t++)p[t]=q(t),0<t&&(p[-t]=q(-t));return p.one=p[1],p.zero=p[0],p.minusOne=p[-1],p.max=G,p.min=U,p.gcd=H,p.lcm=function(t,e){return t=q(t).abs(),e=q(e).abs(),t.divide(H(t,e)).multiply(e)},p.isInstance=function(t){return t instanceof d||t instanceof f||t instanceof _},p.randBetween=function(t,e){var i=U(t=q(t),e=q(e));if((e=G(t,e).subtract(i).add(1)).isSmall)return i.add(Math.floor(Math.random()*e));for(var r=V(e,y).value,n=[],o=!0,a=0;a<r.length;a++){var s=o?r[a]:y,h=T(Math.random()*s);n.push(h),h<s&&(o=!1)}return i.add(p.fromArray(n,y,!1))},p.fromArray=function(t,e,i){return W(t.map(q),q(e||10),i)},p}(),function(h){var t,l,u;t=h.ARR||(h.ARR={}),l=[],u=[],t.rand=function(t,e){e=null==e?1:e,e=Math.min(t.length,e),l.length=0,u.length=0;for(var i=t.length,r=[],n=0;n<i;++n)l.push(n);for(;u.length<e;){var o=h.NUM.random(l.length-1);u.push(l[o]),l.splice(o,1)}for(var n=0,a=u.length;n<a;n++){var s=u[n];r.push(t[s])}return r},t.unique=function(t){if(!t||!t.length)return t;for(var e=[],i=0;i<t.length;i++)t.indexOf(t[i])===i&&e.push(t[i]);return e},t.getDifferent=function(t,e){return t.concat(e).filter(function(t,e,i){return i.indexOf(t)===i.lastIndexOf(t)})},t.getSame=function(t,e){for(var i=[],r=0;r<e.length;r++)for(var n=0;n<t.length;n++)t[n]===e[r]&&i.push(t[n]);return i},t.sort=function(t,i){t.sort(function(t,e){return i(t,e)?1:-1})}}(god=god||{}),function(t){var o;function i(t,e){return e=null==e?o.curStamp:e,a(e+=864e5*t).setHours(0,0,0,0)-6e4*((new Date).getTimezoneOffset()+60*o.timezone)}function a(t){var e=null==t?o.curStamp:t,t=6e4*new Date(e).getTimezoneOffset();return new Date(e+t+36e5*o.timezone)}(o=t.DATE||(t.DATE={})).curStamp=(new Date).getTime(),o.timezone=8,o.now=function(){return o.curStamp},o.zeroTime=i,o.setHours=function(t,e,i,r,n){return a(n).setHours(t,e,i,r)-6e4*((new Date).getTimezoneOffset()+60*o.timezone)},o.setStamp=function(t){t&&(o.curStamp=t)},o.addDay=function(t,e){return(e=null==e?o.curStamp:e)+864e5*t},o.isSameDay=function(t,e){return e=null==e?0:e,i(0,t=null==t?0:t)==i(0,e)},o.diffDay=function(t,e){return t=i(0,t),e=i(0,e),t==e?0:Math.floor(Math.abs(t-e)/864e5)},o.getDayInfo=function(t){var e=a(t),i={},t=e.getDay();return i.dayOfWeek=0==t?7:t,i.year=e.getFullYear(),0==(i.month=e.getMonth())&&(i.month=12),i.day=e.getDate(),i.hour=e.getHours(),i.minute=e.getMinutes(),i.second=e.getSeconds(),i.milliSecond=e.getMilliseconds(),i},o.format=function(t,e){var i,r={"M+":(e=a(e)).getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("00"+r[i]).substr((""+r[i]).length)));return t}}(god=god||{}),function(t){(t=t.ENV_TYPE||(t.ENV_TYPE={})).wx="wx",t.oppo="oppo",t.qq="qq",t.hw="hw",t.zfb="zfb"}(god=god||{}),function(t){window&&window.__iswx__&&(t.envType=t.ENV_TYPE.wx),window&&window.__isoppo__&&(t.envType=t.ENV_TYPE.oppo),window&&window.__isqq__&&(t.envType=t.ENV_TYPE.qq),window&&window.__ishw__&&(t.envType=t.ENV_TYPE.hw),window&&window.__iszfb__&&(t.envType=t.ENV_TYPE.zfb)}(god=god||{}),function(t){(t.NUM||(t.NUM={})).random=function(t,e){var i=Math.random();return 1==arguments.length&&(e=t,t=0),t-1+Math.ceil(i*(e-t+1))}}(god=god||{}),function(t){!function(t){t.format=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.replace(r,function(s){{if(1==s.length&&"object"==typeof s[0])return s=s[0],function(t,e,i,r,n,o,a){return l[n](s[r])};var h=0;return function(t,e,i,r,n,o,a){return l[n](s[h++],i)}}}(e))},t.relpace=function(t,e){for(var i=0,r=e.length;i<r;i++){var n=e[i];t=t.replace("{"+i+"}",n)}return t},t.fill=function(t,e){for(var i=t.toString(),r=i.length;r<e;)i="0"+i,r++;return i},t.tf2under=function(t){var e;return(t=(e=t)&&e.length?1==e.length?e.toLowerCase():e.substr(0,1).toLowerCase()+e.substr(1,e.length-1):e).replace(/([A-Z])/g,"_$1").toLowerCase()},t.under2tf=function(t){return(t=t=t.replace(/_(\w)/g,function(t,e){return e.toUpperCase()}))&&t.length?1==t.length?t.toUpperCase():t.substr(0,1).toUpperCase()+t.substr(1,t.length-1):t},t.uint8ArrayToStr=function(t){for(var e,i,r,n="",o=t.length,a=0;a<o;)switch((e=t[a++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(e);break;case 12:case 13:i=t[a++],n+=String.fromCharCode((31&e)<<6|63&i);break;case 14:i=t[a++],r=t[a++],n+=String.fromCharCode((15&e)<<12|(63&i)<<6|(63&r)<<0)}return n};var l={"%":function(t){return"%"},b:function(t){return parseInt(t,10).toString(2)},c:function(t){return String.fromCharCode(parseInt(t,10))},d:function(t){return parseInt(t,10)?parseInt(t,10):0},u:function(t){return Math.abs(t)},f:function(t,e){return-1<e?Math.round(parseFloat(t)*Math.pow(10,e))/Math.pow(10,e):parseFloat(t)},o:function(t){return parseInt(t,10).toString(8)},s:function(t){return t},S:function(t,e){for(var i=e-t.toString().length,r=0;r<i;r++)t="0"+t;return t},x:function(t){return(""+parseInt(t,10).toString(16)).toLowerCase()},X:function(t){return(""+parseInt(t,10).toString(16)).toUpperCase()}},r=/%(?:(\d+)?(?:\.(\d+))?|\(([^)]+)\))([%bcdufosSxX])/g}(t.STR||(t.STR={}))}(god=god||{}),function(h){var c;function e(t,e){var i=c.dstData[t],r=c.srcData[t],n=r?r.data:{};if(i||r&&!h.OBJ.isEmpty(n)){for(var o in n)a(t,o);for(var o in i=c.dstData[t])if(e(o,i[o]))return}}function a(t,e){var i,r=c.srcData[t],n=r.data,o=r.type,a=r.field,s=n[e],h={};for(i in a){var l,u=a[i];"@"==i?h[u]="int"==o[i]?Number(e):e:(l=s[i],h[u]=l)}return delete n[e],(c.dstData[t]=c.dstData[t]||{})[e]=h}(c=h.D||(h.D={})).srcData={},c.dstData={},c.load=function(t){if(t)for(var e in t)c.srcData[e]&&(c.srcData[e]=null),c.dstData[e]&&(c.dstData[e]=null),c.srcData[e]=t[e]},c.lang=function(t){if(t)for(var e in t){var i=c.srcData[e];if(i){var r,n=t[e].data,o=i.data;for(r in n){var a,s=n[r];for(a in s)o[r]||(o[r]={}),o[r][a]=s[a]}}else h.getLogger().error("\u672a\u627e\u5230\u6e90\u6570\u636e:",e)}},c.get=function(t,e){if((r=c.dstData[t])&&r[e])return r[e];var i=c.srcData[t],r=i?i.data:{};return i&&!h.OBJ.isEmpty(r)&&r[e]?a(t,e):null},c.each=e,c.all=function(t){var i={};return e(t,function(t,e){-1!=t&&(i[t]=e)}),i}}(god=god||{}),function(t){!function(t){t.isEmpty=function(t){if(!t)return!0;for(var e in t)return!1;return!0},t.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i={};return t.forEach(function(t){!function t(e,i){for(var r in i){var n;i.hasOwnProperty(r)&&(n=i[r],o.isNULL(n)||(o.isArray(n)?(e[r]||(e[r]=[]),t(e[r],i[r])):o.isObj(n)?(e[r]||(e[r]={}),t(e[r],i[r])):e[r]=i[r]))}}(i,t)}),i};var e=Object.prototype.toString,o={isObj:function(t){return"[object Object]"==e.call(t)},isArray:function(t){return"[object Array]"==e.call(t)},isNULL:function(t){return"[object Null]"==e.call(t)}}}(t.OBJ||(t.OBJ={}))}(god=god||{}),function(t){(t.PATH||(t.PATH={})).extname=function(t){return t?(t=t.split("").reverse().join("")).substring(0,t.search(/\./)).split("").reverse().join(""):""}}(god=god||{}),function(a){var s;(s=a.R||(a.R={})).resCache={},s.load=function i(r,n,o){if(!r)return o("\u4e0d\u80fd\u4e3a\u7a7a\u5b57\u7b26\u4e32");s.resCache[r]?(s.resCache[r].count++,o()):RES.getResByUrl(r,function(t){if(t){if(t instanceof egret.Texture&&!t.bitmapData)return RES.destroyRes(r),void i(r,n,o);var e=s.resCache[r]=s.resCache[r]||{count:0,data:null};e.count++,e.data=t,o()}else t="\u52a0\u8f7d\u8d44\u6e90:"+r+"\u51fa\u73b0\u9519\u8bef!",a.getLogger().error(t),o(t)},null,n)},s.unLoad=function(t){var e;!t||(e=s.resCache[t])&&(e.count--,e.count||(delete s.resCache[t],RES.hasRes(t)&&RES.destroyRes(t)))},s._getRes=function(t){return(t=s.resCache[t])?t.data:null},s._getResWithRef=function(t){s.resCache[t]&&s.resCache[t].count++}}(god=god||{}),function(i){Object.defineProperty(i,"Logger",{get:function(){return i.getLogger()}}),i.getLogger=function(){var t=i.DATE.format("[yyyy-MM-dd hh:mm:ss]"),e="["+i.DATE.now()+"]";return{log:Function.prototype.bind.apply(console.log,[console,t,e]),warn:Function.prototype.bind.apply(console.warn,[console,t,e]),error:Function.prototype.bind.apply(console.error,[console,t,e])}}}(god=god||{}),function(t){var e=(i.prototype.continuation=function(t,e){null==t||"[object Function]"===Object.prototype.toString.call(t)?this.forList():this.onOver(t)},i.prototype.add=function(t){return this.addToList(1,[t]),this},i.prototype.each=function(t,e){return this.addToList(2,t,e),this},i.prototype.eachLimit=function(t,e,i){return this.addToList(3,t,e,i),this},i.prototype.eachSeries=function(t,e){return this.addToList(4,t,e),this},i.prototype.parallel=function(t){return this.addToList(5,t),this},i.prototype.parallelLimit=function(t,e){return this.addToList(6,t,null,e),this},i.prototype.parallelSeries=function(t){return this.addToList(7,t),this},i.prototype.finally=function(t){return this.fin=t,this},i.prototype.onError=function(t){throw console.error("Quque catch error : ",t),t},i.prototype.onErrorArr=function(t,e){e=new Error("The argument "+(t&&t.toString())+' in "'+e+'" is not Array!');if(!this.fin)throw e;this.FinExec(e)},i.prototype.onOver=function(t){console.error("\u7ed3\u675f: ",t)},i.prototype.addToList=function(t,e,i,r){var n={};n.type=t,n.list=e,n.iterator=i,n.limit=r,this.execList.push(n)},i.prototype.start=function(){this.isExec?this.onError("\u5df2\u7ecf\u5728\u6267\u884c\u4e2d..."):(this.isExec=!0,this.isStop=!1,this.forList())},i.prototype.stop=function(t,e){t&&this.carry(null,t),this.isStop=!0,this.isExec=!1,this.cont(e)},i.prototype.forList=function(){var t=this;if(!t.isStop)if(t.execList.length){var e=t.execList.shift();switch(e.type){case 1:var i=e.list[0];t.carry(null,i,t.cont.bind(t));break;case 2:t.defer(null,function(){t.carry(null,t.parallelExec.bind(t),t.arrToFunction(e.list,e.iterator))});break;case 3:t.defer(null,function(){t.carry(null,t.parallelLimitExec.bind(t),t.arrToFunction(e.list,e.iterator),e.limit)});break;case 4:t.defer(null,function(){t.carry(null,t.parallelSeriesExec.bind(t),t.arrToFunction(e.list,e.iterator))});break;case 5:t.defer(null,function(){t.carry(null,t.parallelExec.bind(t),e.list)});break;case 6:t.defer(null,function(){t.carry(null,t.parallelLimitExec.bind(t),e.list,e.limit)});break;case 7:t.defer(null,function(){t.carry(null,t.parallelSeriesExec.bind(t),e.list)});break;default:return void t.onError("\u975e\u6cd5\u9519\u8bef")}}else t.fin&&t.FinExec()},i.prototype.arrToFunction=function(t,n){for(var e=[],i=0;i<t.length;i++)e.push(function(e,i,r){return function(t){n(t,e,i,r)}}(t[i],i,t));return e},i.prototype.parallelExec=function(t){var i=this;if("[object Array]"!==Object.prototype.toString.call(t))return i.onErrorArr(t,"parallel");var r=t.length;if(r<=0)return i.cont();for(var e=0,n=r;e<n;e++)i.carry(null,t[e],function(t,e){if(!(r<=0))return t?(r=0,void i.cont(t)):!--r&&i.cont()})},i.prototype.parallelLimitExec=function(n,t){var o=this;if(t){if("[object Array]"!==Object.prototype.toString.call(n))return o.onErrorArr(n,"parallelLimit");var a=n.length;if(a<=0)return o.cont();for(var s=(t=a<t?a:t)-1,e=0;e<t;e++)o.defer(null,n[e],function r(t){function e(t,e){if(!(a<=0)){if(!t){var i=n[++s];return i&&o.defer(null,i,r(s)),!--a&&o.cont()}a=0,o.cont(t)}}return e}())}else o.parallelExec(n)},i.prototype.parallelSeriesExec=function(n){var o=this;if("[object Array]"!==Object.prototype.toString.call(n))return o.onErrorArr(n,"parallelSeries");var a=n.length;if(a<=0)return o.cont();var s=0;o.carry(null,n[s],function r(t){function e(t,e){if(!(a<=0)){if(!t){var i=n[++s];return i&&o.carry(null,i,r(s)),!--a&&o.cont()}a=0,o.cont(t)}}return e}())},i.prototype.FinExec=function(t){var e=this;e.fin(function(t){return t?void e.cont(t):e.cont()},t)},i.prototype.carry=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(!this.isStop)try{t.apply(null,this.slice(arguments,2))}catch(t){if(this.fin)return void this.FinExec(t);e?e(t):this.onError(t)}},i.prototype.defer=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var n,o=this;o.isStop||(n=arguments,o.nextTick(function(){o.carry.apply(o,n)}))},i.prototype.nextTick=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=this.slice(arguments,1);egret.setTimeout(t,this,0,r)},i.prototype.slice=function(t,e){if((e=e||0)>=t.length)return[];for(var i=t.length,r=Array(i-e);i-- >e;)r[i-e]=t[i];return r},i);function i(){this.isStop=!1,this.isExec=!1,this.execList=[],this.cont=this.continuation,this.fin=null}t.Queue=e}(god=god||{}),function(t){var e=(Object.defineProperty(i,"inst",{get:function(){return this._inst||(this._inst=new i),this._inst},enumerable:!1,configurable:!0}),i.prototype.reload=function(){t.Emitter.inst.emit(t.EmitterEvent.$$reload)},i.prototype.exit=function(){switch(egret.Capabilities.runtimeType){case egret.RuntimeType.WEB:case egret.RuntimeType.RUNTIME2:(window.parent||window).location.reload();break;case egret.RuntimeType.WXGAME:wx.exitMiniProgram({});break;case egret.RuntimeType.QQGAME:qq.exitMiniProgram({})}},i.prototype.setClipboardData=function(t){switch(egret.Capabilities.runtimeType){case egret.RuntimeType.WEB:this._clipBoradData=t;var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("Copy"),document.body.removeChild(e);break;case egret.RuntimeType.RUNTIME2:this._clipBoradData=t;break;case egret.RuntimeType.WXGAME:wx.setClipboardData({data:t});break;case egret.RuntimeType.QQGAME:qq.setClipboardData({data:t})}},i.prototype.getClipboardData=function(){var e="";switch(egret.Capabilities.runtimeType){case egret.RuntimeType.WEB:case egret.RuntimeType.RUNTIME2:e=this._clipBoradData;break;case egret.RuntimeType.WXGAME:wx.getClipboardData({success:function(t){e=t.data}});case egret.RuntimeType.QQGAME:qq.getClipboardData({success:function(t){e=t.data}})}return e||""},i.prototype.loadSubPackage=function(t,e){switch(egret.Capabilities.runtimeType){case egret.RuntimeType.WEB:case egret.RuntimeType.RUNTIME2:this.createScript(t,e);break;case egret.RuntimeType.WXGAME:wx.loadSubpackage({name:t,success:function(){e()},fail:function(){e("\u52a0\u8f7d\u5b50\u5305\u5931\u8d25:"+t)}});break;case egret.RuntimeType.QQGAME:qq.loadSubpackage({name:t,success:function(){e()},fail:function(){e("\u52a0\u8f7d\u5b50\u5305\u5931\u8d25:"+t)}})}},i.prototype.createScript=function(t,e){if(this._jsCache[t])return e();var i=document,r=document.createElement("script");r.hasOwnProperty("async")&&(r.async=!1),this._jsCache[t]=!0,r.src=t,r.addEventListener("load",function(){this.removeEventListener("load",arguments.callee,!1),e()},!1),r.addEventListener("error",function(){e("Load "+t+" failed!")},!1),i.body.appendChild(r)},i);function i(){this._jsCache={};this._clipBoradData=""}t.Plat=e}(god=god||{}),function(t){function c(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function s(t,e,i,r,n,o){return c((o=c(c(e,t),c(r,o)))<<n|o>>>32-n,i)}function p(t,e,i,r,n,o,a){return s(e&i|~e&r,t,e,n,o,a)}function d(t,e,i,r,n,o,a){return s(e&r|i&~r,t,e,n,o,a)}function f(t,e,i,r,n,o,a){return s(e^i^r,t,e,n,o,a)}function _(t,e,i,r,n,o,a){return s(i^(e|~r),t,e,n,o,a)}function a(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i,r,n,o,a=1732584193,s=-271733879,h=-1732584194,l=271733878,u=0;u<t.length;u+=16)a=p(i=a,r=s,n=h,o=l,t[u],7,-680876936),l=p(l,a,s,h,t[u+1],12,-389564586),h=p(h,l,a,s,t[u+2],17,606105819),s=p(s,h,l,a,t[u+3],22,-1044525330),a=p(a,s,h,l,t[u+4],7,-176418897),l=p(l,a,s,h,t[u+5],12,1200080426),h=p(h,l,a,s,t[u+6],17,-1473231341),s=p(s,h,l,a,t[u+7],22,-45705983),a=p(a,s,h,l,t[u+8],7,1770035416),l=p(l,a,s,h,t[u+9],12,-1958414417),h=p(h,l,a,s,t[u+10],17,-42063),s=p(s,h,l,a,t[u+11],22,-1990404162),a=p(a,s,h,l,t[u+12],7,1804603682),l=p(l,a,s,h,t[u+13],12,-40341101),h=p(h,l,a,s,t[u+14],17,-1502002290),a=d(a,s=p(s,h,l,a,t[u+15],22,1236535329),h,l,t[u+1],5,-165796510),l=d(l,a,s,h,t[u+6],9,-1069501632),h=d(h,l,a,s,t[u+11],14,643717713),s=d(s,h,l,a,t[u],20,-373897302),a=d(a,s,h,l,t[u+5],5,-701558691),l=d(l,a,s,h,t[u+10],9,38016083),h=d(h,l,a,s,t[u+15],14,-660478335),s=d(s,h,l,a,t[u+4],20,-405537848),a=d(a,s,h,l,t[u+9],5,568446438),l=d(l,a,s,h,t[u+14],9,-1019803690),h=d(h,l,a,s,t[u+3],14,-187363961),s=d(s,h,l,a,t[u+8],20,1163531501),a=d(a,s,h,l,t[u+13],5,-1444681467),l=d(l,a,s,h,t[u+2],9,-51403784),h=d(h,l,a,s,t[u+7],14,1735328473),a=f(a,s=d(s,h,l,a,t[u+12],20,-1926607734),h,l,t[u+5],4,-378558),l=f(l,a,s,h,t[u+8],11,-2022574463),h=f(h,l,a,s,t[u+11],16,1839030562),s=f(s,h,l,a,t[u+14],23,-35309556),a=f(a,s,h,l,t[u+1],4,-1530992060),l=f(l,a,s,h,t[u+4],11,1272893353),h=f(h,l,a,s,t[u+7],16,-155497632),s=f(s,h,l,a,t[u+10],23,-1094730640),a=f(a,s,h,l,t[u+13],4,681279174),l=f(l,a,s,h,t[u],11,-358537222),h=f(h,l,a,s,t[u+3],16,-722521979),s=f(s,h,l,a,t[u+6],23,76029189),a=f(a,s,h,l,t[u+9],4,-640364487),l=f(l,a,s,h,t[u+12],11,-421815835),h=f(h,l,a,s,t[u+15],16,530742520),a=_(a,s=f(s,h,l,a,t[u+2],23,-995338651),h,l,t[u],6,-198630844),l=_(l,a,s,h,t[u+7],10,1126891415),h=_(h,l,a,s,t[u+14],15,-1416354905),s=_(s,h,l,a,t[u+5],21,-57434055),a=_(a,s,h,l,t[u+12],6,1700485571),l=_(l,a,s,h,t[u+3],10,-1894986606),h=_(h,l,a,s,t[u+10],15,-1051523),s=_(s,h,l,a,t[u+1],21,-2054922799),a=_(a,s,h,l,t[u+8],6,1873313359),l=_(l,a,s,h,t[u+15],10,-30611744),h=_(h,l,a,s,t[u+6],15,-1560198380),s=_(s,h,l,a,t[u+13],21,1309151649),a=_(a,s,h,l,t[u+4],6,-145523070),l=_(l,a,s,h,t[u+11],10,-1120210379),h=_(h,l,a,s,t[u+2],15,718787259),s=_(s,h,l,a,t[u+9],21,-343485551),a=c(a,i),s=c(s,r),h=c(h,n),l=c(l,o);return[a,s,h,l]}function h(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e}function l(t){var e,i=[];for(i[(t.length>>2)-1]=void 0,e=0;e<i.length;e+=1)i[e]=0;for(e=0;e<8*t.length;e+=8)i[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return i}function r(t){for(var e,i="0123456789abcdef",r="",n=0;n<t.length;n+=1)e=t.charCodeAt(n),r+=i.charAt(e>>>4&15)+i.charAt(15&e);return r}function i(t){return unescape(encodeURIComponent(t))}function n(t){return h(a(l(t=i(t)),8*t.length))}function o(t,e){return function(t,e){var i,r=l(t),n=[],o=[];for(n[15]=o[15]=void 0,16<r.length&&(r=a(r,8*t.length)),i=0;i<16;i+=1)n[i]=909522486^r[i],o[i]=1549556828^r[i];return e=a(n.concat(l(e)),512+8*e.length),h(a(o.concat(e),640))}(i(t),i(e))}(t.Crypto||(t.Crypto={})).md5=function(t,e,i){return e?i?o(e,t):r(o(e,t)):i?n(t):r(n(t))}}(god=god||{}),window.EasyStar=function(i){var r={};function n(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}return n.m=i,n.c=r,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/bin/",n(n.s=0)}([function(t,e,i){var x={},w=i(1),S=i(2),C=i(3);t.exports=x;var E=1;x.js=function(){var u,o,c,p=!1,a={},r={},n={},h={},s=!0,d={},f=[],l=Number.MAX_VALUE,_=!1;this.setAcceptableTiles=function(t){t instanceof Array?c=t:!isNaN(parseFloat(t))&&isFinite(t)&&(c=[t])},this.enableSync=function(){p=!0},this.disableSync=function(){p=!1},this.enableDiagonals=function(){_=!0},this.disableDiagonals=function(){_=!1},this.setGrid=function(t){u=t;for(var e=0;e<u.length;e++)for(var i=0;i<u[0].length;i++)r[u[e][i]]||(r[u[e][i]]=1)},this.setTileCost=function(t,e){r[t]=e},this.setAdditionalPointCost=function(t,e,i){void 0===n[e]&&(n[e]={}),n[e][t]=i},this.removeAdditionalPointCost=function(t,e){void 0!==n[e]&&delete n[e][t]},this.removeAllAdditionalPointCosts=function(){n={}},this.setDirectionalCondition=function(t,e,i){void 0===h[e]&&(h[e]={}),h[e][t]=i},this.removeAllDirectionalConditions=function(){h={}},this.setIterationsPerCalculation=function(t){l=t},this.avoidAdditionalPoint=function(t,e){void 0===a[e]&&(a[e]={}),a[e][t]=1},this.stopAvoidingAdditionalPoint=function(t,e){void 0!==a[e]&&delete a[e][t]},this.enableCornerCutting=function(){s=!0},this.disableCornerCutting=function(){s=!1},this.stopAvoidingAllAdditionalPoints=function(){a={}},this.findPath=function(t,e,i,r,n){function o(t){p?n(t):setTimeout(function(){n(t)})}if(void 0===c)throw new Error("You can't set a path without first calling setAcceptableTiles() on EasyStar.");if(void 0===u)throw new Error("You can't set a path without first calling setGrid() on EasyStar.");if(t<0||e<0||i<0||r<0||t>u[0].length-1||e>u.length-1||i>u[0].length-1||r>u.length-1)throw new Error("Your start or end point is outside the scope of your grid.");if(t!==i||e!==r){for(var a=u[r][i],s=!1,h=0;h<c.length;h++)if(a===c[h]){s=!0;break}if(!1!==s){var l=new w;l.openList=new C(function(t,e){return t.bestGuessDistance()-e.bestGuessDistance()}),l.isDoneCalculating=!1,l.nodeHash={},l.startX=t,l.startY=e,l.endX=i,l.endY=r,l.callback=o,l.openList.push(b(l,l.startX,l.startY,null,1));r=E++;return d[r]=l,f.push(r),r}o(null)}else o([])},this.cancelPath=function(t){return t in d&&(delete d[t],!0)},this.calculate=function(){if(0!==f.length&&void 0!==u&&void 0!==c)for(o=0;o<l;o++){if(0===f.length)return;p&&(o=0);var t=f[0],e=d[t];if(void 0!==e)if(0!==e.openList.size()){var i=e.openList.pop();if(e.endX!==i.x||e.endY!==i.y)(i.list=0)<i.y&&g(e,i,0,-1,+v(i.x,i.y-1)),i.x<u[0].length-1&&g(e,i,1,0,+v(i.x+1,i.y)),i.y<u.length-1&&g(e,i,0,1,+v(i.x,i.y+1)),0<i.x&&g(e,i,-1,0,+v(i.x-1,i.y)),_&&(0<i.x&&0<i.y&&(s||y(u,c,i.x,i.y-1,i)&&y(u,c,i.x-1,i.y,i))&&g(e,i,-1,-1,1.4*v(i.x-1,i.y-1)),i.x<u[0].length-1&&i.y<u.length-1&&(s||y(u,c,i.x,i.y+1,i)&&y(u,c,i.x+1,i.y,i))&&g(e,i,1,1,1.4*v(i.x+1,i.y+1)),i.x<u[0].length-1&&0<i.y&&(s||y(u,c,i.x,i.y-1,i)&&y(u,c,i.x+1,i.y,i))&&g(e,i,1,-1,1.4*v(i.x+1,i.y-1)),0<i.x&&i.y<u.length-1&&(s||y(u,c,i.x,i.y+1,i)&&y(u,c,i.x-1,i.y,i))&&g(e,i,-1,1,1.4*v(i.x-1,i.y+1)));else{var r=[];r.push({x:i.x,y:i.y});for(var n=i.parent;null!=n;)r.push({x:n.x,y:n.y}),n=n.parent;r.reverse(),e.callback(r),delete d[t],f.shift()}}else e.callback(null),delete d[t],f.shift();else f.shift()}};var g=function(t,e,i,r,n){i=e.x+i,r=e.y+r;void 0!==a[r]&&void 0!==a[r][i]||!y(u,c,i,r,e)||(void 0===(r=b(t,i,r,e,n)).list?(r.list=1,t.openList.push(r)):e.costSoFar+n<r.costSoFar&&(r.costSoFar=e.costSoFar+n,r.parent=e,t.openList.updateItem(r)))},y=function(t,e,i,r,n){var o=h[r]&&h[r][i];if(o){var a=m(n.x-i,n.y-r);if(!function(){for(var t=0;t<o.length;t++)if(o[t]===a)return 1}())return!1}for(var s=0;s<e.length;s++)if(t[r][i]===e[s])return!0;return!1},m=function(t,e){if(0===t&&-1===e)return x.TOP;if(1===t&&-1===e)return x.TOP_RIGHT;if(1===t&&0===e)return x.RIGHT;if(1===t&&1===e)return x.BOTTOM_RIGHT;if(0===t&&1===e)return x.BOTTOM;if(-1===t&&1===e)return x.BOTTOM_LEFT;if(-1===t&&0===e)return x.LEFT;if(-1===t&&-1===e)return x.TOP_LEFT;throw new Error("These differences are not valid: "+t+", "+e)},v=function(t,e){return n[e]&&n[e][t]||r[u[e][t]]},b=function(t,e,i,r,n){if(void 0!==t.nodeHash[i]){if(void 0!==t.nodeHash[i][e])return t.nodeHash[i][e]}else t.nodeHash[i]={};var o=T(e,i,t.endX,t.endY),n=null!==r?r.costSoFar+n:0,o=new S(r,e,i,n,o);return t.nodeHash[i][e]=o},T=function(t,e,i,r){var n,o;return _?(n=Math.abs(t-i))<(o=Math.abs(e-r))?1.4*n+o:1.4*o+n:(n=Math.abs(t-i))+Math.abs(e-r)}},x.TOP="TOP",x.TOP_RIGHT="TOP_RIGHT",x.RIGHT="RIGHT",x.BOTTOM_RIGHT="BOTTOM_RIGHT",x.BOTTOM="BOTTOM",x.BOTTOM_LEFT="BOTTOM_LEFT",x.LEFT="LEFT",x.TOP_LEFT="TOP_LEFT"},function(t,e){t.exports=function(){this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList}},function(t,e){t.exports=function(t,e,i,r,n){this.parent=t,this.x=e,this.y=i,this.costSoFar=r,this.simpleDistanceToTarget=n,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}}},function(t,e,i){t.exports=i(4)},function(s,y,t){var m,v;!function(){var t,p,h,d,f,e,l,i,_,g,r,n,o,u,c;function a(t){this.cmp=null!=t?t:p,this.nodes=[]}h=Math.floor,g=Math.min,p=function(t,e){return t<e?-1:e<t?1:0},_=function(t,e,i,r,n){var o;if(null==n&&(n=p),(i=null==i?0:i)<0)throw new Error("lo must be non-negative");for(null==r&&(r=t.length);i<r;)n(e,t[o=h((i+r)/2)])<0?r=o:i=o+1;return[].splice.apply(t,[i,i-i].concat(e)),e},e=function(t,e,i){return null==i&&(i=p),t.push(e),u(t,0,t.length-1,i)},f=function(t,e){var i,r;return null==e&&(e=p),i=t.pop(),t.length?(r=t[0],t[0]=i,c(t,0,e)):r=i,r},i=function(t,e,i){var r;return null==i&&(i=p),r=t[0],t[0]=e,c(t,0,i),r},l=function(t,e,i){var r;return null==i&&(i=p),t.length&&i(t[0],e)<0&&(e=(r=[t[0],e])[0],t[0]=r[1],c(t,0,i)),e},d=function(i,t){var e,r,n,o,a,s;for(null==t&&(t=p),a=[],r=0,n=(o=function(){s=[];for(var t=0,e=h(i.length/2);0<=e?t<e:e<t;0<=e?t++:t--)s.push(t);return s}.apply(this).reverse()).length;r<n;r++)e=o[r],a.push(c(i,e,t));return a},o=function(t,e,i){if(null==i&&(i=p),-1!==(e=t.indexOf(e)))return u(t,0,e,i),c(t,e,i)},r=function(t,e,i){var r,n,o,a,s;if(null==i&&(i=p),!(n=t.slice(0,e)).length)return n;for(d(n,i),o=0,a=(s=t.slice(e)).length;o<a;o++)r=s[o],l(n,r,i);return n.sort(i).reverse()},n=function(t,e,i){var r,n,o,a,s,h,l,u,c;if(null==i&&(i=p),10*e<=t.length){if(!(o=t.slice(0,e).sort(i)).length)return o;for(n=o[o.length-1],a=0,h=(l=t.slice(e)).length;a<h;a++)i(r=l[a],n)<0&&(_(o,r,0,null,i),o.pop(),n=o[o.length-1]);return o}for(d(t,i),c=[],s=0,u=g(e,t.length);0<=u?s<u:u<s;0<=u?++s:--s)c.push(f(t,i));return c},u=function(t,e,i,r){var n,o,a;for(null==r&&(r=p),n=t[i];e<i&&r(n,o=t[a=i-1>>1])<0;)t[i]=o,i=a;return t[i]=n},c=function(t,e,i){var r,n,o,a,s;for(null==i&&(i=p),n=t.length,o=t[s=e],r=2*e+1;r<n;)(a=r+1)<n&&!(i(t[r],t[a])<0)&&(r=a),t[e]=t[r],r=2*(e=r)+1;return t[e]=o,u(t,s,e,i)},a.push=e,a.pop=f,a.replace=i,a.pushpop=l,a.heapify=d,a.updateItem=o,a.nlargest=r,a.nsmallest=n,a.prototype.push=function(t){return e(this.nodes,t,this.cmp)},a.prototype.pop=function(){return f(this.nodes,this.cmp)},a.prototype.peek=function(){return this.nodes[0]},a.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},a.prototype.replace=function(t){return i(this.nodes,t,this.cmp)},a.prototype.pushpop=function(t){return l(this.nodes,t,this.cmp)},a.prototype.heapify=function(){return d(this.nodes,this.cmp)},a.prototype.updateItem=function(t){return o(this.nodes,t,this.cmp)},a.prototype.clear=function(){return this.nodes=[]},a.prototype.empty=function(){return 0===this.nodes.length},a.prototype.size=function(){return this.nodes.length},a.prototype.clone=function(){var t;return(t=new a).nodes=this.nodes.slice(0),t},a.prototype.toArray=function(){return this.nodes.slice(0)},a.prototype.insert=a.prototype.push,a.prototype.top=a.prototype.peek,a.prototype.front=a.prototype.peek,a.prototype.has=a.prototype.contains,a.prototype.copy=a.prototype.clone,t=a,m=[],void 0===(v="function"==typeof(v=function(){return t})?v.apply(y,m):v)||(s.exports=v)}.call(this)}]),function(t){function n(t,e,i,r){t=Math.atan2(r-e,i-t);return t<0&&(t+=2*Math.PI),t}function r(t){return t*Math.PI/180}function o(t){return 180*t/Math.PI}(t=t.MATH||(t.MATH={})).getAngle=function(t,e,i,r){return o(n(t,e,i,r))},t.getRadian=n,t.getDistance=function(t,e,i,r){return Math.sqrt((t-i)*(t-i)+(e-r)*(e-r))},t.getXYByLine=function(t,e,i){return e=i?e:r(e),{x:t*Math.cos(e),y:t*Math.sin(e)}},t.angleToRadian=r,t.radianToAngle=o}(god=god||{}),function(){"use strict";var h,c;void 0===window.btoa&&(window.btoa=(h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),function(t){var e,i,r,n=i=0,o=t.length,a=o%3,s=(o-=a)/3<<2;for(0<a&&(s+=4),e=new Array(s);n<o;)r=t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<8|t.charCodeAt(n++),e[i++]=h[r>>18]+h[r>>12&63]+h[r>>6&63]+h[63&r];return 1==a?(r=t.charCodeAt(n++),e[i++]=h[r>>2]+h[(3&r)<<4]+"=="):2==a&&(r=t.charCodeAt(n++)<<8|t.charCodeAt(n++),e[i++]=h[r>>10]+h[r>>4&63]+h[(15&r)<<2]+"="),e.join("")})),void 0===window.atob&&(window.atob=(c=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],function(t){var e,i,r,n,o,a,s,h,l,u=t.length;if(u%4!=0)return"";if(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(t))return"";for(0<(s="="==t.charAt((h=u)-2)?1:"="==t.charAt(u-1)?2:0)&&(h-=4),h=3*(h>>2)+s,l=new Array(h),o=a=0;o<u&&-1!=(e=c[t.charCodeAt(o++)])&&-1!=(i=c[t.charCodeAt(o++)])&&(l[a++]=String.fromCharCode(e<<2|(48&i)>>4),-1!=(r=c[t.charCodeAt(o++)]))&&(l[a++]=String.fromCharCode((15&i)<<4|(60&r)>>2),-1!=(n=c[t.charCodeAt(o++)]));)l[a++]=String.fromCharCode((3&r)<<6|n);return l.join("")}));var a=!0;try{String.fromCharCode.apply(String,new Uint8Array([1,2]))}catch(t){a=!1,Object.defineProperty(Array.prototype,"subarray",{value:Array.prototype.slice})}var u=2654435769;function i(t,e){var i=t.length,r=i<<2;if(e){i=t[i-1];if(i<(r-=4)-3||r<i)return null;r=i}for(var n=new Uint8Array(r),o=0;o<r;++o)n[o]=t[o>>2]>>((3&o)<<3);return n}function r(t,e){var i,r=t.length,n=r>>2;0!=(3&r)&&++n,e?(i=new Uint32Array(n+1))[n]=r:i=new Uint32Array(n);for(var o=0;o<r;++o)i[o>>2]|=t[o]<<((3&o)<<3);return i}function p(t){return 4294967295&t}function d(t,e,i,r,n,o){return(i>>>5^e<<2)+(e>>>3^i<<4)^(t^e)+(o[3&r^n]^i)}function n(t){var e;return t.length<16&&((e=new Uint8Array(16)).set(t),t=e),t}function o(t){for(var e=t.length,i=new Uint8Array(3*e),r=0,n=0;n<e;n++){var o=t.charCodeAt(n);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6,i[r++]=128|63&o;else{if(!(o<55296||57343<o)){if(n+1<e){var a=t.charCodeAt(n+1);if(o<56320&&56320<=a&&a<=57343){a=65536+((1023&o)<<10|1023&a);i[r++]=240|a>>18,i[r++]=128|a>>12&63,i[r++]=128|a>>6&63,i[r++]=128|63&a,n++;continue}}throw new Error("Malformed string")}i[r++]=224|o>>12,i[r++]=128|o>>6&63,i[r++]=128|63&o}}return i.subarray(0,r)}function s(t){var e=t.length;return 0===e?"":(e<32767?function(t,e){for(var i=new Array(e),r=0,n=0,o=t.length;r<e&&n<o;r++){var a=t[n++];switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i[r]=a;break;case 12:case 13:if(!(n<o))throw new Error("Unfinished UTF-8 octet sequence");i[r]=(31&a)<<6|63&t[n++];break;case 14:if(!(n+1<o))throw new Error("Unfinished UTF-8 octet sequence");i[r]=(15&a)<<12|(63&t[n++])<<6|63&t[n++];break;case 15:if(!(n+2<o))throw new Error("Unfinished UTF-8 octet sequence");var s=((7&a)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;if(!(0<=s&&s<=1048575))throw new Error("Character outside valid Unicode range: 0x"+s.toString(16));i[r++]=s>>10&1023|55296,i[r]=1023&s|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+a.toString(16))}}return r<e&&(i.length=r),String.fromCharCode.apply(String,i)}:function(t,e){for(var i=[],r=new Array(32768),n=0,o=0,a=t.length;n<e&&o<a;n++){var s,h=t[o++];switch(h>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r[n]=h;break;case 12:case 13:if(!(o<a))throw new Error("Unfinished UTF-8 octet sequence");r[n]=(31&h)<<6|63&t[o++];break;case 14:if(!(o+1<a))throw new Error("Unfinished UTF-8 octet sequence");r[n]=(15&h)<<12|(63&t[o++])<<6|63&t[o++];break;case 15:if(!(o+2<a))throw new Error("Unfinished UTF-8 octet sequence");var l=((7&h)<<18|(63&t[o++])<<12|(63&t[o++])<<6|63&t[o++])-65536;if(!(0<=l&&l<=1048575))throw new Error("Character outside valid Unicode range: 0x"+l.toString(16));r[n++]=l>>10&1023|55296,r[n]=1023&l|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+h.toString(16))}32766<=n&&(r.length=s=n+1,i.push(String.fromCharCode.apply(String,r)),e-=s,n=-1)}return 0<n&&(r.length=n,i.push(String.fromCharCode.apply(String,r))),i.join("")})(t,e)}function l(t){var e=t.length;if(0===e)return"";var i=a?t:function(t){for(var e=t.length,i=new Array(t.length),r=0;r<e;++r)i[r]=t[r];return i}(t);if(e<65535)return String.fromCharCode.apply(String,i);for(var t=32767&e,r=e>>15,n=new Array(t?1+r:r),o=0;o<r;++o)n[o]=String.fromCharCode.apply(String,i.subarray(o<<15,o+1<<15));return t&&(n[r]=String.fromCharCode.apply(String,i.subarray(r<<15,e))),n.join("")}function f(t,e){return"string"==typeof t&&(t=o(t)),"string"==typeof e&&(e=o(e)),null==t||0===t.length?t:i(function(t,e){for(var i,r,n,o=t.length,a=o-1,s=t[a],h=0,l=0|Math.floor(6+52/o);0<l;--l){for(r=(h=p(h+u))>>>2&3,n=0;n<a;++n)i=t[n+1],s=t[n]=p(t[n]+d(h,i,s,n,r,e));i=t[0],s=t[a]=p(t[a]+d(h,i,s,a,r,e))}return t}(r(t,!0),r(n(e),!1)),!1)}function _(t,e){return"string"==typeof t&&(t=function(t){for(var e=window.atob(t),i=e.length,r=new Uint8Array(i),n=0;n<i;n++)r[n]=e.charCodeAt(n);return r}(t)),"string"==typeof e&&(e=o(e)),null==t||0===t.length?t:i(function(t,e){for(var i,r,n,o=t.length,a=o-1,s=t[0],h=p(Math.floor(6+52/o)*u);0!==h;h=p(h-u)){for(r=h>>>2&3,n=a;0<n;--n)i=t[n-1],s=t[n]=p(t[n]-d(h,s,i,n,r,e));i=t[a],s=t[0]=p(t[0]-d(h,s,i,0,r,e))}return t}(r(t,!1),r(n(e),!1)),!0)}window.aed=Object.create(null,{tb:{value:o},ts:{value:s},e:{value:f},ets:{value:function(t,e){return window.btoa(l(f(t,e)))}},d:{value:_},dts:{value:function(t,e){return s(_(t,e))}}})}(),window.b3=window.b3||{},function(){var t,i,e,r,n,o,c,a,s,h,l,u,p;function d(t){this.id=t.id||i.createUUID(),this.category=t.category||"",this.name=t.name||"",this.title=t.title||this.name,this.description=t.description||"",this.properties=t.properties||{},this.parameters={},this._parseProp(this.properties)}function f(t){return t.category=e.EnumCategory.ACTION,r.call(this,t)||this}function _(t){var e=this;return t.category=n.EnumCategory.COMPOSITE,(e=o.call(this,t)||this).children=[],e}function g(t){this.id=t||c.createUUID(),this.title="The behavior tree",this.description="Default description",this.properties={},this.root=null,this.debug=null}function y(){}function m(){this._baseMemory={},this._treeMemory={}}function v(t){return t.category=s.EnumCategory.CONDITION,h.call(this,t)||this}function b(t){var e=this;return t.category=l.EnumCategory.DECORATOR,(e=u.call(this,t)||this).child=t.child,e}function T(){this.tree=null,this.debug=null,this.target=null,this.blackboard=null,this._openNodes=[],this._nodeCount=0}(p=b3=b3||{}).VERSION="0.2.2",(t=p.EnumStatus||(p.EnumStatus={}))[t.SUCCESS=1]="SUCCESS",t[t.FAILURE=2]="FAILURE",t[t.RUNNING=3]="RUNNING",t[t.ERROR=4]="ERROR",(p=p.EnumCategory||(p.EnumCategory={})).COMPOSITE="composite",p.DECORATOR="decorator",p.ACTION="action",p.CONDITION="condition",i=b3=b3||{},d.prototype._parseProp=function(t){},d.prototype.execute=function(t){this._enter(t),t.blackboard.get("isOpen",t.tree.id,this.id)||this._open(t);var e=this._tick(t);return e!==i.EnumStatus.RUNNING&&this._close(t),this._exit(t),e},d.prototype._enter=function(t){t.enterNode(this),this.enter(t)},d.prototype._open=function(t){t.openNode(this),t.blackboard.set("isOpen",!0,t.tree.id,this.id),this.open(t)},d.prototype._tick=function(t){return t.tickNode(this),this.tick(t)},d.prototype._close=function(t){t.blackboard.get("isOpen",t.tree.id,this.id)&&(t.closeNode(this),t.blackboard.set("isOpen",!1,t.tree.id,this.id),this.close(t))},d.prototype._exit=function(t){t.exitNode(this),this.exit(t)},d.prototype.enter=function(t){},d.prototype.open=function(t){},d.prototype.close=function(t){},d.prototype.exit=function(t){},i.BaseNode=d,e=b3=b3||{},r=e.BaseNode,__extends(f,r),e.Action=f,function(e){var t,i;function r(t){return i.call(this,t||{name:"Error"})||this}t=e.actions||(e.actions={}),i=e.Action,__extends(r,i),r.prototype.tick=function(t){return e.EnumStatus.ERROR},t.Error=r}(b3=b3||{}),function(e){var t,i;function r(t){return i.call(this,t||{name:"Failer"})||this}t=e.actions||(e.actions={}),i=e.Action,__extends(r,i),r.prototype.tick=function(t){return e.EnumStatus.FAILURE},t.Failer=r}(b3=b3||{}),function(e){var t,i;function r(t){return i.call(this,t||{name:"Runner"})||this}t=e.actions||(e.actions={}),i=e.Action,__extends(r,i),r.prototype.tick=function(t){return e.EnumStatus.RUNNING},t.Runner=r}(b3=b3||{}),function(e){var t,i;function r(t){return i.call(this,t||{name:"Succeeder"})||this}t=e.actions||(e.actions={}),i=e.Action,__extends(r,i),r.prototype.tick=function(t){return e.EnumStatus.SUCCESS},t.Succeeder=r}(b3=b3||{}),function(e){var t,i;function r(t){return i.call(this,t)||this}t=e.actions||(e.actions={}),i=e.Action,__extends(r,i),r.prototype._parseProp=function(t){this.endTime=t.milliseconds||0},r.prototype.open=function(t){var e=(new Date).getTime();t.blackboard.set("startTime",e,t.tree.id,this.id)},r.prototype.tick=function(t){return(new Date).getTime()-t.blackboard.get("startTime",t.tree.id,this.id)>this.endTime?e.EnumStatus.SUCCESS:e.EnumStatus.RUNNING},t.Wait=r}(b3=b3||{}),n=b3=b3||{},o=n.BaseNode,__extends(_,o),n.Composite=_,function(r){var t,e;function i(t){return t.name="MemPriority",e.call(this,t)||this}t=r.composites||(r.composites={}),e=r.Composite,__extends(i,e),i.prototype.open=function(t){t.blackboard.set("runningChild",0,t.tree.id,this.id)},i.prototype.tick=function(t){for(var e=t.blackboard.get("runningChild",t.tree.id,this.id);e<this.children.length;e++){var i=this.children[e].execute(t);if(i!==r.EnumStatus.FAILURE)return i===r.EnumStatus.RUNNING&&t.blackboard.set("runningChild",e,t.tree.id,this.id),i}return r.EnumStatus.FAILURE},t.MemPriority=i}(b3=b3||{}),function(r){var t,e;function i(t){return t.name="MemSequence",e.call(this,t)||this}t=r.composites||(r.composites={}),e=r.Composite,__extends(i,e),i.prototype.open=function(t){t.blackboard.set("runningChild",0,t.tree.id,this.id)},i.prototype.tick=function(t){for(var e=t.blackboard.get("runningChild",t.tree.id,this.id);e<this.children.length;e++){var i=this.children[e].execute(t);if(i!==r.EnumStatus.SUCCESS)return i===r.EnumStatus.RUNNING&&t.blackboard.set("runningChild",e,t.tree.id,this.id),i}return r.EnumStatus.SUCCESS},t.MemSequence=i}(b3=b3||{}),function(r){var t,e;function i(t){return t.name="Priority",e.call(this,t)||this}t=r.composites||(r.composites={}),e=r.Composite,__extends(i,e),i.prototype.tick=function(t){for(var e=0;e<this.children.length;e++){var i=this.children[e].execute(t);if(i!==r.EnumStatus.FAILURE)return i}return r.EnumStatus.FAILURE},t.Priority=i}(b3=b3||{}),function(r){var t,e;function i(t){return t.name="Sequence",e.call(this,t)||this}t=r.composites||(r.composites={}),e=r.Composite,__extends(i,e),i.prototype.tick=function(t){for(var e=0;e<this.children.length;e++){var i=this.children[e].execute(t);if(i!==r.EnumStatus.SUCCESS)return i}return r.EnumStatus.SUCCESS},t.Sequence=i}(b3=b3||{}),c=b3=b3||{},g.prototype.load=function(t,e){e=e||{},this.id=t.id||this.id,this.title=t.title||this.title,this.description=t.description||this.description,this.properties=t.properties||this.properties;var i,r,n,o,a={};for(i in t.nodes){if((o=t.nodes[i]).name in e)n=e[o.name];else if(o.name in c.actions)n=c.actions[o.name];else if(o.name in c.composites)n=c.composites[o.name];else{if(!(o.name in c.decorators))throw new EvalError('BehaviorTree.load: Invalid node name + "'+o.name+'".');n=c.decorators[o.name]}r=new n(o),a[i]=r}for(i in t.nodes)if(o=t.nodes[i],(r=a[i]).category===c.EnumCategory.COMPOSITE&&o.children)for(var s=0;s<o.children.length;s++){var h=o.children[s];r.children.push(a[h])}else r.category===c.EnumCategory.DECORATOR&&o.child&&(r.child=a[o.child]);this.nodes=a,this.root=a[t.root]},g.prototype.dump=function(){var t={},e=[];if(t.title=this.title,t.description=this.description,t.root=this.root?this.root.id:null,t.properties=this.properties,t.nodes={},t.custom_nodes=[],!this.root)return t;for(var i=[this.root];0<i.length;){var r=i.pop(),n={};n.id=r.id,n.name=r.name,n.title=r.title,n.description=r.description,n.properties=r.properties,n.parameters=r.parameters;var o,a=r.constructor&&r.constructor.prototype,s=a&&a.name||r.name;if(r.category,c.EnumCategory.ACTION,r.category!=c.EnumCategory.ACTION&&r.category!=c.EnumCategory.COMPOSITE&&r.category!=c.EnumCategory.DECORATOR&&e.indexOf(s)<0&&((o={}).name=s,o.title=a&&a.title||r.title,o.category=r.category,e.push(s),t.custom_nodes.push(o)),r.category===c.EnumCategory.COMPOSITE){var h=r;if(h.children){for(var l=[],u=h.children.length-1;0<=u;u--)l.push(h.children[u].id),i.push(h.children[u]);n.children=l}}else r.category===c.EnumCategory.DECORATOR&&r.child&&(i.push(r.child),n.child=r.child.id);t.nodes[r.id]=n}return t},g.prototype.tick=function(t,e){if(!e)throw"The blackboard parameter is obligatory and must be an instance of b3.Blackboard";var i=new c.Tick;i.debug=this.debug,i.target=t,i.blackboard=e;for(var t=(i.tree=this).root.execute(i),r=e.get("openNodes",this.id),n=i.openNodes.slice(0),o=0,a=0,s=Math.min(r.length,n.length);a<s;a++){if(r[a]!==n[a]){o=a;break}o=a+1}for(a=r.length-1;o<=a;a--){var h=this.nodes[r[a]];h&&h._close(i)}return e.set("openNodes",n,this.id),e.set("nodeCount",i.nodeCount,this.id),t},c.BehaviorTree=g,a=b3=b3||{},y.prototype.parse=function(t){this._trees||(this._trees={});for(var e,i={},r=0;r<t.trees.length;r++)i[t.trees[r].id]=t.trees[r];for(e in i){var n=i[e];this._paserTree(n,i),this._trees[n.title]=n}},y.prototype.build=function(t,e){var i=this._trees[t];if(!i)return null;t=new a.BehaviorTree;return t.load(i,e),t},y.prototype._paserTree=function(t,e){if(t.pasered){var i=[];for(n in t.nodes){var r=t.nodes[n];i.push(r)}return i}var n,o,a,s=[];for(n in t.nodes)e[(r=t.nodes[n]).name]?(o=e[r.name],a=this._paserTree(o,e),s=s.concat(a),r.name="Sequence",r.children=[o.root]):s.push(r);for(var h=0;h<s.length;h++)t.nodes[s[h].id]=s[h];return t.pasered=!0,s},a.BehaviorTreeGroup=y,p=b3=b3||{},m.prototype._getTreeMemory=function(t){return this._treeMemory[t]||(this._treeMemory[t]={nodeMemory:{},openNodes:[],traversalDepth:0,traversalCycle:0}),this._treeMemory[t]},m.prototype._getNodeMemory=function(t,e){t=t.nodeMemory;return t[e]||(t[e]={}),t[e]},m.prototype._getMemory=function(t,e){var i=this._baseMemory;return t&&(i=this._getTreeMemory(t),e&&(i=this._getNodeMemory(i,e))),i},m.prototype.set=function(t,e,i,r){this._getMemory(i,r)[t]=e},m.prototype.get=function(t,e,i){return this._getMemory(e,i)[t]},m.prototype.getCache=function(){return{base:this._baseMemory,tree:this._treeMemory}},m.prototype.setCache=function(t,e){this._baseMemory=t,this._treeMemory=e},p.Blackboard=m,s=b3=b3||{},h=s.BaseNode,__extends(v,h),s.Condition=v,l=b3=b3||{},u=l.BaseNode,__extends(b,u),l.Decorator=b,p=b3=b3||{},Object.defineProperty(T.prototype,"openNodes",{get:function(){return this._openNodes},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"nodeCount",{get:function(){return this._nodeCount},enumerable:!1,configurable:!0}),T.prototype.enterNode=function(t){this._nodeCount++,this._openNodes.push(t.id)},T.prototype.openNode=function(t){},T.prototype.tickNode=function(t){},T.prototype.closeNode=function(t){this._openNodes.pop()},T.prototype.exitNode=function(t){},p.Tick=T,function(e){var t,i;function r(t){return t.name="Inverter",i.call(this,t)||this}t=e.decorators||(e.decorators={}),i=e.Decorator,__extends(r,i),r.prototype.tick=function(t){if(!this.child)return e.EnumStatus.ERROR;t=this.child.execute(t);return t==e.EnumStatus.SUCCESS?t=e.EnumStatus.FAILURE:t==e.EnumStatus.FAILURE&&(t=e.EnumStatus.SUCCESS),t},t.Inverter=r}(b3=b3||{}),function(r){var t,e;function i(t){return e.call(this,t)||this}t=r.decorators||(r.decorators={}),e=r.Decorator,__extends(i,e),i.prototype._parseProp=function(t){if(!t.maxLoop)throw"maxLoop parameter in Limiter decorator is an obligatory parameter";this.maxLoop=t.maxLoop||1},i.prototype.open=function(t){t.blackboard.set("i",0,t.tree.id,this.id)},i.prototype.tick=function(t){if(!this.child)return r.EnumStatus.ERROR;var e=t.blackboard.get("i",t.tree.id,this.id);if(e<this.maxLoop){var i=this.child.execute(t);return i!=r.EnumStatus.SUCCESS&&i!=r.EnumStatus.FAILURE||t.blackboard.set("i",e+1,t.tree.id,this.id),i}return r.EnumStatus.FAILURE},t.Limiter=i}(b3=b3||{}),function(r){var t,e;function i(t){return e.call(this,t)||this}t=r.decorators||(r.decorators={}),e=r.Decorator,__extends(i,e),i.prototype._parseProp=function(t){if(!t.maxTime)throw"maxTime parameter in MaxTime decorator is an obligatory parameter";this.maxTime=t.maxTime||0},i.prototype.open=function(t){var e=(new Date).getTime();t.blackboard.set("startTime",e,t.tree.id,this.id)},i.prototype.tick=function(t){if(!this.child)return r.EnumStatus.ERROR;var e=(new Date).getTime(),i=t.blackboard.get("startTime",t.tree.id,this.id),t=this.child.execute(t);return e-i>this.maxTime?r.EnumStatus.FAILURE:t},t.MaxTime=i}(b3=b3||{}),function(r){var t,e;function i(t){return e.call(this,t)||this}t=r.decorators||(r.decorators={}),e=r.Decorator,__extends(i,e),i.prototype._parseProp=function(t){this.maxLoop=this.maxLoop||-1},i.prototype.open=function(t){t.blackboard.set("i",0,t.tree.id,this.id)},i.prototype.tick=function(t){if(!this.child)return r.EnumStatus.ERROR;for(var e=t.blackboard.get("i",t.tree.id,this.id),i=r.EnumStatus.ERROR;(this.maxLoop<0||e<this.maxLoop)&&(i=this.child.execute(t))==r.EnumStatus.SUCCESS;)e++;return e=t.blackboard.set("i",e,t.tree.id,this.id),i},t.RepeatUntilFailure=i}(b3=b3||{}),function(r){var t,e;function i(t){return e.call(this,t)||this}t=r.decorators||(r.decorators={}),e=r.Decorator,__extends(i,e),i.prototype._parseProp=function(t){this.maxLoop=t.maxLoop||-1},i.prototype.open=function(t){t.blackboard.set("i",0,t.tree.id,this.id)},i.prototype.tick=function(t){if(!this.child)return r.EnumStatus.ERROR;for(var e=t.blackboard.get("i",t.tree.id,this.id),i=r.EnumStatus.ERROR;(this.maxLoop<0||e<this.maxLoop)&&(i=this.child.execute(t))==r.EnumStatus.FAILURE;)e++;return e=t.blackboard.set("i",e,t.tree.id,this.id),i},t.RepeatUntilSuccess=i}(b3=b3||{}),function(r){var t,e;function i(t){return e.call(this,t)||this}t=r.decorators||(r.decorators={}),e=r.Decorator,__extends(i,e),i.prototype._parseProp=function(t){this.maxLoop=t.maxLoop||-1},i.prototype.open=function(t){t.blackboard.set("i",0,t.tree.id,this.id)},i.prototype.tick=function(t){if(!this.child)return r.EnumStatus.ERROR;for(var e=t.blackboard.get("i",t.tree.id,this.id),i=r.EnumStatus.SUCCESS;(this.maxLoop<0||e<this.maxLoop)&&((i=this.child.execute(t))==r.EnumStatus.SUCCESS||i==r.EnumStatus.FAILURE);)e++;return t.blackboard.set("i",e,t.tree.id,this.id),i},t.Repeater=i}(b3=b3||{}),(b3||(b3={})).createUUID=function(){for(var t=[],e="0123456789abcdef",i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")}}(),window.qrcode=function(t){"use strict";function o(){return void 0!==a}var a,x=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],s=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||40<t)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},r=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var h=e(function(t,i){i.L={bit:1},i.M={bit:0},i.Q={bit:3},i.H={bit:2},i.isValid=function(t){return t&&void 0!==t.bit&&0<=t.bit&&t.bit<4},i.from=function(t,e){if(i.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return i.L;case"m":case"medium":return i.M;case"q":case"quartile":return i.Q;case"h":case"high":return i.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return e}}});function i(){this.buffer=[],this.length=0}h.L,h.M,h.Q,h.H,h.isValid,i.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var i=0;i<e;i++)this.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var l=i;function n(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}n.prototype.set=function(t,e,i,r){e=t*this.size+e;this.data[e]=i,r&&(this.reservedBit[e]=!0)},n.prototype.get=function(t,e){return this.data[t*this.size+e]},n.prototype.xor=function(t,e,i){this.data[t*this.size+e]^=i},n.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};function w(t,e){switch(e){case h.L:return _[4*(t-1)+0];case h.M:return _[4*(t-1)+1];case h.Q:return _[4*(t-1)+2];case h.H:return _[4*(t-1)+3];default:return}}function S(t,e){switch(e){case h.L:return g[4*(t-1)+0];case h.M:return g[4*(t-1)+1];case h.Q:return g[4*(t-1)+2];case h.H:return g[4*(t-1)+3];default:return}}var u=n,c=e(function(t,a){var o=s;a.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,t=o(t),i=145===t?26:2*Math.ceil((t-13)/(2*e-2)),r=[t-7],n=1;n<e-1;n++)r[n]=r[n-1]-i;return r.push(6),r.reverse()},a.getPositions=function(t){for(var e=[],i=a.getRowColCoords(t),r=i.length,n=0;n<r;n++)for(var o=0;o<r;o++)0===n&&0===o||0===n&&o===r-1||n===r-1&&0===o||e.push([i[n],i[o]]);return e}}),p=(c.getRowColCoords,c.getPositions,s),d=function(t){t=p(t);return[[0,0],[t-7,0],[0,t-7]]},f=e(function(t,s){s.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};s.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&0<=t&&t<=7},s.from=function(t){return s.isValid(t)?parseInt(t,10):void 0},s.getPenaltyN1=function(t){for(var e=t.size,i=0,r=0,n=0,o=null,a=null,s=0;s<e;s++){for(var r=n=0,o=a=null,h=0;h<e;h++){var l=t.get(s,h);l===o?r++:(5<=r&&(i+=r-5+3),o=l,r=1),(l=t.get(h,s))===a?n++:(5<=n&&(i+=n-5+3),a=l,n=1)}5<=r&&(i+=r-5+3),5<=n&&(i+=n-5+3)}return i},s.getPenaltyN2=function(t){for(var e=t.size,i=0,r=0;r<e-1;r++)for(var n=0;n<e-1;n++){var o=t.get(r,n)+t.get(r,n+1)+t.get(r+1,n)+t.get(r+1,n+1);4!==o&&0!==o||i++}return 3*i},s.getPenaltyN3=function(t){for(var e=t.size,i=0,r=0,n=0,o=0;o<e;o++)for(var r=n=0,a=0;a<e;a++)r=r<<1&2047|t.get(o,a),10<=a&&(1488===r||93===r)&&i++,n=n<<1&2047|t.get(a,o),10<=a&&(1488===n||93===n)&&i++;return 40*i},s.getPenaltyN4=function(t){for(var e=0,i=t.data.length,r=0;r<i;r++)e+=t.data[r];return 10*Math.abs(Math.ceil(100*e/i/5)-10)},s.applyMask=function(t,e){for(var i=e.size,r=0;r<i;r++)for(var n=0;n<i;n++)e.isReserved(n,r)||e.xor(n,r,function(t,e,i){switch(t){case s.Patterns.PATTERN000:return(e+i)%2==0;case s.Patterns.PATTERN001:return e%2==0;case s.Patterns.PATTERN010:return i%3==0;case s.Patterns.PATTERN011:return(e+i)%3==0;case s.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(i/3))%2==0;case s.Patterns.PATTERN101:return e*i%2+e*i%3==0;case s.Patterns.PATTERN110:return(e*i%2+e*i%3)%2==0;case s.Patterns.PATTERN111:return(e*i%3+(e+i)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}(t,n,r))},s.getBestMask=function(t,e){for(var i=Object.keys(s.Patterns).length,r=0,n=1/0,o=0;o<i;o++){e(o),s.applyMask(o,t);var a=s.getPenaltyN1(t)+s.getPenaltyN2(t)+s.getPenaltyN3(t)+s.getPenaltyN4(t);s.applyMask(o,t),a<n&&(n=a,r=o)}return r}}),_=(f.Patterns,f.isValid,f.getPenaltyN1,f.getPenaltyN2,f.getPenaltyN3,f.getPenaltyN4,f.applyMask,f.getBestMask,[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81]),g=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],y=new Uint8Array(512),m=new Uint8Array(256);!function(){for(var t=1,e=0;e<255;e++)y[e]=t,m[t]=e,256&(t<<=1)&&(t^=285);for(var i=255;i<512;i++)y[i]=y[i-255]}();function v(t,e){return 0===t||0===e?0:y[m[t]+m[e]]}var b=e(function(t,r){r.mul=function(t,e){for(var i=new Uint8Array(t.length+e.length-1),r=0;r<t.length;r++)for(var n=0;n<e.length;n++)i[r+n]^=v(t[r],e[n]);return i},r.mod=function(t,e){for(var i=new Uint8Array(t);0<=i.length-e.length;){for(var r=i[0],n=0;n<e.length;n++)i[n]^=v(e[n],r);for(var o=0;o<i.length&&0===i[o];)o++;i=i.slice(o)}return i},r.generateECPolynomial=function(t){for(var e=new Uint8Array([1]),i=0;i<t;i++)e=r.mul(e,new Uint8Array([1,y[i]]));return e}});function T(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}b.mul,b.mod,b.generateECPolynomial,T.prototype.initialize=function(t){this.degree=t,this.genPoly=b.generateECPolynomial(this.degree)},T.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=new Uint8Array(t.length+this.degree);e.set(t);var i=b.mod(e,this.genPoly),t=this.degree-i.length;if(0<t){e=new Uint8Array(this.degree);return e.set(i,t),e}return i};function C(t){return!isNaN(t)&&1<=t&&t<=40}function E(t,e){for(var i=(e=t.bit<<3|e)<<10;0<=r(i)-N;)i^=1335<<r(i)-N;return 21522^(e<<10|i)}var P,D=T,O="(?:(?![A-Z0-9 $%*+\\-./:]|"+(P="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+".replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",I=new RegExp(P,"g"),$=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),A=new RegExp(O,"g"),R=new RegExp("[0-9]+","g"),O=new RegExp("[A-Z $%*+\\-./:]+","g"),B=new RegExp("^"+P+"$"),M=new RegExp("^[0-9]+$"),L=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),F={KANJI:I,BYTE_KANJI:$,BYTE:A,NUMERIC:R,ALPHANUMERIC:O,testKanji:function(t){return B.test(t)},testNumeric:function(t){return M.test(t)},testAlphanumeric:function(t){return L.test(t)}},k=e(function(t,i){i.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},i.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},i.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},i.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},i.MIXED={bit:-1},i.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!C(e))throw new Error("Invalid version: "+e);return 1<=e&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},i.getBestModeForData=function(t){return F.testNumeric(t)?i.NUMERIC:F.testAlphanumeric(t)?i.ALPHANUMERIC:F.testKanji(t)?i.KANJI:i.BYTE},i.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},i.isValid=function(t){return t&&t.bit&&t.ccBits},i.from=function(t,e){if(i.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return i.NUMERIC;case"alphanumeric":return i.ALPHANUMERIC;case"kanji":return i.KANJI;case"byte":return i.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return e}}}),j=(k.NUMERIC,k.ALPHANUMERIC,k.BYTE,k.KANJI,k.MIXED,k.getCharCountIndicator,k.getBestModeForData,k.isValid,e(function(t,n){var i=r(7973);function o(t,e){return k.getCharCountIndicator(t,e)+4}n.from=function(t,e){return C(t)?parseInt(t,10):e},n.getCapacity=function(t,e,i){if(!C(t))throw new Error("Invalid QR Code version");void 0===i&&(i=k.BYTE);e=8*(x[t]-S(t,e));if(i===k.MIXED)return e;var r=e-o(i,t);switch(i){case k.NUMERIC:return Math.floor(r/10*3);case k.ALPHANUMERIC:return Math.floor(r/11*2);case k.KANJI:return Math.floor(r/13);default:k.BYTE;return Math.floor(r/8)}},n.getBestVersionForData=function(t,e){var i,e=h.from(e,h.M);if(Array.isArray(t)){if(1<t.length)return function(t,e){for(var i=1;i<=40;i++)if(function(t,i){var r=0;return t.forEach(function(t){var e=o(t.mode,i);r+=e+t.getBitsLength()}),r}(t,i)<=n.getCapacity(i,e,k.MIXED))return i}(t,e);if(0===t.length)return 1;i=t[0]}else i=t;return function(t,e,i){for(var r=1;r<=40;r++)if(e<=n.getCapacity(r,i,t))return r}(i.mode,i.getLength(),e)},n.getEncodedBits=function(t){if(!C(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;0<=r(e)-i;)e^=7973<<r(e)-i;return t<<12|e}})),N=(j.getCapacity,j.getBestVersionForData,j.getEncodedBits,r(1335));function G(t){this.mode=k.NUMERIC,this.data=t.toString()}G.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},G.prototype.getLength=function(){return this.data.length},G.prototype.getBitsLength=function(){return G.getBitsLength(this.data.length)},G.prototype.write=function(t){for(var e,i,r=0;r+3<=this.data.length;r+=3)e=this.data.substr(r,3),i=parseInt(e,10),t.put(i,10);var n=this.data.length-r;0<n&&(e=this.data.substr(r),i=parseInt(e,10),t.put(i,3*n+1))};var U=G,H=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function z(t){this.mode=k.ALPHANUMERIC,this.data=t}z.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},z.prototype.getLength=function(){return this.data.length},z.prototype.getBitsLength=function(){return z.getBitsLength(this.data.length)},z.prototype.write=function(t){for(var e=0;e+2<=this.data.length;e+=2){var i=45*H.indexOf(this.data[e]);i+=H.indexOf(this.data[e+1]),t.put(i,11)}this.data.length%2&&t.put(H.indexOf(this.data[e]),6)};var W=z;function V(t){this.mode=k.BYTE,this.data=new Uint8Array(function(t){for(var e=[],i=t.length,r=0;r<i;r++){var n,o=t.charCodeAt(r);55296<=o&&o<=56319&&r+1<i&&(56320<=(n=t.charCodeAt(r+1))&&n<=57343&&(o=1024*(o-55296)+n-56320+65536,r+=1)),o<128?e.push(o):o<2048?(e.push(o>>6|192),e.push(63&o|128)):o<55296||57344<=o&&o<65536?(e.push(o>>12|224),e.push(o>>6&63|128),e.push(63&o|128)):65536<=o&&o<=1114111?(e.push(o>>18|240),e.push(o>>12&63|128),e.push(o>>6&63|128),e.push(63&o|128)):e.push(239,191,189)}return new Uint8Array(e).buffer}(t))}V.getBitsLength=function(t){return 8*t},V.prototype.getLength=function(){return this.data.length},V.prototype.getBitsLength=function(){return V.getBitsLength(this.data.length)},V.prototype.write=function(t){for(var e=0,i=this.data.length;e<i;e++)t.put(this.data[e],8)};var Y=V;function X(t){this.mode=k.KANJI,this.data=t}X.getBitsLength=function(t){return 13*t},X.prototype.getLength=function(){return this.data.length},X.prototype.getBitsLength=function(){return X.getBitsLength(this.data.length)},X.prototype.write=function(t){for(var e=0;e<this.data.length;e++){var i=(i=this.data[e],a(i));if(33088<=i&&i<=40956)i-=33088;else{if(!(57408<=i&&i<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");i-=49472}t.put(i=192*(i>>>8&255)+(255&i),13)}};var q=X,K=e(function(t){var d={single_source_shortest_paths:function(t,e,i){var r={},n={};n[e]=0;var o,a,s,h,l,u,c,p=d.PriorityQueue.make();for(p.push(e,0);!p.empty();)for(s in a=(o=p.pop()).value,h=o.cost,l=t[a]||{})l.hasOwnProperty(s)&&(u=h+l[s],c=n[s],(void 0===n[s]||u<c)&&(n[s]=u,p.push(s,u),r[s]=a));if(void 0===i||void 0!==n[i])return r;i=["Could not find a path from ",e," to ",i,"."].join("");throw new Error(i)},extract_shortest_path_from_predecessor_list:function(t,e){for(var i=[],r=e;r;)i.push(r),t[r],r=t[r];return i.reverse(),i},find_path:function(t,e,i){e=d.single_source_shortest_paths(t,e,i);return d.extract_shortest_path_from_predecessor_list(e,i)},PriorityQueue:{make:function(t){var e,i=d.PriorityQueue,r={};for(e in t=t||{},i)i.hasOwnProperty(e)&&(r[e]=i[e]);return r.queue=[],r.sorter=t.sorter||i.default_sorter,r},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){this.queue.push({value:t,cost:e}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=d}),J=e(function(t,a){function s(t){return unescape(encodeURIComponent(t)).length}function n(t,e,i){for(var r,n=[];null!==(r=t.exec(i));)n.push({data:r[0],index:r.index,mode:e,length:r[0].length});return n}function h(t){var e,i=n(F.NUMERIC,k.NUMERIC,t),r=n(F.ALPHANUMERIC,k.ALPHANUMERIC,t),t=o()?(e=n(F.BYTE,k.BYTE,t),n(F.KANJI,k.KANJI,t)):(e=n(F.BYTE_KANJI,k.BYTE,t),[]);return i.concat(r,e,t).sort(function(t,e){return t.index-e.index}).map(function(t){return{data:t.data,mode:t.mode,length:t.length}})}function f(t,e){switch(e){case k.NUMERIC:return U.getBitsLength(t);case k.ALPHANUMERIC:return W.getBitsLength(t);case k.KANJI:return q.getBitsLength(t);case k.BYTE:return Y.getBitsLength(t)}}function i(t,e){var i=k.getBestModeForData(t);if((e=k.from(e,i))!==k.BYTE&&e.bit<i.bit)throw new Error('"'+t+'" cannot be encoded with mode '+k.toString(e)+".\n Suggested mode is: "+k.toString(i));switch(e=e===k.KANJI&&!o()?k.BYTE:e){case k.NUMERIC:return new U(t);case k.ALPHANUMERIC:return new W(t);case k.KANJI:return new q(t);case k.BYTE:return new Y(t)}}a.fromArray=function(t){return t.reduce(function(t,e){return"string"==typeof e?t.push(i(e,null)):e.data&&t.push(i(e.data,e.mode)),t},[])},a.fromString=function(t,e){for(var i=function(t,e){for(var i={},r={start:{}},n=["start"],o=0;o<t.length;o++){for(var a=t[o],s=[],h=0;h<a.length;h++){var l=a[h],u=""+o+h;s.push(u),i[u]={node:l,lastCount:0},r[u]={};for(var c=0;c<n.length;c++){var p=n[c];i[p]&&i[p].node.mode===l.mode?(r[p][u]=f(i[p].lastCount+l.length,l.mode)-f(i[p].lastCount,l.mode),i[p].lastCount+=l.length):(i[p]&&(i[p].lastCount=l.length),r[p][u]=f(l.length,l.mode)+4+k.getCharCountIndicator(l.mode,e))}}n=s}for(var d=0;d<n.length;d++)r[n[d]].end=0;return{map:r,table:i}}(function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i];switch(r.mode){case k.NUMERIC:e.push([r,{data:r.data,mode:k.ALPHANUMERIC,length:r.length},{data:r.data,mode:k.BYTE,length:r.length}]);break;case k.ALPHANUMERIC:e.push([r,{data:r.data,mode:k.BYTE,length:r.length}]);break;case k.KANJI:e.push([r,{data:r.data,mode:k.BYTE,length:s(r.data)}]);break;case k.BYTE:e.push([{data:r.data,mode:k.BYTE,length:s(r.data)}])}}return e}(h(t)),e),r=K.find_path(i.map,"start","end"),n=[],o=1;o<r.length-1;o++)n.push(i.table[r[o]].node);return a.fromArray(n.reduce(function(t,e){var i=0<=t.length-1?t[t.length-1]:null;return i&&i.mode===e.mode?t[t.length-1].data+=e.data:t.push(e),t},[]))},a.rawSplit=function(t){return a.fromArray(h(t))}});function Q(t,e,i){for(var r,n=t.size,o=E(e,i),a=0;a<15;a++)r=1==(o>>a&1),a<6?t.set(a,8,r,!0):a<8?t.set(a+1,8,r,!0):t.set(n-15+a,8,r,!0),a<8?t.set(8,n-a-1,r,!0):a<9?t.set(8,15-a-1+1,r,!0):t.set(8,15-a-1,r,!0);t.set(n-8,8,1,!0)}function Z(t,e,i,r){var n;if(Array.isArray(t))n=J.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var o,a=e;a||(o=J.rawSplit(t),a=j.getBestVersionForData(o,i)),n=J.fromString(t,a||40)}t=j.getBestVersionForData(n,i);if(!t)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<t)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+t+".\n")}else e=t;a=function(e,t,i){var r=new l;for(i.forEach(function(t){r.put(t.mode.bit,4),r.put(t.getLength(),k.getCharCountIndicator(t.mode,e)),t.write(r)}),i=8*(x[e]-S(e,t)),r.getLengthInBits()+4<=i&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(0);for(var n=(i-r.getLengthInBits())/8,o=0;o<n;o++)r.put(o%2?17:236,8);return function(t,e,i){for(var r=x[e],n=r-S(e,i),o=w(e,i),a=o-r%o,i=Math.floor(r/o),s=Math.floor(n/o),h=s+1,l=i-s,u=new D(l),c=0,p=new Array(o),d=new Array(o),f=0,_=new Uint8Array(t.buffer),g=0;g<o;g++){var y=g<a?s:h;p[g]=_.slice(c,c+y),d[g]=u.encode(p[g]),c+=y,f=Math.max(f,y)}for(var m,v=new Uint8Array(r),b=0,T=0;T<f;T++)for(m=0;m<o;m++)T<p[m].length&&(v[b++]=p[m][T]);for(T=0;T<l;T++)for(m=0;m<o;m++)v[b++]=d[m][T];return v}(r,e,t)}(e,i,n),t=s(e),t=new u(t);return function(t,e){for(var i=t.size,r=d(e),n=0;n<r.length;n++)for(var o=r[n][0],a=r[n][1],s=-1;s<=7;s++)if(!(o+s<=-1||i<=o+s))for(var h=-1;h<=7;h++)a+h<=-1||i<=a+h||(0<=s&&s<=6&&(0===h||6===h)||0<=h&&h<=6&&(0===s||6===s)||2<=s&&s<=4&&2<=h&&h<=4?t.set(o+s,a+h,!0,!0):t.set(o+s,a+h,!1,!0))}(t,e),function(t){for(var e=t.size,i=8;i<e-8;i++){var r=i%2==0;t.set(i,6,r,!0),t.set(6,i,r,!0)}}(t),function(t,e){for(var i=c.getPositions(e),r=0;r<i.length;r++)for(var n=i[r][0],o=i[r][1],a=-2;a<=2;a++)for(var s=-2;s<=2;s++)-2===a||2===a||-2===s||2===s||0===a&&0===s?t.set(n+a,o+s,!0,!0):t.set(n+a,o+s,!1,!0)}(t,e),Q(t,i,0),7<=e&&function(t,e){for(var i,r,n,o=t.size,a=j.getEncodedBits(e),s=0;s<18;s++)i=Math.floor(s/3),t.set(i,r=s%3+o-8-3,n=1==(a>>s&1),!0),t.set(r,i,n,!0)}(t,e),function(t,e){for(var i=t.size,r=-1,n=i-1,o=7,a=0,s=i-1;0<s;s-=2)for(6===s&&s--;;){for(var h,l=0;l<2;l++)t.isReserved(n,s-l)||(h=!1,a<e.length&&(h=1==(e[a]>>>o&1)),t.set(n,s-l,h),-1==--o&&(a++,o=7));if((n+=r)<0||i<=n){n-=r,r=-r;break}}}(t,a),isNaN(r)&&(r=f.getBestMask(t,Q.bind(null,t,i))),f.applyMask(r,t),Q(t,i,r),{modules:t,version:e,errorCorrectionLevel:i,maskPattern:r,segments:n}}J.fromArray,J.fromString,J.rawSplit;function tt(t,e){if(void 0===t||""===t)throw new Error("No input text");var i,r,n=h.M;return void 0!==e&&(n=h.from(e.errorCorrectionLevel,h.M),i=j.from(e.version),r=f.from(e.maskPattern),e.toSJISFunc&&function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');a=t}(e.toSJISFunc)),Z(t,i,n,r)}var et=e(function(t,d){function n(t){if("string"!=typeof(t="number"==typeof t?t.toString():t))throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||8<e.length)throw new Error("Invalid hex color: "+t);6===(e=3===e.length||4===e.length?Array.prototype.concat.apply([],e.map(function(t){return[t,t]})):e).length&&e.push("F","F");t=parseInt(e.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:255&t,hex:"#"+e.slice(0,6).join("")}}d.getOptions=function(t){(t=t||{}).color||(t.color={});var e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,i=t.width&&21<=t.width?t.width:void 0,r=t.scale||4;return{width:i,scale:i?4:r,margin:e,color:{dark:n(t.color.dark||"#000000ff"),light:n(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},d.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},d.getImageWidth=function(t,e){var i=d.getScale(t,e);return Math.floor((t+2*e.margin)*i)},d.qrToImageData=function(t,e,i){for(var r=e.modules.size,n=e.modules.data,o=d.getScale(r,i),a=Math.floor((r+2*i.margin)*o),s=i.margin*o,h=[i.color.light,i.color.dark],l=0;l<a;l++)for(var u=0;u<a;u++){var c=4*(l*a+u),p=i.color.light;s<=l&&s<=u&&l<a-s&&u<a-s&&(p=h[n[Math.floor((l-s)/o)*r+Math.floor((u-s)/o)]?1:0]),t[c++]=p.r,t[c++]=p.g,t[c++]=p.b,t[c]=p.a}}}),I=(et.getOptions,et.getScale,et.getImageWidth,et.qrToImageData,e(function(t,r){r.render=function(t,e,i){var r=e;void 0!==(n=i)||e&&e.getContext||(n=e,e=void 0),e||(r=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}());var n=et.getOptions(n),o=et.getImageWidth(t.modules.size,n),i=r.getContext("2d"),e=i.createImageData(o,o);return et.qrToImageData(e.data,t,n),n=r,o=o,i.clearRect(0,0,n.width,n.height),n.style||(n.style={}),n.height=o,n.width=o,n.style.height=o+"px",n.style.width=o+"px",i.putImageData(e,0,0),r},r.renderToDataURL=function(t,e,i){void 0!==(i=i)||e&&e.getContext||(i=e,e=void 0);i=i||{},t=r.render(t,e,i),e=i.type||"image/png",i=i.rendererOpts||{};return t.toDataURL(e,i.quality)}}));function it(t,e){var i=t.a/255,t=e+'="'+t.hex+'"';return i<1?t+" "+e+'-opacity="'+i.toFixed(2).slice(1)+'"':t}function rt(t,e,i){e=t+e;return void 0!==i&&(e+=" "+i),e}I.render,I.renderToDataURL;function nt(r,n,o,a,t){var e=[].slice.call(arguments,1),i=e.length,e="function"==typeof e[i-1];if(!(e||"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then))throw new Error("Callback required as last argument");if(!e){if(i<1)throw new Error("Too few arguments provided");return 1===i?(o=n,n=a=void 0):2!==i||n.getContext||(a=o,o=n,n=void 0),new Promise(function(t,e){try{var i=tt(o,a);t(r(i,n,a))}catch(t){e(t)}})}if(i<2)throw new Error("Too few arguments provided");2===i?(t=o,o=n,n=a=void 0):3===i&&(n.getContext&&void 0===t?(t=a,a=void 0):(t=a,a=o,o=n,n=void 0));try{var s=tt(o,a);t(null,r(s,n,a))}catch(r){t(r)}}$=tt,A=nt.bind(null,I.render),R=nt.bind(null,I.renderToDataURL),O=nt.bind(null,function(t,e,i){return r=t,n=i,a=et.getOptions(n),t=r.modules.size,i=r.modules.data,n=t+2*a.margin,r=a.color.light.a?"<path "+it(a.color.light,"fill")+' d="M0 0h'+n+"v"+n+'H0z"/>':"",t="<path "+it(a.color.dark,"stroke")+' d="'+function(t,e,i){for(var r="",n=0,o=!1,a=0,s=0;s<t.length;s++){var h=Math.floor(s%e),l=Math.floor(s/e);h||o||(o=!0),t[s]?(a++,0<s&&0<h&&t[s-1]||(r+=o?rt("M",h+i,.5+l+i):rt("m",n,0),n=0,o=!1),h+1<e&&t[s+1]||(r+=rt("h",a),a=0)):n++}return r}(i,t,a.margin)+'"/>',t='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+('viewBox="0 0 '+n+" "+n+'"')+' shape-rendering="crispEdges">'+r+t+"</svg>\n","function"==typeof o&&o(null,t),t;var r,n,o,a}),I={create:$,toCanvas:A,toDataURL:R,toString:O};return t.create=$,t.default=I,t.toCanvas=A,t.toDataURL=R,t.toString=O,t}({});__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};window.GestureRecognizerPlugin=function(){function t(t,e,i,r,n){void 0===t&&(t=""),void 0===e&&(e=0),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=1),this._failed=!1,this._priority=0,this._numTouchesRequired=1,this._continuous=!1,this._possible=!0,this._gestureType=t,this._continuous=r,this._requireGestureRecognizerToFail=i,this._priority=e||0,this._numTouchesRequired=n}return t.activate=function(t){for(var e=t.length;-1<--e;)GestureManager._gesturePlugins[(new t[e])._gestureName]=t[e]},t.prototype._onInitGesture=function(t,e,i){return this._callBack=t,this._config=e,this._g=i,null!=this._config&&null!=this._config.shouldReceiveTouch&&(this._shouldReceiveTouch=this._config.shouldReceiveTouch),this._result=new GestureEvent(GestureEvent.ACHE_GESTURE,this._g),!0},t.prototype.executeGestureRecognizedCallback=function(){this._callBack.recognized&&(this._result.state=GestureState.RECOGNIZED,this._callBack.recognized(this._result))},t.prototype.checkGesture=function(t){return!1},t.prototype.updateValue=function(t){return!0},t.prototype.gesturePossible=function(t){this._possible=t,this._callBack.possible&&(this._result.state=GestureState.POSSIBLE,this._result.possible=t,this._callBack.possible(this._result))},t.prototype.gestureBegan=function(){this._callBack.began&&(this._result.state=GestureState.BEGAN,this._callBack.began(this._result))},t.prototype.gestureEnded=function(){this._callBack.ended&&(this._result.state=GestureState.ENDED,this._callBack.ended(this._result))},t}(),__reflect(GestureRecognizerPlugin.prototype,"GestureRecognizerPlugin"),window.PinchGestureRecognizer=function(i){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);e=i.call(this,GestureType.PINCH,t,e,!0,2)||this;return e._cx=0,e._cy=0,e._offsetX=0,e._offsetY=0,e.pZero=new egret.Point,e}return __extends(t,i),t.prototype.checkGesture=function(t){if(2!=t.length)return this._cx=0,this._offsetX=this._offsetY=0,!1;var e=t[0],t=t[1];return e.type==egret.TouchEvent.TOUCH_END||t.type==egret.TouchEvent.TOUCH_END?(this._cx=0,this._offsetX=this._offsetY=0,!1):(0!=this._cx||(this._cx=.5*(e.stageX+t.stageX),this._cy=.5*(e.stageY+t.stageY),this._d1X=e.stageX-t.stageX,this._d1Y=e.stageY-t.stageY,this._localLocation=this._g.target.globalToLocal(this._cx,this._cy,this._localLocation),this._callBack.changed&&(this._result.dx=this._offsetX,this._result.dy=this._offsetY,this._result.dScale=1,this._result.localLocation=this._localLocation,this._callBack.changed(this._result))),!0)},t.prototype.updateValue=function(t){if(2!=t.length)return this._cx=0,!1;var e=t[0],i=t[1];if(e.type==egret.TouchEvent.TOUCH_END||i.type==egret.TouchEvent.TOUCH_END)return this._cx=0,this._offsetX=this._offsetY=0,!1;var r=this._cx,t=this._cy;this._cx=.5*(e.stageX+i.stageX),this._cy=.5*(e.stageY+i.stageY),this._offsetX=this._cx-r,this._offsetY=this._cy-t,this._d2X=e.stageX-i.stageX,this._d2Y=e.stageY-i.stageY,this._localLocation=this._g.target.globalToLocal(this._cx,this._cy,this._localLocation);i=egret.Point.distance(new egret.Point(this._d2X,this._d2Y),this.pZero)/egret.Point.distance(new egret.Point(this._d1X,this._d1Y),this.pZero);return this._d1X=this._d2X,this._d1Y=this._d2Y,this._callBack.changed&&(this._result.dx=this._offsetX,this._result.dy=this._offsetY,this._result.dScale=i,this._result.localLocation=this._localLocation,this._callBack.changed(this._result)),!0},t}(GestureRecognizerPlugin),__reflect(PinchGestureRecognizer.prototype,"PinchGestureRecognizer"),window.DoubleTapGestureRecognizer=function(i){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);e=i.call(this,GestureType.DOUBLE_TAP,t,e)||this;return e._interval=300,e._max_dist=80,e._count=0,e._validate=!1,e._sx=0,e._sy=0,e._t=new egret.Timer(e._interval,1),e._t.addEventListener(egret.TimerEvent.TIMER,e.onCheck,e),e._count=0,e}return __extends(t,i),t.prototype.checkGesture=function(t){var e,t=t[0];return t.type==egret.TouchEvent.TOUCH_BEGIN&&0==this._count&&(this._failed=!1),t.type,egret.TouchEvent.TOUCH_MOVE,t.type==egret.TouchEvent.TOUCH_END&&(0==this._count?(this._count+=1,this._validate=!0,this._t.reset(),this._t.start(),this._sx=t.stageX,this._sy=t.stageY):1==this._count&&(this._validate&&Math.abs(t.stageX-this._sx)<this._max_dist&&Math.abs(t.stageY-this._sy)<this._max_dist&&(e=!0),this._count=0,this._t.stop())),e},t.prototype.onCheck=function(t){this._failed=!0,this._validate=!1,this._count=0,this._requireGestureRecognizerToFail&&this._g.gestureRecognizerStateChange(this._gestureType,!1)},t}(GestureRecognizerPlugin),__reflect(DoubleTapGestureRecognizer.prototype,"DoubleTapGestureRecognizer"),window.PropGesture=function(t,e,i,r,n,o,a,s){void 0===e&&(e="executeGestureRecognizedCallback"),void 0===i&&(i="checkGesture"),void 0===r&&(r="updateValue"),void 0===n&&(n=null),void 0===o&&(o=!1),void 0===a&&(a=0),void 0===s&&(s=1),this.n=0,this.p=!0,this.pr=0,this.t=t,this.c=o,n&&((n._prev=this)._next=n),this.p0=e,this.p1=i,this.p2=r,this.n=s},__reflect(PropGesture.prototype,"PropGesture"),window.GestureEvent=function(r){function t(t,e,i){void 0===i&&(i="");t=r.call(this,t,!1,null)||this;return t.gm=e,t.state=i,t}return __extends(t,r),t.ACHE_GESTURE="acheGesture",t}(egret.Event),__reflect(GestureEvent.prototype,"GestureEvent"),window.GestureType=function(){function t(){}return t.DOUBLE_TAP="doubleTap",t.PINCH="pinch",t}(),__reflect(GestureType.prototype,"GestureType"),window.GestureState=function(){function t(){}return t.POSSIBLE="possible",t.RECOGNIZED="recognized",t.FAILED="failed",t.BEGAN="began",t.CHANGED="changed",t.ENDED="ended",t.CANCELLED="cancelled",t}(),__reflect(GestureState.prototype,"GestureState"),window.GestureManager=function(){function r(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),this._ref={},this._ts=[],this._touchEventPool=[],this.vars=e||{},(this.target=t).touchEnabled=!0,this._allowSimultaneous=i,this._initGesture()}return r.prototype._initGesture=function(){var t,e;for(t in this.vars)t in r._gesturePlugins&&(e=new r._gesturePlugins[t])._onInitGesture(this.vars[t],this.vars[t].config,this)&&(this._firstG=new PropGesture(e,"executeGestureRecognizedCallback","checkGesture","updateValue",this._firstG,e._continuous,e._priority,e._numTouchesRequired),this._ref[e._gestureType]=this._firstG);this.linkGestureCondition(),this.target.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouched,this),this.target.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouched,this),this.target.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouched,this),egret.MainContext.instance.stage.addEventListener(egret.Event.LEAVE_STAGE,this.leaveStage,this)},r.prototype.leaveStage=function(t){for(;0<this._ts.length;){var e=this._ts.splice(0,1)[0];this._touchEventPool.push(e)}},r.prototype.linkGestureCondition=function(){for(var t,e=this._firstG;e;)e.t._callBack.hasOwnProperty("requireGestureToFail")&&null!=e.t._callBack.requireGestureToFail&&(t=this._ref[e.t._callBack.requireGestureToFail.type],(e._f=t)._o=e,t.t._requireGestureRecognizerToFail=!0,e.t._requireGestureRecognizerToFail=!0),e=e._next},r.prototype.gestureRecognizerStateChange=function(t,e){var i,r=this._ref[t];if(null!=r._o?e?(r.t[r.p0](),r._o.h&&(r._o.h=!1),r.r=!0,r.c&&(i=this._allowSimultaneous?null:r),i=r):(r.f=!0,r._o.h&&(r._o.t[r._o.p0](),r._o.c&&(r._o.r=!0),r.f=!1,r._o.h=!1)):e&&(r.t[r.p0](),r.r=!0,i=r),null!=i)for(r=this._firstG;r;){if(r==i){r!=this._firstG&&(r._prev._next=r._next,null!=r._next&&(r._next._prev=r._prev),(this._firstG._prev=r)._next=this._firstG,r._prev=null,this._firstG=r);break}r=r._next}},r.prototype.removeTouch=function(t){for(var e=0;e<this._ts.length;e++)if(this._ts[e].touchPointID==t.touchPointID){var i=this._ts.splice(e,1)[0];this._touchEventPool.push(i);break}},r.prototype.cloneTouchEvent=function(t){var e=this._touchEventPool.pop();return(e=e||{}).stageX=t.stageX,e.stageY=t.stageY,e.type=t.type,e.touchDown=t.touchDown,e.touchPointID=t.touchPointID,e},r.prototype.onTouched=function(t){this.removeTouch(t),this._ts.push(this.cloneTouchEvent(t));var e,i,r,n=this._ts;0!=n.length&&(e=n[0],i=n.length,e&&(e.type==egret.TouchEvent.TOUCH_BEGIN&&(this.startGlobalX=e.stageX,this.startGlobalY=e.stageY),r=this,function(){var t,e=r._firstG;if(null!=e&&(!e.r||e.c||(e.r=!1,r._allowSimultaneous)))if(e.r&&!r._allowSimultaneous&&e.c)e.r=e.t[e.p2](n);else{for(;e;){if(null!=e.t._shouldReceiveTouch&&!e.t._shouldReceiveTouch())return e=e._next;e=e.n>=i&&e.t[e.p1](n)?(null!=e._o&&e._o.h&&(e._o.h=!1),null!=e._f?e._f.r?(e._f.c||(e._f.r=!1),e._next):e._f.f?(null!=e._o&&e._o.h&&(e._o.h=!1),e._f.f=!1,e.t[e.p0](),null!=e._o&&(e.r=!0),e.c&&(e.r=!0,e.t[e.p2](n),t=r._allowSimultaneous?null:e),r._allowSimultaneous?e._next:null):(e.h||(e.h=!0),e._next):(null!=e._o&&e._o.h&&(e._o.h=!1),e.t[e.p0](),null!=e._o&&e.c&&(e.r=!0),e.c&&(e.r=!0,e.t[e.p2](n),t=r._allowSimultaneous?null:e),r._allowSimultaneous?e._next:null)):null!=e._o?(e.f=e.t._failed,e.f&&e._o.h?(e._o.t[e._o.p0](),e._o.c&&(e._o.t[e._o.p2](n),e._o.r=!0),e.f=!1,e._o.h=!1,null):e._next):e._next}if(null!=t&&!r._allowSimultaneous)for(e=r._firstG;e;){if(e==t){e!=r._firstG&&(e._prev._next=e._next,null!=e._next&&(e._next._prev=e._prev),(r._firstG._prev=e)._next=r._firstG,e._prev=null,r._firstG=e);break}e=e._next}}}(),null!=this.vars.onTouch&&this.vars.onTouch instanceof Function&&this.vars.onTouch(n),t.type==egret.TouchEvent.TOUCH_END&&this.removeTouch(t)))},r.add=function(t,e,i){i=new r(t,e=void 0===e?null:e,i=void 0===i?!1:i);return null==r._gestures[t.hashCode]?r._gestures[t.hashCode]=[i]:r._gestures[t.hashCode].push(i),i},r.removeAll=function(t){var e=r._gestures[t.hashCode];if(e&&0<e.length){for(var i=0;i<e.length;i++)e[i].dispose();e.length=0}},r.prototype.add=function(t){var e,i;for(e in t)e in r._gesturePlugins&&(i=new r._gesturePlugins[e])._onInitGesture(t[e],t[e].config,this)&&(this._firstG=new PropGesture(i,"executeGestureRecognizedCallback","checkGesture","updateValue",this._firstG,i._continuous,i._priority,i._numTouchesRequired),this._ref[i._gestureType]=this._firstG)},r.prototype.remove=function(t){for(var e,i=this._firstG;i;)i.t._gestureType==t&&(null!=(e=i)._prev&&(e._prev._next=e._next),null!=e._next&&(e._next._prev=e._prev),e==this._firstG&&(this._firstG=e._next)),i=i._next;return null!=e},r.prototype.dispose=function(){this.target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouched,this),this.target.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouched,this),this.target.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouched,this),egret.MainContext.instance.stage.removeEventListener(egret.Event.LEAVE_STAGE,this.leaveStage,this)},Object.defineProperty(r.prototype,"allowSimultaneous",{get:function(){return this._allowSimultaneous},set:function(t){this._allowSimultaneous=t},enumerable:!0,configurable:!0}),r._gesturePlugins={doubleTap:DoubleTapGestureRecognizer,pinch:PinchGestureRecognizer},r._gestures={},r}(),__reflect(GestureManager.prototype,"GestureManager"),function(t){var e=(i.prototype.setTarget=function(t){this.target=t},i.prototype.setScene=function(t){this.scene=t},i.prototype.setSceneRect=function(t,e){this.sceneRect={width:t,height:e}},i.prototype.setViewRect=function(t,e){this.viewRect={width:t,height:e}},i.prototype.move=function(){if(this.target&&this.scene&&this.sceneRect&&this.viewRect){var t=this.scene,e=this.viewRect,i=e.height,r=e.width,n=this.sceneRect,e=n.height*t.scaleY,n=n.width*t.scaleX;if(n<=r&&e<=i)return{x:0,y:0};n=n<=r?0:Math.max(Math.min(0,r/2-this.target.x*t.scaleX),r-n);return{x:n,y:e<=i?0:Math.max(Math.min(0,i/2-this.target.y*t.scaleY),i-e)}}},i);function i(){}t.Camera2D=e}(god=god||{}),function(m){var t;function _(t,e,i,r){var n=!1;if(r!=t.writeByte&&r!=t.writeShort&&r!=t.writeInt&&r!=t.writeLong&&r!=t.writeFloat&&r!=t.writeDouble||(n=!0),i){t.writeShort(e.length);for(var o=0,a=e.length;o<a;o++){var s=n?Number(e[o]):e[o];r.call(t,s)}}else r.call(t,n?Number(e):e)}function v(t,e,i){if(e){for(var r=[],n=t.readShort(),o=0;o<n;o++)r.push(i.call(t));return r}return i.call(t)}m.m2sMap={},m.s2fMap={},egret.ByteArray.prototype.readLong=function(){if(this.validate(8)){var t=this.data.getInt32(this._position,0==this.$endian);this.position+=4;var e=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,new m.Long(e,t,!1).toNumber()}},egret.ByteArray.prototype.writeLong=function(t){this.validateBuffer(8);t=m.Long.fromNumber(Number(t));this.data.setInt32(this._position,t.high,0==this.$endian),this.position+=4,this.data.setInt32(this._position,t.low,0==this.$endian),this.position+=4},egret.ByteArray.prototype.readLongStr=function(){if(this.validate(8)){var t=this.data.getInt32(this._position,0==this.$endian);this.position+=4;var e=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,new m.Long(e,t,!1).toString()}},egret.ByteArray.prototype.writeLongStr=function(t){this.validateBuffer(8);t=m.Long.fromString(t,!1);this.data.setInt32(this._position,t.high,0==this.$endian),this.position+=4,this.data.setInt32(this._position,t.low,0==this.$endian),this.position+=4},egret.ByteArray.prototype.readStr32=function(){var t=this.readInt();return 0<t?this.readUTFBytes(t):""},egret.ByteArray.prototype.writeStr32=function(t){var e=this.encodeUTF8(t),t=e.length;this.validateBuffer(4+t),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4,this._writeUint8Array(e,!1)},(t=m.msg||(m.msg={})).encode=function(t,e,i){var r=m.m2sMap[e];r?function t(e,i,r,n,o){if(n){if(null==r)return void(o?e.writeShort(0):"string"==i||"map"==i?e.writeInt(0):"byte"!=i&&"bool"==i?e.writeBoolean(!1):e.writeByte(0));"string"==i||"map"==i||"byte"==i||"bool"==i||o||e.writeByte(1)}switch(i){case"byte":_(e,r,o,e.writeByte);break;case"short":_(e,r,o,e.writeShort);break;case"int":_(e,r,o,e.writeInt);break;case"long":_(e,r,o,e.writeLong);break;case"longstr":_(e,r,o,e.writeLongStr);break;case"float":_(e,r,o,e.writeFloat);break;case"double":_(e,r,o,e.writeDouble);break;case"bool":_(e,r,o,e.writeBoolean);break;case"string":_(e,r,o,e.writeStr32);break;case"map":var a=JSON.stringify(r);_(e,a,o,e.writeStr32);break;default:if(!m.s2fMap[i])return void m.getLogger().error("encodeByClazz => clazz:%s,\u6ca1\u6709\u627e\u5230\u8fd9\u4e2a\u7c7b\u578b\u5b57\u6bb5",i);var s=m.s2fMap[i];if(o){e.writeShort(r.length);for(c=0,p=r.length;c<p;c++){var h=r[c];if(h){e.writeByte(1);for(var l=0,u=s.length;l<u;l++){d=s[l],f=h[d[0]];t(e,d[1],f,d[0],d[2])}}else e.writeByte(0)}}else for(var c=0,p=s.length;c<p;c++){var d=s[c],f=r[d[0]];t(e,d[1],f,d[0],d[2])}}}(t,r,i,null):m.getLogger().error("encode => msgId:%s,\u6ca1\u6709\u627e\u5230\u8fd9\u4e2a\u7c7b\u578b",e)},t.decode=function(t,e){var i=m.m2sMap[e];if(i){var r={};return function t(e,i,r,n,o){if(n&&!o&&"string"!=i&&"map"!=i&&"byte"!=i&&"bool"!=i){var a=e.readByte();if(!a)return"int"!=i&&"short"!=i&&"long"!=i&&"float"!=i&&"double"!=i||(r[n]=0),void("longstr"==i&&(r[n]="0"))}switch(i){case"byte":r[n]=v(e,o,e.readByte);break;case"short":r[n]=v(e,o,e.readShort);break;case"int":r[n]=v(e,o,e.readInt);break;case"long":r[n]=v(e,o,e.readLong);break;case"longstr":r[n]=v(e,o,e.readLongStr);break;case"float":r[n]=v(e,o,e.readFloat);break;case"double":r[n]=v(e,o,e.readDouble);break;case"bool":r[n]=v(e,o,e.readBoolean);break;case"string":r[n]=v(e,o,e.readStr32);break;case"map":var s=v(e,o,e.readStr32)||"{}";r[n]=JSON.parse(s);break;default:if(!m.s2fMap[i])return void m.getLogger().error("decodeByClazz => clazz:%s,\u6ca1\u6709\u627e\u5230\u8fd9\u4e2a\u7c7b\u578b\u5b57\u6bb5",i);var h=m.s2fMap[i];if(o){for(var l=e.readShort(),u=[],c=0;c<l;c++){var p=e.readByte();if(p)for(var d=0,f=h.length;d<f;d++){g=h[d],y=u[c]=u[c]||{};t(e,g[1],y,g[0],g[2])}}r[n]=u}else for(var c=0,_=h.length;c<_;c++){var g=h[c],y=r;n&&(r[n]=r[n]||{},y=r[n]),t(e,g[1],y,g[0],g[2])}}}(t,i,r,null),r}m.getLogger().error("decode => msgId:%s,\u6ca1\u6709\u627e\u5230\u8fd9\u4e2a\u7c7b\u578b",e)}}(god=god||{}),function(a){var t=(Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid++,32767<this._uid&&(this._uid=0),this._uid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url=t},enumerable:!1,configurable:!0}),e.prototype.isWss=function(){return!1},e.prototype.request=function(t,e){if(this.connected){var i=new egret.ByteArray;a.msg.encode(i,t,e);var r=i.bytes.byteLength,n=this.sock,e=new egret.ByteArray;e.writeInt(r+4),e.writeShort(this.uid),e.writeShort(t),e.writeBytes(i);try{n.writeBytes(e)}catch(t){a.getLogger().error(t)}}else a.getLogger().warn("socket\u5904\u7406\u65ad\u5f00\u72b6\u6001,\u4e0d\u80fd\u53d1\u9001\u4efb\u4f55\u6570\u636e")},e.prototype._onConnect=function(){this.connected=!0,this._onSocketOpen(),a.Emitter.inst.emit(a.EmitterEvent.$$socketopen);var t=this._conncb;t&&t()},e.prototype._onData=function(t){this._onReceiveMessage(t)},e.prototype._onClose=function(){var t=this._conncb;t&&(this.connected?(a.getLogger().warn("CLOSE \u53d1\u9001 socketclose"),a.Emitter.inst.emit(a.EmitterEvent.$$socketclose)):t("egret.Event.CLOSE"),this._onSocketClose())},e.prototype._onError=function(){var t=this._conncb;t&&(this.connected?(a.getLogger().warn("IO_ERROR \u53d1\u9001 socketclose"),a.Emitter.inst.emit(a.EmitterEvent.$$socketclose)):t("egret.IOErrorEvent.IO_ERROR"),this._onSocketError())},e.prototype.reset=function(){var t=this;t.connected=!1,t._conncb=null;var e=t.sock;if(e){try{e.close(),a.getLogger().warn("\u5173\u95edsocket\u94fe\u63a5")}catch(t){a.getLogger().error("\u5173\u95edsocket\u94fe\u63a5\u5931\u8d25")}e.removeEventListener(egret.Event.CONNECT,t._onConnect,t),e.removeEventListener(egret.ProgressEvent.SOCKET_DATA,t._onData,t),e.removeEventListener(egret.Event.CLOSE,t._onClose,t),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,t._onError,t),t.sock=null}},e.prototype.connect=function(t){var e=this;e._conncb=t;t=e.sock;t||((t=e.sock=new egret.WebSocket).type=egret.WebSocket.TYPE_BINARY,t.addEventListener(egret.Event.CONNECT,e._onConnect,e),t.addEventListener(egret.ProgressEvent.SOCKET_DATA,e._onData,e),t.addEventListener(egret.Event.CLOSE,e._onClose,e),t.addEventListener(egret.IOErrorEvent.IO_ERROR,e._onError,e));e=(e.isWss()?"wss":"ws")+"://"+e.url;a.getLogger().log("\u8fde\u63a5ws\u670d\u52a1\u5668:",e),t.connectByUrl(e)},e.prototype._onReceiveMessage=function(t){var e=this,i=e.sock;try{e._bytes||(e._bytes=new egret.ByteArray);var r=e._bytes,n=new egret.ByteArray;i.readBytes(n);var o=r.position;if(r.position=r.length,r.writeBytes(n),r.position=o,!r.length)return;e._handlerBytes()}catch(t){a.getLogger().error("receive error:",t),e._msgId&&(a.getLogger().error("\u9519\u8befmsgId:",e._msgId),a.getLogger().error("\u9519\u8bef\u6570\u636e\u6d41:",e._bytes?e._bytes.bytes:[]),a.getLogger().error("\u9519\u8bef\u4f4d\u7f6e:",e._bytes?e._bytes.position:0))}},e.prototype._onSocketOpen=function(){a.getLogger().warn("socket open")},e.prototype._onSocketClose=function(){a.getLogger().error("socket close");this.connected=!1},e.prototype._onSocketError=function(){a.getLogger().error("scoket error");this.connected=!1},e.prototype._handlerBytes=function(){var t,e,i,r=this,n=r._bytes;r._msgLength||4<=n.length-n.position&&(r._msgLength=n.readInt()),r._msgLength&&!r._msgId&&2<=n.length-n.position&&(r._msgId=n.readShort()),r._msgLength&&r._msgId&&n.length-n.position>=r._msgLength-2&&(t=new egret.ByteArray,2!=r._msgLength&&n.readBytes(t,0,r._msgLength-2),t.position=0,e=a.msg.decode(t,r._msgId),i=r._msgId,egret.callLater(function(){a.Emitter.inst.emit(a.EmitterEvent.$$msg,i,e)},null),r._msgLength=void 0,r._msgId=void 0,r._bytes=new egret.ByteArray,r._bytes.writeBytes(n,n.position),r._bytes.position=0,4<=r._bytes.length&&r._handlerBytes())},e);function e(){this._uid=0}a.WsMgr=t}(god=god||{}),function(s){var h,n;(t=h=s.HttpRequestType||(s.HttpRequestType={})).POST="POST",t.GET="GET",(t=n=s.HttpResponseType||(s.HttpResponseType={}))[t.Text=1]="Text",t[t.Json=2]="Json";var t=(e.create=function(t){(new e)._request(t)},e.prototype._request=function(t){this.option=t;var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT;var i=t.data;if(e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),t.method==h.GET){var r=t.url;if(!s.OBJ.isEmpty(i)){var n=void 0;for(a in r+="?",i)n&&(r+="&"),n=n||!0,r+=a+"="+i[a]}e.open(r,t.method),e.send()}else{var o="";if(!s.OBJ.isEmpty(i)){var a,n=void 0;for(a in i)n&&(o+="&"),n=n||!0,o+=a+"="+i[a]}e.open(t.url,h.POST),e.send(o)}e.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(t){var e=t.currentTarget;this.removeEventListener(e);var i=this.option,r=i.callback,t=i.responseType,i=i.ctx;if(r){e=e.response;if(t&&t!=n.Json)r.call(i,null,e);else{try{e=JSON.parse(e||"{}")}catch(t){return void r.call(i,t)}r.call(i,null,e)}}},e.prototype.onGetIOError=function(t){var e=t.currentTarget;s.getLogger().error("http get error : "+t);var i=this.option,t=i.callback;t&&t.call(i.ctx,"http get error"),this.removeEventListener(e)},e.prototype.onGetProgress=function(t){},e.prototype.removeEventListener=function(t){t.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),t.removeEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e);function e(){}s.HttpRequest=t}(god=god||{}),function(t){var r,e=(r=egret.HashObject,__extends(i,r),i.prototype.notify=function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return!!this.callback&&(t=this.callback).call.apply(t,__spreadArray([this.context],e))},i.prototype.compareContext=function(t){return t==this.context},i.prototype.compareCallBack=function(t){return t==this.callback},i);function i(t,e){var i=r.call(this)||this;return i.callback=null,i.context=null,i.callback=t,i.context=e,i}t.Observer=e}(god=god||{}),function(s){(e=s.EmitterEvent||(s.EmitterEvent={})).$$resize="$$resize",e.$$layerCreate="$$layerCreate",e.$$layerBeforeEnter="$$layerBeforeEnter",e.$$layerEnter="$$layerEnter",e.$$layerBeforeExit="$$layerBeforeExit",e.$$layerExit="$$layerExit",e.$$layerDispose="$$layerDispose",e.$$layerCloseWithCache="$$layerCloseWithCache",e.$$waitAdd="$$waitAdd",e.$$waitSub="$$waitSub",e.$$socketopen="$$socketopen",e.$$socketclose="$$socketclose",e.$$msg="$$msg",e.$$redChanged="$$redChanged",e.$$redStart="$$redStart",e.$$redEnd="$$redEnd",e.$$redState="$$redState",e.$$reload="$$reload",e.$$gamePause="$$gamePause",e.$$gameResume="$$gameResume";var t,e=(t=egret.HashObject,__extends(i,t),Object.defineProperty(i,"inst",{get:function(){return this._inst||(this._inst=new i),this._inst},enumerable:!1,configurable:!0}),i.prototype.on=function(t,e,i){if(e){this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]);for(var r=this._listeners[t],n=0,o=r.length;n<o;n++){var a=r[n];if(!i&&a.compareCallBack(e)||i&&a.compareCallBack(e)&&a.compareContext(i))return}r.push(new s.Observer(e,i))}else s.getLogger().error("\u6ce8\u518c\u9519\u8bef\u7684\u4e8b\u4ef6:"+t)},i.prototype.un=function(t,e){if(this._listeners&&this._listeners[t])for(var i=this._listeners[t],r=i.length-1;0<=r;r--)i[r].compareContext(e)&&i.splice(r,1)},i.prototype.unName=function(t){this._listeners&&this._listeners[t]&&delete this._listeners[t]},i.prototype.unCtx=function(t){if(this._listeners){var e,i=this._listeners;for(e in i)this.un(e,t),i[e]&&i[e].length||delete i[e]}},i.prototype.unAll=function(){if(this._listeners){for(var t in this._listeners)delete this._listeners[t];this._listeners=null}},i.prototype.emit=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];if(!this._listeners)return!1;if(!this._listeners[t])return!1;var n=this._listeners[t],o=!1,a={};return function(){for(var t=n.length-1;0<=t;t--){var e,i=n[t];i&&!a[i.hashCode]&&(e=i.notify.apply(i,r),a[i.hashCode]=1,o=o||!!e)}}(),o},i);function i(){return null!==t&&t.apply(this,arguments)||this}s.Emitter=e}(god=god||{}),function(c){c.getCompName=function(t){return"function"==typeof t?(null==t?void 0:t.NAME)||"":(null===(t=null==t?void 0:t.constructor)||void 0===t?void 0:t.NAME)||""},c.getCompPkg=function(t){return"function"==typeof t?(null==t?void 0:t.PKG)||"":(null===(t=null==t?void 0:t.constructor)||void 0===t?void 0:t.PKG)||""},c.registerResizeHandler=function(){t(),egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,function(){t(),c.Emitter.inst.emit(c.EmitterEvent.$$resize)},null)},c.setDesignSize=function(t,e){p=e,d=t},c.getDesignSize=function(){return[d,p]};var p=0,d=0;function t(){var t=egret.MainContext.instance.stage,e=fgui.GRoot.inst,i=t.stageHeight,r=t.stageWidth,n=i-c.project.myUpHeight,o=d/n,a=d/p;e.width=d,e.height=i,e.x=(r-d)/2,c.layerWidth=d,a<=o?(c.layerHeight=i,c.layerYPos=0):n<=c.maxBgHeight?(c.layerHeight=n,c.layerYPos=c.project.myUpHeight):(n=n-c.maxBgHeight,c.layerHeight=c.maxBgHeight,n>c.project.myUpHeight?c.layerYPos=Math.ceil((n+c.project.myUpHeight)/2):c.layerYPos=c.project.myUpHeight);for(var s=e._children,h=0,l=s.length;h<l;h++){var u=s[h];u.width=e.width,u.height=e.height}t.scaleMode!=egret.StageScaleMode.FIXED_NARROW&&(t.scaleMode=egret.StageScaleMode.FIXED_NARROW)}c.maxBgHeight=1486,c.layerWidth=0,c.layerHeight=0,c.layerYPos=0,c.reScaleMode=t}(god=god||{}),fgui.GObject.prototype.onRedComp=function(t,e){var i;e.parent==this?(i=this.$$onRedCompMap=this.$$onRedCompMap||{})[t]?god.getLogger().warn("onRedComp: \u5df2\u5b58\u5728\u4e00\u5bf9\u4e00\u5173\u7cfb\uff0c\u8c03\u7528\u65e0\u6548"):(i[t]=e,god.Emitter.inst.emit(god.EmitterEvent.$$redState,t,function(t){e.visible=t})):god.getLogger().warn("onRedComp: comp\u4e0d\u662f\u81ea\u5df1\u7684\u5b50\u8282\u70b9\uff0c\u8c03\u7528\u65e0\u6548")},fgui.GObject.prototype.onRedFunc=function(e,i){var r=this,t=r.$$onRedFuncMap=r.$$onRedFuncMap||{};t[e]?god.getLogger().warn("onRedFunc: \u5df2\u5b58\u5728\u56de\u8c03\uff0c\u8c03\u7528\u65e0\u6548"):(t[e]=i,god.Emitter.inst.emit(god.EmitterEvent.$$redState,e,function(t){i.call(r,e,t)}))},fgui.GObject.prototype.$$onRedChanged=function(t,e){var i=this.$$onRedCompMap;i&&i[t]&&(i[t].visible=e);i=this.$$onRedFuncMap;i&&i[t]&&i[t].call(this,t,e)},fgui.GObject.prototype.$$onRedEnd=function(t){var e=this.$$onRedCompMap;e&&e[t]&&delete e[t];e=this.$$onRedFuncMap;e&&e[t]&&delete e[t]},fgui.GObject.prototype.setInterval=function(t,e){var i=this.$$intervalKeys=this.$$intervalKeys||[],e=egret.setInterval(t,this,e);return i.push(e),e},fgui.GObject.prototype.clearInterval=function(t){var e,i;t&&(0<=(i=(e=this.$$intervalKeys=this.$$intervalKeys||[]).indexOf(t))&&e.splice(i,1),egret.clearInterval(t))},fgui.GObject.prototype.setTimeout=function(t,e){var i=this.$$timeoutKeys=this.$$timeoutKeys||[],e=egret.setTimeout(t,this,e);return i.push(e),e},fgui.GObject.prototype.clearTimeout=function(t){var e,i;t&&(0<=(i=(e=this.$$timeoutKeys=this.$$timeoutKeys||[]).indexOf(t))&&e.splice(i,1),egret.clearTimeout(t))},fgui.GObject.prototype._beforeCreate=function(){var r=this;if(r.constructor.PKG){r.trayName&&god.getLogger().log(god.getCompName(r)+" _beforeCreate");var n=r._children;if(n&&n.length)for(var t=0,e=n.length;t<e;t++)!function(t){t=n[t];if(t instanceof fgui.GList){var i=t.name;if(!i)return;(t.callbackThisObj=r)["render_"+i]&&(t.itemRenderer=function(t,e){e.$isCreate||(e.parent||god.getLogger().error("item have no parent"),e._beforeCreate.call(e),e.$isCreate=!0,e._beforeEnter.call(e)),this["render_"+i].call(this,t,e)}),r["provider_"+i]&&(t.itemProvider=r["provider_"+i]),r["click_"+i]&&t.addEventListener(fgui.ItemEvent.CLICK,r["click_"+i],r),r["pull_up_"+i]&&t.scrollPane.addEventListener(fgui.ScrollPane.PULL_UP_RELEASE,r["pull_up_"+i],r)}else if(t instanceof fgui.GRichTextField){var e=t.name;if(!e)return;r["link_"+e]&&t.addEventListener(egret.TextEvent.LINK,r["link_"+e],r)}else if(t instanceof fgui.GObject){e=t.name;if(!e)return;r["tap_"+e]&&"function"==typeof r["tap_"+e]&&t.addClickListener(r["tap_"+e],r),r["begin_"+e]&&"function"==typeof r["begin_"+e]&&t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r["begin_"+e],r),r["move_"+e]&&"function"==typeof r["move_"+e]&&t.addEventListener(egret.TouchEvent.TOUCH_MOVE,r["move_"+e],r),r["end_"+e]&&"function"==typeof r["end_"+e]&&t.addEventListener(egret.TouchEvent.TOUCH_END,r["end_"+e],r),r["cancel_"+e]&&"function"==typeof r["cancel_"+e]&&t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,r["cancel_"+e],r),r["outside_"+e]&&"function"==typeof r["outside_"+e]&&t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,r["outside_"+e],r),r["change_"+e]&&"function"==typeof r["change_"+e]&&t.addEventListener(fgui.StateChangeEvent.CHANGED,r["change_"+e],r)}}(t);var i=r._controllers;if(i&&i.length)for(t=0,e=i.length;t<e;t++){var o=i[t],a=o.name;a&&r["change_"+a]&&o.addEventListener(fgui.StateChangeEvent.CHANGED,r["change_"+a],r)}if(r.onScroll&&"function"==typeof r.onScroll&&r.scrollPane.addEventListener(fgui.ScrollPane.SCROLL,r.onScroll,r),r.onCreate)try{if(r.onCreate(),!r.parent)return}catch(t){god.getLogger().error(t)}r.isNeedPop&&r.grayRect&&r.trayName==god.TrayName.dlg&&(r.setPivot(.5,.5),r.setScale(.9,.9),r.isPlayDlgShow=!0,fgui.GTween.to2(.9,.9,1,1,.3).setTarget(r,r.setScale).setEase(fgui.EaseType.BackOut).onComplete(function(){r.setPivot(0,0),r.isPlayDlgShow=!1},null)),r.trayName&&god.Emitter.inst.emit(god.EmitterEvent.$$layerCreate,r.trayName,god.getCompName(r)),r.onEmitter(god.Emitter.inst,god.EmitterEvent.$$redEnd,r.$$onRedEnd),r.onEmitter(god.Emitter.inst,god.EmitterEvent.$$redChanged,r.$$onRedChanged)}},fgui.GObject.prototype._beforeEnter=function(){var t=this;if(t.constructor.PKG){if(t.trayName&&(god.getLogger().log(god.getCompName(t)+" _beforeEnter"),god.Emitter.inst.emit(god.EmitterEvent.$$layerBeforeEnter,t.trayName,god.getCompName(t))),t.onEnter)try{t.onEnter()}catch(t){god.getLogger().error(t)}t.uiDataChange&&t.dataChanged&&(t.dataChanged(),t.uiDataChange=!1),t.trayName&&god.Emitter.inst.emit(god.EmitterEvent.$$layerEnter,t.trayName,god.getCompName(t))}},fgui.GObject.prototype._beforeExit=function(){var t=this;t.constructor.PKG&&(t.trayName&&(god.getLogger().log(god.getCompName(t)+" _beforeExit"),god.Emitter.inst.emit(god.EmitterEvent.$$layerBeforeExit,t.trayName,god.getCompName(t))),t.onExit&&t.onExit(),t.trayName&&god.Emitter.inst.emit(god.EmitterEvent.$$layerExit,t.trayName,god.getCompName(t)))},fgui.GObject.prototype._beforeDispose=function(){var t=this;if(t.constructor.PKG){t.trayName&&god.getLogger().log(god.getCompName(t)+" _beforeDispose");for(var e,i,r=t._children,n=0,o=r.length;n<o;n++)(s=r[n])instanceof fgui.GList?(e=s.name)&&(t["click_"+e]&&s.removeEventListener(fgui.ItemEvent.CLICK,t["click_"+e],t),(s.callbackThisObj=t)["render_"+e]&&(s.itemRenderer=null),t["provider_"+e]&&(s.itemProvider=null),t["pull_up_"+e]&&s.scrollPane.removeEventListener(fgui.ScrollPane.PULL_UP_RELEASE,t["pull_up_"+e],t)):s instanceof fgui.GRichTextField?(i=s.name)&&t["link_"+i]&&s.removeEventListener(egret.TextEvent.LINK,t["link_"+i],t):s instanceof fgui.GObject&&((i=s.name)&&(t["tap_"+i]&&"function"==typeof t["tap_"+i]&&s.removeClickListener(t["tap_"+i],t),t["begin_"+i]&&"function"==typeof t["begin_"+i]&&s.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t["begin_"+i],t),t["move_"+i]&&"function"==typeof t["move_"+i]&&s.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t["move_"+i],t),t["end_"+i]&&"function"==typeof t["end_"+i]&&s.removeEventListener(egret.TouchEvent.TOUCH_END,t["end_"+i],t),t["cancel_"+i]&&"function"==typeof t["cancel_"+i]&&s.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,t["cancel_"+i],t),t["outside_"+i]&&"function"==typeof t["outside_"+i]&&s.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t["outside_"+i],t),t["change_"+i]&&"function"==typeof t["change_"+i]&&s.removeEventListener(fgui.StateChangeEvent.CHANGED,t["change_"+i],t)));var a=t._controllers;if(a&&a.length)for(n=0,o=a.length;n<o;n++){var s,h=(s=a[n]).name;h&&t["change_"+h]&&s.removeEventListener(fgui.StateChangeEvent.CHANGED,t["change_"+h],t)}t.onScroll&&"function"==typeof t.onScroll&&t.scrollPane.removeEventListener(fgui.ScrollPane.SCROLL,t.onScroll,t),t.grayRect&&t.grayRect.removeClickListener(t.grayRectTouched,t),t.onDispose&&t.onDispose(),t.unAllEmitter();for(var l=t.$$intervalKeys||[],n=0,o=l.length;n<o;n++)egret.clearInterval(l[n]);for(var u=t.$$timeoutKeys||[],n=0,o=u.length;n<o;n++)egret.clearTimeout(u[n]);t.trayName&&god.Emitter.inst.emit(god.EmitterEvent.$$layerDispose,t.trayName,god.getCompName(t));var c=t.$$longPressMap;if(c){for(var p in c)c[p].removeEventListener();t.$$longPressMap=null}for(var d=t._transitions||[],n=0,o=d.length;n<o;n++){var f=d[n];f&&f.stop()}}},fgui.GObject.prototype.setUIData=function(t){t&&(this.uiData=t,this.parent&&this.$isCreate?this.dataChanged&&this.dataChanged():this.uiDataChange=!0)},fgui.GObject.prototype.close=function(){this.constructor.PKG&&god.UIMgr.inst.close(this)},fgui.GObject.prototype.tap_btn_close=function(){this.close()},fgui.GObject.prototype.onEmitter=function(t,e,i){var r=(r=this.emitters)||(this.emitters=[]);t.on(e,i,this);for(var n=!0,o=0,a=r.length;o<a;o++)if(r[o]==t){n=!1;break}n&&r.push(t)},fgui.GObject.prototype.unAllEmitter=function(){if(this.emitters){for(var t=this.emitters,e=0,i=t.length;e<i;e++)t[e].unCtx(this);this.emitters=null}},fgui.GObject.prototype.unEmitter=function(t,e){if(this.emitters)for(var i=this.emitters,r=0,n=i.length;r<n;r++)if(t==i[r]){i[r].un(e,this);break}},fgui.GObject.prototype.addLongPress=function(t,e){this.$$longPressMap||(this.$$longPressMap={});var i=t.name,r=this.$$longPressMap[i];r&&(r.removeEventListener(),delete this.$$longPressMap[i]),(e=e||{}).changeTime||(e.changeTime=5e3),e.minValue||(e.minValue=1),e.maxValue||(e.maxValue=50),e.fireGap||(e.fireGap=100);e=new god.LongPressBinder(t,this,e);this.$$longPressMap[i]=e},fgui.GObject.prototype.delLongPress=function(t){this.$$longPressMap||(this.$$longPressMap={});var e=t.name,t=this.$$longPressMap[e];t&&(t.removeEventListener(),delete this.$$longPressMap[e])};var $onAddToStage_old=egret.DisplayObject.prototype.$onAddToStage;egret.DisplayObject.prototype.$onAddToStage=function(t,e){var i,r=this.$owner;!this.name&&r&&(r.name?0<=(i=this.name=r.name).indexOf("_")&&r.parent&&null==r.parent[i]&&(r.parent[i]=r):r instanceof fgui.GComponent&&(i=god.getCompName(r),this.name=i)),r&&(r.$isCreate||(r._beforeCreate.call(r),r.$isCreate=!0),r.parent&&r._beforeEnter.call(r)),$onAddToStage_old.call(this,t,e)};var $onRemoveFromStage_old=egret.DisplayObject.prototype.$onRemoveFromStage;egret.DisplayObject.prototype.$onRemoveFromStage=function(){var t=this.$owner;t&&t._beforeExit.call(t),$onRemoveFromStage_old.call(this)},Object.defineProperty(fgui.GObject.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!=t&&(this._visible=t,this.handleVisibleChanged(),this._parent&&this._parent.setBoundsChangedFlag(),this._group&&this._group.excludeInvisibles&&this._group.setBoundsChangedFlag(),this.$isCreate&&(t?this._beforeEnter():this._beforeExit()))},enumerable:!0,configurable:!0}),Object.defineProperty(fgui.GObject.prototype,"sortingOrder",{get:function(){return this._sortingOrder},set:function(t){var e;this._sortingOrder!=t&&(e=this._sortingOrder,this._sortingOrder=t,null!=this._parent&&this._parent.childSortingOrderChanged(this,e,this._sortingOrder))},enumerable:!0,configurable:!0});var dispose_old=fgui.GObject.prototype.dispose;fgui.GObject.prototype.dispose=function(){this._disposed||(this._beforeDispose(),dispose_old.call(this),god.Emitter.inst.un("$$resize",this))},Object.defineProperty(fgui.GObject.prototype,"grayEnabled",{get:function(){return this._grayEnabled},set:function(t){this._grayEnabled!=t&&(this._grayEnabled=t,(t=this.grayRect)&&(this._grayEnabled?(t.touchable=!0,t.addClickListener(this.grayRectTouched,this)):(t.touchable=!1,t.removeClickListener(this.grayRectTouched,this))))},enumerable:!0,configurable:!0}),fgui.GObject.prototype.grayRectTouched=function(){return!this.grayNotClose&&(!this.isPlayDlgShow&&(!(this.grayEnabled&&god.canCloseLayer&&!god.canCloseLayer(this))&&(this.close(),!0)))},Object.defineProperty(fgui.GObject.prototype,"grayAlpha",{get:function(){return this._grayAlpha},set:function(t){this._grayAlpha!=t&&(this._grayAlpha=t,this.grayRect.alpha=t,this.grayRect.visible=0<t)},enumerable:!0,configurable:!0}),Object.defineProperty(fgui.GObject.prototype,"grayNotClose",{get:function(){return this._grayNotClose},set:function(t){this._grayNotClose!=t&&(this._grayNotClose=t)},enumerable:!0,configurable:!0});var god,constructFromResource_old=fgui.GComponent.prototype.constructFromResource;fgui.GComponent.prototype.constructFromResource=function(){var t;constructFromResource_old.call(this),this.constructor.PKG&&this.trayName&&((t=this.grayRect=new fgui.GGraph).setSize(this.width,this.height+400),t.drawRect(0,0,0,0,1),t.sortingOrder=-1,t.touchable=!1,t.alpha=0,t.visible=!1,t.y=-200,t.x=0,this.addChild(t))},fgui.GComponent.prototype.constructFromXML=function(t){this.constructor.PKG&&this.trayName&&(this.resize(),god.Emitter.inst.on("$$resize",this.resize,this))},fgui.GComponent.prototype.resize=function(){var t,e=this;e.$noAutoResize?(t=god.getDesignSize(),e.width=t[0],e.height=t[1]):(fgui.GRoot.inst,e.height=god.layerHeight,e.width=god.layerWidth,e.y=god.layerYPos,e.x=0,e.grayRect&&e.grayRect.setSize(e.width,e.height+400))},fgui.GButton.handleVisibleChanged=function(){fgui.GComponent.prototype.handleVisibleChanged.call(this),this.visible||this._mode!=fgui.ButtonMode.Common||this.setState(fgui.GButton.UP)},fgui.GTextField.prototype.updateTextFieldText=function(){var t=this._textField.text,e=this.$$oldStyle,i=this._text;null!=this._templateVars&&(i=this.parseTemplate(i));var r="";if(this.style?r=this.style:this.data&&0<=this.data.indexOf("style=")&&(r=(n=this.data.split("="))[1]),e!=r||t!=i)if(r&&(i="[style="+r+"]"+i+"[/style]",this._ubbEnabled=!0,this.$$oldStyle=r),this._ubbEnabled){var n=fgui.GTextField._htmlParser.parser(fgui.UBBParser.inst.parse(fgui.ToolSet.encodeHTML(i)));if(this._underline)for(var o=0;o<n.length;o++){var a=n[o];a.style?a.style.underline=!0:a.style={underline:!0}}this._textField.textFlow=n}else this._underline?((n=new Array(1))[0]={text:i,style:{underline:!0}},this._textField.textFlow=n):this._textField.text=i},Object.defineProperty(fgui.GTextField.prototype,"style",{get:function(){return this._style},set:function(t){this._style!=t&&(this._style=t,this.parent&&this.parent._underConstruct?this.renderNow():this.render())},enumerable:!0,configurable:!0}),fgui.GRichTextField.prototype.updateTextFieldText=function(){var t=this._textField.text,e=this.$$oldStyle,i=this._text;null!=this._templateVars&&(i=this.parseTemplate(i));var r,n="";if(this.style?n=this.style:this.data&&0<=this.data.indexOf("style=")&&(n=this.data.split("=")[1]),e!=n||t!=i){if(n&&(i="[style="+n+"]"+i+"[/style]",this._ubbEnabled=!0,this.$$oldStyle=n),r=this._ubbEnabled?fgui.GTextField._htmlParser.parser(fgui.UBBParser.inst.parse(i)):fgui.GTextField._htmlParser.parser(i),this._underline)for(var o=0;o<r.length;o++){var a=r[o];a.style?a.style.underline=!0:a.style={underline:!0}}this._textField.textFlow=r}},function(o){var t=(e.prototype.removeEventListener=function(){var t=this;t.stopChange();var e=t.binderBtn;e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.startChange,t),e.removeEventListener(egret.TouchEvent.TOUCH_END,t.stopChange,t),e.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.stopChange,t),e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,t.stopChange,t)},e.prototype.startChange=function(r){var n=this;n.lastTime=o.DATE.now(),n.curValue=n.opt.minValue,n.timeoutKey&&egret.clearTimeout(n.timeoutKey),n.timeoutKey=egret.setTimeout(function(){n.intervalKey&&egret.clearInterval(n.intervalKey),n.intervalKey=egret.setInterval(function(){var t,e,i;n.binderBtn.enabled?(n.binderFunc.call(n.binderContext,r,n.curValue),t=n.opt.maxValue,e=n.opt.minValue,n.curValue<t&&(i=o.DATE.now()-n.lastTime,n.curValue=Math.floor(e+(t-e)*(i/n.opt.changeTime)),n.curValue<e&&(n.curValue=e),n.curValue>t&&(n.curValue=t))):n.stopChange()},null,n.intervalTime)},null,n.timeoutTime)},e.prototype.stopChange=function(){this.timeoutKey&&(egret.clearTimeout(this.timeoutKey),this.timeoutKey=null),this.intervalKey&&(egret.clearInterval(this.intervalKey),this.intervalKey=null)},e);function e(t,e,i){var r=this;r.opt=i,r.timeoutTime=300,r.intervalTime=i.fireGap,r.binderBtn=t,r.binderContext=e,r.binderFunc=e["tap_"+t.name],t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r.startChange,r),t.addEventListener(egret.TouchEvent.TOUCH_END,r.stopChange,r),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,r.stopChange,r),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,r.stopChange,r)}o.LongPressBinder=t}(god=god||{}),function(n){var t=(Object.defineProperty(e,"inst",{get:function(){return this._inst||(this._inst=new e,this._inst.reset()),this._inst},enumerable:!1,configurable:!0}),e.prototype.reset=function(){for(var t=this.refCount,e=Object.keys(t),i=0,r=e.length;i<r;i++){var n=e[i];this._clear(n)}this.refCount={}},e.prototype.loadPackage=function(i,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,fgui.UIPackage.loadPackage(i)];case 1:return t.sent(),fgui.UIPackage.getByName(i)||fgui.UIPackage.addPackage(i),n.Emitter.inst.emit(n.EmitterEvent.$$waitSub),r(),[3,3];case 2:return e=t.sent(),n.Emitter.inst.emit(n.EmitterEvent.$$waitSub),r(e),[3,3];case 3:return[2]}})})},e.prototype.removePackage=function(t){var e;this.notClearPkg[t]||(!(e=this.refCount[t])||e.count<=0||(e.count--,e.time=n.DATE.now(),e.count<=0&&this._clear(t)))},e.prototype.addPackage=function(t){t=this.refCount[t]=this.refCount[t]||{count:0,time:0};t.count++,t.time=n.DATE.now()},e.prototype._clear=function(e){if(!this.notClearPkg[e])try{fgui.UIPackage.removePackage(e),RES.destroyRes(e),delete this.refCount[e],n.getLogger().log("\u6e05\u9664\u5305:",e)}catch(t){n.getLogger().error("\u6e05\u9664\u5305\u5931\u8d25:",e)}},e);function e(){this.notClearPkg={},this.refCount={}}n.PkgMgr=t,n.setPkgExt=function(t){var e=n.getCompName(t);if(n.layerClazzMap[e])throw"name:"+e+",\u5df2\u7ecf\u8bbe\u7f6e\u8fc7\u5bf9\u5e94\u7684\u6269\u5c55\u7c7b!\u8bf7\u68c0\u67e5!";fgui.UIObjectFactory.setPackageItemExtension(t.URL,t),n.layerClazzMap[e]=t},n.layerClazzMap={}}(god=god||{}),function(n){var e,t=(e=fgui.GLoader,__extends(i,e),i.prototype.loadExternal=function(){var t=this.url;if(0<=t.indexOf("undefined"))return n.getLogger().error("\u56fe\u7247\u5730\u5740\u9519\u8bef:"+t),void n.getLogger().error("\u56fe\u7247\u5730\u5740\u9519\u8bef:self=>"+this.name+",parent=>"+(this.parent?this.parent.name:"\u6ca1\u6709\u7236\u8282\u70b9"));this.waitResArr.push({resUrl:t}),this.isResLoading||(this.isResLoading=!0,this.loadOneByOne())},i.prototype.loadOneByOne=function(){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(t){return(i=(e=this).waitResArr.shift()).resUrl&&n.R.load(i.resUrl,RES.ResourceItem.TYPE_IMAGE,function(t){if(e.isResLoading=!1,t)e.isDisposed||(e.waitResArr=[],e.onExternalLoadFailed());else{if(e.isDisposed)return n.R.unLoad(i.resUrl),void n.getLogger().log("UILoader \u5df2\u7ecf\u91ca\u653e\u4e86:"+i.resUrl);if(e.waitResArr.length){t=e.waitResArr[e.waitResArr.length-1];if(!t.resUrl||t.resUrl!=i.resUrl)return e.waitResArr=[t],e.addWaitUnload(i.resUrl),e.isResLoading=!0,void e.loadOneByOne()}e.destryOldRes(),e.waitResArr=[],e.curRes=i,e.onExternalLoadSuccess(n.R._getRes(i.resUrl)),e.$loadSucc&&e.$loadSucc()}}),[2]})})},i.prototype.destryOldRes=function(){var t;this.curRes&&((t=this.curRes).resUrl&&this.addWaitUnload(t.resUrl),this.curRes=null)},i.prototype.addWaitUnload=function(t){this.waitUnloadMap[t]=this.waitUnloadMap[t]||0,this.waitUnloadMap[t]++},i.prototype.clearContent=function(){this.destryOldRes(),e.prototype.clearContent.call(this)},i.prototype.destoryUnloadMap=function(){var t,e=this.waitUnloadMap;for(t in e)for(var i=e[t],r=0;r<i;r++)n.R.unLoad(t)},i.prototype.dispose=function(){this.isDisposed||(this.destryOldRes(),this.destoryUnloadMap()),e.prototype.dispose.call(this)},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.waitResArr=[],t.waitUnloadMap={},t}n.UILoader=t,fgui.UIObjectFactory.setLoaderExtension(t)}(god=god||{}),function(a){var e,t=(e=fgui.GLoader3D,__extends(i,e),i.prototype.setStateTimescale=function(t,e){this._stateScaleMap[t]=e},i.prototype.loadExternal=function(){var t=this,e=t.url;if(0<=e.indexOf("undefined"))return a.getLogger().error("\u9f99\u9aa8id\u9519\u8bef:"+e),void a.getLogger().error("\u9f99\u9aa8id\u9519\u8bef:self=>"+t.name+",parent=>"+(t.parent?t.parent.name:"\u6ca1\u6709\u7236\u8282\u70b9"));var i=e,r=dragonBones.EgretFactory.factory,n=(n=r.getDragonBonesData(i))||r.parseDragonBonesData(a.db.getDbJson(i),i),o=r.getTextureAtlasData(i),e=null,e=o&&o.length?o[0]:r.parseTextureAtlasData(a.db.getDbAltasJson(i),a.db.getDbAltasTexture(i),i);t.setDragonBones(n.armatureNames[0],n.name,"",e.name,t.pivotAsAnchor?new egret.Point(t.pivotX*t.width,t.pivotY*t.pivotY):new egret.Point(0,0)),t.content.x=t.pivotAsAnchor?t.pivotX*t.width:0,t.content.y=t.pivotAsAnchor?t.pivotY*t.height:0},i.prototype.clearContent=function(){this._content&&this.content.removeEventListener(dragonBones.EventObject.COMPLETE,this.animationEventHandler,this),e.prototype.clearContent.call(this)},i.prototype.play=function(t,e,i){this.playTimes=e,this.eventCallback=i,this._animationName=t,this.onChange()},i.prototype.animationEventHandler=function(t){var e=t.eventObject;this.eventCallback&&this.eventCallback(t.type,e.animationState.name,e.name||"")},i.prototype.setDragonBones=function(t,e,i,r,n){this.url=null,this._content;var o=dragonBones.EgretFactory.factory;this._content=o.buildArmatureDisplay(t,e,i,r),this._container.addChild(this._content),this._content.x=n.x,this._content.y=n.y,this._content.tint=this._color,this.onChangeDragonBones(),this.updateLayout()},i.prototype.onChangeDragonBones=function(){var t,e;this.content instanceof dragonBones.EgretArmatureDisplay&&(this._animationName?(this.playing?this.content.animation.play(this.animationName,this.playTimes):this.content.animation.gotoAndStopByFrame(this.animationName,this.frame),!(t=this._stateScaleMap[this._animationName]||1)||(e=this.content.animation.getState(this._animationName))&&(e.timeScale=t)):this.content.animation.reset())},i);function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._stateScaleMap={},t.playTimes=0,t}a.UILoader3D=t,fgui.UIObjectFactory.setLoader3DExtension(t)}(god=god||{}),function(f){var d,_,t;(t=d=f.TrayName||(f.TrayName={})).mutex="mutex",t.full="full",t.dlg="dlg",t.menu="menu",t.fixed="fixed",t.wait="wait",t.border="border",(t=_=f.NodeName||(f.NodeName={})).stack="stack",t.menu="menu",t.middle="middle",t.top="top",t.border="border";var g=(Object.defineProperty(e,"inst",{get:function(){return this._inst||(this._inst=new e,this._inst.reset()),this._inst},enumerable:!1,configurable:!0}),e.prototype.reset=function(){var t,e=this.root=fgui.GRoot.inst;for(t in this.uiCache)this.close(this.uiCache[t],!0);this.uiCache={};for(var i,r=e._children.concat([]),n=0,o=r.length;n<o;n++){var a=r[n];e.removeChild(a,!0)}for(i in _){var s=new fgui.GComponent;s.width=e.width,s.height=e.height,s.name=i,s.displayObject.name=s.name,s.setupOverflow(fairygui.OverflowType.Hidden),e.addChild(s)}},e.prototype.getNode=function(t){var e=this.root,i="";switch(t){case d.mutex:case d.full:case d.dlg:i=_.stack;break;case d.menu:i=_.menu;break;case d.fixed:i=_.middle;break;case d.wait:i=_.top;break;case d.border:i=_.border;break;default:throw"\u65e0\u6cd5\u627e\u6253\u8fd9\u4e2atrayName\u7684NodeName:"+t}return e.getChild(i)},e.prototype.show=function(t,e){var i=f.getCompName(t),r=null;this.uiCache[i]?(r=this.uiCache[i],f.PkgMgr.inst.removePackage(f.getCompPkg(t))):((r=this.getLayer(i))&&r.uiCache&&f.PkgMgr.inst.removePackage(f.getCompPkg(t)),r&&r.uiCache||(r=t.createInstance()));var n=r.trayName,t=this.getNode(n);if(!t)return f.getLogger().error("no found uiNode "+i),null;if(!r.uiCache&&(null==r.singleLayer||r.singleLayer))for(var o=this.getLayer(i,n);o;)o.close(),o=this.getLayer(i,n);if(t.name==_.stack)if(n==d.mutex)for(var a=0,s=(h=t._children.concat([])).length;a<s;a++)(l=h[a]).close();else if(n==d.full)for(a=0,s=(h=t._children).length;a<s;a++)(l=h[a]).visible=!1;else if(n==d.dlg)for(var h,l,u=!1,a=(h=t._children).length-1;0<=a;a--)(l=h[a]).trayName==d.dlg||u?l.visible=!1:u=l.visible=!0;return r.uiData=e,t.addChild(r),r.visible||(r.visible=!0),e&&r.dataChanged&&r.dataChanged(),r},e.prototype.close=function(t,e){var i=f.getCompName(t),r=t.trayName;if(!r)throw"\u6ca1\u6709trayName\u7684\u754c\u9762\u4e0d\u53ef\u8c03\u7528 close\u65b9\u6cd5";if(t.parent){var n=this.getNode(r);if(n){var o=t.constructor.PRE_RES;if(o&&o.length)for(var a=0,s=o.length;a<s;a++){var h=o[a];f.getLogger().log(f.getCompName(t)+"\u79fb\u9664\u8d44\u6e90:"+h),f.R.unLoad(h)}var l=!0;if(!e&&t.uiCache&&(this.uiCache[i]=t,l=!1),n.removeChild(t,l),l?f.PkgMgr.inst.removePackage(f.getCompPkg(t)):f.Emitter.inst.emit(f.EmitterEvent.$$layerCloseWithCache,r,i),n.name==_.stack&&r!=d.mutex)if(r==d.full)for(var u=!1,a=(p=n._children).length-1;0<=a;a--){var c=p[a];if(u||c.trayName!=d.dlg){c.visible=!0;break}u=c.visible=!0}else if(r==d.dlg)for(var p,a=(p=n._children).length-1;0<=a;a--){(c=p[a]).trayName==d.dlg&&(c.visible=!0);break}}else f.getLogger().error("no found uiNode "+r)}else f.getLogger().error(i+"\u6ca1\u6709\u7236\u8282\u70b9")},e.prototype.getLayer=function(t,e){if(e){var i=this.getNode(e);if(!i)return f.getLogger().error("no find uiNode "+e),null;for(var r=0,n=(a=i._children).length;r<n;r++)if((s=a[r]).displayObject&&s.displayObject.name==t)return s}else for(var o=this.root._children||[],r=0,n=o.length;r<n;r++)for(var a,s,h=0,l=(a=o[r].asCom._children).length;h<l;h++)if((s=a[h]).displayObject&&s.displayObject.name==t)return s;return null},e);function e(){this.uiCache={}}f.UIMgr=g,f.show=function(p){for(var d=[],t=1;t<arguments.length;t++)d[t-1]=arguments[t];return __awaiter(this,void 0,void 0,function(){var e,i,r,n,o,a,s,h,l,u,c;return __generator(this,function(t){switch(t.label){case 0:if(d&&d.length)for(u=0,c=d.length;u<c;u++)"function"==typeof(r=d[u])?e=r:"object"==typeof r&&(i=r);if(!(n=f.layerClazzMap[p]))return f.getLogger().error("\u672a\u6ce8\u518c\u7684\u754c\u9762:"+p),[2];if(f.Emitter.inst.emit(f.EmitterEvent.$$waitAdd),o=n.PKG,f.PkgMgr.inst.addPackage(o),!(a=n.getPreRes&&n.getPreRes())||!a.length)return[3,4];for(s=[],h=[],l=function(t,e){var i=a[t];f.getLogger().log(f.getCompName(n)+"\u52a0\u8f7d\u8d44\u6e90:"+i);t=f.promisify(function(e){f.R.load(i,"",function(t){t||h.push(i),e(t)})})();s.push(t)},u=0,c=a.length;u<c;u++)l(u);t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Promise.all(s)];case 2:return t.sent(),n.PRE_RES=h,[3,4];case 3:return t.sent(),[3,4];case 4:return f.PkgMgr.inst.loadPackage(o,function(t){return t?(f.getLogger().error(t),void f.PkgMgr.inst.removePackage(o)):void egret.callLater(function(){var t=g.inst.show(n,i);t&&e&&e(t)},null)}),[2]}})})}}(god=god||{}),function(o){o.codeVer="1.0.0.0",o.cdnUrl="",o.projectUrl="",o.signObj={};var t=(e.prototype.init=function(){return new Promise(function(t,e){t(null)})},e.prototype.getVirtualUrl=function(t){if("http"==t.substr(0,4))return t;var e=(r=t.split("?"))[1];e?(e="?"+e,t=r[0]):e="";var i=(n=RES.path).dirname(t),r=n.basename(t),n="";return i?(i=o.signObj[i])&&(n=i[r]):n=o.signObj[r],n?(t=o.PATH.extname(r),r="resource/"+n.substr(0,2),o.cdnUrl+r+"/"+n+"."+t+e):o.cdnUrl+t+e},e);function e(){}o.VersionController=t}(god=god||{}),function(t){var o;(o=t.db||(t.db={})).init=function(t,e){var i,r=e.frames;for(i in o.spriteSheet=new egret.SpriteSheet(t),r){var n=r[i];o.spriteSheet.createTexture(i,n.x,n.y,n.w,n.h,n.offX,n.offY,n.sourceW,n.sourceH)}o.config=e.db},o.getDbJson=function(t){return o.config[t+"_ske"]},o.getDbAltasTexture=function(t){return o.spriteSheet.getTexture(t+"_tex")},o.getDbAltasJson=function(t){return o.config[t+"_tex"]}}(god=god||{}),function(i){i.project={myLang:"zhCN",mySubpackage:"",myUpHeight:0,myShowFps:0,myNativeProcess:0,myLoadSignType:0,myNative:"",myApiUrl:"http://dmf.easyswoole.cn:9501"},i.preCfg={},i.mergerProject=function(){for(var t in i.project){var e=egret.getOption(t);e&&("number"==typeof i.project[t]?i.project[t]=Number(e):i.project[t]=e)}},i.getLang=function(){return i.project.myLang.toLowerCase()},i.getLangDefault=function(){return"zhcn"}}(god=god||{}),function(l){var t=(e.prototype.load=function(h){return __awaiter(this,void 0,void 0,function(){var e,i,r,n,o,a,s;return __generator(this,function(t){switch(t.label){case 0:return(i=+((e=this).isRes&&l.project.myLoadSignType?1:0)+(e.isRes?1:0)+(e.baseBin?1:0)+(e.langBin?1:0)+(e.baseReplaceBin?1:0)+(e.langReplaceBin?1:0)+e.pkgList.length+(e.subpackage?1:0)+(e.mapFile?1:0)+(e.db?1:0)+(e.ttf?1:0)+e.imgs.length)?(r=0,n=function(){r++,h&&h(r,i)},e.isRes?l.project.myLoadSignType?[4,e.loadSign(function(){n()})]:[3,2]:[3,4]):(h(1,1),[2]);case 1:t.sent(),t.label=2;case 2:return[4,e.loadResJson(function(){n()})];case 3:t.sent(),t.label=4;case 4:return e.baseBin?[4,e.loadCfg(e.baseBin,function(t){l.D.load(JSON.parse(u(t))),n()})]:[3,6];case 5:t.sent(),t.label=6;case 6:return e.langBin?[4,e.loadCfg(e.langBin,function(t){l.D.lang(JSON.parse(u(t))),n()})]:[3,8];case 7:t.sent(),t.label=8;case 8:return e.baseReplaceBin?[4,e.loadCfg(e.baseReplaceBin,function(t){l.D.load(JSON.parse(u(t))),n()})]:[3,10];case 9:t.sent(),t.label=10;case 10:return e.langReplaceBin?[4,e.loadCfg(e.langReplaceBin,function(t){l.D.lang(JSON.parse(u(t))),n()})]:[3,12];case 11:t.sent(),t.label=12;case 12:if(o=[],e.pkgList.length)for(a=0,s=e.pkgList.length;a<s;a++)o.push(e.loadPkg(e.pkgList[a],function(){n()}));if(e.imgs.length)for(a=0,s=e.imgs.length;a<s;a++)o.push(e.loadImg(e.imgs[a],function(){n()}));return e.mapFile&&o.push(e.loadMap(function(){n()})),e.db&&o.push(e.loadDb(function(){n()})),e.ttf&&o.push(e.loadTTF(function(){n()})),e.subpackage&&o.push(e.loadSubpackage(e.subpackage,function(){n()})),o.length?[4,Promise.all(o)]:[3,14];case 13:t.sent(),t.label=14;case 14:return[2]}})})},e.prototype.loadSign=function(r){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,3,,6]),RES.config.config={alias:{},groups:{},resourceRoot:"resource/",mergeSelector:null,fileSystem:{fsData:{},getFile:function(t){return this.fsData[t]},addFile:function(t){t.type||(t.type=""),null==this.root&&(t.root=""),this.fsData[t.name]=t},profile:function(){console.log(this.fsData)},removeFile:function(t){delete this.fsData[t]}},loadGroup:[]},i="",i=1==l.project.myLoadSignType?"version/"+l.codeVer+"/sign/sign.bin?v="+l.DATE.now():"version/"+l.codeVer+"/native/"+l.project.myNative+"/sign.bin",[4,RES.getResByUrl(i,function(t){t&&(l.signObj=JSON.parse(u(t)))},null,RES.ResourceItem.TYPE_BIN)];case 2:return t.sent(),RES.config.config=null,e._isSignLoad=!0,l.getLogger().log("loadSign\u52a0\u8f7d\u6210\u529f"),r(),[3,6];case 3:return(t.sent(),e._isSignLoad)?[2]:(l.getLogger().error("loadSign\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5"),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,e.loadSign(r)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e.prototype.loadResJson=function(i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,3,,6]),[4,RES.loadConfig("resource/cfg/res.json","resource/")];case 2:return t.sent(),l.getLogger().log("loadResJson\u52a0\u8f7d\u6210\u529f"),e._isLoadResJson=!0,i(),[3,6];case 3:return(t.sent(),e._isLoadResJson)?[2]:(l.getLogger().error("loadResJson\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5"),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,e.loadResJson(i)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e.prototype.loadSubpackage=function(i,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,3,,6]),[4,l.promisify(function(e){l.Plat.inst.loadSubPackage(i,function(t){e(t)})})()];case 2:return t.sent(),l.getLogger().log("loadSubpackage\u52a0\u8f7d\u6210\u529f:"+i),e._isLoadSubpackage=!0,r(),[3,6];case 3:return(t.sent(),e._isLoadSubpackage)?[2]:(l.getLogger().error("loadSubpackage\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5:"+i),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,e.loadSubpackage(i,r)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e.prototype.loadMap=function(i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,3,,6]),[4,RES.getResByUrl(e.mapFile,function(t){t&&(l.mapInfo=JSON.parse(u(t)))},null,RES.ResourceItem.TYPE_BIN)];case 2:return t.sent(),e._isLoadMap=!0,i(),[3,6];case 3:return(t.sent(),e._isLoadMap)?[2]:(l.getLogger().error("loadMap\u52a0\u8f7d\u5931\u8d25,\u91cd\u65b0\u5c1d\u8bd5"),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,e.loadMap(i)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e.prototype.loadPkg=function(i,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,3,,6]),[4,fairygui.UIPackage.loadPackage(i)];case 2:return t.sent(),l.getLogger().log("loadPkg\u52a0\u8f7d\u6210\u529f:"+i),e._pkgLoadMap[i]=!0,r(),[3,6];case 3:return(t.sent(),e._pkgLoadMap[i])?[2]:(l.getLogger().error("loadPkg\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5:"+i),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,e.loadPkg(i,r)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e.prototype.loadCfg=function(e,r){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(t){switch(t.label){case 0:i=this,t.label=1;case 1:return t.trys.push([1,3,,6]),[4,RES.getResByUrl(e,function(t,e){t&&(l.getLogger().log("loadCfg\u6210\u529f:"+e),i._cfgLoadMap[e]=!0,r(t))})];case 2:return t.sent(),[3,6];case 3:return(t.sent(),i._cfgLoadMap[e])?[2]:(l.getLogger().error("loadCfg\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5:"+e),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,i.loadCfg(e,r)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e.prototype.loadDb=function(n){return __awaiter(this,void 0,void 0,function(){var e,i,r;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,4,,7]),r=i=null,[4,RES.getResByUrl("resource/dy/"+l.getLang()+"/db/db.json",function(t){t&&(i=t,l.getLogger().log("loadDb\u6210\u529f:db.json"))},null,RES.ResourceItem.TYPE_JSON)];case 2:return t.sent(),[4,RES.getResByUrl("resource/dy/"+l.getLang()+"/db/db.png",function(t){t&&(r=t,l.getLogger().log("loadDb\u6210\u529f:db.png"))},null,RES.ResourceItem.TYPE_IMAGE)];case 3:return t.sent(),l.db.init(r,i),l.getLogger().log("loadDb\u6210\u529f"),e._isLoadDb=!0,n(),[3,7];case 4:return(t.sent(),e._isLoadDb)?[2]:(l.getLogger().error("loadDb\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5"),[4,l.sleep(1e3)]);case 5:return t.sent(),[4,e.loadDb(n)];case 6:return t.sent(),[3,7];case 7:return[2]}})})},e.prototype.loadTTF=function(i){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,3,,6]),[4,RES.getResByUrl("resource/dy/"+l.getLang()+"/fnt/my.ttf",function(t){l.getLogger().log("loasTTF\u6210\u529f"),egret.registerFontMapping("my","resource/dy/"+l.getLang()+"/fnt/my.ttf")},null,RES.ResourceItem.TYPE_TTF)];case 2:return t.sent(),e._isLoadTTF=!0,i(),[3,6];case 3:return(t.sent(),e._isLoadTTF)?[2]:(l.getLogger().error("loasTTF\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5"),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,e.loadTTF(i)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e.prototype.loadImg=function(i,r){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:e=this,t.label=1;case 1:return t.trys.push([1,3,,6]),[4,l.promisify(function(e){l.R.load(i,RES.ResourceItem.TYPE_IMAGE,function(t){return t?e(t):void e()})})()];case 2:return t.sent(),l.getLogger().log("loadImg\u6210\u529f:"+i),e._imgLoadMap[i]=!0,r(),[3,6];case 3:return(t.sent(),e._imgLoadMap[i])?[2]:(l.getLogger().error("loadImg\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u65b0\u5c1d\u8bd5"),[4,l.sleep(1e3)]);case 4:return t.sent(),[4,e.loadImg(i,r)];case 5:return t.sent(),[3,6];case 6:return[2]}})})},e);function e(){this._pkgLoadMap={},this._cfgLoadMap={},this._imgLoadMap={};this.pkgList=[],this.imgs=[]}l.LazyLoad=t;var i=[55,98,99,55,100,99,54,98,98,56,49,100,49,49,55,101];function u(t){return aed.dts(new Uint8Array(t),i)}l.getDString=u}(god=god||{}),function(n){var e,t=(e=egret.DisplayObjectContainer,__extends(i,e),i.prototype.onAddToStage=function(t){var e=this;egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){var t=new Date;n.DATE.curStamp+=t.getTime()-e.lastTime.getTime(),e.lastTime=t}}),egret.lifecycle.onPause=function(){n.getLogger().warn("onPause"),n.isBackGround=!0,n.Emitter.inst.emit(n.EmitterEvent.$$gamePause)},egret.lifecycle.onResume=function(){var t=new Date;n.DATE.curStamp+=t.getTime()-e.lastTime.getTime(),e.lastTime=t,n.getLogger().warn("onResume"),n.isBackGround=!1,n.Emitter.inst.emit(n.EmitterEvent.$$gameResume)},this.runGame().catch(function(t){n.getLogger().error(t)})},i.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,i,r;return __generator(this,function(t){for(i in r=(e=this).stage,n.preCfg)n.project[i]=n.preCfg[i];return n.mergerProject(),fairygui.GRoot.inst.displayObject.name="root",r.addChild(fairygui.GRoot.inst.displayObject),n.setDesignSize(640,1136),n.registerResizeHandler(),RES.registerVersionController(new n.VersionController),(r=new n.LazyLoad).isRes=!0,n.project.mySubpackage&&(r.subpackage=n.project.mySubpackage),r.baseBin="resource/data/data_pre.bin",r.langBin="resource/data/data_pre_"+n.getLang()+".bin",r.pkgList=["com"],r.load(e.progressHandle.bind(e)),n.Emitter.inst.on(n.EmitterEvent.$$resize,e.onResize,e),egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(n.project.myShowFps?document.getElementById("egret-fps-panel").style.visibility="visible":document.getElementById("egret-fps-panel").style.visibility="hidden"),e.cText=new egret.TextField,e.cText.size=24,e.cText.textColor=16777215,e.cText.stroke=2,e.cText.strokeColor=4656646,e.cText.text="...",e.addChild(e.cText),e.onResize(),[2]})})},i.prototype.progressHandle=function(t,e){n.getLogger().log("\u9884\u52a0\u8f7d\u8fdb\u5ea6\uff1a"+t+"/"+e),this.cText.text=t+"/"+e+"...",this.resizeText(),t==e&&window.runGame(this)},i.prototype.onResize=function(){var t;this.visible&&(t=fgui.GRoot.inst,this.width=n.layerWidth,this.height=n.layerHeight,this.x=t.x,this.y=n.layerYPos,this.resizeText())},i.prototype.resizeBg=function(){var t=this.cBg;t&&(t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=this.width/2,t.y=this.height/2)},i.prototype.resizeText=function(){var t=this.cText;t&&(t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.x=this.width/2,t.y=.9*this.height)},i);function i(){var t=e.call(this)||this;return t.name="Main",t.lastTime=new Date,egret.ImageLoader.crossOrigin="anonymous",t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}n.Main=t,window.Main=t}(god=god||{});