## 进入地图步骤
- 初始化用户所有属性
- 初始化地图怪物属性,初始化地图宫格,宝箱位置等
- 维护全局buff

## 连接地址
直接根据接口host,改为ws协议连接即可

## 命令协议
### 发送命令相关
- 进入地下城
- 获取地图信息
- 获取玩家信息 
- 打开宝箱
- 开启战斗,攻击怪物
- 释放技能
- 逃跑
- 进入下一层
- 退出地图
- 复活
- 使用 hp,mp 药水

### 服务器下发命令
- 进入地图成功
- 发送地图信息
- 发送玩家信息
- 发送宝箱打开情况
- 战斗开启事件
- 技能触发,释放技能事件
- 造成伤害事件
- 怪物死亡事件
- 人物死亡事件
- 属性变更事件
- 物品变更事件
- buff叠加事件
- 战斗结束事件
- 进入下一层
- 退出地图

## 接口说明
### 接口规范
- 传参和响应都为json
- 传参json示例:
```json
{"action":"intoMap","mapId":1,"requestId":1636771102}
```
- 响应json示例:
```json
{
    "action": "mapInfo",
    "code": 200,
    "data": {
        "mapInfo": {
            "mapInfo": {
                "mapId": 1,
                "name": "哥布林部落",
                "mapEnvironmentId": 1,
                "difficultyLevel": 1,
                "description": "哥布林部落",
                "recommendedLevel": 1,
                "isInstanceZone": 0,
                "maxLevel": 10,
                "monsterNum": 5,
                "exp": 10,
                "gold": 100,
                "material": 10,
                "equipment": 10,
                "pet": 10,
                "prop": 10,
                "order": 1
            },
            "nowMapLevel": 1,
            "nowMapGrid": [
                [
                    {
                        "type": 1,
                        "data": {
                            "mapMonsterId": 2,
                            "monsterId": 1,
                            "mapId": 1,
                            "mapLevelMin": 1,
                            "mapLevelMax": 10,
                            "name": "哥布林",
                            "type": 1,
                            "description": "瘦小的哥布林,在一号洞穴是最弱小的存在",
                            "level": 1,
                            "hp": 10000,
                            "mp": 0,
                            "attack": 10,
                            "defense": 0,
                            "endurance": 0,
                            "intellect": 0,
                            "strength": 0,
                            "enduranceQualification": 0,
                            "intellectQualification": 0,
                            "strengthQualification": 0,
                            "criticalRate": 10,
                            "criticalStrikeDamage": 200,
                            "hitRate": 100,
                            "dodgeRate": 0,
                            "penetrate": 0,
                            "attackSpeed": 1,
                            "userElement": 3,
                            "attackElement": 0,
                            "jin": 0,
                            "mu": 0,
                            "tu": 10,
                            "sui": 0,
                            "huo": 0,
                            "light": 0,
                            "dark": 0
                        }
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": 1,
                        "data": null
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": 1,
                        "data": {
                            "mapMonsterId": 2,
                            "monsterId": 1,
                            "mapId": 1,
                            "mapLevelMin": 1,
                            "mapLevelMax": 10,
                            "name": "哥布林",
                            "type": 1,
                            "description": "瘦小的哥布林,在一号洞穴是最弱小的存在",
                            "level": 1,
                            "hp": 10000,
                            "mp": 0,
                            "attack": 10,
                            "defense": 0,
                            "endurance": 0,
                            "intellect": 0,
                            "strength": 0,
                            "enduranceQualification": 0,
                            "intellectQualification": 0,
                            "strengthQualification": 0,
                            "criticalRate": 10,
                            "criticalStrikeDamage": 200,
                            "hitRate": 100,
                            "dodgeRate": 0,
                            "penetrate": 0,
                            "attackSpeed": 1,
                            "userElement": 3,
                            "attackElement": 0,
                            "jin": 0,
                            "mu": 0,
                            "tu": 10,
                            "sui": 0,
                            "huo": 0,
                            "light": 0,
                            "dark": 0
                        }
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ]
            ]
        },
        "goodsChange": []
    },
    "msg": "地图信息"
}
```
- 响应结构为:
```json
{
    "action": "mapInfo",
    "code": 200,
    "data": {
     
    }
}
```
- action为响应命令
- code为响应状态码
- data为响应数据

### 连接websocket
- http://dnf.easyswoole.cn:9501/userId=xx (后期改为userToken)

### 进入地图
- action:intoMap
- 参数 
    - mapId 地图id
    - isAbyss 是否进入深渊 (进入深渊需要消耗深渊挑战书,这个后期做)
    
### 获取地图信息
- action:mapInfo
### 获取玩家信息
- action:userInfo

###  客户端流程
- 在用户选择完地图后,连接websocket
- 

