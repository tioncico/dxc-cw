## 进入地图步骤
- 初始化用户所有属性
- 初始化地图怪物属性,初始化地图宫格,宝箱位置等
- 维护全局buff

## 连接地址
直接根据接口host,改为ws协议连接即可

## 命令协议
### 发送命令相关
- 进入地下城
- 获取地图信息
- 获取玩家信息 
- 打开宝箱
- 开启战斗,攻击怪物
- 释放技能
- 逃跑
- 进入下一层
- 退出地图
- 复活
- 使用 hp,mp 药水

### 服务器下发命令
- 进入地图成功
- 发送地图信息
- 发送玩家信息
- 发送宝箱打开情况
- 战斗开启事件
- 技能触发,释放技能事件
- 造成伤害事件
- 怪物死亡事件
- 人物死亡事件
- 属性变更事件
- 物品变更事件
- buff叠加事件
- 战斗结束事件
- 进入下一层
- 退出地图

## 接口说明
### 接口规范
- 传参和响应都为json
- 传参json示例:
```json
{"action":"intoMap","mapId":1,"requestId":1636771102}
```
- 响应json示例:
```json
{
    "action": "mapInfo",
    "code": 200,
    "data": {
        "mapInfo": {
            "mapInfo": {
                "mapId": 1,
                "name": "哥布林部落",
                "mapEnvironmentId": 1,
                "difficultyLevel": 1,
                "description": "哥布林部落",
                "recommendedLevel": 1,
                "isInstanceZone": 0,
                "maxLevel": 10,
                "monsterNum": 5,
                "exp": 10,
                "gold": 100,
                "material": 10,
                "equipment": 10,
                "pet": 10,
                "prop": 10,
                "order": 1
            },
            "nowMapLevel": 1,
            "nowMapGrid": [
                [
                    {
                        "type": 1,
                        "data": {
                            "mapMonsterId": 2,
                            "monsterId": 1,
                            "mapId": 1,
                            "mapLevelMin": 1,
                            "mapLevelMax": 10,
                            "name": "哥布林",
                            "type": 1,
                            "description": "瘦小的哥布林,在一号洞穴是最弱小的存在",
                            "level": 1,
                            "hp": 10000,
                            "mp": 0,
                            "attack": 10,
                            "defense": 0,
                            "endurance": 0,
                            "intellect": 0,
                            "strength": 0,
                            "enduranceQualification": 0,
                            "intellectQualification": 0,
                            "strengthQualification": 0,
                            "criticalRate": 10,
                            "criticalStrikeDamage": 200,
                            "hitRate": 100,
                            "dodgeRate": 0,
                            "penetrate": 0,
                            "attackSpeed": 1,
                            "userElement": 3,
                            "attackElement": 0,
                            "jin": 0,
                            "mu": 0,
                            "tu": 10,
                            "sui": 0,
                            "huo": 0,
                            "light": 0,
                            "dark": 0
                        }
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": 1,
                        "data": null
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": 1,
                        "data": {
                            "mapMonsterId": 2,
                            "monsterId": 1,
                            "mapId": 1,
                            "mapLevelMin": 1,
                            "mapLevelMax": 10,
                            "name": "哥布林",
                            "type": 1,
                            "description": "瘦小的哥布林,在一号洞穴是最弱小的存在",
                            "level": 1,
                            "hp": 10000,
                            "mp": 0,
                            "attack": 10,
                            "defense": 0,
                            "endurance": 0,
                            "intellect": 0,
                            "strength": 0,
                            "enduranceQualification": 0,
                            "intellectQualification": 0,
                            "strengthQualification": 0,
                            "criticalRate": 10,
                            "criticalStrikeDamage": 200,
                            "hitRate": 100,
                            "dodgeRate": 0,
                            "penetrate": 0,
                            "attackSpeed": 1,
                            "userElement": 3,
                            "attackElement": 0,
                            "jin": 0,
                            "mu": 0,
                            "tu": 10,
                            "sui": 0,
                            "huo": 0,
                            "light": 0,
                            "dark": 0
                        }
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ]
            ]
        },
        "goodsChange": []
    },
    "msg": "地图信息"
}
```
- 响应结构为:
```json
{
    "action": "mapInfo",
    "code": 200,
    "data": {
     
    }
}
```
- action为响应命令
- code为响应状态码
- data为响应数据

### 连接websocket
- http://dnf.easyswoole.cn:9501/userId=xx (后期改为userToken)

### 进入地图
- action:intoMap
- 参数 
    - mapId 地图id
    - isAbyss 是否进入深渊 (进入深渊需要消耗深渊挑战书,这个后期做)
> 进入地图后,会自动响应一次地图信息+玩家信息
### 获取地图信息
- action:mapInfo
```json
{
    "action": "mapInfo",
    "code": 200,
    "data": {
        "mapInfo": {
            "mapInfo": {
                "mapId": 1,
                "name": "哥布林部落",
                "mapEnvironmentId": 1,
                "difficultyLevel": 1,
                "description": "哥布林部落",
                "recommendedLevel": 1,
                "isInstanceZone": 0,
                "maxLevel": 10,
                "monsterNum": 5,
                "exp": 10,
                "gold": 100,
                "material": 10,
                "equipment": 10,
                "pet": 10,
                "prop": 10,
                "order": 1
            },
            "nowMapLevel": 1,
            "nowMapGrid": [
                [
                    {
                        "type": 1,
                        "data": {
                            "mapMonsterId": 2,
                            "monsterId": 1,
                            "mapId": 1,
                            "mapLevelMin": 1,
                            "mapLevelMax": 10,
                            "name": "哥布林",
                            "type": 1,
                            "description": "瘦小的哥布林,在一号洞穴是最弱小的存在",
                            "level": 1,
                            "hp": 10000,
                            "mp": 0,
                            "attack": 10,
                            "defense": 0,
                            "endurance": 0,
                            "intellect": 0,
                            "strength": 0,
                            "enduranceQualification": 0,
                            "intellectQualification": 0,
                            "strengthQualification": 0,
                            "criticalRate": 10,
                            "criticalStrikeDamage": 200,
                            "hitRate": 100,
                            "dodgeRate": 0,
                            "penetrate": 0,
                            "attackSpeed": 1,
                            "userElement": 3,
                            "attackElement": 0,
                            "jin": 0,
                            "mu": 0,
                            "tu": 10,
                            "sui": 0,
                            "huo": 0,
                            "light": 0,
                            "dark": 0
                        }
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": 1,
                        "data": null
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": 1,
                        "data": {
                            "mapMonsterId": 2,
                            "monsterId": 1,
                            "mapId": 1,
                            "mapLevelMin": 1,
                            "mapLevelMax": 10,
                            "name": "哥布林",
                            "type": 1,
                            "description": "瘦小的哥布林,在一号洞穴是最弱小的存在",
                            "level": 1,
                            "hp": 10000,
                            "mp": 0,
                            "attack": 10,
                            "defense": 0,
                            "endurance": 0,
                            "intellect": 0,
                            "strength": 0,
                            "enduranceQualification": 0,
                            "intellectQualification": 0,
                            "strengthQualification": 0,
                            "criticalRate": 10,
                            "criticalStrikeDamage": 200,
                            "hitRate": 100,
                            "dodgeRate": 0,
                            "penetrate": 0,
                            "attackSpeed": 1,
                            "userElement": 3,
                            "attackElement": 0,
                            "jin": 0,
                            "mu": 0,
                            "tu": 10,
                            "sui": 0,
                            "huo": 0,
                            "light": 0,
                            "dark": 0
                        }
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ],
                [
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    },
                    {
                        "type": "0",
                        "data": []
                    }
                ]
            ]
        },
        "goodsChange": []
    },
    "msg": "地图信息"
}
```
### 获取玩家信息
- action:userInfo
```json
{
    "action": "userInfo",
    "code": 200,
    "data": {
        "userInfo": {
            "userAttribute": {
                "hp": 2530,
                "mp": 330,
                "name": "仙士可",
                "attributeType": null,
                "level": 10,
                "attack": 154,
                "defense": 118,
                "endurance": 10,
                "intellect": 10,
                "strength": 10,
                "criticalRate": 0,
                "criticalStrikeDamage": 200,
                "hitRate": 100,
                "dodgeRate": 0,
                "penetrate": 0,
                "attackSpeed": 0.1,
                "userElement": null,
                "attackElement": null,
                "jin": 0,
                "mu": 0,
                "tu": 0,
                "sui": 0,
                "huo": 0,
                "light": 0,
                "dark": 0,
                "luck": 0,
                "attackTimes": 1,
                "isDie": false,
                "originModel": {
                    "hp": 2530,
                    "mp": 330,
                    "name": "仙士可",
                    "level": 10,
                    "attack": 154,
                    "defense": 118,
                    "endurance": 10,
                    "intellect": 10,
                    "strength": 10,
                    "enduranceQualification": 1,
                    "intellectQualification": 1,
                    "strengthQualification": 1,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 200,
                    "hitRate": 100,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0.1,
                    "userElement": null,
                    "attackElement": null,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0,
                    "luck": 0,
                    "attackTimes": 1,
                    "isDie": false,
                    "buffList": [
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        []
                    ],
                    "skillList": []
                },
                "buffManager": {
                    "attributeType": null
                },
                "skillManager": null,
                "skillList": {
                    "0002": {
                        "skillName": "蓄力一击",
                        "skillCode": "0002",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "{$self.hitRate}",
                        "coolingTime": "5",
                        "manaCost": "10",
                        "description": "重重的一击,攻击附带100+100%的伤害",
                        "effectParam": [
                            {
                                "type": "harm",
                                "target": "enemy",
                                "harmType": "harm",
                                "countStr": "100+(100+{$skillInfo.level}*10)\/100*{$self.attack}",
                                "element": "{$self.attackElement}",
                                "isCritical": 1,
                                "criticalRate": "{$self.criticalRate}",
                                "criticalStrikeDamage": "{$self.criticalStrikeDamage}",
                                "name": "伤害"
                            }
                        ],
                        "tickTime": 0
                    },
                    "0004": {
                        "skillName": "雷霆万钧",
                        "skillCode": "0004",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "100",
                        "coolingTime": "10",
                        "manaCost": "10",
                        "description": "雷霆万钧,对敌人造成伤害,如果敌人存在感电效果,额外造成100%伤害",
                        "effectParam": [
                            {
                                "type": "effect001",
                                "addMultipleNum": "200",
                                "buffType": 51,
                                "buffCode": "001",
                                "target": "enemy",
                                "harmType": "harm",
                                "countStr": "100+(100+{$skillInfo.level}*10)\/100*{$self.attack}",
                                "element": "{$self.attackElement}",
                                "isCritical": 1,
                                "criticalRate": "{$self.criticalRate}",
                                "criticalStrikeDamage": "{$self.criticalStrikeDamage}",
                                "name": "伤害"
                            }
                        ],
                        "tickTime": 0
                    },
                    "0003": {
                        "skillName": "雷霆一击",
                        "skillCode": "0003",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "100",
                        "coolingTime": "10",
                        "manaCost": "10",
                        "description": "雷霆一击,对敌人造成伤害,并附带5秒[感电]效果",
                        "effectParam": [
                            {
                                "name": "叠加buff",
                                "type": "addBuff",
                                "target": "enemy",
                                "buffLayer": "1",
                                "buffCode": "001",
                                "buffBean": {
                                    "buffName": "感电",
                                    "buffCode": "001",
                                    "isDeBuff": 1,
                                    "level": 1,
                                    "buffLayer": 1,
                                    "maxBuffLayer": 1,
                                    "triggerType": "51",
                                    "triggerRate": 100,
                                    "coolingTime": null,
                                    "description": "感电",
                                    "expireType": 1,
                                    "expireTime": 5,
                                    "isExpire": false,
                                    "effectParam": []
                                }
                            }
                        ],
                        "tickTime": 0
                    },
                    "0005": {
                        "skillName": "治疗术",
                        "skillCode": "0005",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "100",
                        "coolingTime": "10",
                        "manaCost": "10",
                        "description": "立即回复自身生命值",
                        "effectParam": [
                            {
                                "type": "changeProperty",
                                "name": "治疗",
                                "numCount": "(10+({$skillInfo.level}*2))*{$selfBase.hp}\/100",
                                "propertyName": "hp",
                                "target": "self"
                            }
                        ],
                        "tickTime": 0
                    }
                }
            },
            "userEquipmentList": {
                "2": {
                    "backpackId": 749,
                    "userId": 1,
                    "isUse": 1,
                    "strengthenLevel": 0,
                    "attributeDescription": "[color=#FFFFFF]血量+100[\/color]\n[color=#FFFFFF]法力+10[\/color]",
                    "attributeEntryDescription": "[color=#FFFFFF]法力 +2[\/color]",
                    "extraAttributeDescription": null,
                    "suitAttribute2Description": null,
                    "suitAttribute3Description": null,
                    "suitAttribute5Description": null,
                    "goodsCode": "eq_0001",
                    "goodsName": "新手之帽",
                    "equipmentType": 2,
                    "suitCode": "0",
                    "rarityLevel": 2,
                    "level": 1,
                    "hp": 100,
                    "mp": 10,
                    "attack": 0,
                    "defense": 0,
                    "endurance": 0,
                    "intellect": 0,
                    "strength": 0,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 0,
                    "hitRate": 0,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0,
                    "userElement": 0,
                    "attackElement": 0,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0,
                    "luck": 0,
                    "equipmentAttributeEntryList": [
                        {
                            "id": 335,
                            "backpackId": 749,
                            "code": "012",
                            "baseCode": "0001",
                            "name": "法力",
                            "level": 1,
                            "description": "法力 +2",
                            "param": {
                                "attribute": "mp",
                                "num": 2
                            }
                        }
                    ]
                },
                "4": {
                    "backpackId": 751,
                    "userId": 1,
                    "isUse": 1,
                    "strengthenLevel": 0,
                    "attributeDescription": "[color=#FFFFFF]血量+100[\/color]",
                    "attributeEntryDescription": "[color=#FFFFFF]+1% 防御力[\/color]",
                    "extraAttributeDescription": null,
                    "suitAttribute2Description": null,
                    "suitAttribute3Description": null,
                    "suitAttribute5Description": null,
                    "goodsCode": "eq_0002",
                    "goodsName": "新手护腿",
                    "equipmentType": 4,
                    "suitCode": "0",
                    "rarityLevel": 2,
                    "level": 1,
                    "hp": 100,
                    "mp": 0,
                    "attack": 0,
                    "defense": 0,
                    "endurance": 0,
                    "intellect": 0,
                    "strength": 0,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 0,
                    "hitRate": 0,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0,
                    "userElement": 0,
                    "attackElement": 0,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0,
                    "luck": 0
                },
                "3": {
                    "backpackId": 752,
                    "userId": 1,
                    "isUse": 1,
                    "strengthenLevel": 0,
                    "attributeDescription": "[color=#FFFFFF]血量+100[\/color]",
                    "attributeEntryDescription": "[color=#0000FF]+2% 闪避率[\/color]",
                    "extraAttributeDescription": null,
                    "suitAttribute2Description": null,
                    "suitAttribute3Description": null,
                    "suitAttribute5Description": null,
                    "goodsCode": "eq_0003",
                    "goodsName": "新手之袍",
                    "equipmentType": 3,
                    "suitCode": "0",
                    "rarityLevel": 2,
                    "level": 1,
                    "hp": 100,
                    "mp": 0,
                    "attack": 0,
                    "defense": 0,
                    "endurance": 0,
                    "intellect": 0,
                    "strength": 0,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 0,
                    "hitRate": 0,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0,
                    "userElement": 0,
                    "attackElement": 0,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0,
                    "luck": 0
                },
                "5": {
                    "backpackId": 754,
                    "userId": 1,
                    "isUse": 1,
                    "strengthenLevel": 0,
                    "attributeDescription": "[color=#FFFFFF]血量+100[\/color]",
                    "attributeEntryDescription": "[color=#FFFFFF]+1% hp[\/color]",
                    "extraAttributeDescription": null,
                    "suitAttribute2Description": null,
                    "suitAttribute3Description": null,
                    "suitAttribute5Description": null,
                    "goodsCode": "eq_0004",
                    "goodsName": "新手之鞋",
                    "equipmentType": 5,
                    "suitCode": "0",
                    "rarityLevel": 2,
                    "level": 1,
                    "hp": 100,
                    "mp": 0,
                    "attack": 0,
                    "defense": 0,
                    "endurance": 0,
                    "intellect": 0,
                    "strength": 0,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 0,
                    "hitRate": 0,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0,
                    "userElement": 0,
                    "attackElement": 0,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0,
                    "luck": 0
                },
                "6": {
                    "backpackId": 757,
                    "userId": 1,
                    "isUse": 1,
                    "strengthenLevel": 0,
                    "attributeDescription": "[color=#FFFFFF]血量+100[\/color]",
                    "attributeEntryDescription": "[color=#FFFFFF]血量 +20[\/color]",
                    "extraAttributeDescription": null,
                    "suitAttribute2Description": null,
                    "suitAttribute3Description": null,
                    "suitAttribute5Description": null,
                    "goodsCode": "eq_0005",
                    "goodsName": "新手之披",
                    "equipmentType": 6,
                    "suitCode": "0",
                    "rarityLevel": 2,
                    "level": 1,
                    "hp": 100,
                    "mp": 0,
                    "attack": 0,
                    "defense": 0,
                    "endurance": 0,
                    "intellect": 0,
                    "strength": 0,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 0,
                    "hitRate": 0,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0,
                    "userElement": 0,
                    "attackElement": 0,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0,
                    "luck": 0,
                    "equipmentAttributeEntryList": [
                        {
                            "id": 337,
                            "backpackId": 757,
                            "code": "007",
                            "baseCode": "0001",
                            "name": "生命",
                            "level": 1,
                            "description": "血量 +20",
                            "param": {
                                "attribute": "hp",
                                "num": 20
                            }
                        }
                    ]
                }
            },
            "userPetList": {
                "10": {
                    "userPetId": 10,
                    "petId": 1,
                    "userId": 1,
                    "name": "铁甲蜥",
                    "type": "1",
                    "isUse": 1,
                    "description": "铁甲蜥",
                    "level": 1,
                    "classLevel": 0,
                    "awakeLevel": 0,
                    "exp": 0,
                    "isBest": 1,
                    "hp": 100,
                    "mp": 100,
                    "attack": 10,
                    "defense": 0,
                    "endurance": 0,
                    "intellect": 0,
                    "strength": 0,
                    "enduranceQualification": 0,
                    "intellectQualification": 0,
                    "strengthQualification": 0,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 0,
                    "hitRate": 100,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0,
                    "userElement": 1,
                    "attackElement": 0,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0
                }
            },
            "userNowAttribute": {
                "hp": 2530,
                "mp": 330,
                "name": "仙士可",
                "attributeType": null,
                "level": 10,
                "attack": 154,
                "defense": 118,
                "endurance": 10,
                "intellect": 10,
                "strength": 10,
                "criticalRate": 0,
                "criticalStrikeDamage": 200,
                "hitRate": 100,
                "dodgeRate": 0,
                "penetrate": 0,
                "attackSpeed": 0.1,
                "userElement": null,
                "attackElement": null,
                "jin": 0,
                "mu": 0,
                "tu": 0,
                "sui": 0,
                "huo": 0,
                "light": 0,
                "dark": 0,
                "luck": 0,
                "attackTimes": 1,
                "isDie": false,
                "originModel": {
                    "hp": 2530,
                    "mp": 330,
                    "name": "仙士可",
                    "level": 10,
                    "attack": 154,
                    "defense": 118,
                    "endurance": 10,
                    "intellect": 10,
                    "strength": 10,
                    "enduranceQualification": 1,
                    "intellectQualification": 1,
                    "strengthQualification": 1,
                    "criticalRate": 0,
                    "criticalStrikeDamage": 200,
                    "hitRate": 100,
                    "dodgeRate": 0,
                    "penetrate": 0,
                    "attackSpeed": 0.1,
                    "userElement": null,
                    "attackElement": null,
                    "jin": 0,
                    "mu": 0,
                    "tu": 0,
                    "sui": 0,
                    "huo": 0,
                    "light": 0,
                    "dark": 0,
                    "luck": 0,
                    "attackTimes": 1,
                    "isDie": false,
                    "buffList": [
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        [],
                        []
                    ],
                    "skillList": []
                },
                "buffManager": {
                    "attributeType": null
                },
                "skillManager": null,
                "skillList": {
                    "0002": {
                        "skillName": "蓄力一击",
                        "skillCode": "0002",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "{$self.hitRate}",
                        "coolingTime": "5",
                        "manaCost": "10",
                        "description": "重重的一击,攻击附带100+100%的伤害",
                        "effectParam": [
                            {
                                "type": "harm",
                                "target": "enemy",
                                "harmType": "harm",
                                "countStr": "100+(100+{$skillInfo.level}*10)\/100*{$self.attack}",
                                "element": "{$self.attackElement}",
                                "isCritical": 1,
                                "criticalRate": "{$self.criticalRate}",
                                "criticalStrikeDamage": "{$self.criticalStrikeDamage}",
                                "name": "伤害"
                            }
                        ],
                        "tickTime": 0
                    },
                    "0004": {
                        "skillName": "雷霆万钧",
                        "skillCode": "0004",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "100",
                        "coolingTime": "10",
                        "manaCost": "10",
                        "description": "雷霆万钧,对敌人造成伤害,如果敌人存在感电效果,额外造成100%伤害",
                        "effectParam": [
                            {
                                "type": "effect001",
                                "addMultipleNum": "200",
                                "buffType": 51,
                                "buffCode": "001",
                                "target": "enemy",
                                "harmType": "harm",
                                "countStr": "100+(100+{$skillInfo.level}*10)\/100*{$self.attack}",
                                "element": "{$self.attackElement}",
                                "isCritical": 1,
                                "criticalRate": "{$self.criticalRate}",
                                "criticalStrikeDamage": "{$self.criticalStrikeDamage}",
                                "name": "伤害"
                            }
                        ],
                        "tickTime": 0
                    },
                    "0003": {
                        "skillName": "雷霆一击",
                        "skillCode": "0003",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "100",
                        "coolingTime": "10",
                        "manaCost": "10",
                        "description": "雷霆一击,对敌人造成伤害,并附带5秒[感电]效果",
                        "effectParam": [
                            {
                                "name": "叠加buff",
                                "type": "addBuff",
                                "target": "enemy",
                                "buffLayer": "1",
                                "buffCode": "001",
                                "buffBean": {
                                    "buffName": "感电",
                                    "buffCode": "001",
                                    "isDeBuff": 1,
                                    "level": 1,
                                    "buffLayer": 1,
                                    "maxBuffLayer": 1,
                                    "triggerType": "51",
                                    "triggerRate": 100,
                                    "coolingTime": null,
                                    "description": "感电",
                                    "expireType": 1,
                                    "expireTime": 5,
                                    "isExpire": false,
                                    "effectParam": []
                                }
                            }
                        ],
                        "tickTime": 0
                    },
                    "0005": {
                        "skillName": "治疗术",
                        "skillCode": "0005",
                        "level": 1,
                        "triggerType": 0,
                        "triggerRate": "100",
                        "coolingTime": "10",
                        "manaCost": "10",
                        "description": "立即回复自身生命值",
                        "effectParam": [
                            {
                                "type": "changeProperty",
                                "name": "治疗",
                                "numCount": "(10+({$skillInfo.level}*2))*{$selfBase.hp}\/100",
                                "propertyName": "hp",
                                "target": "self"
                            }
                        ],
                        "tickTime": 0
                    }
                }
            }
        },
        "goodsChange": []
    },
    "msg": "用户信息"
}
```
### 战斗
- action:fight
- 参数
    - x 格子的x
    - y 格子的y

### 下一层
- action:nextLevelMap
- 只有打完怪物才可以进入下一层
- 进入下一层之后,将会重新推送地图信息和玩家信息

### 退出地下城
- action:exitMap

### 使用技能
- action:useSkill
- 参数
    - skillCode
    
### 打开箱子
- action:openBox
- 参数
    - x 格子的x
    - y 格子的y
### 逃跑
- action:stopFight
- 只有战斗时才可以逃跑

### 复活
- action:revive
- 消耗复活币复活

### 请求获取当前战斗状态
- action:fightStatus

### 使用物品
- action:useGoods
- 参数
    - goodsCode 物品code

## 服务端事件推送
### 地图信息 mapInfo
### 玩家信息 userInfo
### 退出地图 exitMap
### 打开箱子 boxOpen
### 战斗开始 fightStart
### 释放技能(普攻)前fightSkillBefore
### 释放技能(普攻)后 fightSkillAfter
### 新增buff buffAdd
### buff触发 buffResult
### 战斗伤害  fightHarm
### 玩家死亡 userDie
### 怪物死亡 monsterDie
### 属性变动 property
### 物品变动 goodsChange
### buff变动(更新) buffChange
### 战斗结束 fightEnd
### 战斗状态推送 fightStatus  (断线重连后,可请求此接口)
### 
### 


###  客户端流程
- 在用户选择完地图后,连接websocket
- 

